(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const eT=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Xf="ACCEPTED_ON_L2",Qf="ACCEPTED_ON_L1",tm="SUCCEEDED",nm="REVERTED",tT="PENDING",rm="REJECTED",sm="RECEIVED",im="DECLARE",om="DEPLOY",am="DEPLOY_ACCOUNT",cm="INVOKE",lm="L1_HANDLER",nT="struct",rT="event",sT="function",iT="constructor",oT="l1_handler",aT="enum",cT="view",lT="external",uT="WEI",dT="FRI",fT={BLOB:"BLOB",CALLDATA:"CALLDATA"},hT={DELEGATE:"DELEGATE",LIBRARY_CALL:"LIBRARY_CALL",CALL:"CALL"},es={DECLARE:im,DEPLOY:om,DEPLOY_ACCOUNT:am,INVOKE:cm,L1_HANDLER:lm},el={SKIP_VALIDATE:"SKIP_VALIDATE",SKIP_FEE_CHARGE:"SKIP_FEE_CHARGE"},tl={RECEIVED:sm,REJECTED:rm,ACCEPTED_ON_L2:Xf,ACCEPTED_ON_L1:Qf},pT={ACCEPTED_ON_L2:Xf,ACCEPTED_ON_L1:Qf},gT={SUCCEEDED:tm,REVERTED:nm},_T={LATEST:"latest",PENDING:"pending"},yT={L1:"L1",L2:"L2"},mT={L1:0,L2:1},Tn={V0:"0x0",V1:"0x1",V2:"0x2",V3:"0x3",F0:"0x100000000000000000000000000000000",F1:"0x100000000000000000000000000000001",F2:"0x100000000000000000000000000000002",F3:"0x100000000000000000000000000000003"},bT={V0:Tn.V0,V1:Tn.V1,V2:Tn.V2,F0:Tn.F0,F1:Tn.F1,F2:Tn.F2},wT={V3:Tn.V3,F3:Tn.F3},gO=Object.freeze(Object.defineProperty({__proto__:null,ABI_TYPE_CONSTRUCTOR:iT,ABI_TYPE_ENUM:aT,ABI_TYPE_FUNCTION:sT,ABI_TYPE_L1_HANDLER:oT,CALL_TYPE:hT,CONTRACT:eT,EBlockTag:_T,EDAMode:mT,EDataAvailabilityMode:yT,ESimulationFlag:el,ETransactionExecutionStatus:gT,ETransactionFinalityStatus:pT,ETransactionStatus:tl,ETransactionType:es,ETransactionVersion:Tn,ETransactionVersion2:bT,ETransactionVersion3:wT,EVENT_ABI_TYPE:rT,L1_DA_MODE:fT,PRICE_UNIT_FRI:dT,PRICE_UNIT_WEI:uT,STATE_MUTABILITY_EXTERNAL:lT,STATE_MUTABILITY_VIEW:cT,STATUS_ACCEPTED_ON_L1:Qf,STATUS_ACCEPTED_ON_L2:Xf,STATUS_PENDING:tT,STATUS_RECEIVED:sm,STATUS_REJECTED:rm,STATUS_REVERTED:nm,STATUS_SUCCEEDED:tm,STRUCT_ABI_TYPE:nT,TXN_TYPE_DECLARE:im,TXN_TYPE_DEPLOY:om,TXN_TYPE_DEPLOY_ACCOUNT:am,TXN_TYPE_INVOKE:cm,TXN_TYPE_L1_HANDLER:lm},Symbol.toStringTag,{value:"Module"})),kT={ACCOUNTS:"accounts"},ET={ACTIVE:"1",LEGACY:"0"},_O=Object.freeze(Object.defineProperty({__proto__:null,Permission:kT,TypedDataRevision:ET},Symbol.toStringTag,{value:"Module"})),TT=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),um=Object.freeze(Object.defineProperty({__proto__:null,ABI_TYPE_CONSTRUCTOR:iT,ABI_TYPE_ENUM:aT,ABI_TYPE_FUNCTION:sT,ABI_TYPE_L1_HANDLER:oT,API:gO,CALL_TYPE:hT,CONTRACT:eT,EBlockTag:_T,EDAMode:mT,EDataAvailabilityMode:yT,ESimulationFlag:el,ETransactionExecutionStatus:gT,ETransactionFinalityStatus:pT,ETransactionStatus:tl,ETransactionType:es,ETransactionVersion:Tn,ETransactionVersion2:bT,ETransactionVersion3:wT,EVENT_ABI_TYPE:rT,L1_DA_MODE:fT,PAYMASTER_API:TT,PRICE_UNIT_FRI:dT,PRICE_UNIT_WEI:uT,Permission:kT,STATE_MUTABILITY_EXTERNAL:lT,STATE_MUTABILITY_VIEW:cT,STATUS_ACCEPTED_ON_L1:Qf,STATUS_ACCEPTED_ON_L2:Xf,STATUS_PENDING:tT,STATUS_RECEIVED:sm,STATUS_REJECTED:rm,STATUS_REVERTED:nm,STATUS_SUCCEEDED:tm,STRUCT_ABI_TYPE:nT,TXN_TYPE_DECLARE:im,TXN_TYPE_DEPLOY:om,TXN_TYPE_DEPLOY_ACCOUNT:am,TXN_TYPE_INVOKE:cm,TXN_TYPE_L1_HANDLER:lm,TypedDataRevision:ET,WALLET_API:_O},Symbol.toStringTag,{value:"Module"})),vT=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Jl="ACCEPTED_ON_L2",Xl="ACCEPTED_ON_L1",dm="SUCCEEDED",fm="REVERTED",hm="RECEIVED",pm="CANDIDATE",Ga="PRE_CONFIRMED",gm=Ga.toLowerCase(),_m="DECLARE",ym="DEPLOY",mm="DEPLOY_ACCOUNT",bm="INVOKE",wm="L1_HANDLER",ST="struct",AT="event",IT="function",NT="constructor",xT="l1_handler",RT="enum",CT="view",OT="external",BT="WEI",$T="FRI",DT={BLOB:"BLOB",CALLDATA:"CALLDATA"},MT={DELEGATE:"DELEGATE",LIBRARY_CALL:"LIBRARY_CALL",CALL:"CALL"},km={DECLARE:_m,DEPLOY:ym,DEPLOY_ACCOUNT:mm,INVOKE:bm,L1_HANDLER:wm},nl={SKIP_VALIDATE:"SKIP_VALIDATE",SKIP_FEE_CHARGE:"SKIP_FEE_CHARGE"},Os={RECEIVED:hm,CANDIDATE:pm,PRE_CONFIRMED:Ga,ACCEPTED_ON_L2:Jl,ACCEPTED_ON_L1:Xl},wi={PRE_CONFIRMED:Ga,ACCEPTED_ON_L2:Jl,ACCEPTED_ON_L1:Xl},Em={SUCCEEDED:dm,REVERTED:fm},LT={LATEST:"latest",PRE_CONFIRMED:gm,L1_ACCEPTED:"l1_accepted"},UT={PRE_CONFIRMED:Ga,ACCEPTED_ON_L2:Jl,ACCEPTED_ON_L1:Xl},PT={L1:"L1",L2:"L2"},FT={L1:0,L2:1},xr={V0:"0x0",V1:"0x1",V2:"0x2",V3:"0x3",F0:"0x100000000000000000000000000000000",F1:"0x100000000000000000000000000000001",F2:"0x100000000000000000000000000000002",F3:"0x100000000000000000000000000000003"},jT={V0:xr.V0,V1:xr.V1,V2:xr.V2,F0:xr.F0,F1:xr.F1,F2:xr.F2},VT={V3:xr.V3,F3:xr.F3},yO=Object.freeze(Object.defineProperty({__proto__:null,ABI_TYPE_CONSTRUCTOR:NT,ABI_TYPE_ENUM:RT,ABI_TYPE_FUNCTION:IT,ABI_TYPE_L1_HANDLER:xT,CALL_TYPE:MT,CONTRACT:vT,EBlockStatus:UT,EBlockTag:LT,EDAMode:FT,EDataAvailabilityMode:PT,ESimulationFlag:nl,ETransactionExecutionStatus:Em,ETransactionFinalityStatus:wi,ETransactionStatus:Os,ETransactionType:km,ETransactionVersion:xr,ETransactionVersion2:jT,ETransactionVersion3:VT,EVENT_ABI_TYPE:AT,L1_DA_MODE:DT,PRICE_UNIT_FRI:$T,PRICE_UNIT_WEI:BT,STATE_MUTABILITY_EXTERNAL:OT,STATE_MUTABILITY_VIEW:CT,STATUS_ACCEPTED_ON_L1:Xl,STATUS_ACCEPTED_ON_L2:Jl,STATUS_CANDIDATE:pm,STATUS_PRE_CONFIRMED:Ga,STATUS_PRE_CONFIRMED_LOWERCASE:gm,STATUS_RECEIVED:hm,STATUS_REVERTED:fm,STATUS_SUCCEEDED:dm,STRUCT_ABI_TYPE:ST,TXN_TYPE_DECLARE:_m,TXN_TYPE_DEPLOY:ym,TXN_TYPE_DEPLOY_ACCOUNT:mm,TXN_TYPE_INVOKE:bm,TXN_TYPE_L1_HANDLER:wm},Symbol.toStringTag,{value:"Module"})),zT={ACCOUNTS:"accounts"},qT={ACTIVE:"1",LEGACY:"0"},mO=Object.freeze(Object.defineProperty({__proto__:null,Permission:zT,TypedDataRevision:qT},Symbol.toStringTag,{value:"Module"})),bO=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Za=Object.freeze(Object.defineProperty({__proto__:null,ABI_TYPE_CONSTRUCTOR:NT,ABI_TYPE_ENUM:RT,ABI_TYPE_FUNCTION:IT,ABI_TYPE_L1_HANDLER:xT,API:yO,CALL_TYPE:MT,CONTRACT:vT,EBlockStatus:UT,EBlockTag:LT,EDAMode:FT,EDataAvailabilityMode:PT,ESimulationFlag:nl,ETransactionExecutionStatus:Em,ETransactionFinalityStatus:wi,ETransactionStatus:Os,ETransactionType:km,ETransactionVersion:xr,ETransactionVersion2:jT,ETransactionVersion3:VT,EVENT_ABI_TYPE:AT,L1_DA_MODE:DT,PAYMASTER_API:bO,PRICE_UNIT_FRI:$T,PRICE_UNIT_WEI:BT,Permission:zT,STATE_MUTABILITY_EXTERNAL:OT,STATE_MUTABILITY_VIEW:CT,STATUS_ACCEPTED_ON_L1:Xl,STATUS_ACCEPTED_ON_L2:Jl,STATUS_CANDIDATE:pm,STATUS_PRE_CONFIRMED:Ga,STATUS_PRE_CONFIRMED_LOWERCASE:gm,STATUS_RECEIVED:hm,STATUS_REVERTED:fm,STATUS_SUCCEEDED:dm,STRUCT_ABI_TYPE:ST,TXN_TYPE_DECLARE:_m,TXN_TYPE_DEPLOY:ym,TXN_TYPE_DEPLOY_ACCOUNT:mm,TXN_TYPE_INVOKE:bm,TXN_TYPE_L1_HANDLER:wm,TypedDataRevision:qT,WALLET_API:mO},Symbol.toStringTag,{value:"Module"}));/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function wO(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function HT(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function Wd(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Tm(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function Zg(e){if(!Array.isArray(e))throw new Error("array expected")}function Kd(e,t){if(!HT(!0,t))throw new Error(`${e}: array of strings expected`)}function kO(e,t){if(!HT(!1,t))throw new Error(`${e}: array of numbers expected`)}function EO(...e){const t=i=>i,n=(i,o)=>a=>i(o(a)),r=e.map(i=>i.encode).reduceRight(n,t),s=e.map(i=>i.decode).reduce(n,t);return{encode:r,decode:s}}function TO(e){const t=typeof e=="string"?e.split(""):e,n=t.length;Kd("alphabet",t);const r=new Map(t.map((s,i)=>[s,i]));return{encode:s=>(Zg(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${e}`);return t[i]})),decode:s=>(Zg(s),s.map(i=>{Wd("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${e}`);return o}))}}function vO(e=""){return Wd("join",e),{encode:t=>(Kd("join.decode",t),t.join(e)),decode:t=>(Wd("join.decode",t),t.split(e))}}function SO(e,t="="){return Tm(e),Wd("padding",t),{encode(n){for(Kd("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){Kd("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}const WT=(e,t)=>t===0?e:WT(t,e%t),Yd=(e,t)=>e+(t-WT(e,t)),Ep=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function r0(e,t,n,r){if(Zg(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Yd(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Yd(t,n)}`);let s=0,i=0;const o=Ep[t],a=Ep[n]-1,c=[];for(const l of e){if(Tm(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${t}`);if(s=s<<t|l,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)c.push((s>>i-n&a)>>>0);const u=Ep[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-i&a,!r&&i>=t)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&c.push(s>>>0),c}function AO(e,t=!1){if(Tm(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Yd(8,e)>32||Yd(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!wO(n))throw new Error("radix2.encode input should be Uint8Array");return r0(Array.from(n),8,e,!t)},decode:n=>(kO("radix2.decode",n),Uint8Array.from(r0(n,e,8,t)))}}const KT=EO(AO(6),TO("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),SO(6),vO(""));function eh(e){return IO.test(e)}const IO=/^-?[0-9]+$/;function YT(e){return NO.test(e)}const NO=/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?$/;function xO(e,t){const n=Number.parseFloat(e),r=String(n),s=s0(e),i=s0(r);return s===i}let Ic=function(e){return e.underflow="underflow",e.overflow="overflow",e.truncate_integer="truncate_integer",e.truncate_float="truncate_float",e}({});function RO(e){if(xO(e))return;if(eh(e))return Ic.truncate_integer;const t=Number.parseFloat(e);return Number.isFinite(t)?t===0?Ic.underflow:Ic.truncate_float:Ic.overflow}function s0(e){return e.replace(CO,"").replace(BO,"").replace($O,"").replace(OO,"")}const CO=/[eE][+-]?\d+$/,OO=/^-?(0*)?/,BO=/\./,$O=/0+$/;class DO{isLosslessNumber=!0;constructor(t){if(!YT(t))throw new Error(`Invalid number (value: "${t}")`);this.value=t}valueOf(){const t=RO(this.value);if(t===void 0||t===Ic.truncate_float)return Number.parseFloat(this.value);if(eh(this.value))return BigInt(this.value);throw new Error(`Cannot safely convert to number: the value '${this.value}' would ${t} and become ${Number.parseFloat(this.value)}`)}toString(){return this.value}}function MO(e){return e&&typeof e=="object"&&e.isLosslessNumber===!0||!1}function LO(e){return new DO(e)}function UO(e){return eh(e)?BigInt(e):Number.parseFloat(e)}function PO(e,t){return vm({"":e},"",e,t)}function vm(e,t,n,r){return Array.isArray(n)?r.call(e,t,jO(n,r)):n&&typeof n=="object"&&!MO(n)?r.call(e,t,FO(n,r)):r.call(e,t,n)}function FO(e,t){for(const n of Object.keys(e)){const r=vm(e,n,e[n],t);r!==void 0?e[n]=r:delete e[n]}return e}function jO(e,t){for(let n=0;n<e.length;n++)e[n]=vm(e,String(n),e[n],t);return e}function GT(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:LO,r=0;const s=a();return p(s),g(),t?PO(s,t):s;function i(){if(e.charCodeAt(r)===KO){r++,l();const R={};let U=!0;for(;r<e.length&&e.charCodeAt(r)!==o0;){U?U=!1:(f(),l());const P=r,q=u();if(q===void 0){k();return}l(),h();const Z=a();if(Z===void 0){x();return}Object.prototype.hasOwnProperty.call(R,q)&&!Jg(Z,R[q])&&b(q,P+1),R[q]=Z}return e.charCodeAt(r)!==o0&&N(),r++,R}}function o(){if(e.charCodeAt(r)===YO){r++,l();const R=[];let U=!0;for(;r<e.length&&e.charCodeAt(r)!==a0;){U?U=!1:f();const P=a();_(P),R.push(P)}return e.charCodeAt(r)!==a0&&S(),r++,R}}function a(){l();const R=u()??d()??i()??o()??c("true",!0)??c("false",!1)??c("null",null);return l(),R}function c(R,U){if(e.slice(r,r+R.length)===R)return r+=R.length,U}function l(){for(;VO(e.charCodeAt(r));)r++}function u(){if(e.charCodeAt(r)===Tp){r++;let R="";for(;r<e.length&&e.charCodeAt(r)!==Tp;){if(e.charCodeAt(r)===WO){const U=e[r+1],P=HO[U];P!==void 0?(R+=P,r++):U==="u"?Lu(e.charCodeAt(r+2))&&Lu(e.charCodeAt(r+3))&&Lu(e.charCodeAt(r+4))&&Lu(e.charCodeAt(r+5))?(R+=String.fromCharCode(Number.parseInt(e.slice(r+2,r+6),16)),r+=5):D(r):A(r)}else qO(e.charCodeAt(r))?R+=e[r]:E(e[r]);r++}return w(),r++,R}}function d(){const R=r;if(e.charCodeAt(r)===c0&&(r++,y(R)),e.charCodeAt(r)===Sm)r++;else if(zO(e.charCodeAt(r)))for(r++;Uu(e.charCodeAt(r));)r++;if(e.charCodeAt(r)===nB)for(r++,y(R);Uu(e.charCodeAt(r));)r++;if(e.charCodeAt(r)===aB||e.charCodeAt(r)===oB)for(r++,(e.charCodeAt(r)===c0||e.charCodeAt(r)===QO)&&r++,y(R);Uu(e.charCodeAt(r));)r++;if(r>R)return n(e.slice(R,r))}function f(){if(e.charCodeAt(r)!==tB)throw new SyntaxError(`Comma ',' expected after value ${J()}`);r++}function h(){if(e.charCodeAt(r)!==rB)throw new SyntaxError(`Colon ':' expected after property name ${J()}`);r++}function p(R){if(R===void 0)throw new SyntaxError(`JSON value expected ${J()}`)}function _(R){if(R===void 0)throw new SyntaxError(`Array item expected ${J()}`)}function g(){if(r<e.length)throw new SyntaxError(`Expected end of input ${J()}`)}function y(R){if(!Uu(e.charCodeAt(r))){const U=e.slice(R,r);throw new SyntaxError(`Invalid number '${U}', expecting a digit ${J()}`)}}function w(){if(e.charCodeAt(r)!==Tp)throw new SyntaxError(`End of string '"' expected ${J()}`)}function k(){throw new SyntaxError(`Quoted object key expected ${J()}`)}function b(R,U){throw new SyntaxError(`Duplicate key '${R}' encountered at position ${U}`)}function N(){throw new SyntaxError(`Quoted object key or end of object '}' expected ${J()}`)}function S(){throw new SyntaxError(`Array item or end of array ']' expected ${J()}`)}function E(R){throw new SyntaxError(`Invalid character '${R}' ${B()}`)}function A(R){const U=e.slice(R,R+2);throw new SyntaxError(`Invalid escape character '${U}' ${B()}`)}function x(){throw new SyntaxError(`Object value expected after ':' ${B()}`)}function D(R){const U=e.slice(R,R+6);throw new SyntaxError(`Invalid unicode character '${U}' ${B()}`)}function B(){return`at position ${r}`}function z(){return r<e.length?`but got '${e[r]}'`:"but reached end of input"}function J(){return`${z()} ${B()}`}}function VO(e){return e===GO||e===ZO||e===JO||e===XO}function Lu(e){return e>=Sm&&e<=Am||e>=sB&&e<=cB||e>=iB&&e<=lB}function Uu(e){return e>=Sm&&e<=Am}function zO(e){return e>=eB&&e<=Am}function qO(e){return e>=32&&e<=1114111}function Jg(e,t){return e===t?!0:Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every((n,r)=>Jg(n,t[r])):i0(e)&&i0(t)?[...new Set([...Object.keys(e),...Object.keys(t)])].every(r=>Jg(e[r],t[r])):!1}function i0(e){return typeof e=="object"&&e!==null}const HO={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},WO=92,KO=123,o0=125,YO=91,a0=93,GO=32,ZO=10,JO=9,XO=13,Tp=34,QO=43,c0=45,Sm=48,eB=49,Am=57,tB=44,nB=46,rB=58,sB=65,iB=97,oB=69,aB=101,cB=70,lB=102;function ZT(e,t,n,r){const s=uB(n),i=typeof t=="function"?t.call({"":e},"",e):e;return o(i,"");function o(u,d){if(Array.isArray(r)){const f=r.find(h=>h.test(u));if(f){const h=f.stringify(u);if(typeof h!="string"||!YT(h))throw new Error(`Invalid JSON number: output of a number stringifier must be a string containing a JSON number (output: ${h})`);return h}}if(typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u===null||u instanceof Date||u instanceof Boolean||u instanceof Number||u instanceof String)return JSON.stringify(u);if(u?.isLosslessNumber||typeof u=="bigint")return u.toString();if(Array.isArray(u))return a(u,d);if(u&&typeof u=="object")return c(u,d)}function a(u,d){if(u.length===0)return"[]";const f=s?d+s:void 0;let h=s?`[
`:"[";for(let p=0;p<u.length;p++){const _=typeof t=="function"?t.call(u,String(p),u[p]):u[p];s&&(h+=f),typeof _<"u"&&typeof _!="function"?h+=o(_,f):h+="null",p<u.length-1&&(h+=s?`,
`:",")}return h+=s?`
${d}]`:"]",h}function c(u,d){if(typeof u.toJSON=="function")return ZT(u.toJSON(),t,n,void 0);const f=Array.isArray(t)?t.map(String):Object.keys(u);if(f.length===0)return"{}";const h=s?d+s:void 0;let p=!0,_=s?`{
`:"{";for(const g of f){const y=typeof t=="function"?t.call(u,g,u[g]):u[g];if(l(g,y)){p?p=!1:_+=s?`,
`:",";const w=JSON.stringify(g);_+=s?`${h+w}: `:`${w}:`,_+=o(y,h)}}return _+=s?`
${d}}`:"}",_}function l(u,d){return typeof d<"u"&&typeof d!="function"&&typeof d!="symbol"}}function uB(e){if(typeof e=="number")return" ".repeat(e);if(typeof e=="string"&&e!=="")return e}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const th=BigInt(0),nh=BigInt(1),dB=BigInt(2);function Wi(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ql(e){if(!Wi(e))throw new Error("Uint8Array expected")}function ga(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}const fB=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function fs(e){Ql(e);let t="";for(let n=0;n<e.length;n++)t+=fB[e[n]];return t}function Uo(e){const t=e.toString(16);return t.length&1?"0"+t:t}function rh(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?th:BigInt("0x"+e)}const Gr={_0:48,_9:57,A:65,F:70,a:97,f:102};function l0(e){if(e>=Gr._0&&e<=Gr._9)return e-Gr._0;if(e>=Gr.A&&e<=Gr.F)return e-(Gr.A-10);if(e>=Gr.a&&e<=Gr.f)return e-(Gr.a-10)}function Vs(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=l0(e.charCodeAt(i)),a=l0(e.charCodeAt(i+1));if(o===void 0||a===void 0){const c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function Wt(e){return rh(fs(e))}function Im(e){return Ql(e),rh(fs(Uint8Array.from(e).reverse()))}function _a(e,t){return Vs(e.toString(16).padStart(t*2,"0"))}function Nm(e,t){return _a(e,t).reverse()}function xm(e){return Vs(Uo(e))}function Fn(e,t,n){let r;if(typeof t=="string")try{r=Vs(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if(Wi(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}function ya(...e){let t=0;for(let r=0;r<e.length;r++){const s=e[r];Ql(s),t+=s.length}const n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}function hB(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function pB(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}const vp=e=>typeof e=="bigint"&&th<=e;function sh(e,t,n){return vp(e)&&vp(t)&&vp(n)&&t<=e&&e<n}function $i(e,t,n,r){if(!sh(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function JT(e){let t;for(t=0;e>th;e>>=nh,t+=1);return t}function gB(e,t){return e>>BigInt(t)&nh}function _B(e,t,n){return e|(n?nh:th)<<BigInt(t)}const ih=e=>(dB<<BigInt(e-1))-nh,Sp=e=>new Uint8Array(e),u0=e=>Uint8Array.from(e);function XT(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=Sp(e),s=Sp(e),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...d)=>n(s,r,...d),c=(d=Sp())=>{s=a(u0([0]),d),r=a(),d.length!==0&&(s=a(u0([1]),d),r=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const f=[];for(;d<t;){r=a();const h=r.slice();f.push(h),d+=r.length}return ya(...f)};return(d,f)=>{o(),c(d);let h;for(;!(h=f(l()));)c();return o(),h}}const yB={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||Wi(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function eu(e,t,n={}){const r=(s,i,o)=>{const a=yB[i];if(typeof a!="function")throw new Error("invalid validator function");const c=e[s];if(!(o&&c===void 0)&&!a(c,e))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(t))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return e}const mB=()=>{throw new Error("not implemented")};function Xg(e){const t=new WeakMap;return(n,...r)=>{const s=t.get(n);if(s!==void 0)return s;const i=e(n,...r);return t.set(n,i),i}}const bB=Object.freeze(Object.defineProperty({__proto__:null,aInRange:$i,abool:ga,abytes:Ql,bitGet:gB,bitLen:JT,bitMask:ih,bitSet:_B,bytesToHex:fs,bytesToNumberBE:Wt,bytesToNumberLE:Im,concatBytes:ya,createHmacDrbg:XT,ensureBytes:Fn,equalBytes:hB,hexToBytes:Vs,hexToNumber:rh,inRange:sh,isBytes:Wi,memoized:Xg,notImplemented:mB,numberToBytesBE:_a,numberToBytesLE:Nm,numberToHexUnpadded:Uo,numberToVarBytesBE:xm,utf8ToBytes:pB,validateObject:eu},Symbol.toStringTag,{value:"Module"}));function Gd(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function wB(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function tu(e,...t){if(!wB(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function kB(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Gd(e.outputLen),Gd(e.blockLen)}function ma(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function QT(e,t){tu(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Ao=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const EB=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ap=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),kr=(e,t)=>e<<32-t|e>>>t,d0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,TB=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function f0(e){for(let t=0;t<e.length;t++)e[t]=TB(e[t])}function ev(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function oh(e){return typeof e=="string"&&(e=ev(e)),tu(e),e}function vB(...e){let t=0;for(let r=0;r<e.length;r++){const s=e[r];tu(s),t+=s.length}const n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}class Rm{clone(){return this._cloneInto()}}function tv(e){const t=r=>e().update(oh(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function SB(e=32){if(Ao&&typeof Ao.getRandomValues=="function")return Ao.getRandomValues(new Uint8Array(e));if(Ao&&typeof Ao.randomBytes=="function")return Ao.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function AB(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+l,a,r)}const IB=(e,t,n)=>e&t^~e&n,NB=(e,t,n)=>e&t^e&n^t&n;class xB extends Rm{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ap(this.buffer)}update(t){ma(this);const{view:n,buffer:r,blockLen:s}=this;t=oh(t);const i=t.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Ap(t);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ma(this),QT(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;AB(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Ap(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return t.length=s,t.pos=a,t.finished=i,t.destroyed=o,s%n&&t.buffer.set(r),t}}const RB=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ms=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),bs=new Uint32Array(64);class CB extends xB{constructor(){super(64,32,8,!1),this.A=ms[0]|0,this.B=ms[1]|0,this.C=ms[2]|0,this.D=ms[3]|0,this.E=ms[4]|0,this.F=ms[5]|0,this.G=ms[6]|0,this.H=ms[7]|0}get(){const{A:t,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[t,n,r,s,i,o,a,c]}set(t,n,r,s,i,o,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)bs[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const f=bs[d-15],h=bs[d-2],p=kr(f,7)^kr(f,18)^f>>>3,_=kr(h,17)^kr(h,19)^h>>>10;bs[d]=_+bs[d-7]+p+bs[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const f=kr(a,6)^kr(a,11)^kr(a,25),h=u+f+IB(a,c,l)+RB[d]+bs[d]|0,_=(kr(r,2)^kr(r,13)^kr(r,22))+NB(r,s,i)|0;u=l,l=c,c=a,a=o+h|0,o=i,i=s,s=r,r=h+_|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){bs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const nu=tv(()=>new CB),Pu=BigInt(2**32-1),h0=BigInt(32);function OB(e,t=!1){return t?{h:Number(e&Pu),l:Number(e>>h0&Pu)}:{h:Number(e>>h0&Pu)|0,l:Number(e&Pu)|0}}function BB(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:i,l:o}=OB(e[s],t);[n[s],r[s]]=[i,o]}return[n,r]}const $B=(e,t,n)=>e<<n|t>>>32-n,DB=(e,t,n)=>t<<n|e>>>32-n,MB=(e,t,n)=>t<<n-32|e>>>64-n,LB=(e,t,n)=>e<<n-32|t>>>64-n,nv=[],rv=[],sv=[],UB=BigInt(0),yc=BigInt(1),PB=BigInt(2),FB=BigInt(7),jB=BigInt(256),VB=BigInt(113);for(let e=0,t=yc,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],nv.push(2*(5*r+n)),rv.push((e+1)*(e+2)/2%64);let s=UB;for(let i=0;i<7;i++)t=(t<<yc^(t>>FB)*VB)%jB,t&PB&&(s^=yc<<(yc<<BigInt(i))-yc);sv.push(s)}const[zB,qB]=BB(sv,!0),p0=(e,t,n)=>n>32?MB(e,t,n):$B(e,t,n),g0=(e,t,n)=>n>32?LB(e,t,n):DB(e,t,n);function HB(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=p0(l,u,1)^n[a],f=g0(l,u,1)^n[a+1];for(let h=0;h<50;h+=10)e[o+h]^=d,e[o+h+1]^=f}let s=e[2],i=e[3];for(let o=0;o<24;o++){const a=rv[o],c=p0(s,i,a),l=g0(s,i,a),u=nv[o];s=e[u],i=e[u+1],e[u]=c,e[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=zB[r],e[1]^=qB[r]}n.fill(0)}class Cm extends Rm{constructor(t,n,r,s=!1,i=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Gd(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=EB(this.state)}keccak(){d0||f0(this.state32),HB(this.state32,this.rounds),d0||f0(this.state32),this.posOut=0,this.pos=0}update(t){ma(this);const{blockLen:n,state:r}=this;t=oh(t);const s=t.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=t[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){ma(this,!1),tu(t),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=t.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);t.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Gd(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(QT(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return t||(t=new Cm(n,r,s,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=s,t.enableXOF=o,t.destroyed=this.destroyed,t}}const WB=(e,t,n)=>tv(()=>new Cm(t,e,n)),iv=WB(1,136,256/8);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pt=BigInt(0),Ye=BigInt(1),ki=BigInt(2),KB=BigInt(3),Qg=BigInt(4),_0=BigInt(5),y0=BigInt(8);function Nt(e,t){const n=e%t;return n>=pt?n:t+n}function YB(e,t,n){if(t<pt)throw new Error("invalid exponent, negatives unsupported");if(n<=pt)throw new Error("invalid modulus");if(n===Ye)return pt;let r=Ye;for(;t>pt;)t&Ye&&(r=r*e%n),e=e*e%n,t>>=Ye;return r}function $n(e,t,n){let r=e;for(;t-- >pt;)r*=r,r%=n;return r}function Zd(e,t){if(e===pt)throw new Error("invert: expected non-zero number");if(t<=pt)throw new Error("invert: expected positive modulus, got "+t);let n=Nt(e,t),r=t,s=pt,i=Ye;for(;n!==pt;){const a=r/n,c=r%n,l=s-i*a;r=n,n=c,s=i,i=l}if(r!==Ye)throw new Error("invert: does not exist");return Nt(s,t)}function GB(e){const t=(e-Ye)/ki;let n,r,s;for(n=e-Ye,r=0;n%ki===pt;n/=ki,r++);for(s=ki;s<e&&YB(s,t,e)!==e-Ye;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(e+Ye)/Qg;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(n+Ye)/ki;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=r,u=a.pow(a.mul(a.ONE,s),n),d=a.pow(c,i),f=a.pow(c,n);for(;!a.eql(f,a.ONE);){if(a.eql(f,a.ZERO))return a.ZERO;let h=1;for(let _=a.sqr(f);h<l&&!a.eql(_,a.ONE);h++)_=a.sqr(_);const p=a.pow(u,Ye<<BigInt(l-h-1));u=a.sqr(p),d=a.mul(d,p),f=a.mul(f,u),l=h}return d}}function ZB(e){if(e%Qg===KB){const t=(e+Ye)/Qg;return function(r,s){const i=r.pow(s,t);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(e%y0===_0){const t=(e-_0)/y0;return function(r,s){const i=r.mul(s,ki),o=r.pow(i,t),a=r.mul(s,o),c=r.mul(r.mul(a,ki),o),l=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(l),s))throw new Error("Cannot find square root");return l}}return GB(e)}const JB=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ah(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=JB.reduce((r,s)=>(r[s]="function",r),t);return eu(e,n)}function ov(e,t,n){if(n<pt)throw new Error("invalid exponent, negatives unsupported");if(n===pt)return e.ONE;if(n===Ye)return t;let r=e.ONE,s=t;for(;n>pt;)n&Ye&&(r=e.mul(r,s)),s=e.sqr(s),n>>=Ye;return r}function XB(e,t){const n=new Array(t.length),r=t.reduce((i,o,a)=>e.is0(o)?i:(n[a]=i,e.mul(i,o)),e.ONE),s=e.inv(r);return t.reduceRight((i,o,a)=>e.is0(o)?i:(n[a]=e.mul(i,n[a]),e.mul(i,o)),s),n}function av(e,t){const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function ch(e,t,n=!1,r={}){if(e<=pt)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:s,nByteLength:i}=av(e,t);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,BITS:s,BYTES:i,MASK:ih(s),ZERO:pt,ONE:Ye,create:c=>Nt(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return pt<=c&&c<e},is0:c=>c===pt,isOdd:c=>(c&Ye)===Ye,neg:c=>Nt(-c,e),eql:(c,l)=>c===l,sqr:c=>Nt(c*c,e),add:(c,l)=>Nt(c+l,e),sub:(c,l)=>Nt(c-l,e),mul:(c,l)=>Nt(c*l,e),pow:(c,l)=>ov(a,c,l),div:(c,l)=>Nt(c*Zd(l,e),e),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Zd(c,e),sqrt:r.sqrt||(c=>(o||(o=ZB(e)),o(a,c))),invertBatch:c=>XB(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?Nm(c,i):_a(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?Im(c):Wt(c)}});return Object.freeze(a)}function cv(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function lv(e){const t=cv(e);return t+Math.ceil(t/2)}function QB(e,t,n=!1){const r=e.length,s=cv(t),i=lv(t);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?Wt(e):Im(e),a=Nt(o,t-Ye)+Ye;return n?Nm(a,s):_a(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function uv(e){const{Fp:t,mds:n,reversePartialPowIdx:r,roundConstants:s}=e,{roundsFull:i,roundsPartial:o,sboxPower:a,t:c}=e;ah(t);for(const p of["t","roundsFull","roundsPartial"])if(typeof e[p]!="number"||!Number.isSafeInteger(e[p]))throw new Error("invalid number "+p);if(!Array.isArray(n)||n.length!==c)throw new Error("Poseidon: invalid MDS matrix");const l=n.map(p=>{if(!Array.isArray(p)||p.length!==c)throw new Error("invalid MDS matrix row: "+p);return p.map(_=>{if(typeof _!="bigint")throw new Error("invalid MDS matrix bigint: "+_);return t.create(_)})});if(r!==void 0&&typeof r!="boolean")throw new Error("invalid param reversePartialPowIdx="+r);if(i&1)throw new Error("roundsFull is not even"+i);const u=i+o;if(!Array.isArray(s)||s.length!==u)throw new Error("Poseidon: invalid round constants");const d=s.map(p=>{if(!Array.isArray(p)||p.length!==c)throw new Error("invalid round constants");return p.map(_=>{if(typeof _!="bigint"||!t.isValid(_))throw new Error("invalid round constant");return t.create(_)})});if(!a||![3,5,7].includes(a))throw new Error("invalid sboxPower");const f=BigInt(a);let h=p=>ov(t,p,f);return a===3?h=p=>t.mul(t.sqrN(p),p):a===5&&(h=p=>t.mul(t.sqrN(t.sqrN(p)),p)),Object.freeze({...e,rounds:u,sboxFn:h,roundConstants:d,mds:l})}function e$(e,t){if(typeof t!="number")throw new Error("poseidonSplitConstants: invalid t");if(!Array.isArray(e)||e.length%t)throw new Error("poseidonSplitConstants: invalid rc");const n=[];let r=[];for(let s=0;s<e.length;s++)r.push(e[s]),r.length===t&&(n.push(r),r=[]);return n}function dv(e){const t=uv(e),{Fp:n,mds:r,roundConstants:s,rounds:i,roundsPartial:o,sboxFn:a,t:c}=t,l=t.roundsFull/2,u=t.reversePartialPowIdx?c-1:0,d=(h,p,_)=>(h=h.map((g,y)=>n.add(g,s[_][y])),p?h=h.map(g=>a(g)):h[u]=a(h[u]),h=r.map(g=>g.reduce((y,w,k)=>n.add(y,n.mulN(w,h[k])),n.ZERO)),h),f=function(p){if(!Array.isArray(p)||p.length!==c)throw new Error("invalid values, expected array of bigints with length "+c);p=p.map(g=>{if(typeof g!="bigint")throw new Error("invalid bigint="+g);return n.create(g)});let _=0;for(let g=0;g<l;g++)p=d(p,!0,_++);for(let g=0;g<o;g++)p=d(p,!1,_++);for(let g=0;g<l;g++)p=d(p,!0,_++);if(_!==i)throw new Error("invalid number of rounds");return p};return f.roundConstants=s,f}const t$=Object.freeze(Object.defineProperty({__proto__:null,poseidon:dv,splitConstants:e$,validateOpts:uv},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const m0=BigInt(0),Fu=BigInt(1);function Ip(e,t){const n=t.negate();return e?n:t}function fv(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Np(e,t){fv(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1);return{windows:n,windowSize:r}}function n$(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function r$(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const xp=new WeakMap,hv=new WeakMap;function Rp(e){return hv.get(e)||1}function s$(e,t){return{constTimeNegate:Ip,hasPrecomputes(n){return Rp(n)!==1},unsafeLadder(n,r,s=e.ZERO){let i=n;for(;r>m0;)r&Fu&&(s=s.add(i)),i=i.double(),r>>=Fu;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Np(r,t),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=Np(n,t);let a=e.ZERO,c=e.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let f=0;f<i;f++){const h=f*o;let p=Number(s&l);s>>=d,p>o&&(p-=u,s+=Fu);const _=h,g=h+Math.abs(p)-1,y=f%2!==0,w=p<0;p===0?c=c.add(Ip(y,r[_])):a=a.add(Ip(w,r[g]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=e.ZERO){const{windows:o,windowSize:a}=Np(n,t),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const f=d*a;if(s===m0)break;let h=Number(s&c);if(s>>=u,h>a&&(h-=l,s+=Fu),h===0)continue;let p=r[f+Math.abs(h)-1];h<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(n,r,s){let i=xp.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&xp.set(r,s(i))),i},wNAFCached(n,r,s){const i=Rp(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Rp(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){fv(r,t),hv.set(n,r),xp.delete(n)}}}function i$(e,t,n,r){if(n$(n,e),r$(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,i=JT(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((t.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let h=0;h<r.length;h++){const p=r[h],_=Number(p>>BigInt(d)&BigInt(a));c[_]=c[_].add(n[h])}let f=s;for(let h=c.length-1,p=s;h>0;h--)p=p.add(c[h]),f=f.add(p);if(u=u.add(f),d!==0)for(let h=0;h<o;h++)u=u.double()}return u}function pv(e){return ah(e.Fp),eu(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...av(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function b0(e){e.lowS!==void 0&&ga("lowS",e.lowS),e.prehash!==void 0&&ga("prehash",e.prehash)}function o$(e){const t=pv(e);eu(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=t;if(n){if(!r.eql(s,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:a$,hexToBytes:c$}=bB,ir={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(e,t)=>{const{Err:n}=ir;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,s=Uo(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?Uo(s.length/2|128):"";return Uo(e)+i+s+t},decode(e,t){const{Err:n}=ir;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const s=t[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=t.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=ir;if(e<or)throw new t("integer: negative integers are not allowed");let n=Uo(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=ir;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return a$(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=ir,s=typeof e=="string"?c$(e):e;Ql(s);const{v:i,l:o}=r.decode(48,s);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(e){const{_tlv:t,_int:n}=ir,r=t.encode(2,n.encode(e.r)),s=t.encode(2,n.encode(e.s)),i=r+s;return t.encode(48,i)}},or=BigInt(0),ve=BigInt(1),ws=BigInt(2),Jd=BigInt(3),w0=BigInt(4);function gv(e){const t=o$(e),{Fp:n}=t,r=ch(t.n,t.nBitLength),s=t.toBytes||((_,g,y)=>{const w=g.toAffine();return ya(Uint8Array.from([4]),n.toBytes(w.x),n.toBytes(w.y))}),i=t.fromBytes||(_=>{const g=_.subarray(1),y=n.fromBytes(g.subarray(0,n.BYTES)),w=n.fromBytes(g.subarray(n.BYTES,2*n.BYTES));return{x:y,y:w}});function o(_){const{a:g,b:y}=t,w=n.sqr(_),k=n.mul(w,_);return n.add(n.add(k,n.mul(_,g)),y)}if(!n.eql(n.sqr(t.Gy),o(t.Gx)))throw new Error("bad generator point: equation left != right");function a(_){return sh(_,ve,t.n)}function c(_){const{allowedPrivateKeyLengths:g,nByteLength:y,wrapPrivateKey:w,n:k}=t;if(g&&typeof _!="bigint"){if(Wi(_)&&(_=fs(_)),typeof _!="string"||!g.includes(_.length))throw new Error("invalid private key");_=_.padStart(y*2,"0")}let b;try{b=typeof _=="bigint"?_:Wt(Fn("private key",_,y))}catch{throw new Error("invalid private key, expected hex or "+y+" bytes, got "+typeof _)}return w&&(b=Nt(b,k)),$i("private key",b,ve,k),b}function l(_){if(!(_ instanceof f))throw new Error("ProjectivePoint expected")}const u=Xg((_,g)=>{const{px:y,py:w,pz:k}=_;if(n.eql(k,n.ONE))return{x:y,y:w};const b=_.is0();g==null&&(g=b?n.ONE:n.inv(k));const N=n.mul(y,g),S=n.mul(w,g),E=n.mul(k,g);if(b)return{x:n.ZERO,y:n.ZERO};if(!n.eql(E,n.ONE))throw new Error("invZ was invalid");return{x:N,y:S}}),d=Xg(_=>{if(_.is0()){if(t.allowInfinityPoint&&!n.is0(_.py))return;throw new Error("bad point: ZERO")}const{x:g,y}=_.toAffine();if(!n.isValid(g)||!n.isValid(y))throw new Error("bad point: x or y not FE");const w=n.sqr(y),k=o(g);if(!n.eql(w,k))throw new Error("bad point: equation left != right");if(!_.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class f{constructor(g,y,w){if(this.px=g,this.py=y,this.pz=w,g==null||!n.isValid(g))throw new Error("x required");if(y==null||!n.isValid(y))throw new Error("y required");if(w==null||!n.isValid(w))throw new Error("z required");Object.freeze(this)}static fromAffine(g){const{x:y,y:w}=g||{};if(!g||!n.isValid(y)||!n.isValid(w))throw new Error("invalid affine point");if(g instanceof f)throw new Error("projective point not allowed");const k=b=>n.eql(b,n.ZERO);return k(y)&&k(w)?f.ZERO:new f(y,w,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const y=n.invertBatch(g.map(w=>w.pz));return g.map((w,k)=>w.toAffine(y[k])).map(f.fromAffine)}static fromHex(g){const y=f.fromAffine(i(Fn("pointHex",g)));return y.assertValidity(),y}static fromPrivateKey(g){return f.BASE.multiply(c(g))}static msm(g,y){return i$(f,r,g,y)}_setWindowSize(g){p.setWindowSize(this,g)}assertValidity(){d(this)}hasEvenY(){const{y:g}=this.toAffine();if(n.isOdd)return!n.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){l(g);const{px:y,py:w,pz:k}=this,{px:b,py:N,pz:S}=g,E=n.eql(n.mul(y,S),n.mul(b,k)),A=n.eql(n.mul(w,S),n.mul(N,k));return E&&A}negate(){return new f(this.px,n.neg(this.py),this.pz)}double(){const{a:g,b:y}=t,w=n.mul(y,Jd),{px:k,py:b,pz:N}=this;let S=n.ZERO,E=n.ZERO,A=n.ZERO,x=n.mul(k,k),D=n.mul(b,b),B=n.mul(N,N),z=n.mul(k,b);return z=n.add(z,z),A=n.mul(k,N),A=n.add(A,A),S=n.mul(g,A),E=n.mul(w,B),E=n.add(S,E),S=n.sub(D,E),E=n.add(D,E),E=n.mul(S,E),S=n.mul(z,S),A=n.mul(w,A),B=n.mul(g,B),z=n.sub(x,B),z=n.mul(g,z),z=n.add(z,A),A=n.add(x,x),x=n.add(A,x),x=n.add(x,B),x=n.mul(x,z),E=n.add(E,x),B=n.mul(b,N),B=n.add(B,B),x=n.mul(B,z),S=n.sub(S,x),A=n.mul(B,D),A=n.add(A,A),A=n.add(A,A),new f(S,E,A)}add(g){l(g);const{px:y,py:w,pz:k}=this,{px:b,py:N,pz:S}=g;let E=n.ZERO,A=n.ZERO,x=n.ZERO;const D=t.a,B=n.mul(t.b,Jd);let z=n.mul(y,b),J=n.mul(w,N),R=n.mul(k,S),U=n.add(y,w),P=n.add(b,N);U=n.mul(U,P),P=n.add(z,J),U=n.sub(U,P),P=n.add(y,k);let q=n.add(b,S);return P=n.mul(P,q),q=n.add(z,R),P=n.sub(P,q),q=n.add(w,k),E=n.add(N,S),q=n.mul(q,E),E=n.add(J,R),q=n.sub(q,E),x=n.mul(D,P),E=n.mul(B,R),x=n.add(E,x),E=n.sub(J,x),x=n.add(J,x),A=n.mul(E,x),J=n.add(z,z),J=n.add(J,z),R=n.mul(D,R),P=n.mul(B,P),J=n.add(J,R),R=n.sub(z,R),R=n.mul(D,R),P=n.add(P,R),z=n.mul(J,P),A=n.add(A,z),z=n.mul(q,P),E=n.mul(U,E),E=n.sub(E,z),z=n.mul(U,J),x=n.mul(q,x),x=n.add(x,z),new f(E,A,x)}subtract(g){return this.add(g.negate())}is0(){return this.equals(f.ZERO)}wNAF(g){return p.wNAFCached(this,g,f.normalizeZ)}multiplyUnsafe(g){const{endo:y,n:w}=t;$i("scalar",g,or,w);const k=f.ZERO;if(g===or)return k;if(this.is0()||g===ve)return this;if(!y||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,g,f.normalizeZ);let{k1neg:b,k1:N,k2neg:S,k2:E}=y.splitScalar(g),A=k,x=k,D=this;for(;N>or||E>or;)N&ve&&(A=A.add(D)),E&ve&&(x=x.add(D)),D=D.double(),N>>=ve,E>>=ve;return b&&(A=A.negate()),S&&(x=x.negate()),x=new f(n.mul(x.px,y.beta),x.py,x.pz),A.add(x)}multiply(g){const{endo:y,n:w}=t;$i("scalar",g,ve,w);let k,b;if(y){const{k1neg:N,k1:S,k2neg:E,k2:A}=y.splitScalar(g);let{p:x,f:D}=this.wNAF(S),{p:B,f:z}=this.wNAF(A);x=p.constTimeNegate(N,x),B=p.constTimeNegate(E,B),B=new f(n.mul(B.px,y.beta),B.py,B.pz),k=x.add(B),b=D.add(z)}else{const{p:N,f:S}=this.wNAF(g);k=N,b=S}return f.normalizeZ([k,b])[0]}multiplyAndAddUnsafe(g,y,w){const k=f.BASE,b=(S,E)=>E===or||E===ve||!S.equals(k)?S.multiplyUnsafe(E):S.multiply(E),N=b(this,y).add(b(g,w));return N.is0()?void 0:N}toAffine(g){return u(this,g)}isTorsionFree(){const{h:g,isTorsionFree:y}=t;if(g===ve)return!0;if(y)return y(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:y}=t;return g===ve?this:y?y(f,this):this.multiplyUnsafe(t.h)}toRawBytes(g=!0){return ga("isCompressed",g),this.assertValidity(),s(f,this,g)}toHex(g=!0){return ga("isCompressed",g),fs(this.toRawBytes(g))}}f.BASE=new f(t.Gx,t.Gy,n.ONE),f.ZERO=new f(n.ZERO,n.ONE,n.ZERO);const h=t.nBitLength,p=s$(f,t.endo?Math.ceil(h/2):h);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function l$(e){const t=pv(e);return eu(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Om(e){const t=l$(e),{Fp:n,n:r}=t,s=n.BYTES+1,i=2*n.BYTES+1;function o(R){return Nt(R,r)}function a(R){return Zd(R,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:d}=gv({...t,toBytes(R,U,P){const q=U.toAffine(),Z=n.toBytes(q.x),Re=ya;return ga("isCompressed",P),P?Re(Uint8Array.from([U.hasEvenY()?2:3]),Z):Re(Uint8Array.from([4]),Z,n.toBytes(q.y))},fromBytes(R){const U=R.length,P=R[0],q=R.subarray(1);if(U===s&&(P===2||P===3)){const Z=Wt(q);if(!sh(Z,ve,n.ORDER))throw new Error("Point is not on curve");const Re=u(Z);let Dt;try{Dt=n.sqrt(Re)}catch(Qn){const Xt=Qn instanceof Error?": "+Qn.message:"";throw new Error("Point is not on curve"+Xt)}const qe=(Dt&ve)===ve;return(P&1)===1!==qe&&(Dt=n.neg(Dt)),{x:Z,y:Dt}}else if(U===i&&P===4){const Z=n.fromBytes(q.subarray(0,n.BYTES)),Re=n.fromBytes(q.subarray(n.BYTES,2*n.BYTES));return{x:Z,y:Re}}else{const Z=s,Re=i;throw new Error("invalid Point, expected length of "+Z+", or uncompressed "+Re+", got "+U)}}}),f=R=>fs(_a(R,t.nByteLength));function h(R){const U=r>>ve;return R>U}function p(R){return h(R)?o(-R):R}const _=(R,U,P)=>Wt(R.slice(U,P));class g{constructor(U,P,q){this.r=U,this.s=P,this.recovery=q,this.assertValidity()}static fromCompact(U){const P=t.nByteLength;return U=Fn("compactSignature",U,P*2),new g(_(U,0,P),_(U,P,2*P))}static fromDER(U){const{r:P,s:q}=ir.toSig(Fn("DER",U));return new g(P,q)}assertValidity(){$i("r",this.r,ve,r),$i("s",this.s,ve,r)}addRecoveryBit(U){return new g(this.r,this.s,U)}recoverPublicKey(U){const{r:P,s:q,recovery:Z}=this,Re=S(Fn("msgHash",U));if(Z==null||![0,1,2,3].includes(Z))throw new Error("recovery id invalid");const Dt=Z===2||Z===3?P+t.n:P;if(Dt>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const qe=(Z&1)===0?"02":"03",Yr=c.fromHex(qe+f(Dt)),Qn=a(Dt),Xt=o(-Re*Qn),To=o(q*Qn),ys=c.BASE.multiplyAndAddUnsafe(Yr,Xt,To);if(!ys)throw new Error("point at infinify");return ys.assertValidity(),ys}hasHighS(){return h(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Vs(this.toDERHex())}toDERHex(){return ir.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Vs(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const y={isValidPrivateKey(R){try{return l(R),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const R=lv(t.n);return QB(t.randomBytes(R),t.n)},precompute(R=8,U=c.BASE){return U._setWindowSize(R),U.multiply(BigInt(3)),U}};function w(R,U=!0){return c.fromPrivateKey(R).toRawBytes(U)}function k(R){const U=Wi(R),P=typeof R=="string",q=(U||P)&&R.length;return U?q===s||q===i:P?q===2*s||q===2*i:R instanceof c}function b(R,U,P=!0){if(k(R))throw new Error("first arg must be private key");if(!k(U))throw new Error("second arg must be public key");return c.fromHex(U).multiply(l(R)).toRawBytes(P)}const N=t.bits2int||function(R){if(R.length>8192)throw new Error("input is too large");const U=Wt(R),P=R.length*8-t.nBitLength;return P>0?U>>BigInt(P):U},S=t.bits2int_modN||function(R){return o(N(R))},E=ih(t.nBitLength);function A(R){return $i("num < 2^"+t.nBitLength,R,or,E),_a(R,t.nByteLength)}function x(R,U,P=D){if(["recovered","canonical"].some(Js=>Js in P))throw new Error("sign() legacy options not supported");const{hash:q,randomBytes:Z}=t;let{lowS:Re,prehash:Dt,extraEntropy:qe}=P;Re==null&&(Re=!0),R=Fn("msgHash",R),b0(P),Dt&&(R=Fn("prehashed msgHash",q(R)));const Yr=S(R),Qn=l(U),Xt=[A(Qn),A(Yr)];if(qe!=null&&qe!==!1){const Js=qe===!0?Z(n.BYTES):qe;Xt.push(Fn("extraEntropy",Js))}const To=ya(...Xt),ys=Yr;function wp(Js){const vo=N(Js);if(!d(vo))return;const kp=a(vo),gc=c.BASE.multiply(vo).toAffine(),Xs=o(gc.x);if(Xs===or)return;const _c=o(kp*o(ys+Xs*Qn));if(_c===or)return;let So=(gc.x===Xs?0:2)|Number(gc.y&ve),n0=_c;return Re&&h(_c)&&(n0=p(_c),So^=1),new g(Xs,n0,So)}return{seed:To,k2sig:wp}}const D={lowS:t.lowS,prehash:!1},B={lowS:t.lowS,prehash:!1};function z(R,U,P=D){const{seed:q,k2sig:Z}=x(R,U,P),Re=t;return XT(Re.hash.outputLen,Re.nByteLength,Re.hmac)(q,Z)}c.BASE._setWindowSize(8);function J(R,U,P,q=B){const Z=R;U=Fn("msgHash",U),P=Fn("publicKey",P);const{lowS:Re,prehash:Dt,format:qe}=q;if(b0(q),"strict"in q)throw new Error("options.strict was renamed to lowS");if(qe!==void 0&&qe!=="compact"&&qe!=="der")throw new Error("format must be compact or der");const Yr=typeof Z=="string"||Wi(Z),Qn=!Yr&&!qe&&typeof Z=="object"&&Z!==null&&typeof Z.r=="bigint"&&typeof Z.s=="bigint";if(!Yr&&!Qn)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let Xt,To;try{if(Qn&&(Xt=new g(Z.r,Z.s)),Yr){try{qe!=="compact"&&(Xt=g.fromDER(Z))}catch(So){if(!(So instanceof ir.Err))throw So}!Xt&&qe!=="der"&&(Xt=g.fromCompact(Z))}To=c.fromHex(P)}catch{return!1}if(!Xt||Re&&Xt.hasHighS())return!1;Dt&&(U=t.hash(U));const{r:ys,s:wp}=Xt,Js=S(U),vo=a(wp),kp=o(Js*vo),gc=o(ys*vo),Xs=c.BASE.multiplyAndAddUnsafe(To,kp,gc)?.toAffine();return Xs?o(Xs.x)===ys:!1}return{CURVE:t,getPublicKey:w,getSharedSecret:b,sign:z,verify:J,ProjectivePoint:c,Signature:g,utils:y}}function _v(e,t){const n=e.ORDER;let r=or;for(let p=n-ve;p%ws===or;p/=ws)r+=ve;const s=r,i=ws<<s-ve-ve,o=i*ws,a=(n-ve)/o,c=(a-ve)/ws,l=o-ve,u=i,d=e.pow(t,a),f=e.pow(t,(a+ve)/ws);let h=(p,_)=>{let g=d,y=e.pow(_,l),w=e.sqr(y);w=e.mul(w,_);let k=e.mul(p,w);k=e.pow(k,c),k=e.mul(k,y),y=e.mul(k,_),w=e.mul(k,p);let b=e.mul(w,y);k=e.pow(b,u);let N=e.eql(k,e.ONE);y=e.mul(w,f),k=e.mul(b,g),w=e.cmov(y,w,N),b=e.cmov(k,b,N);for(let S=s;S>ve;S--){let E=S-ws;E=ws<<E-ve;let A=e.pow(b,E);const x=e.eql(A,e.ONE);y=e.mul(w,g),g=e.mul(g,g),A=e.mul(b,g),w=e.cmov(y,w,x),b=e.cmov(A,b,x)}return{isValid:N,value:w}};if(e.ORDER%w0===Jd){const p=(e.ORDER-Jd)/w0,_=e.sqrt(e.neg(t));h=(g,y)=>{let w=e.sqr(y);const k=e.mul(g,y);w=e.mul(w,k);let b=e.pow(w,p);b=e.mul(b,k);const N=e.mul(b,_),S=e.mul(e.sqr(b),y),E=e.eql(S,g);let A=e.cmov(N,b,E);return{isValid:E,value:A}}}return h}function u$(e,t){if(ah(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=_v(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let s,i,o,a,c,l,u,d;s=e.sqr(r),s=e.mul(s,t.Z),i=e.sqr(s),i=e.add(i,s),o=e.add(i,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(i),!e.eql(i,e.ZERO)),a=e.mul(a,t.A),i=e.sqr(o),l=e.sqr(a),c=e.mul(l,t.A),i=e.add(i,c),i=e.mul(i,o),l=e.mul(l,a),c=e.mul(l,t.B),i=e.add(i,c),u=e.mul(s,o);const{isValid:f,value:h}=n(i,l);d=e.mul(s,r),d=e.mul(d,h),u=e.cmov(u,o,f),d=e.cmov(d,h,f);const p=e.isOdd(r)===e.isOdd(d);return d=e.cmov(e.neg(d),d,p),u=e.div(u,a),{x:u,y:d}}}const d$=Object.freeze(Object.defineProperty({__proto__:null,DER:ir,SWUFpSqrtRatio:_v,mapToCurveSimpleSWU:u$,weierstrass:Om,weierstrassPoints:gv},Symbol.toStringTag,{value:"Module"}));class yv extends Rm{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,kB(t);const r=oh(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?t.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(t){return ma(this),this.iHash.update(t),this}digestInto(t){ma(this),tu(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=s,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const mv=(e,t,n)=>new yv(e,t).update(n).digest();mv.create=(e,t)=>new yv(e,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function bv(e){return{hash:e,hmac:(t,...n)=>mv(e,t,vB(...n)),randomBytes:SB}}function f$(e,t){const n=r=>Om({...e,...bv(r)});return Object.freeze({...n(t),create:n})}/*! scure-starknet - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ml=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),Ti=BigInt("0x800000000000000000000000000000000000000000000000000000000000000"),wv=252;function k0(e){for(;e[0]===0;)e=e.subarray(1);const t=e.length*8-wv,n=Wt(e);return t>0?n>>BigInt(t):n}function kv(e){return typeof e=="string"&&(e=Dm(e),e.length&1&&(e="0"+e)),Vs(e)}const lo=Om({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:ch(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:ml,nBitLength:wv,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...bv(nu),bits2int:k0,bits2int_modN:e=>{const t=Wt(e).toString(16);return t.length===63&&(e=kv(t+"0")),Nt(k0(e),ml)}}),h$=lo;function ba(e){return Fn("",typeof e=="string"?kv(e):e)}function lh(e){return fs(ba(e)).padStart(64,"0")}function Bm(e,t=!1){return lo.getPublicKey(lh(e),t)}function p$(e,t){return lo.getSharedSecret(lh(e),t)}function Ev(e){const{r:t,s:n}=e;if(t<0n||t>=Ti)throw new Error(`Signature.r should be [1, ${Ti})`);const r=Zd(n,ml);if(r<0n||r>=Ti)throw new Error(`inv(Signature.s) should be [1, ${Ti})`)}function Tv(e){const t=ba(e);if(Wt(t)>=Ti)throw new Error(`msgHash should be [0, ${Ti})`);return t}function vv(e,t,n){const r=lo.sign(Tv(e),lh(t),n);return Ev(r),r}function Sv(e,t,n){if(!(e instanceof rl)){const r=ba(e);try{e=rl.fromDER(r)}catch(s){if(!(s instanceof ir.Err))throw s;e=rl.fromCompact(r)}}return Ev(e),lo.verify(e,Tv(t),ba(n))}const{CURVE:g$,ProjectivePoint:Do,Signature:rl,utils:$m}=lo;function Av(e){return`0x${fs(e.subarray(1)).replace(/^0+/gm,"")}`}function Dm(e){return e.replace(/^0x/i,"")}function Iv(e){const t=ba(e),n=2n**256n,r=n-Nt(n,ml);for(let s=0;;s++){const i=e_(ya(t,xm(BigInt(s))));if(i<r)return Nt(i,ml).toString(16);if(s===1e5)throw new Error("grindKey is broken: tried 100k vals")}}function Mm(e){return Av(Bm(e,!0))}function _$(e){if(e=Dm(e),e.length!==130)throw new Error("Wrong ethereum signature");return Iv(e.substring(0,64))}const y$=2n**31n-1n,ju=e=>Number(e&y$);function m$(e,t,n,r){const s=ju(e_(e)),i=ju(e_(t)),o=rh(Dm(n));return`m/2645'/${s}'/${i}'/${ju(o)}'/${ju(o>>31n)}'/${r}`}const bl=[new Do(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new Do(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new Do(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new Do(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new Do(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function Nv(e,t){const n=[];let r=e;for(let s=0;s<248;s++)n.push(r),r=r.double();r=t;for(let s=0;s<4;s++)n.push(r),r=r.double();return n}const b$=Nv(bl[1],bl[2]),w$=Nv(bl[3],bl[4]);function k$(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);t=BigInt(e)}else t=Wt(ba(e));if(!(0n<=t&&t<lo.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${t}`);return t}function E0(e,t,n){let r=k$(t);for(let s=0;s<252;s++){const i=n[s];if(!i)throw new Error("invalid constant index");if(i.equals(e))throw new Error("Same point");(r&1n)!==0n&&(e=e.add(i)),r>>=1n}return e}function Ja(e,t){let n=bl[0];return n=E0(n,e,b$),n=E0(n,t,w$),Av(n.toRawBytes(!0))}const E$=(e,t=Ja)=>[0,...e,e.length].reduce((n,r)=>t(n,r)),T$=ih(250),zs=e=>Wt(iv(e))&T$,e_=e=>Wt(nu(e)),xv=ch(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function t_(e,t,n){const r=e.fromBytes(nu(ev(`${t}${n}`)));return e.create(r)}function Rv(e,t,n,r=0){const s=[],i=[];for(let o=0;o<n;o++)s.push(t_(e,`${t}x`,r*n+o)),i.push(t_(e,`${t}y`,r*n+o));if(new Set([...s,...i]).size!==2*n)throw new Error("X and Y values are not distinct");return s.map(o=>i.map(a=>e.inv(e.sub(o,a))))}const v$=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function Lm(e,t){if(ah(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);const n=e.rate+e.capacity,r=e.roundsFull+e.roundsPartial,s=[];for(let o=0;o<r;o++){const a=[];for(let c=0;c<n;c++)a.push(t_(e.Fp,"Hades",n*o+c));s.push(a)}const i=dv({...e,t:n,sboxPower:3,reversePartialPowIdx:!0,mds:t,roundConstants:s});return i.m=n,i.rate=e.rate,i.capacity=e.capacity,i}function S$(e,t=0){const n=e.rate+e.capacity;if(!Number.isSafeInteger(t))throw new Error(`Wrong mdsAttempt=${t}`);return Lm(e,Rv(e.Fp,"HadesMDS",n,t))}const ru=Lm({Fp:xv,rate:2,capacity:1,roundsFull:8,roundsPartial:83},v$);function Um(e,t,n=ru){return n([e,t,2n])[0]}function A$(e,t,n=ru){return xm(Um(Wt(e),Wt(t),n))}function I$(e,t=ru){return t([e,0n,1n])[0]}function bt(e,t=ru){const{m:n,rate:r}=t;if(!Array.isArray(e))throw new Error("bigint array expected in values");const s=Array.from(e);for(s.push(1n);s.length%r!==0;)s.push(0n);let i=new Array(n).fill(0n);for(let o=0;o<s.length;o+=r){for(let a=0;a<r;a++){const c=s[o+a];if(typeof c>"u")throw new Error("invalid index");if(typeof i[a]>"u")throw new Error("state[j] is undefined");i[a]=i[a]+c}i=t(i)}return i[0]}const N$=Object.freeze(Object.defineProperty({__proto__:null,CURVE:g$,Fp251:xv,MAX_VALUE:Ti,ProjectivePoint:Do,Signature:rl,_poseidonMDS:Rv,_starkCurve:h$,computeHashOnElements:E$,ethSigToPrivate:_$,getAccountPath:m$,getPublicKey:Bm,getSharedSecret:p$,getStarkKey:Mm,grindKey:Iv,keccak:zs,normalizePrivateKey:lh,pedersen:Ja,poseidonBasic:Lm,poseidonCreate:S$,poseidonHash:Um,poseidonHashFunc:A$,poseidonHashMany:bt,poseidonHashSingle:I$,poseidonSmall:ru,sign:vv,utils:$m,verify:Sv},Symbol.toStringTag,{value:"Module"}));/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const x$=4,T0=0,v0=1,R$=2;function Xa(e){let t=e.length;for(;--t>=0;)e[t]=0}const C$=0,Cv=1,O$=2,B$=3,$$=258,Pm=29,su=256,wl=su+1+Pm,Go=30,Fm=19,Ov=2*wl+1,vi=15,Cp=16,D$=7,jm=256,Bv=16,$v=17,Dv=18,n_=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),pd=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),M$=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Mv=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),L$=512,ts=new Array((wl+2)*2);Xa(ts);const sl=new Array(Go*2);Xa(sl);const kl=new Array(L$);Xa(kl);const El=new Array($$-B$+1);Xa(El);const Vm=new Array(Pm);Xa(Vm);const Xd=new Array(Go);Xa(Xd);function Op(e,t,n,r,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=s,this.has_stree=e&&e.length}let Lv,Uv,Pv;function Bp(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const Fv=e=>e<256?kl[e]:kl[256+(e>>>7)],Tl=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},on=(e,t,n)=>{e.bi_valid>Cp-n?(e.bi_buf|=t<<e.bi_valid&65535,Tl(e,e.bi_buf),e.bi_buf=t>>Cp-e.bi_valid,e.bi_valid+=n-Cp):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Dr=(e,t,n)=>{on(e,n[t*2],n[t*2+1])},jv=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},U$=e=>{e.bi_valid===16?(Tl(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},P$=(e,t)=>{const n=t.dyn_tree,r=t.max_code,s=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,u,d,f,h,p,_=0;for(f=0;f<=vi;f++)e.bl_count[f]=0;for(n[e.heap[e.heap_max]*2+1]=0,l=e.heap_max+1;l<Ov;l++)u=e.heap[l],f=n[n[u*2+1]*2+1]+1,f>c&&(f=c,_++),n[u*2+1]=f,!(u>r)&&(e.bl_count[f]++,h=0,u>=a&&(h=o[u-a]),p=n[u*2],e.opt_len+=p*(f+h),i&&(e.static_len+=p*(s[u*2+1]+h)));if(_!==0){do{for(f=c-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[c]--,_-=2}while(_>0);for(f=c;f!==0;f--)for(u=e.bl_count[f];u!==0;)d=e.heap[--l],!(d>r)&&(n[d*2+1]!==f&&(e.opt_len+=(f-n[d*2+1])*n[d*2],n[d*2+1]=f),u--)}},Vv=(e,t,n)=>{const r=new Array(vi+1);let s=0,i,o;for(i=1;i<=vi;i++)s=s+n[i-1]<<1,r[i]=s;for(o=0;o<=t;o++){let a=e[o*2+1];a!==0&&(e[o*2]=jv(r[a]++,a))}},F$=()=>{let e,t,n,r,s;const i=new Array(vi+1);for(n=0,r=0;r<Pm-1;r++)for(Vm[r]=n,e=0;e<1<<n_[r];e++)El[n++]=r;for(El[n-1]=r,s=0,r=0;r<16;r++)for(Xd[r]=s,e=0;e<1<<pd[r];e++)kl[s++]=r;for(s>>=7;r<Go;r++)for(Xd[r]=s<<7,e=0;e<1<<pd[r]-7;e++)kl[256+s++]=r;for(t=0;t<=vi;t++)i[t]=0;for(e=0;e<=143;)ts[e*2+1]=8,e++,i[8]++;for(;e<=255;)ts[e*2+1]=9,e++,i[9]++;for(;e<=279;)ts[e*2+1]=7,e++,i[7]++;for(;e<=287;)ts[e*2+1]=8,e++,i[8]++;for(Vv(ts,wl+1,i),e=0;e<Go;e++)sl[e*2+1]=5,sl[e*2]=jv(e,5);Lv=new Op(ts,n_,su+1,wl,vi),Uv=new Op(sl,pd,0,Go,vi),Pv=new Op(new Array(0),M$,0,Fm,D$)},zv=e=>{let t;for(t=0;t<wl;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Go;t++)e.dyn_dtree[t*2]=0;for(t=0;t<Fm;t++)e.bl_tree[t*2]=0;e.dyn_ltree[jm*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},qv=e=>{e.bi_valid>8?Tl(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},S0=(e,t,n,r)=>{const s=t*2,i=n*2;return e[s]<e[i]||e[s]===e[i]&&r[t]<=r[n]},$p=(e,t,n)=>{const r=e.heap[n];let s=n<<1;for(;s<=e.heap_len&&(s<e.heap_len&&S0(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!S0(t,r,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=r},A0=(e,t,n)=>{let r,s,i=0,o,a;if(e.sym_next!==0)do r=e.pending_buf[e.sym_buf+i++]&255,r+=(e.pending_buf[e.sym_buf+i++]&255)<<8,s=e.pending_buf[e.sym_buf+i++],r===0?Dr(e,s,t):(o=El[s],Dr(e,o+su+1,t),a=n_[o],a!==0&&(s-=Vm[o],on(e,s,a)),r--,o=Fv(r),Dr(e,o,n),a=pd[o],a!==0&&(r-=Xd[o],on(e,r,a)));while(i<e.sym_next);Dr(e,jm,t)},r_=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.elems;let o,a,c=-1,l;for(e.heap_len=0,e.heap_max=Ov,o=0;o<i;o++)n[o*2]!==0?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):n[o*2+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,n[l*2]=1,e.depth[l]=0,e.opt_len--,s&&(e.static_len-=r[l*2+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)$p(e,n,o);l=i;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],$p(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[l*2]=n[o*2]+n[a*2],e.depth[l]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[o*2+1]=n[a*2+1]=l,e.heap[1]=l++,$p(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],P$(e,t),Vv(n,c,e.bl_count)},I0=(e,t,n)=>{let r,s=-1,i,o=t[0*2+1],a=0,c=7,l=4;for(o===0&&(c=138,l=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)i=o,o=t[(r+1)*2+1],!(++a<c&&i===o)&&(a<l?e.bl_tree[i*2]+=a:i!==0?(i!==s&&e.bl_tree[i*2]++,e.bl_tree[Bv*2]++):a<=10?e.bl_tree[$v*2]++:e.bl_tree[Dv*2]++,a=0,s=i,o===0?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4))},N0=(e,t,n)=>{let r,s=-1,i,o=t[0*2+1],a=0,c=7,l=4;for(o===0&&(c=138,l=3),r=0;r<=n;r++)if(i=o,o=t[(r+1)*2+1],!(++a<c&&i===o)){if(a<l)do Dr(e,i,e.bl_tree);while(--a!==0);else i!==0?(i!==s&&(Dr(e,i,e.bl_tree),a--),Dr(e,Bv,e.bl_tree),on(e,a-3,2)):a<=10?(Dr(e,$v,e.bl_tree),on(e,a-3,3)):(Dr(e,Dv,e.bl_tree),on(e,a-11,7));a=0,s=i,o===0?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4)}},j$=e=>{let t;for(I0(e,e.dyn_ltree,e.l_desc.max_code),I0(e,e.dyn_dtree,e.d_desc.max_code),r_(e,e.bl_desc),t=Fm-1;t>=3&&e.bl_tree[Mv[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},V$=(e,t,n,r)=>{let s;for(on(e,t-257,5),on(e,n-1,5),on(e,r-4,4),s=0;s<r;s++)on(e,e.bl_tree[Mv[s]*2+1],3);N0(e,e.dyn_ltree,t-1),N0(e,e.dyn_dtree,n-1)},z$=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return T0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return v0;for(n=32;n<su;n++)if(e.dyn_ltree[n*2]!==0)return v0;return T0};let x0=!1;const q$=e=>{x0||(F$(),x0=!0),e.l_desc=new Bp(e.dyn_ltree,Lv),e.d_desc=new Bp(e.dyn_dtree,Uv),e.bl_desc=new Bp(e.bl_tree,Pv),e.bi_buf=0,e.bi_valid=0,zv(e)},Hv=(e,t,n,r)=>{on(e,(C$<<1)+(r?1:0),3),qv(e),Tl(e,n),Tl(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},H$=e=>{on(e,Cv<<1,3),Dr(e,jm,ts),U$(e)},W$=(e,t,n,r)=>{let s,i,o=0;e.level>0?(e.strm.data_type===R$&&(e.strm.data_type=z$(e)),r_(e,e.l_desc),r_(e,e.d_desc),o=j$(e),s=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=s&&(s=i)):s=i=n+5,n+4<=s&&t!==-1?Hv(e,t,n,r):e.strategy===x$||i===s?(on(e,(Cv<<1)+(r?1:0),3),A0(e,ts,sl)):(on(e,(O$<<1)+(r?1:0),3),V$(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),A0(e,e.dyn_ltree,e.dyn_dtree)),zv(e),r&&qv(e)},K$=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(El[n]+su+1)*2]++,e.dyn_dtree[Fv(t)*2]++),e.sym_next===e.sym_end);var Y$=q$,G$=Hv,Z$=W$,J$=K$,X$=H$,Q$={_tr_init:Y$,_tr_stored_block:G$,_tr_flush_block:Z$,_tr_tally:J$,_tr_align:X$};const e3=(e,t,n,r)=>{let s=e&65535|0,i=e>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do s=s+t[r++]|0,i=i+s|0;while(--o);s%=65521,i%=65521}return s|i<<16|0};var vl=e3;const t3=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},n3=new Uint32Array(t3()),r3=(e,t,n,r)=>{const s=n3,i=r+n;e^=-1;for(let o=r;o<i;o++)e=e>>>8^s[(e^t[o])&255];return e^-1};var dt=r3,Ki={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},uh={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:s3,_tr_stored_block:s_,_tr_flush_block:i3,_tr_tally:Bs,_tr_align:o3}=Q$,{Z_NO_FLUSH:$s,Z_PARTIAL_FLUSH:a3,Z_FULL_FLUSH:c3,Z_FINISH:zn,Z_BLOCK:R0,Z_OK:St,Z_STREAM_END:C0,Z_STREAM_ERROR:Pr,Z_DATA_ERROR:l3,Z_BUF_ERROR:Dp,Z_DEFAULT_COMPRESSION:u3,Z_FILTERED:d3,Z_HUFFMAN_ONLY:Vu,Z_RLE:f3,Z_FIXED:h3,Z_DEFAULT_STRATEGY:p3,Z_UNKNOWN:g3,Z_DEFLATED:dh}=uh,_3=9,y3=15,m3=8,b3=29,w3=256,i_=w3+1+b3,k3=30,E3=19,T3=2*i_+1,v3=15,pe=3,As=258,Fr=As+pe+1,S3=32,wa=42,zm=57,o_=69,a_=73,c_=91,l_=103,Si=113,Nc=666,Ht=1,Qa=2,Yi=3,ec=4,A3=3,Ai=(e,t)=>(e.msg=Ki[t],t),O0=e=>e*2-(e>4?9:0),vs=e=>{let t=e.length;for(;--t>=0;)e[t]=0},I3=e=>{let t,n,r,s=e.w_size;t=e.hash_size,r=t;do n=e.head[--r],e.head[r]=n>=s?n-s:0;while(--t);t=s,r=t;do n=e.prev[--r],e.prev[r]=n>=s?n-s:0;while(--t)};let N3=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,Ds=N3;const mn=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},In=(e,t)=>{i3(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,mn(e.strm)},Te=(e,t)=>{e.pending_buf[e.pending++]=t},mc=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},u_=(e,t,n,r)=>{let s=e.avail_in;return s>r&&(s=r),s===0?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),n),e.state.wrap===1?e.adler=vl(e.adler,t,s,n):e.state.wrap===2&&(e.adler=dt(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)},Wv=(e,t)=>{let n=e.max_chain_length,r=e.strstart,s,i,o=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-Fr?e.strstart-(e.w_size-Fr):0,l=e.window,u=e.w_mask,d=e.prev,f=e.strstart+As;let h=l[r+o-1],p=l[r+o];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do if(s=t,!(l[s+o]!==p||l[s+o-1]!==h||l[s]!==l[r]||l[++s]!==l[r+1])){r+=2,s++;do;while(l[++r]===l[++s]&&l[++r]===l[++s]&&l[++r]===l[++s]&&l[++r]===l[++s]&&l[++r]===l[++s]&&l[++r]===l[++s]&&l[++r]===l[++s]&&l[++r]===l[++s]&&r<f);if(i=As-(f-r),r=f-As,i>o){if(e.match_start=t,o=i,i>=a)break;h=l[r+o-1],p=l[r+o]}}while((t=d[t&u])>c&&--n!==0);return o<=e.lookahead?o:e.lookahead},ka=e=>{const t=e.w_size;let n,r,s;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Fr)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),I3(e),r+=t),e.strm.avail_in===0)break;if(n=u_(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=pe)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=Ds(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=Ds(e,e.ins_h,e.window[s+pe-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<pe)););}while(e.lookahead<Fr&&e.strm.avail_in!==0)},Kv=(e,t)=>{let n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,s,i,o=0,a=e.strm.avail_in;do{if(r=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,s=e.strstart-e.block_start,r>s+e.strm.avail_in&&(r=s+e.strm.avail_in),r>i&&(r=i),r<n&&(r===0&&t!==zn||t===$s||r!==s+e.strm.avail_in)))break;o=t===zn&&r===s+e.strm.avail_in?1:0,s_(e,0,0,o),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,mn(e.strm),s&&(s>r&&(s=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,r-=s),r&&(u_(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(o===0);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?ec:t!==$s&&t!==zn&&e.strm.avail_in===0&&e.strstart===e.block_start?Qa:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(u_(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,n=i>e.w_size?e.w_size:i,s=e.strstart-e.block_start,(s>=n||(s||t===zn)&&t!==$s&&e.strm.avail_in===0&&s<=i)&&(r=s>i?i:s,o=t===zn&&e.strm.avail_in===0&&r===s?1:0,s_(e,e.block_start,r,o),e.block_start+=r,mn(e.strm)),o?Yi:Ht)},Mp=(e,t)=>{let n,r;for(;;){if(e.lookahead<Fr){if(ka(e),e.lookahead<Fr&&t===$s)return Ht;if(e.lookahead===0)break}if(n=0,e.lookahead>=pe&&(e.ins_h=Ds(e,e.ins_h,e.window[e.strstart+pe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-Fr&&(e.match_length=Wv(e,n)),e.match_length>=pe)if(r=Bs(e,e.strstart-e.match_start,e.match_length-pe),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=pe){e.match_length--;do e.strstart++,e.ins_h=Ds(e,e.ins_h,e.window[e.strstart+pe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ds(e,e.ins_h,e.window[e.strstart+1]);else r=Bs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(In(e,!1),e.strm.avail_out===0))return Ht}return e.insert=e.strstart<pe-1?e.strstart:pe-1,t===zn?(In(e,!0),e.strm.avail_out===0?Yi:ec):e.sym_next&&(In(e,!1),e.strm.avail_out===0)?Ht:Qa},Io=(e,t)=>{let n,r,s;for(;;){if(e.lookahead<Fr){if(ka(e),e.lookahead<Fr&&t===$s)return Ht;if(e.lookahead===0)break}if(n=0,e.lookahead>=pe&&(e.ins_h=Ds(e,e.ins_h,e.window[e.strstart+pe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=pe-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Fr&&(e.match_length=Wv(e,n),e.match_length<=5&&(e.strategy===d3||e.match_length===pe&&e.strstart-e.match_start>4096)&&(e.match_length=pe-1)),e.prev_length>=pe&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-pe,r=Bs(e,e.strstart-1-e.prev_match,e.prev_length-pe),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=Ds(e,e.ins_h,e.window[e.strstart+pe-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=pe-1,e.strstart++,r&&(In(e,!1),e.strm.avail_out===0))return Ht}else if(e.match_available){if(r=Bs(e,0,e.window[e.strstart-1]),r&&In(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Ht}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Bs(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<pe-1?e.strstart:pe-1,t===zn?(In(e,!0),e.strm.avail_out===0?Yi:ec):e.sym_next&&(In(e,!1),e.strm.avail_out===0)?Ht:Qa},x3=(e,t)=>{let n,r,s,i;const o=e.window;for(;;){if(e.lookahead<=As){if(ka(e),e.lookahead<=As&&t===$s)return Ht;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=pe&&e.strstart>0&&(s=e.strstart-1,r=o[s],r===o[++s]&&r===o[++s]&&r===o[++s])){i=e.strstart+As;do;while(r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&s<i);e.match_length=As-(i-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=pe?(n=Bs(e,1,e.match_length-pe),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Bs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(In(e,!1),e.strm.avail_out===0))return Ht}return e.insert=0,t===zn?(In(e,!0),e.strm.avail_out===0?Yi:ec):e.sym_next&&(In(e,!1),e.strm.avail_out===0)?Ht:Qa},R3=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(ka(e),e.lookahead===0)){if(t===$s)return Ht;break}if(e.match_length=0,n=Bs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(In(e,!1),e.strm.avail_out===0))return Ht}return e.insert=0,t===zn?(In(e,!0),e.strm.avail_out===0?Yi:ec):e.sym_next&&(In(e,!1),e.strm.avail_out===0)?Ht:Qa};function Er(e,t,n,r,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=s}const xc=[new Er(0,0,0,0,Kv),new Er(4,4,8,4,Mp),new Er(4,5,16,8,Mp),new Er(4,6,32,32,Mp),new Er(4,4,16,16,Io),new Er(8,16,32,32,Io),new Er(8,16,128,128,Io),new Er(8,32,128,256,Io),new Er(32,128,258,1024,Io),new Er(32,258,258,4096,Io)],C3=e=>{e.window_size=2*e.w_size,vs(e.head),e.max_lazy_match=xc[e.level].max_lazy,e.good_match=xc[e.level].good_length,e.nice_match=xc[e.level].nice_length,e.max_chain_length=xc[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=pe-1,e.match_available=0,e.ins_h=0};function O3(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=dh,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(T3*2),this.dyn_dtree=new Uint16Array((2*k3+1)*2),this.bl_tree=new Uint16Array((2*E3+1)*2),vs(this.dyn_ltree),vs(this.dyn_dtree),vs(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(v3+1),this.heap=new Uint16Array(2*i_+1),vs(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*i_+1),vs(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const iu=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==wa&&t.status!==zm&&t.status!==o_&&t.status!==a_&&t.status!==c_&&t.status!==l_&&t.status!==Si&&t.status!==Nc?1:0},Yv=e=>{if(iu(e))return Ai(e,Pr);e.total_in=e.total_out=0,e.data_type=g3;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?zm:t.wrap?wa:Si,e.adler=t.wrap===2?0:1,t.last_flush=-2,s3(t),St},Gv=e=>{const t=Yv(e);return t===St&&C3(e.state),t},B3=(e,t)=>iu(e)||e.state.wrap!==2?Pr:(e.state.gzhead=t,St),Zv=(e,t,n,r,s,i)=>{if(!e)return Pr;let o=1;if(t===u3&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),s<1||s>_3||n!==dh||r<8||r>15||t<0||t>9||i<0||i>h3||r===8&&o!==1)return Ai(e,Pr);r===8&&(r=9);const a=new O3;return e.state=a,a.strm=e,a.status=wa,a.wrap=o,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+pe-1)/pe),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=t,a.strategy=i,a.method=n,Gv(e)},$3=(e,t)=>Zv(e,t,dh,y3,m3,p3),D3=(e,t)=>{if(iu(e)||t>R0||t<0)return e?Ai(e,Pr):Pr;const n=e.state;if(!e.output||e.avail_in!==0&&!e.input||n.status===Nc&&t!==zn)return Ai(e,e.avail_out===0?Dp:Pr);const r=n.last_flush;if(n.last_flush=t,n.pending!==0){if(mn(e),e.avail_out===0)return n.last_flush=-1,St}else if(e.avail_in===0&&O0(t)<=O0(r)&&t!==zn)return Ai(e,Dp);if(n.status===Nc&&e.avail_in!==0)return Ai(e,Dp);if(n.status===wa&&n.wrap===0&&(n.status=Si),n.status===wa){let s=dh+(n.w_bits-8<<4)<<8,i=-1;if(n.strategy>=Vu||n.level<2?i=0:n.level<6?i=1:n.level===6?i=2:i=3,s|=i<<6,n.strstart!==0&&(s|=S3),s+=31-s%31,mc(n,s),n.strstart!==0&&(mc(n,e.adler>>>16),mc(n,e.adler&65535)),e.adler=1,n.status=Si,mn(e),n.pending!==0)return n.last_flush=-1,St}if(n.status===zm){if(e.adler=0,Te(n,31),Te(n,139),Te(n,8),n.gzhead)Te(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Te(n,n.gzhead.time&255),Te(n,n.gzhead.time>>8&255),Te(n,n.gzhead.time>>16&255),Te(n,n.gzhead.time>>24&255),Te(n,n.level===9?2:n.strategy>=Vu||n.level<2?4:0),Te(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(Te(n,n.gzhead.extra.length&255),Te(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=dt(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=o_;else if(Te(n,0),Te(n,0),Te(n,0),Te(n,0),Te(n,0),Te(n,n.level===9?2:n.strategy>=Vu||n.level<2?4:0),Te(n,A3),n.status=Si,mn(e),n.pending!==0)return n.last_flush=-1,St}if(n.status===o_){if(n.gzhead.extra){let s=n.pending,i=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+i>n.pending_buf_size;){let a=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+a),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>s&&(e.adler=dt(e.adler,n.pending_buf,n.pending-s,s)),n.gzindex+=a,mn(e),n.pending!==0)return n.last_flush=-1,St;s=0,i-=a}let o=new Uint8Array(n.gzhead.extra);n.pending_buf.set(o.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending+=i,n.gzhead.hcrc&&n.pending>s&&(e.adler=dt(e.adler,n.pending_buf,n.pending-s,s)),n.gzindex=0}n.status=a_}if(n.status===a_){if(n.gzhead.name){let s=n.pending,i;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>s&&(e.adler=dt(e.adler,n.pending_buf,n.pending-s,s)),mn(e),n.pending!==0)return n.last_flush=-1,St;s=0}n.gzindex<n.gzhead.name.length?i=n.gzhead.name.charCodeAt(n.gzindex++)&255:i=0,Te(n,i)}while(i!==0);n.gzhead.hcrc&&n.pending>s&&(e.adler=dt(e.adler,n.pending_buf,n.pending-s,s)),n.gzindex=0}n.status=c_}if(n.status===c_){if(n.gzhead.comment){let s=n.pending,i;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>s&&(e.adler=dt(e.adler,n.pending_buf,n.pending-s,s)),mn(e),n.pending!==0)return n.last_flush=-1,St;s=0}n.gzindex<n.gzhead.comment.length?i=n.gzhead.comment.charCodeAt(n.gzindex++)&255:i=0,Te(n,i)}while(i!==0);n.gzhead.hcrc&&n.pending>s&&(e.adler=dt(e.adler,n.pending_buf,n.pending-s,s))}n.status=l_}if(n.status===l_){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(mn(e),n.pending!==0))return n.last_flush=-1,St;Te(n,e.adler&255),Te(n,e.adler>>8&255),e.adler=0}if(n.status=Si,mn(e),n.pending!==0)return n.last_flush=-1,St}if(e.avail_in!==0||n.lookahead!==0||t!==$s&&n.status!==Nc){let s=n.level===0?Kv(n,t):n.strategy===Vu?R3(n,t):n.strategy===f3?x3(n,t):xc[n.level].func(n,t);if((s===Yi||s===ec)&&(n.status=Nc),s===Ht||s===Yi)return e.avail_out===0&&(n.last_flush=-1),St;if(s===Qa&&(t===a3?o3(n):t!==R0&&(s_(n,0,0,!1),t===c3&&(vs(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),mn(e),e.avail_out===0))return n.last_flush=-1,St}return t!==zn?St:n.wrap<=0?C0:(n.wrap===2?(Te(n,e.adler&255),Te(n,e.adler>>8&255),Te(n,e.adler>>16&255),Te(n,e.adler>>24&255),Te(n,e.total_in&255),Te(n,e.total_in>>8&255),Te(n,e.total_in>>16&255),Te(n,e.total_in>>24&255)):(mc(n,e.adler>>>16),mc(n,e.adler&65535)),mn(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?St:C0)},M3=e=>{if(iu(e))return Pr;const t=e.state.status;return e.state=null,t===Si?Ai(e,l3):St},L3=(e,t)=>{let n=t.length;if(iu(e))return Pr;const r=e.state,s=r.wrap;if(s===2||s===1&&r.status!==wa||r.lookahead)return Pr;if(s===1&&(e.adler=vl(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){s===0&&(vs(r.head),r.strstart=0,r.block_start=0,r.insert=0);let c=new Uint8Array(r.w_size);c.set(t.subarray(n-r.w_size,n),0),t=c,n=r.w_size}const i=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,ka(r);r.lookahead>=pe;){let c=r.strstart,l=r.lookahead-(pe-1);do r.ins_h=Ds(r,r.ins_h,r.window[c+pe-1]),r.prev[c&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=c,c++;while(--l);r.strstart=c,r.lookahead=pe-1,ka(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=pe-1,r.match_available=0,e.next_in=o,e.input=a,e.avail_in=i,r.wrap=s,St};var U3=$3,P3=Zv,F3=Gv,j3=Yv,V3=B3,z3=D3,q3=M3,H3=L3,W3="pako deflate (from Nodeca project)",il={deflateInit:U3,deflateInit2:P3,deflateReset:F3,deflateResetKeep:j3,deflateSetHeader:V3,deflate:z3,deflateEnd:q3,deflateSetDictionary:H3,deflateInfo:W3};const K3=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Y3=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)K3(n,r)&&(e[r]=n[r])}}return e},G3=e=>{let t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,s=0,i=e.length;r<i;r++){let o=e[r];n.set(o,s),s+=o.length}return n},fh={assign:Y3,flattenChunks:G3};let Jv=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Jv=!1}const Sl=new Uint8Array(256);for(let e=0;e<256;e++)Sl[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Sl[254]=Sl[254]=1;var Z3=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,s,i,o=e.length,a=0;for(s=0;s<o;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<o&&(r=e.charCodeAt(s+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),s++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),i=0,s=0;i<a;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<o&&(r=e.charCodeAt(s+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),s++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|n&63):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|n&63):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|n&63);return t};const J3=(e,t)=>{if(t<65534&&e.subarray&&Jv)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};var X3=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,s;const i=new Array(n*2);for(s=0,r=0;r<n;){let o=e[r++];if(o<128){i[s++]=o;continue}let a=Sl[o];if(a>4){i[s++]=65533,r+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&r<n;)o=o<<6|e[r++]&63,a--;if(a>1){i[s++]=65533;continue}o<65536?i[s++]=o:(o-=65536,i[s++]=55296|o>>10&1023,i[s++]=56320|o&1023)}return J3(i,s)},Q3=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+Sl[e[n]]>t?n:t},Al={string2buf:Z3,buf2string:X3,utf8border:Q3};function eD(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Xv=eD;const Qv=Object.prototype.toString,{Z_NO_FLUSH:tD,Z_SYNC_FLUSH:nD,Z_FULL_FLUSH:rD,Z_FINISH:sD,Z_OK:Qd,Z_STREAM_END:iD,Z_DEFAULT_COMPRESSION:oD,Z_DEFAULT_STRATEGY:aD,Z_DEFLATED:cD}=uh;function hh(e){this.options=fh.assign({level:oD,method:cD,chunkSize:16384,windowBits:15,memLevel:8,strategy:aD},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xv,this.strm.avail_out=0;let n=il.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Qd)throw new Error(Ki[n]);if(t.header&&il.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=Al.string2buf(t.dictionary):Qv.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,n=il.deflateSetDictionary(this.strm,r),n!==Qd)throw new Error(Ki[n]);this._dict_set=!0}}hh.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let s,i;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?sD:tD,typeof e=="string"?n.input=Al.string2buf(e):Qv.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(i===nD||i===rD)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(s=il.deflate(n,i),s===iD)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),s=il.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Qd;if(n.avail_out===0){this.onData(n.output);continue}if(i>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};hh.prototype.onData=function(e){this.chunks.push(e)};hh.prototype.onEnd=function(e){e===Qd&&(this.result=fh.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function lD(e,t){const n=new hh(t);if(n.push(e,!0),n.err)throw n.msg||Ki[n.err];return n.result}function uD(e,t){return t=t||{},t.gzip=!0,lD(e,t)}var dD=uD,fD={gzip:dD};const zu=16209,hD=16191;var pD=function(t,n){let r,s,i,o,a,c,l,u,d,f,h,p,_,g,y,w,k,b,N,S,E,A,x,D;const B=t.state;r=t.next_in,x=t.input,s=r+(t.avail_in-5),i=t.next_out,D=t.output,o=i-(n-t.avail_out),a=i+(t.avail_out-257),c=B.dmax,l=B.wsize,u=B.whave,d=B.wnext,f=B.window,h=B.hold,p=B.bits,_=B.lencode,g=B.distcode,y=(1<<B.lenbits)-1,w=(1<<B.distbits)-1;e:do{p<15&&(h+=x[r++]<<p,p+=8,h+=x[r++]<<p,p+=8),k=_[h&y];t:for(;;){if(b=k>>>24,h>>>=b,p-=b,b=k>>>16&255,b===0)D[i++]=k&65535;else if(b&16){N=k&65535,b&=15,b&&(p<b&&(h+=x[r++]<<p,p+=8),N+=h&(1<<b)-1,h>>>=b,p-=b),p<15&&(h+=x[r++]<<p,p+=8,h+=x[r++]<<p,p+=8),k=g[h&w];n:for(;;){if(b=k>>>24,h>>>=b,p-=b,b=k>>>16&255,b&16){if(S=k&65535,b&=15,p<b&&(h+=x[r++]<<p,p+=8,p<b&&(h+=x[r++]<<p,p+=8)),S+=h&(1<<b)-1,S>c){t.msg="invalid distance too far back",B.mode=zu;break e}if(h>>>=b,p-=b,b=i-o,S>b){if(b=S-b,b>u&&B.sane){t.msg="invalid distance too far back",B.mode=zu;break e}if(E=0,A=f,d===0){if(E+=l-b,b<N){N-=b;do D[i++]=f[E++];while(--b);E=i-S,A=D}}else if(d<b){if(E+=l+d-b,b-=d,b<N){N-=b;do D[i++]=f[E++];while(--b);if(E=0,d<N){b=d,N-=b;do D[i++]=f[E++];while(--b);E=i-S,A=D}}}else if(E+=d-b,b<N){N-=b;do D[i++]=f[E++];while(--b);E=i-S,A=D}for(;N>2;)D[i++]=A[E++],D[i++]=A[E++],D[i++]=A[E++],N-=3;N&&(D[i++]=A[E++],N>1&&(D[i++]=A[E++]))}else{E=i-S;do D[i++]=D[E++],D[i++]=D[E++],D[i++]=D[E++],N-=3;while(N>2);N&&(D[i++]=D[E++],N>1&&(D[i++]=D[E++]))}}else if((b&64)===0){k=g[(k&65535)+(h&(1<<b)-1)];continue n}else{t.msg="invalid distance code",B.mode=zu;break e}break}}else if((b&64)===0){k=_[(k&65535)+(h&(1<<b)-1)];continue t}else if(b&32){B.mode=hD;break e}else{t.msg="invalid literal/length code",B.mode=zu;break e}break}}while(r<s&&i<a);N=p>>3,r-=N,p-=N<<3,h&=(1<<p)-1,t.next_in=r,t.next_out=i,t.avail_in=r<s?5+(s-r):5-(r-s),t.avail_out=i<a?257+(a-i):257-(i-a),B.hold=h,B.bits=p};const No=15,B0=852,$0=592,D0=0,Lp=1,M0=2,gD=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_D=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),yD=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),mD=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),bD=(e,t,n,r,s,i,o,a)=>{const c=a.bits;let l=0,u=0,d=0,f=0,h=0,p=0,_=0,g=0,y=0,w=0,k,b,N,S,E,A=null,x;const D=new Uint16Array(No+1),B=new Uint16Array(No+1);let z=null,J,R,U;for(l=0;l<=No;l++)D[l]=0;for(u=0;u<r;u++)D[t[n+u]]++;for(h=c,f=No;f>=1&&D[f]===0;f--);if(h>f&&(h=f),f===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<f&&D[d]===0;d++);for(h<d&&(h=d),g=1,l=1;l<=No;l++)if(g<<=1,g-=D[l],g<0)return-1;if(g>0&&(e===D0||f!==1))return-1;for(B[1]=0,l=1;l<No;l++)B[l+1]=B[l]+D[l];for(u=0;u<r;u++)t[n+u]!==0&&(o[B[t[n+u]]++]=u);if(e===D0?(A=z=o,x=20):e===Lp?(A=gD,z=_D,x=257):(A=yD,z=mD,x=0),w=0,u=0,l=d,E=i,p=h,_=0,N=-1,y=1<<h,S=y-1,e===Lp&&y>B0||e===M0&&y>$0)return 1;for(;;){J=l-_,o[u]+1<x?(R=0,U=o[u]):o[u]>=x?(R=z[o[u]-x],U=A[o[u]-x]):(R=96,U=0),k=1<<l-_,b=1<<p,d=b;do b-=k,s[E+(w>>_)+b]=J<<24|R<<16|U|0;while(b!==0);for(k=1<<l-1;w&k;)k>>=1;if(k!==0?(w&=k-1,w+=k):w=0,u++,--D[l]===0){if(l===f)break;l=t[n+o[u]]}if(l>h&&(w&S)!==N){for(_===0&&(_=h),E+=d,p=l-_,g=1<<p;p+_<f&&(g-=D[p+_],!(g<=0));)p++,g<<=1;if(y+=1<<p,e===Lp&&y>B0||e===M0&&y>$0)return 1;N=w&S,s[N]=h<<24|p<<16|E-i|0}}return w!==0&&(s[E+w]=l-_<<24|64<<16|0),a.bits=h,0};var ol=bD;const wD=0,eS=1,tS=2,{Z_FINISH:L0,Z_BLOCK:kD,Z_TREES:qu,Z_OK:Gi,Z_STREAM_END:ED,Z_NEED_DICT:TD,Z_STREAM_ERROR:Yn,Z_DATA_ERROR:nS,Z_MEM_ERROR:rS,Z_BUF_ERROR:vD,Z_DEFLATED:U0}=uh,ph=16180,P0=16181,F0=16182,j0=16183,V0=16184,z0=16185,q0=16186,H0=16187,W0=16188,K0=16189,ef=16190,Zr=16191,Up=16192,Y0=16193,Pp=16194,G0=16195,Z0=16196,J0=16197,X0=16198,Hu=16199,Wu=16200,Q0=16201,ek=16202,tk=16203,nk=16204,rk=16205,Fp=16206,sk=16207,ik=16208,De=16209,sS=16210,iS=16211,SD=852,AD=592,ID=15,ND=ID,ok=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function xD(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const uo=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<ph||t.mode>iS?1:0},oS=e=>{if(uo(e))return Yn;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=ph,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(SD),t.distcode=t.distdyn=new Int32Array(AD),t.sane=1,t.back=-1,Gi},aS=e=>{if(uo(e))return Yn;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,oS(e)},cS=(e,t)=>{let n;if(uo(e))return Yn;const r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Yn:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,aS(e))},lS=(e,t)=>{if(!e)return Yn;const n=new xD;e.state=n,n.strm=e,n.window=null,n.mode=ph;const r=cS(e,t);return r!==Gi&&(e.state=null),r},RD=e=>lS(e,ND);let ak=!0,jp,Vp;const CD=e=>{if(ak){jp=new Int32Array(512),Vp=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ol(eS,e.lens,0,288,jp,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ol(tS,e.lens,0,32,Vp,0,e.work,{bits:5}),ak=!1}e.lencode=jp,e.lenbits=9,e.distcode=Vp,e.distbits=5},uS=(e,t,n,r)=>{let s;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>r&&(s=r),i.window.set(t.subarray(n-r,n-r+s),i.wnext),r-=s,r?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},OD=(e,t)=>{let n,r,s,i,o,a,c,l,u,d,f,h,p,_,g=0,y,w,k,b,N,S,E,A;const x=new Uint8Array(4);let D,B;const z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(uo(e)||!e.output||!e.input&&e.avail_in!==0)return Yn;n=e.state,n.mode===Zr&&(n.mode=Up),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,r=e.input,a=e.avail_in,l=n.hold,u=n.bits,d=a,f=c,A=Gi;e:for(;;)switch(n.mode){case ph:if(n.wrap===0){n.mode=Up;break}for(;u<16;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if(n.wrap&2&&l===35615){n.wbits===0&&(n.wbits=15),n.check=0,x[0]=l&255,x[1]=l>>>8&255,n.check=dt(n.check,x,2,0),l=0,u=0,n.mode=P0;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((l&255)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=De;break}if((l&15)!==U0){e.msg="unknown compression method",n.mode=De;break}if(l>>>=4,u-=4,E=(l&15)+8,n.wbits===0&&(n.wbits=E),E>15||E>n.wbits){e.msg="invalid window size",n.mode=De;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=l&512?K0:Zr,l=0,u=0;break;case P0:for(;u<16;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if(n.flags=l,(n.flags&255)!==U0){e.msg="unknown compression method",n.mode=De;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=De;break}n.head&&(n.head.text=l>>8&1),n.flags&512&&n.wrap&4&&(x[0]=l&255,x[1]=l>>>8&255,n.check=dt(n.check,x,2,0)),l=0,u=0,n.mode=F0;case F0:for(;u<32;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}n.head&&(n.head.time=l),n.flags&512&&n.wrap&4&&(x[0]=l&255,x[1]=l>>>8&255,x[2]=l>>>16&255,x[3]=l>>>24&255,n.check=dt(n.check,x,4,0)),l=0,u=0,n.mode=j0;case j0:for(;u<16;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}n.head&&(n.head.xflags=l&255,n.head.os=l>>8),n.flags&512&&n.wrap&4&&(x[0]=l&255,x[1]=l>>>8&255,n.check=dt(n.check,x,2,0)),l=0,u=0,n.mode=V0;case V0:if(n.flags&1024){for(;u<16;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),n.flags&512&&n.wrap&4&&(x[0]=l&255,x[1]=l>>>8&255,n.check=dt(n.check,x,2,0)),l=0,u=0}else n.head&&(n.head.extra=null);n.mode=z0;case z0:if(n.flags&1024&&(h=n.length,h>a&&(h=a),h&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+h),E)),n.flags&512&&n.wrap&4&&(n.check=dt(n.check,r,h,i)),a-=h,i+=h,n.length-=h),n.length))break e;n.length=0,n.mode=q0;case q0:if(n.flags&2048){if(a===0)break e;h=0;do E=r[i+h++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E));while(E&&h<a);if(n.flags&512&&n.wrap&4&&(n.check=dt(n.check,r,h,i)),a-=h,i+=h,E)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=H0;case H0:if(n.flags&4096){if(a===0)break e;h=0;do E=r[i+h++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E));while(E&&h<a);if(n.flags&512&&n.wrap&4&&(n.check=dt(n.check,r,h,i)),a-=h,i+=h,E)break e}else n.head&&(n.head.comment=null);n.mode=W0;case W0:if(n.flags&512){for(;u<16;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if(n.wrap&4&&l!==(n.check&65535)){e.msg="header crc mismatch",n.mode=De;break}l=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Zr;break;case K0:for(;u<32;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}e.adler=n.check=ok(l),l=0,u=0,n.mode=ef;case ef:if(n.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=a,n.hold=l,n.bits=u,TD;e.adler=n.check=1,n.mode=Zr;case Zr:if(t===kD||t===qu)break e;case Up:if(n.last){l>>>=u&7,u-=u&7,n.mode=Fp;break}for(;u<3;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}switch(n.last=l&1,l>>>=1,u-=1,l&3){case 0:n.mode=Y0;break;case 1:if(CD(n),n.mode=Hu,t===qu){l>>>=2,u-=2;break e}break;case 2:n.mode=Z0;break;case 3:e.msg="invalid block type",n.mode=De}l>>>=2,u-=2;break;case Y0:for(l>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if((l&65535)!==(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=De;break}if(n.length=l&65535,l=0,u=0,n.mode=Pp,t===qu)break e;case Pp:n.mode=G0;case G0:if(h=n.length,h){if(h>a&&(h=a),h>c&&(h=c),h===0)break e;s.set(r.subarray(i,i+h),o),a-=h,i+=h,c-=h,o+=h,n.length-=h;break}n.mode=Zr;break;case Z0:for(;u<14;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if(n.nlen=(l&31)+257,l>>>=5,u-=5,n.ndist=(l&31)+1,l>>>=5,u-=5,n.ncode=(l&15)+4,l>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=De;break}n.have=0,n.mode=J0;case J0:for(;n.have<n.ncode;){for(;u<3;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}n.lens[z[n.have++]]=l&7,l>>>=3,u-=3}for(;n.have<19;)n.lens[z[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,D={bits:n.lenbits},A=ol(wD,n.lens,0,19,n.lencode,0,n.work,D),n.lenbits=D.bits,A){e.msg="invalid code lengths set",n.mode=De;break}n.have=0,n.mode=X0;case X0:for(;n.have<n.nlen+n.ndist;){for(;g=n.lencode[l&(1<<n.lenbits)-1],y=g>>>24,w=g>>>16&255,k=g&65535,!(y<=u);){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if(k<16)l>>>=y,u-=y,n.lens[n.have++]=k;else{if(k===16){for(B=y+2;u<B;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if(l>>>=y,u-=y,n.have===0){e.msg="invalid bit length repeat",n.mode=De;break}E=n.lens[n.have-1],h=3+(l&3),l>>>=2,u-=2}else if(k===17){for(B=y+3;u<B;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}l>>>=y,u-=y,E=0,h=3+(l&7),l>>>=3,u-=3}else{for(B=y+7;u<B;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}l>>>=y,u-=y,E=0,h=11+(l&127),l>>>=7,u-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=De;break}for(;h--;)n.lens[n.have++]=E}}if(n.mode===De)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=De;break}if(n.lenbits=9,D={bits:n.lenbits},A=ol(eS,n.lens,0,n.nlen,n.lencode,0,n.work,D),n.lenbits=D.bits,A){e.msg="invalid literal/lengths set",n.mode=De;break}if(n.distbits=6,n.distcode=n.distdyn,D={bits:n.distbits},A=ol(tS,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D),n.distbits=D.bits,A){e.msg="invalid distances set",n.mode=De;break}if(n.mode=Hu,t===qu)break e;case Hu:n.mode=Wu;case Wu:if(a>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=a,n.hold=l,n.bits=u,pD(e,f),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,r=e.input,a=e.avail_in,l=n.hold,u=n.bits,n.mode===Zr&&(n.back=-1);break}for(n.back=0;g=n.lencode[l&(1<<n.lenbits)-1],y=g>>>24,w=g>>>16&255,k=g&65535,!(y<=u);){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if(w&&(w&240)===0){for(b=y,N=w,S=k;g=n.lencode[S+((l&(1<<b+N)-1)>>b)],y=g>>>24,w=g>>>16&255,k=g&65535,!(b+y<=u);){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}l>>>=b,u-=b,n.back+=b}if(l>>>=y,u-=y,n.back+=y,n.length=k,w===0){n.mode=rk;break}if(w&32){n.back=-1,n.mode=Zr;break}if(w&64){e.msg="invalid literal/length code",n.mode=De;break}n.extra=w&15,n.mode=Q0;case Q0:if(n.extra){for(B=n.extra;u<B;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=ek;case ek:for(;g=n.distcode[l&(1<<n.distbits)-1],y=g>>>24,w=g>>>16&255,k=g&65535,!(y<=u);){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if((w&240)===0){for(b=y,N=w,S=k;g=n.distcode[S+((l&(1<<b+N)-1)>>b)],y=g>>>24,w=g>>>16&255,k=g&65535,!(b+y<=u);){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}l>>>=b,u-=b,n.back+=b}if(l>>>=y,u-=y,n.back+=y,w&64){e.msg="invalid distance code",n.mode=De;break}n.offset=k,n.extra=w&15,n.mode=tk;case tk:if(n.extra){for(B=n.extra;u<B;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=De;break}n.mode=nk;case nk:if(c===0)break e;if(h=f-c,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=De;break}h>n.wnext?(h-=n.wnext,p=n.wsize-h):p=n.wnext-h,h>n.length&&(h=n.length),_=n.window}else _=s,p=o-n.offset,h=n.length;h>c&&(h=c),c-=h,n.length-=h;do s[o++]=_[p++];while(--h);n.length===0&&(n.mode=Wu);break;case rk:if(c===0)break e;s[o++]=n.length,c--,n.mode=Wu;break;case Fp:if(n.wrap){for(;u<32;){if(a===0)break e;a--,l|=r[i++]<<u,u+=8}if(f-=c,e.total_out+=f,n.total+=f,n.wrap&4&&f&&(e.adler=n.check=n.flags?dt(n.check,s,f,o-f):vl(n.check,s,f,o-f)),f=c,n.wrap&4&&(n.flags?l:ok(l))!==n.check){e.msg="incorrect data check",n.mode=De;break}l=0,u=0}n.mode=sk;case sk:if(n.wrap&&n.flags){for(;u<32;){if(a===0)break e;a--,l+=r[i++]<<u,u+=8}if(n.wrap&4&&l!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=De;break}l=0,u=0}n.mode=ik;case ik:A=ED;break e;case De:A=nS;break e;case sS:return rS;case iS:default:return Yn}return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=a,n.hold=l,n.bits=u,(n.wsize||f!==e.avail_out&&n.mode<De&&(n.mode<Fp||t!==L0))&&uS(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,n.total+=f,n.wrap&4&&f&&(e.adler=n.check=n.flags?dt(n.check,s,f,e.next_out-f):vl(n.check,s,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Zr?128:0)+(n.mode===Hu||n.mode===Pp?256:0),(d===0&&f===0||t===L0)&&A===Gi&&(A=vD),A},BD=e=>{if(uo(e))return Yn;let t=e.state;return t.window&&(t.window=null),e.state=null,Gi},$D=(e,t)=>{if(uo(e))return Yn;const n=e.state;return(n.wrap&2)===0?Yn:(n.head=t,t.done=!1,Gi)},DD=(e,t)=>{const n=t.length;let r,s,i;return uo(e)||(r=e.state,r.wrap!==0&&r.mode!==ef)?Yn:r.mode===ef&&(s=1,s=vl(s,t,n,0),s!==r.check)?nS:(i=uS(e,t,n,n),i?(r.mode=sS,rS):(r.havedict=1,Gi))};var MD=aS,LD=cS,UD=oS,PD=RD,FD=lS,jD=OD,VD=BD,zD=$D,qD=DD,HD="pako inflate (from Nodeca project)",ns={inflateReset:MD,inflateReset2:LD,inflateResetKeep:UD,inflateInit:PD,inflateInit2:FD,inflate:jD,inflateEnd:VD,inflateGetHeader:zD,inflateSetDictionary:qD,inflateInfo:HD};function WD(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var KD=WD;const dS=Object.prototype.toString,{Z_NO_FLUSH:YD,Z_FINISH:GD,Z_OK:Il,Z_STREAM_END:zp,Z_NEED_DICT:qp,Z_STREAM_ERROR:ZD,Z_DATA_ERROR:ck,Z_MEM_ERROR:JD}=uh;function gh(e){this.options=fh.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xv,this.strm.avail_out=0;let n=ns.inflateInit2(this.strm,t.windowBits);if(n!==Il)throw new Error(Ki[n]);if(this.header=new KD,ns.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Al.string2buf(t.dictionary):dS.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=ns.inflateSetDictionary(this.strm,t.dictionary),n!==Il)))throw new Error(Ki[n])}gh.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,s=this.options.dictionary;let i,o,a;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?GD:YD,dS.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=ns.inflate(n,o),i===qp&&s&&(i=ns.inflateSetDictionary(n,s),i===Il?i=ns.inflate(n,o):i===ck&&(i=qp));n.avail_in>0&&i===zp&&n.state.wrap>0&&e[n.next_in]!==0;)ns.inflateReset(n),i=ns.inflate(n,o);switch(i){case ZD:case ck:case qp:case JD:return this.onEnd(i),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(n.avail_out===0||i===zp))if(this.options.to==="string"){let c=Al.utf8border(n.output,n.next_out),l=n.next_out-c,u=Al.buf2string(n.output,c);n.next_out=l,n.avail_out=r-l,l&&n.output.set(n.output.subarray(c,c+l),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(i===Il&&a===0)){if(i===zp)return i=ns.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};gh.prototype.onData=function(e){this.chunks.push(e)};gh.prototype.onEnd=function(e){e===Il&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fh.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function XD(e,t){const n=new gh(t);if(n.push(e),n.err)throw n.msg||Ki[n.err];return n.result}var QD=XD,eM={ungzip:QD};const{gzip:tM}=fD,{ungzip:nM}=eM;var rM=tM,sM=nM;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const fS=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),lk=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),iM=BigInt(1),d_=BigInt(2),uk=(e,t)=>(e+t/d_)/t;function oM(e){const t=fS,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,d=$n(u,n,t)*u%t,f=$n(d,n,t)*u%t,h=$n(f,d_,t)*l%t,p=$n(h,s,t)*h%t,_=$n(p,i,t)*p%t,g=$n(_,a,t)*_%t,y=$n(g,c,t)*g%t,w=$n(y,a,t)*_%t,k=$n(w,n,t)*u%t,b=$n(k,o,t)*p%t,N=$n(b,r,t)*l%t,S=$n(N,d_,t);if(!f_.eql(f_.sqr(S),e))throw new Error("Cannot find square root");return S}const f_=ch(fS,void 0,void 0,{sqrt:oM}),hS=f$({a:BigInt(0),b:BigInt(7),Fp:f_,n:lk,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=lk,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-iM*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=uk(i*e,t),c=uk(-r*e,t);let l=Nt(e-a*n-c*s,t),u=Nt(-a*r-c*i,t);const d=l>o,f=u>o;if(d&&(l=t-l),f&&(u=t-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:d,k1:l,k2neg:f,k2:u}}}},nu);BigInt(0);hS.ProjectivePoint;const pS=(e,t,n=[])=>{const r=Object.getOwnPropertyDescriptors(t);for(let s of n)delete r[s];Object.defineProperties(e,r)},Nl=(e,t=[e])=>{const n=Object.getPrototypeOf(e);return n===null?t:Nl(n,[...t,n])},aM=(...e)=>{if(e.length===0)return;let t;const n=e.map(r=>Nl(r));for(;n.every(r=>r.length>0);){const r=n.map(i=>i.pop()),s=r[0];if(r.every(i=>i===s))t=s;else break}return t},dk=(e,t,n=[])=>{var r;const s=(r=aM(...e))!==null&&r!==void 0?r:Object.prototype,i=Object.create(s),o=Nl(s);for(let a of e){let c=Nl(a);for(let l=c.length-1;l>=0;l--){let u=c[l];o.indexOf(u)===-1&&(pS(i,u,["constructor",...n]),o.push(u))}}return i.constructor=t,i},h_=e=>e.filter((t,n)=>e.indexOf(t)==n),gS=new WeakMap,cM=e=>gS.get(e),lM=(e,t)=>gS.set(e,t),fk=(e,t)=>{var n,r;const s=h_([...Object.getOwnPropertyNames(e),...Object.getOwnPropertyNames(t)]),i={};for(let o of s)i[o]=h_([...(n=e?.[o])!==null&&n!==void 0?n:[],...(r=t?.[o])!==null&&r!==void 0?r:[]]);return i},hk=(e,t)=>{var n,r,s,i;return{property:fk((n=e?.property)!==null&&n!==void 0?n:{},(r=t?.property)!==null&&r!==void 0?r:{}),method:fk((s=e?.method)!==null&&s!==void 0?s:{},(i=t?.method)!==null&&i!==void 0?i:{})}},uM=(e,t)=>{var n,r,s,i,o,a;return{class:h_([...(n=e?.class)!==null&&n!==void 0?n:[],...(r=t?.class)!==null&&r!==void 0?r:[]]),static:hk((s=e?.static)!==null&&s!==void 0?s:{},(i=t?.static)!==null&&i!==void 0?i:{}),instance:hk((o=e?.instance)!==null&&o!==void 0?o:{},(a=t?.instance)!==null&&a!==void 0?a:{})}},dM=new Map,fM=(...e)=>{var t;const n=new Set,r=new Set([...e]);for(;r.size>0;)for(let s of r){const i=Nl(s.prototype).map(l=>l.constructor),o=(t=cM(s))!==null&&t!==void 0?t:[],c=[...i,...o].filter(l=>!n.has(l));for(let l of c)r.add(l);n.add(s),r.delete(s)}return[...n]},hM=(...e)=>{const t=fM(...e).map(n=>dM.get(n)).filter(n=>!!n);return t.length==0?{}:t.length==1?t[0]:t.reduce((n,r)=>uM(n,r))};function pM(...e){var t,n,r;const s=e.map(a=>a.prototype);function i(...a){for(const c of e)pS(this,new c(...a))}i.prototype=dk(s,i),Object.setPrototypeOf(i,dk(e,null,["prototype"]));let o=i;{const a=hM(...e);for(let c of(t=a?.class)!==null&&t!==void 0?t:[]){const l=c(o);l&&(o=l)}pk((n=a?.static)!==null&&n!==void 0?n:{},o),pk((r=a?.instance)!==null&&r!==void 0?r:{},o.prototype)}return lM(o,e),o}const pk=(e,t)=>{const n=e.property,r=e.method;if(n)for(let s in n)for(let i of n[s])i(t,s);if(r)for(let s in r)for(let i of r[s])i(t,s,Object.getOwnPropertyDescriptor(t,s))};var _S=Object.defineProperty,gM=Object.getOwnPropertyDescriptor,_M=Object.getOwnPropertyNames,yM=Object.prototype.hasOwnProperty,Se=(e,t)=>{for(var n in t)_S(e,n,{get:t[n],enumerable:!0})},mM=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of _M(t))!yM.call(e,s)&&s!==n&&_S(e,s,{get:()=>t[s],enumerable:!(r=gM(t,s))||r.enumerable});return e},yS=(e,t,n)=>(mM(e,t,"default"),n),Ms={};Se(Ms,{ADDR_BOUND:()=>BS,API_VERSION:()=>CS,BaseUrl:()=>xM,DEFAULT_GLOBAL_CONFIG:()=>LS,HARDENING_4BYTES:()=>NM,HARDENING_BYTE:()=>IM,IS_BROWSER:()=>bS,LegacyUDC:()=>AM,MASK_250:()=>xS,MASK_31:()=>RS,MAX_STORAGE_ITEM_SIZE:()=>OS,NetworkName:()=>tc,OutsideExecutionCallerAny:()=>$S,PAYMASTER_RPC_NODES:()=>PS,PRIME:()=>rt,RANGE_FELT:()=>tf,RANGE_I128:()=>Fo,RANGE_I16:()=>Dc,RANGE_I32:()=>Mc,RANGE_I64:()=>Lc,RANGE_I8:()=>$c,RANGE_U128:()=>Po,RANGE_U16:()=>Cc,RANGE_U32:()=>SM,RANGE_U64:()=>Oc,RANGE_U8:()=>Rc,RANGE_U96:()=>Bc,RPC_DEFAULT_NODES:()=>US,SNIP9_V1_INTERFACE_ID:()=>DS,SNIP9_V2_INTERFACE_ID:()=>MS,SYSTEM_MESSAGES:()=>Qe,StarknetChainId:()=>fn,SupportedRpcVersion:()=>Ls,TEXT_TO_FELT_MAX_LEN:()=>Hm,TransactionHashPrefix:()=>Ys,UDC:()=>Rl,ZERO:()=>un});var H={};Se(H,{JRPC:()=>bM,PAYMASTER_API:()=>TT,RPCSPEC08:()=>um,RPCSPEC09:()=>Za});var bM={},mS={};yS(mS,Za);yS(H,mS);var wM={};Se(wM,{IS_BROWSER:()=>bS,addHexPrefix:()=>Y,arrayBufferToString:()=>wS,atobUniversal:()=>kS,bigIntToUint8Array:()=>gt,btoaUniversal:()=>ES,buf2hex:()=>fo,calcByteLength:()=>vS,concatenateArrayBuffer:()=>IS,hexStringToUint8Array:()=>NS,padLeft:()=>TS,pascalToSnake:()=>EM,removeHexPrefix:()=>an,sanitizeBytes:()=>SS,sanitizeHex:()=>AS,stringToUint8Array:()=>yh,uint8ArrayToBigInt:()=>xl,utf8ToArray:()=>Zi,utf8ToBigInt:()=>Jn,utf8ToUint8Array:()=>_h});var bS=typeof window<"u",qm="0";function wS(e){return new Uint8Array(e).reduce((t,n)=>t+String.fromCharCode(n),"")}function _h(e){return new TextEncoder().encode(e)}var Zi=_h;function Jn(e){return xl(_h(e))}function kS(e){return KT.decode(e)}function ES(e){return KT.encode(new Uint8Array(e))}function fo(e){return e.reduce((t,n)=>t+n.toString(16).padStart(2,"0"),"")}function an(e){return e.replace(/^0x/i,"")}function Y(e){return`0x${an(e)}`}function kM(e,t,n,r=qm){const s=t-e.length;let i=e;return s>0&&(i=r.repeat(s)+e),i}function TS(e,t,n=qm){return kM(e,t,!0,n)}function vS(e,t=8){const{length:n}=e,r=n%t;return r?(n-r)/t*t+t:n}function SS(e,t=8,n=qm){return TS(e,vS(e,t),n)}function AS(e){const t=an(e),n=SS(t,2);return n&&Y(n)}var EM=e=>/[a-z]/.test(e)?e.split(/(?=[A-Z])/).join("_").toUpperCase():e;function IS(e){const t=e.reduce((s,i)=>s+i.byteLength,0),n=new Uint8Array(t);let r=0;return e.forEach(s=>{n.set(s,r),r+=s.byteLength}),n}function NS(e){const t=e.startsWith("0x")?e.slice(2):e;if(t.length>0&&!/^[0-9a-fA-F]+$/.test(t))throw new Error(`Invalid hex string: "${e}" contains non-hexadecimal characters`);const n=t.length%2!==0?`0${t}`:t,r=new Uint8Array(n.length/2);for(let s=0;s<n.length;s+=2)r[s/2]=parseInt(n.substring(s,s+2),16);return r}function TM(e){return/^0[xX][0-9a-fA-F]*$/.test(e)}function vM(e){return/^[0-9]+$/.test(e)}function yh(e){if(TM(e))return NS(e);if(vM(e)){const t=BigInt(e);return gt(t)}return _h(e)}function gt(e){if(e<0n)throw new Error(`Cannot convert negative bigint ${e} to Uint8Array`);if(e===0n)return new Uint8Array([0]);let t=e.toString(16);t.length%2!==0&&(t=`0${t}`);const n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r/2]=parseInt(t.substring(r,r+2),16);return n}function xl(e){if(!e||e.length===0)return 0n;let t="0x";for(let n=0;n<e.length;n+=1)t+=e[n].toString(16).padStart(2,"0");return BigInt(t)}var Hm=31,un=0n,xS=2n**250n-1n,RS=2n**31n-1n,CS=un,rt=2n**251n+17n*2n**192n+1n,OS=256n,BS=2n**251n-OS,Xn=(e,t)=>({min:e,max:t}),tf=Xn(un,rt-1n),Rc=Xn(un,2n**8n-1n),Cc=Xn(un,2n**16n-1n),SM=Xn(un,2n**32n-1n),Oc=Xn(un,2n**64n-1n),Bc=Xn(un,2n**96n-1n),Po=Xn(un,2n**128n-1n),$c=Xn(-(2n**7n),2n**7n-1n),Dc=Xn(-(2n**15n),2n**15n-1n),Mc=Xn(-(2n**31n),2n**31n-1n),Lc=Xn(-(2n**63n),2n**63n-1n),Fo=Xn(-(2n**127n),2n**127n-1n),AM={ADDRESS:"0x041a78e741e5af2fec34b695679bc6891742439f7afb8484ecd7766661ad02bf",ENTRYPOINT:"deployContract"},Rl={ADDRESS:"0x02ceed65a4bd731034c01113685c831b01c15d7d432f71afb1cf1634b53a2125",ENTRYPOINT:"deploy_contract"},$S="0x414e595f43414c4c4552",DS="0x68cfd18b92d1907b8ba3cc324900277f5a3622099431ea85dd8089255e4181",MS="0x1d1144bb2138366ff28d8e9ab57456b1d332ac42196230c3a602003c89872",IM=128,NM=2147483648n,xM={SN_MAIN:"https://alpha-mainnet.starknet.io",SN_SEPOLIA:"https://alpha-sepolia.starknet.io"},tc={SN_MAIN:"SN_MAIN",SN_SEPOLIA:"SN_SEPOLIA"},fn={SN_MAIN:"0x534e5f4d41494e",SN_SEPOLIA:"0x534e5f5345504f4c4941"},Ys={DECLARE:"0x6465636c617265",DEPLOY:"0x6465706c6f79",DEPLOY_ACCOUNT:"0x6465706c6f795f6163636f756e74",INVOKE:"0x696e766f6b65",L1_HANDLER:"0x6c315f68616e646c6572"},Ls={"0.8.1":"0.8.1","0.9.0":"0.9.0",v0_8_1:"0.8.1",v0_9_0:"0.9.0"},LS={rpcVersion:"0.9.0",transactionVersion:H.ETransactionVersion.V3,logLevel:"INFO",resourceBoundsOverhead:{l1_gas:{max_amount:50,max_price_per_unit:50},l1_data_gas:{max_amount:50,max_price_per_unit:50},l2_gas:{max_amount:50,max_price_per_unit:50}},defaultTipType:"recommendedTip",fetch:void 0,websocket:void 0,buffer:void 0},US={SN_MAIN:["https://starknet-mainnet.public.blastapi.io/rpc/"],SN_SEPOLIA:["https://starknet-sepolia.public.blastapi.io/rpc/"]},PS={SN_MAIN:["https://starknet.paymaster.avnu.fi"],SN_SEPOLIA:["https://sepolia.paymaster.avnu.fi"]},Qe={legacyTxWarningMessage:`You are using a deprecated transaction version (V0,V1,V2)!
Update to the latest V3 transactions!`,legacyTxRPC08Message:"RPC 0.8+ do not support legacy transactions, use RPC 0.8+ v3 transactions!",SWOldV3:"RPC 0.7 V3 tx (improper resource bounds) not supported in RPC 0.8+",channelVersionMismatch:"Channel specification version is not compatible with the connected node Specification Version",unsupportedSpecVersion:"The connected node specification version is not supported by this library",maxFeeInV3:"maxFee is not supported in V3 transactions, use resourceBounds instead",declareNonSierra:"Declaring non Sierra (Cairo0)contract using RPC 0.8+",unsupportedMethodForRpcVersion:"Unsupported method for RPC version",txEvictedFromMempool:"Transaction TTL, evicted from the mempool, try to increase the tip",consensusFailed:"Consensus failed to finalize the block proposal",txFailsBlockBuildingValidation:"Transaction fails block building validation"},RM=class Uc{static instance;config;constructor(){this.initialize()}initialize(){this.config={...LS}}static getInstance(){return Uc.instance||(Uc.instance=new Uc),Uc.instance}get(t,n){return this.config[t]??n}set(t,n){this.config[t]=n}update(t){this.config={...this.config,...t}}getAll(){return{...this.config}}reset(){this.initialize()}delete(t){delete this.config[t]}hasKey(t){return t in this.config}},Gn=RM.getInstance(),Ku={DEBUG:5,INFO:4,WARN:3,ERROR:2,FATAL:1,OFF:0},CM=class Pc{static instance;config;constructor(){this.config=Gn}static getInstance(){return Pc.instance||(Pc.instance=new Pc),Pc.instance}getTimestamp(){return new Date().toISOString()}shouldLog(t){const n=this.config.get("logLevel","INFO");return t<=Ku[n]}formatMessage(t){const{level:n,message:r,timestamp:s,data:i}=t;let o=`[${s}] ${n}: ${r}`;if(i)try{o+=`
${JSON.stringify(i,null,2)}`}catch(a){o+=`
[JSON.stringify Error/Circular]: ${a}`}return o}log(t,n,r){if(!this.shouldLog(Ku[t]))return;const s={level:t,message:n,timestamp:this.getTimestamp(),data:r},i=this.formatMessage(s);switch(t){case"DEBUG":console.debug(i);break;case"INFO":console.info(i);break;case"WARN":console.warn(i);break;case"ERROR":case"FATAL":console.error(i);break;case"OFF":break;default:console.log(i);break}}debug(t,n){this.log("DEBUG",t,n)}info(t,n){this.log("INFO",t,n)}warn(t,n){this.log("WARN",t,n)}error(t,n){this.log("ERROR",t,n)}fatal(t,n){this.log("FATAL",t,n)}setLogLevel(t){this.config.set("logLevel",t)}getLogLevel(){return this.config.get("logLevel","INFO")}getEnabledLogLevels(){return Object.keys(Ku).filter(t=>this.shouldLog(Ku[t])&&t!=="OFF")}},Rt=CM.getInstance(),Fc={};Se(Fc,{RpcChannel:()=>aL});var{ETransactionVersion:wn}=Za,{ETransactionVersion3:jc}=Za,{EDataAvailabilityMode:nf}=um,{EDAMode:gk}=um;function gd(e){return"l1_data_gas"in e}var{ETransactionExecutionStatus:rf}=Za,{EBlockTag:fr}=Za,Vc={DEPLOY:"DEPLOY",INVOKE:"INVOKE"},bn={u8:"core::integer::u8",u16:"core::integer::u16",u32:"core::integer::u32",u64:"core::integer::u64",u96:"core::integer::u96",u128:"core::integer::u128",u256:"core::integer::u256",u512:"core::integer::u512"},OM={i8:"core::integer::i8",i16:"core::integer::i16",i32:"core::integer::i32",i64:"core::integer::i64",i128:"core::integer::i128"},Ii={ClassHash:"core::starknet::class_hash::ClassHash",ContractAddress:"core::starknet::contract_address::ContractAddress",Secp256k1Point:"core::starknet::secp256k1::Secp256k1Point",U96:"core::internal::bounded_int::BoundedInt::<0, 79228162514264337593543950335>"},BM="core::starknet::eth_address::EthAddress",$M="core::zeroable::NonZero::",DM={StarkNetDomain:[{name:"name",type:"felt"},{name:"version",type:"felt"},{name:"chainId",type:"felt"}],OutsideExecution:[{name:"caller",type:"felt"},{name:"nonce",type:"felt"},{name:"execute_after",type:"felt"},{name:"execute_before",type:"felt"},{name:"calls_len",type:"felt"},{name:"calls",type:"OutsideCall*"}],OutsideCall:[{name:"to",type:"felt"},{name:"selector",type:"felt"},{name:"calldata_len",type:"felt"},{name:"calldata",type:"felt*"}]},MM={StarknetDomain:[{name:"name",type:"shortstring"},{name:"version",type:"shortstring"},{name:"chainId",type:"shortstring"},{name:"revision",type:"shortstring"}],OutsideExecution:[{name:"Caller",type:"ContractAddress"},{name:"Nonce",type:"felt"},{name:"Execute After",type:"u128"},{name:"Execute Before",type:"u128"},{name:"Calls",type:"Call*"}],Call:[{name:"To",type:"ContractAddress"},{name:"Selector",type:"selector"},{name:"Calldata",type:"felt*"}]},jo={UNSUPPORTED:"0",V1:"1",V2:"2"},LM={};Se(LM,{parse:()=>ho,parseAlwaysAsBig:()=>PM,stringify:()=>Cn});var UM=e=>{if(!eh(e))return parseFloat(e);const t=parseInt(e,10);return Number.isSafeInteger(t)?t:BigInt(e)},ho=e=>GT(String(e),void 0,UM),PM=e=>GT(String(e),void 0,UO),Cn=(e,t,n,r)=>ZT(e,t,n,r),FS=class{nodeUrl;headers;interval;requestId=0;pendingRequests={};batchPromises={};delayTimer;delayPromise;delayPromiseResolve;baseFetch;rpcMethods;constructor(e){this.nodeUrl=e.nodeUrl,this.headers=e.headers,this.interval=e.interval,this.baseFetch=e.baseFetch,this.rpcMethods=e.rpcMethods}async wait(){return(!this.delayPromise||!this.delayPromiseResolve)&&(this.delayPromise=new Promise(e=>{this.delayPromiseResolve=e})),this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=void 0),this.delayTimer=setTimeout(()=>{this.delayPromiseResolve&&(this.delayPromiseResolve(),this.delayPromise=void 0,this.delayPromiseResolve=void 0)},this.interval),this.delayPromise}addPendingRequest(e,t,n){const r={id:n??`batched_${this.requestId+=1}`,jsonrpc:"2.0",method:e.description||String(e),params:t??void 0};return this.pendingRequests[r.id]=r,r.id}async sendBatch(e){return(await this.baseFetch(this.nodeUrl,{method:"POST",body:Cn(e),headers:this.headers})).json()}async fetch(e,t,n){const r=this.addPendingRequest(e,t,n);await this.wait();const s=this.pendingRequests;if(this.pendingRequests={},!this.batchPromises[r]){const a=this.sendBatch(Object.values(s));Object.keys(s).forEach(c=>{this.batchPromises[c]=a})}const i=await this.batchPromises[r];delete this.batchPromises[r];const o=i.find(a=>a.id===r);if(!o)throw new Error(`Couldn't find the result for the request. Method: ${String(e)}`);return o}};function I(e,t){if(!e)throw new Error(t||"Assertion failure")}var jS={};Se(jS,{addPercent:()=>vn,assertInRange:()=>qS,bigNumberishArrayToDecimalStringArray:()=>HS,bigNumberishArrayToHexadecimalStringArray:()=>Ea,cleanHex:()=>p_,getDecimalString:()=>qM,getHexString:()=>WS,getHexStringArray:()=>Km,getNext:()=>ke,hexToBytes:()=>mh,hexToDecimalString:()=>zS,isBigNumberish:()=>Ji,isHex:()=>Yt,isHexString:()=>jM,isStringWholeNumber:()=>po,stringToSha256ToArrayBuff4:()=>HM,toBigInt:()=>Pt,toCairoBool:()=>KS,toHex:()=>M,toHex64:()=>zM,toHexString:()=>VS,toStorageKey:()=>Wm,tryToBigInt:()=>VM});var Ct=e=>typeof e>"u"||e===void 0;function $e(e){return typeof e=="number"}function Cl(e){return typeof e=="boolean"}function dn(e){return typeof e=="bigint"}function de(e){return typeof e=="string"}function _d(e){return typeof Buffer<"u"&&e instanceof Buffer}function xe(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function FM(e){return Number.isInteger(e)}function Yt(e){return/^0[xX][0-9a-fA-F]*$/.test(e)}var jM=Yt;function Pt(e){return BigInt(e)}function VM(e){return e?BigInt(e):void 0}function M(e){return Y(Pt(e).toString(16))}var VS=M;function Wm(e){return Y(Pt(e).toString(16).padStart(64,"0"))}function zM(e){const t=Y(Pt(e).toString(16).padStart(64,"0"));if(t.length!==66)throw TypeError("number is too big for hex 0x(64) representation");return t}function zS(e){return BigInt(Y(e)).toString(10)}function p_(e){return e.toLowerCase().replace(/^(0x)0+/,"$1")}function qS(e,t,n,r=""){const s=r===""?"invalid length":`invalid ${r} length`,i=BigInt(e),o=BigInt(t),a=BigInt(n);I(i>=o&&i<=a,`Message not signable, ${s}.`)}function HS(e){return e.map(t=>Pt(t).toString(10))}function Ea(e){return e.map(t=>M(t))}function po(e){return/^\d+$/.test(e)}function qM(e){if(Yt(e))return zS(e);if(po(e))return e;throw new Error(`${e} needs to be a hex-string or whole-number-string`)}function WS(e){if(Yt(e))return e;if(po(e))return VS(e);throw new Error(`${e} needs to be a hex-string or whole-number-string`)}function Km(e){return e.map(WS)}function KS(e){return(+e).toString()}function mh(e){if(!Yt(e))throw new Error(`${e} needs to be a hex-string`);let t=an(e);return t.length%2!==0&&(t=`0${t}`),Vs(t)}function vn(e,t){const n=BigInt(e);return n+n*BigInt(t)/100n}function HM(e){const n=(r=>Number(r&RS))(BigInt(Y(fo(nu(e)))));return mh(M(n))}function Ji(e){return $e(e)||dn(e)||de(e)&&(Yt(e)||po(e))}function ke(e){const t=e.next();if(t.done)throw new Error("Unexpected end of response");return t.value}var WM={};Se(WM,{getL1MessageHash:()=>ZS,getL2MessageHash:()=>GS,getSelector:()=>ou,getSelectorFromName:()=>We,keccakBn:()=>YS,solidityUint256PackedKeccak256:()=>au,starknetKeccak:()=>Ym});function YS(e){const t=an(M(BigInt(e))),n=t.length%2===0?t:`0${t}`;return Y(zs(mh(Y(n))).toString(16))}function KM(e){return Y(zs(Zi(e)).toString(16))}function Ym(e){return BigInt(KM(e))&xS}function We(e){return M(Ym(e))}function ou(e){return $e(e)||dn(e)?M(e):Yt(e)?e:po(e)?M(e):We(e)}function au(e){const t=Y(e.reduce((n,r)=>n+an(M(r)).padStart(64,"0"),""));return Y(fs(iv(mh(t))))}function GS(e,t,n,r,s){return au([e,t,s,n,r.length,...r])}function ZS(e,t,n){return au([e,t,n.length,...n])}var Us={};Se(Us,{decodeShortString:()=>Ta,encodeShortString:()=>ht,isASCII:()=>Gm,isDecimalString:()=>Zm,isLongText:()=>Jm,isShortString:()=>cu,isShortText:()=>YM,isText:()=>jt,splitLongString:()=>Xm});function Gm(e){return/^[\x00-\x7F]*$/.test(e)}function cu(e){return e.length<=Hm}function Zm(e){return/^[0-9]*$/i.test(e)}function jt(e){return de(e)&&!Yt(e)&&!po(e)}var YM=e=>jt(e)&&cu(e),Jm=e=>jt(e)&&!cu(e);function Xm(e){const t=RegExp(`[^]{1,${Hm}}`,"g");return e.match(t)||[]}function ht(e){if(!Gm(e))throw new Error(`${e} is not an ASCII string`);if(!cu(e))throw new Error(`${e} is too long`);return Y(e.replace(/./g,t=>t.charCodeAt(0).toString(16)))}function Ta(e){if(!Gm(e))throw new Error(`${e} is not an ASCII string`);if(Yt(e))return an(e).replace(/.{2}/g,t=>String.fromCharCode(parseInt(t,16)));if(Zm(e))return Ta("0X".concat(BigInt(e).toString(16)));throw new Error(`${e} is not Hex or decimal`)}var GM={};Se(GM,{byteArrayFromString:()=>Qm,stringFromByteArray:()=>ZM});function ZM(e){const t=BigInt(e.pending_word)===0n?"":Ta(M(e.pending_word));return e.data.reduce((n,r)=>{const s=BigInt(r)===0n?"":Ta(M(r));return n+s},"")+t}function Qm(e){const t=Xm(e),n=t[t.length-1],r=t.map(ht),[s,i]=n===void 0||n.length===31?["0x00",0]:[r.pop(),n.length];return{data:r.length===0?[]:r,pending_word:s,pending_word_len:i}}var JM={};Se(JM,{felt:()=>xt,getAbiContractVersion:()=>nb,getArrayType:()=>jr,isCairo1Abi:()=>tb,isCairo1Type:()=>qs,isLen:()=>Xi,isTypeArray:()=>hs,isTypeBool:()=>kh,isTypeContractAddress:()=>l4,isTypeEnum:()=>go,isTypeEthAddress:()=>_o,isTypeFelt:()=>va,isTypeInt:()=>a4,isTypeLiteral:()=>eb,isTypeNamedTuple:()=>JS,isTypeNonZero:()=>yo,isTypeOption:()=>bh,isTypeResult:()=>wh,isTypeSecp256k1Point:()=>Eh,isTypeStruct:()=>lu,isTypeTuple:()=>Gs,isTypeU96:()=>XS,isTypeUint:()=>Ol,isTypeUint256:()=>c4,tuple:()=>Sa,uint256:()=>g_,uint512:()=>u4});function gn(e){return Object.defineProperty(e,"__compiled__",{enumerable:!1,writable:!1,value:!0}),e}function Ni(e){if(dn(e)||Number.isInteger(e))return e.toString();if(de(e)){if(Yt(e))return BigInt(e).toString();if(jt(e)){if(!cu(e))throw new Error(`${e} is a long string > 31 chars. Please split it into an array of short strings.`);return BigInt(ht(e)).toString()}if(po(e))return e}if(Cl(e))return`${+e}`;throw new Error(`${e} can't be computed by felt()`)}var Is=class ti{data;static abiSelector="core::felt252";constructor(t){ti.validate(t),this.data=ti.__processData(t)}static __processData(t){if(de(t))return yh(t);if(dn(t))return gt(t);if(Number.isInteger(t))return gt(BigInt(t));if(Cl(t))return gt(BigInt(t?1:0));throw new Error(`${t} can't be computed by felt()`)}toBigInt(){return xl(this.data)}decodeUtf8(){return new TextDecoder().decode(this.data)}toHexString(){return Y(this.toBigInt().toString(16))}toApiRequest(){return gn([this.toHexString()])}static validate(t){I(t!==null,"null value is not allowed for felt252"),I(t!==void 0,"undefined value is not allowed for felt252"),I(de(t)||$e(t)||dn(t)||Cl(t),`Unsupported data type '${typeof t}' for felt252. Expected string, number, bigint, or boolean`);const n=ti.__processData(t),r=xl(n);I(r>=0n&&r<rt,`Value ${n} is out of felt252 range [0, ${rt})`)}static is(t){try{return ti.validate(t),!0}catch{return!1}}static isAbiType(t){return t===ti.abiSelector}static factoryFromApiResponse(t){return new ti(ke(t))}},zc=(1n<<128n)-1n,XM=(1n<<256n)-1n,QM=0n,e4=340282366920938463463374607431768211455n,t4=340282366920938463463374607431768211455n,n4=0n,r4=0n,Ot=class ni{low;high;static abiSelector="core::integer::u256";constructor(...t){if(xe(t[0])&&t.length===1&&"low"in t[0]&&"high"in t[0]){const n=ni.validateProps(t[0].low,t[0].high);this.low=n.low,this.high=n.high}else if(t.length===1){const n=ni.validate(t[0]);this.low=n&zc,this.high=n>>128n}else if(t.length===2){const n=ni.validateProps(t[0],t[1]);this.low=n.low,this.high=n.high}else throw Error("Incorrect constructor parameters")}static validate(t){I(t!==null,"null value is not allowed for u256"),I(t!==void 0,"undefined value is not allowed for u256"),I(Ji(t)||xe(t),`Unsupported data type '${typeof t}' for u256. Expected string, number, bigint, or Uint256 object`);const n=BigInt(t);return I(n>=QM,"bigNumberish is smaller than UINT_256_MIN"),I(n<=XM,"bigNumberish is bigger than UINT_256_MAX"),n}static validateProps(t,n){const r=BigInt(t),s=BigInt(n);return I(r>=n4&&r<=e4,"low is out of range UINT_256_LOW_MIN - UINT_256_LOW_MAX"),I(s>=r4&&s<=t4,"high is out of range UINT_256_HIGH_MIN - UINT_256_HIGH_MAX"),{low:r,high:s}}static is(t){try{ni.validate(t)}catch{return!1}return!0}static isAbiType(t){return t===ni.abiSelector}static factoryFromApiResponse(t){const n=ke(t),r=ke(t);return new ni(n,r)}toBigInt(){return(this.high<<128n)+this.low}toUint256HexString(){return{low:Y(this.low.toString(16)),high:Y(this.high.toString(16))}}toUint256DecimalString(){return{low:this.low.toString(10),high:this.high.toString(10)}}toApiRequest(){return[Ni(this.low),Ni(this.high)]}},s4=(1n<<512n)-1n,i4=0n,o4=0n,Nn=class ri{limb0;limb1;limb2;limb3;static abiSelector="core::integer::u512";constructor(...t){if(xe(t[0])&&t.length===1&&"limb0"in t[0]&&"limb1"in t[0]&&"limb2"in t[0]&&"limb3"in t[0]){const n=ri.validateProps(t[0].limb0,t[0].limb1,t[0].limb2,t[0].limb3);this.limb0=n.limb0,this.limb1=n.limb1,this.limb2=n.limb2,this.limb3=n.limb3}else if(t.length===1){const n=ri.validate(t[0]);this.limb0=n&zc,this.limb1=(n&zc<<128n)>>128n,this.limb2=(n&zc<<256n)>>256n,this.limb3=n>>384n}else if(t.length===4){const n=ri.validateProps(t[0],t[1],t[2],t[3]);this.limb0=n.limb0,this.limb1=n.limb1,this.limb2=n.limb2,this.limb3=n.limb3}else throw Error("Incorrect Uint512 constructor parameters")}static validate(t){I(t!==null,"null value is not allowed for u512"),I(t!==void 0,"undefined value is not allowed for u512"),I(Ji(t)||xe(t),`Unsupported data type '${typeof t}' for u512. Expected string, number, bigint, or Uint512 object`);const n=BigInt(t);return I(n>=i4,"bigNumberish is smaller than UINT_512_MIN."),I(n<=s4,"bigNumberish is bigger than UINT_512_MAX."),n}static validateProps(t,n,r,s){const i=BigInt(t),o=BigInt(n),a=BigInt(r),c=BigInt(s);return[i,o,a,c].forEach((l,u)=>{I(l>=o4&&l<=zc,`limb${u} is not in the range of a u128 number`)}),{limb0:i,limb1:o,limb2:a,limb3:c}}static is(t){try{ri.validate(t)}catch{return!1}return!0}static isAbiType(t){return t===ri.abiSelector}static factoryFromApiResponse(t){const n=ke(t),r=ke(t),s=ke(t),i=ke(t);return new ri(n,r,s,i)}toBigInt(){return(this.limb3<<384n)+(this.limb2<<256n)+(this.limb1<<128n)+this.limb0}toUint512HexString(){return{limb0:Y(this.limb0.toString(16)),limb1:Y(this.limb1.toString(16)),limb2:Y(this.limb2.toString(16)),limb3:Y(this.limb3.toString(16))}}toUint512DecimalString(){return{limb0:this.limb0.toString(10),limb1:this.limb1.toString(10),limb2:this.limb2.toString(10),limb3:this.limb3.toString(10)}}toApiRequest(){return[Ni(this.limb0),Ni(this.limb1),Ni(this.limb2),Ni(this.limb3)]}},Xi=e=>/_len$/.test(e),va=e=>e==="felt"||e==="core::felt252",hs=e=>/\*/.test(e)||e.startsWith("core::array::Array::")||e.startsWith("core::array::Span::"),Gs=e=>/^\(.*\)$/i.test(e),JS=e=>/\(.*\)/i.test(e)&&e.includes(":"),lu=(e,t)=>e in t,go=(e,t)=>e in t,bh=e=>e.startsWith("core::option::Option::"),wh=e=>e.startsWith("core::result::Result::"),Ol=e=>Object.values(bn).includes(e),a4=e=>Object.values(OM).includes(e),c4=e=>Ot.isAbiType(e),eb=e=>Object.values(Ii).includes(e),kh=e=>e==="core::bool",l4=e=>e===Ii.ContractAddress,_o=e=>e===BM,XS=e=>e==="core::internal::bounded_int::BoundedInt::<0, 79228162514264337593543950335>",Eh=e=>e===Ii.Secp256k1Point,qs=e=>e.includes("::"),jr=e=>qs(e)?e.substring(e.indexOf("<")+1,e.lastIndexOf(">")):e.replace("*","");function tb(e){const{cairo:t}=nb(e);if(t===void 0)throw Error("Unable to determine Cairo version");return t==="1"}function yo(e){return e.startsWith($M)}function nb(e){if(e.find(r=>r.type==="interface"))return{cairo:"1",compiler:"2"};const t=e.find(r=>(r.type==="function"||r.type==="constructor")&&(r.inputs.length||r.outputs.length));if(!t)return{cairo:void 0,compiler:void 0};const n=t.inputs.length?t.inputs:t.outputs;return qs(n[0].type)?{cairo:"1",compiler:"1"}:{cairo:"0",compiler:"0"}}var g_=e=>new Ot(e).toUint256DecimalString(),u4=e=>new Nn(e).toUint512DecimalString(),Sa=(...e)=>({...e});function xt(e){return Ni(e)}var nc=class{variant;constructor(e){const t=Object.values(e);if(t.length===0)throw new Error("This Enum must have at least 1 variant");if(t.filter(r=>!Ct(r)).length!==1)throw new Error("This Enum must have exactly one active variant");this.variant=e}unwrap(){return Object.values(this.variant).find(t=>!Ct(t))}activeVariant(){const t=Object.entries(this.variant).find(n=>!Ct(n[1]));return Ct(t)?"":t[0]}},xn={Some:0,None:1},Bl=class{Some;None;constructor(e,t){if(!(e in Object.values(xn)))throw new Error("Wrong variant! It should be CairoOptionVariant.Some or .None.");if(e===xn.Some){if(Ct(t))throw new Error('The creation of a Cairo Option with "Some" variant needs a content as input.');this.Some=t,this.None=void 0}else this.Some=void 0,this.None=!0}unwrap(){return this.None?void 0:this.Some}isSome(){return!Ct(this.Some)}isNone(){return this.None===!0}},Sn={Ok:0,Err:1},__=class{Ok;Err;constructor(e,t){if(!(e in Object.values(Sn)))throw new Error("Wrong variant! It should be CairoResultVariant.Ok or .Err.");e===Sn.Ok?(this.Ok=t,this.Err=void 0):(this.Ok=void 0,this.Err=t)}unwrap(){if(!Ct(this.Ok))return this.Ok;if(!Ct(this.Err))return this.Err;throw new Error("Both Result.Ok and .Err are undefined. Not authorized.")}isOk(){return!Ct(this.Ok)}isErr(){return!Ct(this.Err)}},Hp={isBN:(e,t,n)=>{if(!dn(e[n]))throw new Error(`Data and formatter mismatch on ${n}:${t[n]}, expected response data ${n}:${e[n]} to be BN instead it is ${typeof e[n]}`)},unknown:(e,t,n)=>{throw new Error(`Unhandled formatter type on ${n}:${t[n]} for data ${n}:${e[n]}`)}};function yd(e,t,n){return Object.entries(e).reduce((r,[s,i])=>{const o=n??t[s];if(!(s in t)&&!n)return r[s]=i,r;if(o==="string"){if(Array.isArray(e[s])){const a=yd(e[s],e[s].map(c=>o));return r[s]=Object.values(a).join(""),r}return Hp.isBN(e,t,s),r[s]=Ta(i),r}if(o==="number")return Hp.isBN(e,t,s),r[s]=Number(i),r;if(typeof o=="function")return r[s]=o(i),r;if(Array.isArray(o)){const a=yd(e[s],o,o[0]);return r[s]=Object.values(a),r}return xe(o)?(r[s]=yd(e[s],o),r):(Hp.unknown(e,t,s),r)},{})}var cr=class si{static MAX_BYTE_SIZE=31;data;static abiSelector="core::bytes_31::bytes31";constructor(t){si.validate(t),this.data=si.__processData(t)}static __processData(t){if(de(t))return yh(t);if(_d(t))return new Uint8Array(t);if(t instanceof Uint8Array)return new Uint8Array(t);throw new Error("Invalid input type for CairoBytes31. Expected string, Buffer, or Uint8Array")}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return xl(this.data)}decodeUtf8(){return new TextDecoder().decode(this.data)}toHexString(){const t=this.data.length===0?"0":fo(this.data);return Y(t)}static validate(t){const n=si.__processData(t).length;I(n<=this.MAX_BYTE_SIZE,`Data is too long: ${n} bytes (max ${this.MAX_BYTE_SIZE} bytes)`)}static is(t){try{return si.validate(t),!0}catch{return!1}}static isAbiType(t){return t===si.abiSelector}static factoryFromApiResponse(t){return new si(ke(t))}},d4={FAILED_TO_RECEIVE_TXN:1,NO_TRACE_AVAILABLE:10,CONTRACT_NOT_FOUND:20,ENTRYPOINT_NOT_FOUND:21,BLOCK_NOT_FOUND:24,INVALID_TXN_INDEX:27,CLASS_HASH_NOT_FOUND:28,TXN_HASH_NOT_FOUND:29,PAGE_SIZE_TOO_BIG:31,NO_BLOCKS:32,INVALID_CONTINUATION_TOKEN:33,TOO_MANY_KEYS_IN_FILTER:34,CONTRACT_ERROR:40,TRANSACTION_EXECUTION_ERROR:41,STORAGE_PROOF_NOT_SUPPORTED:42,CLASS_ALREADY_DECLARED:51,INVALID_TRANSACTION_NONCE:52,INSUFFICIENT_RESOURCES_FOR_VALIDATE:53,INSUFFICIENT_ACCOUNT_BALANCE:54,VALIDATION_FAILURE:55,COMPILATION_FAILED:56,CONTRACT_CLASS_SIZE_IS_TOO_LARGE:57,NON_ACCOUNT:58,DUPLICATE_TX:59,COMPILED_CLASS_HASH_MISMATCH:60,UNSUPPORTED_TX_VERSION:61,UNSUPPORTED_CONTRACT_CLASS_VERSION:62,UNEXPECTED_ERROR:63,INVALID_SUBSCRIPTION_ID:66,TOO_MANY_ADDRESSES_IN_FILTER:67,TOO_MANY_BLOCKS_BACK:68,COMPILATION_ERROR:100,INVALID_ADDRESS:150,TOKEN_NOT_SUPPORTED:151,INVALID_SIGNATURE:153,MAX_AMOUNT_TOO_LOW:154,CLASS_HASH_NOT_SUPPORTED:155,PAYMASTER_TRANSACTION_EXECUTION_ERROR:156,INVALID_TIME_BOUNDS:157,INVALID_DEPLOYMENT_DATA:158,INVALID_CLASS_HASH:159,INVALID_ID:160,UNKNOWN_ERROR:163},f4=d4;function h4(e,t=e.constructor){const{captureStackTrace:n}=Error;n&&n(e,t)}function p4(e,t){const{setPrototypeOf:n}=Object;n?n(e,t):e.__proto__=t}var g4=class extends Error{name;constructor(e){super(e),Object.defineProperty(this,"name",{value:new.target.name,enumerable:!1,configurable:!0}),p4(this,new.target.prototype),h4(this)}},Bt=class extends g4{},$l=class extends Bt{constructor(t,n,r){super(`RPC: ${n} with params ${Cn(r,null,2)}

      ${t.code}: ${t.message}: ${Cn(t.data)}`),this.baseError=t,this.request={method:n,params:r}}request;get code(){return this.baseError.code}isType(t){return f4[t]===this.code}},_4=Gn.get("buffer")||typeof Buffer<"u"&&Buffer||typeof globalThis<"u"&&globalThis.Buffer||typeof window<"u"&&window.Buffer||typeof global<"u"&&global.Buffer||class{constructor(){throw new Bt(`Buffer not detected, use 'config.set("buffer", YourBufferPolyfill)' or polyfill or Node.js environment for Buffer support`)}static from(e){throw new Bt(`Buffer not detected, use 'config.set("buffer", YourBufferPolyfill)' or polyfill or Node.js environment for Buffer support`)}static isBuffer(e){const t=Gn.get("buffer")||typeof Buffer<"u"&&Buffer;return t&&t.isBuffer&&t.isBuffer(e)}},Yu=class ii{data;static abiSelector="core::u32::u32";constructor(t){ii.validate(t),this.data=ii.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data))}toHexString(){return Y(this.toBigInt().toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=ii.__processData(t);I(n>=0n&&n<=2n**32n-1n,"Value is out of u32 range [0, 2^32)")}static is(t){try{return ii.validate(t),!0}catch{return!1}}static isAbiType(t){return t===ii.abiSelector}static factoryFromApiResponse(t){return new ii(ke(t))}},os=class Mo{data=[];pending_word;pending_word_len;static abiSelector="core::byte_array::ByteArray";constructor(...t){if(t.length===3){const[o,a,c]=t;I(Array.isArray(o)&&a instanceof Is&&c instanceof Yu,"Invalid constructor parameters. Expected (CairoBytes31[], CairoFelt252, CairoUint32)"),this.data=o,this.pending_word=a,this.pending_word_len=c;return}const n=t[0];Mo.validate(n);const{data:r,pending_word:s,pending_word_len:i}=Mo.__processData(n);this.data=r,this.pending_word=s,this.pending_word_len=i}static __processData(t){let n;if(t instanceof Uint8Array)n=t;else if(_d(t))n=new Uint8Array(t);else if(de(t))n=yh(t);else if(dn(t))n=gt(t);else if(FM(t))n=gt(BigInt(t));else throw new Error("Invalid input type. Expected Uint8Array, Buffer, string, number, or bigint");const r=cr.MAX_BYTE_SIZE,s=Math.floor(n.length/r),i=n.length%r,o=[];let a,c;for(let l=0;l<s;l+=1){const u=l*r,d=u+r,f=n.slice(u,d);o.push(new cr(f))}if(i>0){const l=n.slice(s*r);let u="0x";for(let d=0;d<l.length;d+=1)u+=l[d].toString(16).padStart(2,"0");a=new Is(u),c=new Yu(i)}else a=new Is(0),c=new Yu(0);return{data:o,pending_word:a,pending_word_len:c}}toApiRequest(){return this.assertInitialized(),gn([Y(this.data.length.toString(16)),...this.data.flatMap(t=>t.toApiRequest()),...this.pending_word.toApiRequest(),...this.pending_word_len.toApiRequest()])}decodeUtf8(){const t=this.reconstructBytes();return new TextDecoder().decode(t)}toBigInt(){const t=this.reconstructBytes();if(t.length===0)return 0n;let n=0n;return t.forEach(r=>{n=n*256n+BigInt(r)}),n}toHexString(){const t=this.reconstructBytes(),n=t.length===0?"0":fo(t);return Y(n)}toBuffer(){this.assertInitialized();const t=this.reconstructBytes();return _4.from(t)}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!Array.isArray(t)||t instanceof Uint8Array,"Invalid input: arrays are not supported, use Uint8Array"),I(typeof t!="object"||_d(t)||t instanceof Uint8Array,"Invalid input for CairoByteArray: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input for CairoByteArray: decimal numbers are not supported, only integers"),I(!$e(t)||t>=0,"Invalid input for CairoByteArray: negative numbers are not supported"),I(!dn(t)||t>=0n,"Invalid input for CairoByteArray: negative bigints are not supported"),I(t instanceof Uint8Array||_d(t)||de(t)||$e(t)||dn(t),"Invalid input type. Expected Uint8Array, Buffer, string, number, or bigint")}static is(t){try{return Mo.validate(t),!0}catch{return!1}}static isAbiType(t){return t===Mo.abiSelector}assertInitialized(){I(this.data&&this.pending_word!==void 0&&this.pending_word_len!==void 0,"CairoByteArray is not properly initialized")}reconstructBytes(){this.assertInitialized();const t=this.data.flatMap(r=>r.data),n=Number(this.pending_word_len.toBigInt());if(n){const r=new Uint8Array(n),s=n-this.pending_word.data.length;r.set(this.pending_word.data,s),t.push(r)}return IS(t)}static factoryFromApiResponse(t){const n=Array.from({length:Number(ke(t))},()=>cr.factoryFromApiResponse(t)),r=Is.factoryFromApiResponse(t),s=Yu.factoryFromApiResponse(t);return new Mo(n,r,s)}},sf=class oi{data;static abiSelector="core::integer::u8";constructor(t){oi.validate(t),this.data=oi.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data))}toHexString(){return Y(this.toBigInt().toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=oi.__processData(t);I(n>=Rc.min&&n<=Rc.max,`Value is out of u8 range [${Rc.min}, ${Rc.max}]`)}static is(t){try{return oi.validate(t),!0}catch{return!1}}static isAbiType(t){return t===oi.abiSelector}static factoryFromApiResponse(t){return new oi(ke(t))}},of=class ai{data;static abiSelector="core::integer::u16";constructor(t){ai.validate(t),this.data=ai.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data))}toHexString(){return Y(this.toBigInt().toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=ai.__processData(t);I(n>=Cc.min&&n<=Cc.max,`Value is out of u16 range [${Cc.min}, ${Cc.max}]`)}static is(t){try{return ai.validate(t),!0}catch{return!1}}static isAbiType(t){return t===ai.abiSelector}static factoryFromApiResponse(t){return new ai(ke(t))}},af=class ci{data;static abiSelector="core::integer::u64";constructor(t){ci.validate(t),this.data=ci.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data))}toHexString(){return Y(this.toBigInt().toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=ci.__processData(t);I(n>=Oc.min&&n<=Oc.max,`Value is out of u64 range [${Oc.min}, ${Oc.max}]`)}static is(t){try{return ci.validate(t),!0}catch{return!1}}static isAbiType(t){return t===ci.abiSelector}static factoryFromApiResponse(t){return new ci(ke(t))}},cf=class li{data;static abiSelector="core::integer::u96";constructor(t){li.validate(t),this.data=li.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data))}toHexString(){return Y(this.toBigInt().toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=li.__processData(t);I(n>=Bc.min&&n<=Bc.max,`Value is out of u96 range [${Bc.min}, ${Bc.max}]`)}static is(t){try{return li.validate(t),!0}catch{return!1}}static isAbiType(t){return t===li.abiSelector}static factoryFromApiResponse(t){return new li(ke(t))}},lf=class ui{data;static abiSelector="core::integer::u128";constructor(t){ui.validate(t),this.data=ui.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data))}toHexString(){return Y(this.toBigInt().toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=ui.__processData(t);I(n>=Po.min&&n<=Po.max,`Value is out of u128 range [${Po.min}, ${Po.max}]`)}static is(t){try{return ui.validate(t),!0}catch{return!1}}static isAbiType(t){return t===ui.abiSelector}static factoryFromApiResponse(t){return new ui(ke(t))}},Di=class di{data;static abiSelector="core::integer::i8";constructor(t){di.validate(t),this.data=di.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data>=0n?this.data:256n+this.data))}toHexString(){const t=this.toBigInt();if(t<0n){const n=rt+t;return Y(n.toString(16))}return Y(t.toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=di.__processData(t);I(n>=$c.min&&n<=$c.max,`Value is out of i8 range [${$c.min}, ${$c.max}]`)}static is(t){try{return di.validate(t),!0}catch{return!1}}static isAbiType(t){return t===di.abiSelector}static factoryFromApiResponse(t){const n=ke(t),r=BigInt(n),s=r>rt/2n?r-rt:r;return new di(s)}},Mi=class fi{data;static abiSelector="core::integer::i16";constructor(t){fi.validate(t),this.data=fi.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data>=0n?this.data:65536n+this.data))}toHexString(){const t=this.toBigInt();if(t<0n){const n=rt+t;return Y(n.toString(16))}return Y(t.toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=fi.__processData(t);I(n>=Dc.min&&n<=Dc.max,`Value is out of i16 range [${Dc.min}, ${Dc.max}]`)}static is(t){try{return fi.validate(t),!0}catch{return!1}}static isAbiType(t){return t===fi.abiSelector}static factoryFromApiResponse(t){const n=ke(t),r=BigInt(n),s=r>rt/2n?r-rt:r;return new fi(s)}},Li=class hi{data;static abiSelector="core::integer::i32";constructor(t){hi.validate(t),this.data=hi.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data>=0n?this.data:4294967296n+this.data))}toHexString(){const t=this.toBigInt();if(t<0n){const n=rt+t;return Y(n.toString(16))}return Y(t.toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=hi.__processData(t);I(n>=Mc.min&&n<=Mc.max,`Value is out of i32 range [${Mc.min}, ${Mc.max}]`)}static is(t){try{return hi.validate(t),!0}catch{return!1}}static isAbiType(t){return t===hi.abiSelector}static factoryFromApiResponse(t){const n=ke(t),r=BigInt(n),s=r>rt/2n?r-rt:r;return new hi(s)}},Ui=class pi{data;static abiSelector="core::integer::i64";constructor(t){pi.validate(t),this.data=pi.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data>=0n?this.data:2n**64n+this.data))}toHexString(){const t=this.toBigInt();if(t<0n){const n=rt+t;return Y(n.toString(16))}return Y(t.toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=pi.__processData(t);I(n>=Lc.min&&n<=Lc.max,`Value is out of i64 range [${Lc.min}, ${Lc.max}]`)}static is(t){try{return pi.validate(t),!0}catch{return!1}}static isAbiType(t){return t===pi.abiSelector}static factoryFromApiResponse(t){const n=ke(t),r=BigInt(n),s=r>rt/2n?r-rt:r;return new pi(s)}},Pi=class gi{data;static abiSelector="core::integer::i128";constructor(t){gi.validate(t),this.data=gi.__processData(t)}static __processData(t){return de(t)&&jt(t)?Jn(t):BigInt(t)}toApiRequest(){return gn([this.toHexString()])}toBigInt(){return this.data}decodeUtf8(){return new TextDecoder().decode(gt(this.data>=0n?this.data:2n**128n+this.data))}toHexString(){const t=this.toBigInt();if(t<0n){const n=rt+t;return Y(n.toString(16))}return Y(t.toString(16))}static validate(t){I(t!=null,"Invalid input: null or undefined"),I(!xe(t)&&!Array.isArray(t),"Invalid input: objects are not supported"),I(!$e(t)||Number.isInteger(t),"Invalid input: decimal numbers are not supported, only integers");const n=gi.__processData(t);I(n>=Fo.min&&n<=Fo.max,`Value is out of i128 range [${Fo.min}, ${Fo.max}]`)}static is(t){try{return gi.validate(t),!0}catch{return!1}}static isAbiType(t){return t===gi.abiSelector}static factoryFromApiResponse(t){const n=ke(t),r=BigInt(n),s=r>rt/2n?r-rt:r;return new gi(s)}},QS={request:{[cr.abiSelector]:e=>new cr(e).toApiRequest(),[os.abiSelector]:e=>new os(e).toApiRequest(),[Is.abiSelector]:e=>xt(e),[Ot.abiSelector]:e=>new Ot(e).toApiRequest(),[Nn.abiSelector]:e=>new Nn(e).toApiRequest(),[sf.abiSelector]:e=>xt(e),[of.abiSelector]:e=>xt(e),[af.abiSelector]:e=>xt(e),[cf.abiSelector]:e=>xt(e),[lf.abiSelector]:e=>xt(e),[Di.abiSelector]:e=>new Di(e).toApiRequest(),[Mi.abiSelector]:e=>new Mi(e).toApiRequest(),[Li.abiSelector]:e=>new Li(e).toApiRequest(),[Ui.abiSelector]:e=>new Ui(e).toApiRequest(),[Pi.abiSelector]:e=>new Pi(e).toApiRequest()},response:{[cr.abiSelector]:e=>cr.factoryFromApiResponse(e).decodeUtf8(),[os.abiSelector]:e=>os.factoryFromApiResponse(e).decodeUtf8(),[Is.abiSelector]:e=>BigInt(ke(e)),[Ot.abiSelector]:e=>Ot.factoryFromApiResponse(e).toBigInt(),[Nn.abiSelector]:e=>Nn.factoryFromApiResponse(e).toBigInt(),[sf.abiSelector]:e=>BigInt(ke(e)),[of.abiSelector]:e=>BigInt(ke(e)),[af.abiSelector]:e=>BigInt(ke(e)),[cf.abiSelector]:e=>BigInt(ke(e)),[lf.abiSelector]:e=>BigInt(ke(e)),[Di.abiSelector]:e=>BigInt(ke(e)),[Mi.abiSelector]:e=>BigInt(ke(e)),[Li.abiSelector]:e=>BigInt(ke(e)),[Ui.abiSelector]:e=>BigInt(ke(e)),[Pi.abiSelector]:e=>BigInt(ke(e))}},y4=class{abi;parsingStrategy;constructor(e,t){this.abi=e,this.parsingStrategy=t||QS}getRequestParser(e){if(this.parsingStrategy.request[e])return this.parsingStrategy.request[e];throw new Error(`Parser for ${e} not found`)}getResponseParser(e){if(this.parsingStrategy.response[e])return this.parsingStrategy.response[e];throw new Error(`Parser for ${e} not found`)}methodInputsLength(e){return e.inputs.reduce((t,n)=>Xi(n.name)?t:t+1,0)}getMethod(e){return this.abi.find(t=>t.name===e)}getLegacyFormat(){return this.abi}},m4=class{abi;parsingStrategy;constructor(e,t){this.abi=e,this.parsingStrategy=t||QS}getRequestParser(e){if(this.parsingStrategy.request[e])return this.parsingStrategy.request[e];throw new Error(`Parser for ${e} not found`)}getResponseParser(e){if(this.parsingStrategy.response[e])return this.parsingStrategy.response[e];throw new Error(`Parser for ${e} not found`)}methodInputsLength(e){return e.inputs.length}getMethod(e){return this.abi.find(n=>n.type==="interface")?.items?.find(n=>n.name===e)}getLegacyFormat(){return this.abi.flatMap(e=>e.type==="interface"?e.items:e)}};function b4(e,t){const n=w4(e);if(n===0||n===1)return new y4(e,t);if(n===2)return new m4(e,t);throw Error(`Unsupported ABI version ${n}`)}function w4(e){return e.find(t=>t.type==="interface")?2:tb(e)?1:0}function _k(e,t,n){return e==="constructor"&&!n&&!t.length}function k4(e){const t=e.substring(0,e.indexOf(":")),n=e.substring(t.length+1);return{name:t,type:n}}function E4(e){if(!e.includes("("))return{subTuple:[],result:e};const t=[];let n="",r=0;for(;r<e.length;){if(e[r]==="("){let s=1;const i=r;for(r++;s;)e[r]===")"&&s--,e[r]==="("&&s++,r++;t.push(e.substring(i,r)),n+=" ",r--}else n+=e[r];r++}return{subTuple:t,result:n}}function T4(e){const t=e.replace(/\s/g,"").slice(1,-1),{subTuple:n,result:r}=E4(t);let s=r.split(",").map(i=>n.length?i.replace(" ",n.shift()):i);return JS(e)&&(s=s.reduce((i,o)=>i.concat(k4(o)),[])),s}function yk(e,t,n){for(let r=0,s=0;r<e.length;r++)if(e[r]===t)s++;else if(e[r]===n&&--s===0)return r;return Number.POSITIVE_INFINITY}function v4(e){const t=e.slice(1,-1),n=[];let r=0,s;for(;r<t.length;){switch(!0){case t[r]==="(":{s=r+yk(t.slice(r),"(",")")+1;break}case(t.startsWith("core::result::Result::<",r)||t.startsWith("core::array::Array::<",r)||t.startsWith("core::option::Option::<",r)):{s=r+yk(t.slice(r),"<",">")+1;break}default:{const i=t.indexOf(",",r);s=i!==-1?i:Number.POSITIVE_INFINITY}}n.push(t.slice(r,s)),r=s+2}return n}function rb(e){return qs(e)?v4(e):T4(e)}var qt=class _i{content;arrayType;constructor(t,n){I(_i.isTypeFixedArray(n),`The type ${n} is not a Cairo fixed array. Needs [type; length].`);try{_i.getFixedArrayType(n)}catch{throw new Error(`The type ${n} do not includes any content type. Needs [type; length].`)}let r;try{r=_i.getFixedArraySize(n)}catch{throw new Error(`The type ${n} type do not includes any length. Needs [type; length].`)}I(r===t.length,`The ABI type ${n} is expecting ${r} items. ${t.length} items provided.`),this.content=t,this.arrayType=n}static getFixedArraySize(t){const n=t.match(new RegExp("(?<=; )\\d+(?=\\])"));if(n===null)throw new Error(`ABI type ${t} do not includes a valid number after ';' character.`);return Number(n[0])}getFixedArraySize(){return _i.getFixedArraySize(this.arrayType)}static getFixedArrayType=t=>{const n=t.match(new RegExp("(?<=\\[).+(?=;)"));if(n===null)throw new Error(`ABI type ${t} do not includes a valid type of data.`);return n[0]};getFixedArrayType(){return _i.getFixedArrayType(this.arrayType)}static compile(t){return t.reduce((n,r,s)=>(n[s]=r,n),{})}compile(){return _i.compile(this.content)}static isTypeFixedArray(t){return/^\[.*;\s.*\]$/.test(t)&&new RegExp("(?<=\\[).+(?=;)").test(t)&&new RegExp("(?<=; )\\d+(?=\\])").test(t)}};function S4(e){return Error(`Your object includes the property : ${e}, containing an Uint256 object without the 'low' and 'high' keys.`)}function A4(e){return Error(`Your object includes the property : ${e}, containing an Uint512 object without the 'limb0' to 'limb3' keys.`)}function I4(e,t,n,r){const s=(d,f)=>{if(qt.isTypeFixedArray(f))return a(d,f);if(hs(f))return o(d,f);if(go(f,r)){const h=r[f];return l(d,h)}if(Gs(f))return c(d,f);if(_o(f)||yo(f)||os.isAbiType(f)||XS(f)||Eh(f))return d;if(Ot.isAbiType(f)){const h=d;if(typeof h!="object")return h;if(!("low"in h&&"high"in h))throw S4(f);return{low:h.low,high:h.high}}if(Nn.isAbiType(f)){const h=d;if(typeof h!="object")return h;if(!["limb0","limb1","limb2","limb3"].every(p=>p in h))throw A4(f);return{limb0:h.limb0,limb1:h.limb1,limb2:h.limb2,limb3:h.limb3}}if(lu(f,n)){const h=n[f].members;return i(d,h)}return d},i=(d,f)=>f.reduce((p,_)=>{const g=y=>Object.defineProperty(p,_.name,{enumerable:!0,value:y??d[_.name]});if(d[_.name]==="undefined"&&(qs(_.type)||!Xi(_.name)))throw Error(`Your object needs a property with key : ${_.name} .`);return g(s(d[_.name],_.type)),p},{});function o(d,f){const h=jr(f);return de(d)?d:d.map(p=>s(p,h))}function a(d,f){const h=qt.getFixedArrayType(f),p=qt.getFixedArraySize(f);if(Array.isArray(d)){if(p!==d.length)throw new Error(`ABI type ${f}: array provided do not includes  ${p} items. ${d.length} items provided.`);return d.map(_=>s(_,h))}if(p!==Object.keys(d).length)throw new Error(`ABI type ${f}: object provided do not includes  ${p} properties. ${Object.keys(d).length} items provided.`);return s(d,h)}function c(d,f){return rb(f).reduce((_,g,y)=>{const w=Object.keys(d),k=N=>Object.defineProperty(_,y.toString(),{enumerable:!0,value:N??d[w[y]]}),b=g?.type?g.type:g;return k(s(d[w[y]],b)),_},{})}const l=(d,f)=>{if(wh(f.name)){const g=d,y=f.name.substring(f.name.indexOf("<")+1,f.name.lastIndexOf(",")),w=f.name.substring(f.name.indexOf(",")+1,f.name.lastIndexOf(">"));return g.isOk()?new __(Sn.Ok,s(d.unwrap(),y)):new __(Sn.Err,s(d.unwrap(),w))}if(bh(f.name)){const g=d,y=f.name.substring(f.name.indexOf("<")+1,f.name.lastIndexOf(">"));return g.isSome()?new Bl(xn.Some,s(g.unwrap(),y)):new Bl(xn.None,{})}const h=d,_=Object.entries(h.variant).map(g=>{if(Ct(g[1]))return g;const y=f.type.substring(f.type.lastIndexOf("<")+1,f.type.lastIndexOf(">"));return y==="()"?g:[g[0],s(h.unwrap(),y)]});return new nc(Object.fromEntries(_))};return t.reduce((d,f)=>{const h=p=>Object.defineProperty(d,f.name,{enumerable:!0,value:p});return Xi(f.name)&&!qs(f.type)||h(s(e[f.name],f.type)),d},{})}function Zo({type:e,val:t,parser:n}){switch(!0){case Ot.isAbiType(e):return n.getRequestParser(e)(t);case Nn.isAbiType(e):return n.getRequestParser(e)(t);case sf.isAbiType(e):return n.getRequestParser(e)(t);case of.isAbiType(e):return n.getRequestParser(e)(t);case af.isAbiType(e):return n.getRequestParser(e)(t);case cf.isAbiType(e):return n.getRequestParser(e)(t);case lf.isAbiType(e):return n.getRequestParser(e)(t);case Di.isAbiType(e):return n.getRequestParser(e)(t);case Mi.isAbiType(e):return n.getRequestParser(e)(t);case Li.isAbiType(e):return n.getRequestParser(e)(t);case Ui.isAbiType(e):return n.getRequestParser(e)(t);case Pi.isAbiType(e):return n.getRequestParser(e)(t);case cr.isAbiType(e):return n.getRequestParser(e)(t);case Eh(e):{const r=an(M(t)).padStart(128,"0"),s=g_(Y(r.slice(-64))),i=g_(Y(r.slice(0,-64)));return[xt(i.low),xt(i.high),xt(s.low),xt(s.high)]}default:return n.getRequestParser(Is.abiSelector)(t)}}function N4(e,t){const n=rb(t),r=Object.values(e);if(r.length!==n.length)throw Error(`ParseTuple: provided and expected abi tuple size do not match.
      provided: ${r}
      expected: ${n}`);return n.map((s,i)=>({element:r[i],type:s.type??s}))}function jn({element:e,type:t,structs:n,enums:r,parser:s}){if(e===void 0)throw Error(`Missing parameter for type ${t}`);if(qt.isTypeFixedArray(t)){const i=qt.getFixedArrayType(t);let o=[];if(Array.isArray(e))o=new qt(e,t).content;else if(typeof e=="object")o=Object.values(e),I(o.length===qt.getFixedArraySize(t),`ABI type ${t}: object provided do not includes  ${qt.getFixedArraySize(t)} items. ${o.length} items provided.`);else throw new Error(`ABI type ${t}: not an Array representing a cairo.fixedArray() provided.`);return o.reduce((a,c)=>a.concat(jn({element:c,type:i,structs:n,enums:r,parser:s})),[])}if(Array.isArray(e)){const i=[];i.push(xt(e.length));const o=jr(t);return e.reduce((a,c)=>a.concat(jn({element:c,type:o,structs:n,enums:r,parser:s})),i)}if(Ot.isAbiType(t)||Nn.isAbiType(t))return s.getRequestParser(t)(e);if(n[t]&&n[t].members.length){if(_o(t))return Zo({type:t,val:e,parser:s});if(os.isAbiType(t))return s.getRequestParser(t)(e);const{members:i}=n[t],o=e;return i.reduce((a,c)=>a.concat(jn({element:o[c.name],type:c.type,structs:n,enums:r,parser:s})),[])}if(Gs(t))return N4(e,t).reduce((o,a)=>{const c=jn({element:a.element,type:a.type,structs:n,enums:r,parser:s});return o.concat(c)},[]);if(go(t,r)){const{variants:i}=r[t];if(bh(t)){const f=e;if(f.isSome()){const h=i.find(g=>g.name==="Some");if(Ct(h))throw Error("Error in abi : Option has no 'Some' variant.");const p=h.type;if(p==="()")return xn.Some.toString();const _=jn({element:f.unwrap(),type:p,structs:n,enums:r,parser:s});return Array.isArray(_)?[xn.Some.toString(),..._]:[xn.Some.toString(),_]}return xn.None.toString()}if(wh(t)){const f=e;if(f.isOk()){const g=i.find(k=>k.name==="Ok");if(Ct(g))throw Error("Error in abi : Result has no 'Ok' variant.");const y=g.type;if(y==="()")return Sn.Ok.toString();const w=jn({element:f.unwrap(),type:y,structs:n,enums:r,parser:s});return Array.isArray(w)?[Sn.Ok.toString(),...w]:[Sn.Ok.toString(),w]}const h=i.find(g=>g.name==="Err");if(Ct(h))throw Error("Error in abi : Result has no 'Err' variant.");const p=h.type;if(p==="()")return Sn.Err.toString();const _=jn({element:f.unwrap(),type:p,structs:n,enums:r,parser:s});return Array.isArray(_)?[Sn.Err.toString(),..._]:[Sn.Err.toString(),_]}const o=e,a=o.activeVariant(),c=i.find(f=>f.name===a);if(Ct(c))throw Error(`Not find in abi : Enum has no '${a}' variant.`);const l=c.type,u=i.findIndex(f=>f.name===a);if(l==="()")return u.toString();const d=jn({element:o.unwrap(),type:l,structs:n,enums:r,parser:s});return Array.isArray(d)?[u.toString(),...d]:[u.toString(),d]}if(yo(t))return Zo({type:jr(t),val:e,parser:s});if(typeof e=="object")throw Error(`Parameter ${e} do not align with abi parameter ${t}`);return Zo({type:t,val:e,parser:s})}function x4({argsIterator:e,input:t,structs:n,enums:r,parser:s}){const{name:i,type:o}=t;let{value:a}=e.next();switch(!0){case qt.isTypeFixedArray(o):if(!Array.isArray(a)&&typeof a!="object")throw Error(`ABI expected parameter ${i} to be an array or an object, got ${a}`);return jn({element:a,type:t.type,structs:n,enums:r,parser:s});case hs(o):if(!Array.isArray(a)&&!jt(a))throw Error(`ABI expected parameter ${i} to be array or long string, got ${a}`);return de(a)&&(a=Xm(a)),jn({element:a,type:t.type,structs:n,enums:r,parser:s});case yo(o):return Zo({type:jr(o),val:a,parser:s});case _o(o):return Zo({type:o,val:a,parser:s});case(lu(o,n)||Gs(o)||Ot.isAbiType(o)):return jn({element:a,type:o,structs:n,enums:r,parser:s});case go(o,r):return jn({element:a,type:o,structs:n,enums:r,parser:s});default:return Zo({type:o,val:a,parser:s})}}function y_(e,t,n){let r;switch(!0){case kh(e):return r=t.next().value,!!BigInt(r);case Ot.isAbiType(e):return n.getResponseParser(e)(t);case Nn.isAbiType(e):return n.getResponseParser(e)(t);case sf.isAbiType(e):return n.getResponseParser(e)(t);case of.isAbiType(e):return n.getResponseParser(e)(t);case af.isAbiType(e):return n.getResponseParser(e)(t);case cf.isAbiType(e):return n.getResponseParser(e)(t);case lf.isAbiType(e):return n.getResponseParser(e)(t);case Di.isAbiType(e):return n.getResponseParser(e)(t);case Mi.isAbiType(e):return n.getResponseParser(e)(t);case Li.isAbiType(e):return n.getResponseParser(e)(t);case Ui.isAbiType(e):return n.getResponseParser(e)(t);case Pi.isAbiType(e):return n.getResponseParser(e)(t);case _o(e):return r=t.next().value,BigInt(r);case cr.isAbiType(e):return n.getResponseParser(e)(t);case Eh(e):const s=an(t.next().value).padStart(32,"0"),i=an(t.next().value).padStart(32,"0"),o=an(t.next().value).padStart(32,"0"),a=an(t.next().value).padStart(32,"0");return BigInt(Y(i+s+a+o));default:return n.getResponseParser(Is.abiSelector)(t)}}function kn(e,t,n,r,s){if(t.type==="()")return{};if(Ot.isAbiType(t.type)||Nn.isAbiType(t.type)||os.isAbiType(t.type))return n.getResponseParser(t.type)(e);if(qt.isTypeFixedArray(t.type)){const i=[],o={type:qt.getFixedArrayType(t.type)},a=qt.getFixedArraySize(t.type);for(;i.length<a;)i.push(kn(e,o,n,r,s));return i}if(hs(t.type)){const i=[],o={type:jr(t.type)},a=BigInt(e.next().value);for(;i.length<a;)i.push(kn(e,o,n,r,s));return i}if(yo(t.type)){const i={type:jr(t.type)};return kn(e,i,n,r,s)}if(r&&t.type in r&&r[t.type])return _o(t.type)?y_(t.type,e,n):r[t.type].members.reduce((i,o)=>(i[o.name]=kn(e,o,n,r,s),i),{});if(s&&t.type in s&&s[t.type]){const i=Number(e.next().value),o=s[t.type].variants.reduce((c,l,u)=>u===i?(c[l.name]=kn(e,{type:l.type},n,r,s),c):(c[l.name]=void 0,c),{});if(t.type.startsWith("core::option::Option")){const c=i===xn.Some?o.Some:void 0;return new Bl(i,c)}if(t.type.startsWith("core::result::Result")){let c;return i===Sn.Ok?c=o.Ok:c=o.Err,new __(i,c)}return new nc(o)}if(Gs(t.type))return rb(t.type).reduce((o,a,c)=>{const l=a?.name?a.name:c,d={type:a?.type?a.type:a};return o[l]=kn(e,d,n,r,s),o},{});if(hs(t.type)){const i=[],o={type:jr(t.type)},a=BigInt(e.next().value);for(;i.length<a;)i.push(kn(e,o,n,r,s));return i}return y_(t.type,e,n)}function uf({responseIterator:e,output:t,structs:n,enums:r,parsedResult:s,parser:i}){const{name:o,type:a}=t;let c;switch(!0){case Xi(o):return c=e.next().value,BigInt(c);case(n&&a in n||Gs(a)):return kn(e,t,i,n,r);case(r&&go(a,r)):return kn(e,t,i,n,r);case qt.isTypeFixedArray(a):return kn(e,t,i,n,r);case hs(a):if(qs(a))return kn(e,t,i,n,r);const l=[];if(s&&s[`${o}_len`]){const u=s[`${o}_len`];for(;l.length<u;)l.push(kn(e,{type:t.type.replace("*","")},i,n,r))}return l;case yo(a):return kn(e,t,i,n,r);default:return y_(a,e,i)}}var sb=(e,t)=>{if(I(de(e)||$e(e)||dn(e),`Validate: arg ${t.name} should be a felt typed as (String, Number or BigInt)`),de(e)&&!Yt(e))return;const n=BigInt(e.toString(10));I(n>=0n&&n<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`)},Th=(e,t)=>{$e(e)&&I(e<=Number.MAX_SAFE_INTEGER,"Validation: Parameter is too large to be typed as Number use (BigInt or String)"),I(de(e)||$e(e)||dn(e)||xe(e)&&"low"in e&&"high"in e||xe(e)&&["limb0","limb1","limb2","limb3"].every(r=>r in e),`Validate: arg ${t.name} of cairo type ${t.type} should be type (String, Number or BigInt), but is ${typeof e} ${e}.`);let n;switch(t.type){case bn.u256:n=new Ot(e).toBigInt();break;case bn.u512:n=new Nn(e).toBigInt();break;default:n=Pt(e)}switch(t.type){case bn.u8:I(n>=0n&&n<=255n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0 - 255]`);break;case bn.u16:I(n>=0n&&n<=65535n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 65535]`);break;case bn.u32:I(n>=0n&&n<=4294967295n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 4294967295]`);break;case bn.u64:I(n>=0n&&n<=2n**64n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^64-1]`);break;case bn.u128:I(n>=0n&&n<=2n**128n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^128-1]`);break;case bn.u256:I(n>=0n&&n<=2n**256n-1n,`Validate: arg ${t.name} is ${t.type} should be in range 0 - 2^256-1`);break;case bn.u512:I(Nn.is(n),`Validate: arg ${t.name} is ${t.type} should be in range 0 - 2^512-1`);break;case Ii.ClassHash:I(n>=0n&&n<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`);break;case Ii.ContractAddress:I(n>=0n&&n<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`);break;case Ii.Secp256k1Point:{I(n>=0n&&n<=2n**512n-1n,`Validate: arg ${t.name} must be ${t.type} : a 512 bits number.`);break}case Ii.U96:{I(n>=0n&&n<=2n**96n-1n,`Validate: arg ${t.name} must be ${t.type} : a 96 bits number.`);break}}},e2=(e,t)=>{I(Cl(e),`Validate: arg ${t.name} of cairo type ${t.type} should be type (Boolean)`)},t2=(e,t,n)=>{if(t.type===bn.u256||t.type===bn.u512){Th(e,t);return}if(_o(t.type)){I(!xe(e),`EthAddress type is waiting a BigNumberish. Got "${e}"`);const r=BigInt(e.toString(10));I(r>=0n&&r<=2n**160n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^160-1]`);return}I(xe(e),`Validate: arg ${t.name} is cairo type struct (${t.type}), and should be defined as a js object (not array)`),n[t.type].members.forEach(({name:r})=>{I(Object.keys(e).includes(r),`Validate: arg ${t.name} should have a property ${r}`)})},n2=(e,t)=>{I(xe(e),`Validate: arg ${t.name} is cairo type Enum (${t.type}), and should be defined as a js object (not array)`);const n=Object.getOwnPropertyNames(Object.getPrototypeOf(e)),r=[...Object.getOwnPropertyNames(e),...n];if(!(bh(t.type)&&r.includes("isSome")&&r.includes("isNone"))&&!(wh(t.type)&&r.includes("isOk")&&r.includes("isErr"))&&!(r.includes("variant")&&r.includes("activeVariant")))throw new Error(`Validate Enum: argument ${t.name}, type ${t.type}, value received "${e}", is not an Enum.`)},r2=(e,t)=>{I(xe(e),`Validate: arg ${t.name} should be a tuple (defined as object)`)},s2=(e,t,n,r)=>{const s=hs(t.type),i=s?jr(t.type):qt.getFixedArrayType(t.type);if(s&&va(i)&&Jm(e))return;let o=[];if(s)I(Array.isArray(e),`Validate: arg ${t.name} should be an Array`),o=e;else switch(!0){case Array.isArray(e):o=e;break;case typeof e=="object":o=Object.values(e);break;default:throw new Error(`Validate: arg ${t.name} should be an Array or an object.`)}switch(!0){case va(i):o.forEach(a=>sb(a,t));break;case Gs(i):o.forEach(a=>r2(a,{name:t.name}));break;case hs(i):o.forEach(a=>s2(a,{name:"",type:i},n,r));break;case lu(i,n):o.forEach(a=>t2(a,{name:t.name,type:i},n));break;case go(i,r):o.forEach(a=>n2(a,{name:t.name,type:i}));break;case(Ol(i)||eb(i)):o.forEach(a=>Th(a,{name:"",type:i}));break;case kh(i):o.forEach(a=>e2(a,t));break;default:throw new Error(`Validate Unhandled: argument ${t.name}, type ${t.type}, value ${o}`)}},R4=(e,t)=>{const n=jr(t.type);switch(I(Ol(n)&&n!==Nn.abiSelector||va(n),`Validate: ${t.name} type is not authorized for NonZero type.`),!0){case va(n):sb(e,t),I(BigInt(e.toString(10))>0,"Validate: value 0 is not authorized in NonZero felt252 type.");break;case Ol(n):switch(Th(e,{name:"",type:n}),n){case bn.u256:I(new Ot(e).toBigInt()>0,"Validate: value 0 is not authorized in NonZero uint256 type.");break;default:I(Pt(e)>0,"Validate: value 0 is not authorized in NonZero uint type.")}break;default:throw new Error(`Validate Unhandled: argument ${t.name}, type ${t.type}, value "${e}"`)}};function mk(e,t,n,r){e.inputs.reduce((s,i)=>{const o=t[s];switch(!0){case Xi(i.name):return s;case va(i.type):sb(o,i);break;case cr.isAbiType(i.type):cr.validate(o);break;case(Ol(i.type)||eb(i.type)):Th(o,i);break;case kh(i.type):e2(o,i);break;case os.isAbiType(i.type):os.validate(o);break;case Di.isAbiType(i.type):Di.validate(o);break;case Mi.isAbiType(i.type):Mi.validate(o);break;case Li.isAbiType(i.type):Li.validate(o);break;case Ui.isAbiType(i.type):Ui.validate(o);break;case Pi.isAbiType(i.type):Pi.validate(o);break;case(hs(i.type)||qt.isTypeFixedArray(i.type)):s2(o,i,n,r);break;case lu(i.type,n):t2(o,i,n);break;case go(i.type,r):n2(o,i);break;case Gs(i.type):r2(o,i);break;case yo(i.type):R4(o,i);break;default:throw new Error(`Validate Unhandled: argument ${i.name}, type ${i.type}, value ${o}`)}return s+1},0)}var ye=class qc{abi;parser;structs;enums;constructor(t,n){this.structs=qc.getAbiStruct(t),this.enums=qc.getAbiEnum(t),this.parser=b4(t,n),this.abi=this.parser.getLegacyFormat()}validate(t,n,r=[]){if(t!==Vc.DEPLOY){const o=this.abi.filter(a=>{if(a.type!=="function")return!1;const c=a.stateMutability==="view"||a.state_mutability==="view";return t===Vc.INVOKE?!c:c}).map(a=>a.name);I(o.includes(n),`${t===Vc.INVOKE?"invocable":"viewable"} method not found in abi`)}const s=this.abi.find(o=>t===Vc.DEPLOY?o.name===n&&o.type==="constructor":o.name===n&&o.type==="function");if(_k(n,r,s))return;const i=this.parser.methodInputsLength(s);if(r.length!==i)throw Error(`Invalid number of arguments, expected ${i} arguments, but got ${r.length}`);mk(s,r,this.structs,this.enums)}compile(t,n){const r=this.abi.find(a=>a.name===t);if(_k(t,n,r))return[];let s;if(Array.isArray(n))s=n;else{const a=I4(n,r.inputs,this.structs,this.enums);s=Object.values(a),mk(r,s,this.structs,this.enums)}const i=s[Symbol.iterator](),o=r.inputs.reduce((a,c)=>Xi(c.name)&&!qs(c.type)?a:a.concat(x4({argsIterator:i,input:c,structs:this.structs,enums:this.enums,parser:this.parser})),[]);return Object.defineProperty(o,"__compiled__",{enumerable:!1,writable:!1,value:!0}),o}static compile(t){const n=s=>{const i=(a,c=".")=>{const l=Array.isArray(a)?[a.length.toString(),...a]:a;return Object.entries(l).flatMap(([u,d])=>{let f=d;u==="entrypoint"?f=We(f):Jm(f)&&(f=Qm(f));const h=Array.isArray(l)&&u==="0"?"$$len":u;if(dn(f))return[[`${c}${h}`,xt(f)]];if(Object(f)===f){const p=Object.getOwnPropertyNames(Object.getPrototypeOf(f)),_=[...Object.getOwnPropertyNames(f),...p];if(_.includes("isSome")&&_.includes("isNone")){const g=f,y=g.isSome()?xn.Some:xn.None;return g.isSome()?i({0:y,1:g.unwrap()},`${c}${h}.`):[[`${c}${h}`,xt(y)]]}if(_.includes("isOk")&&_.includes("isErr")){const g=f,y=g.isOk()?Sn.Ok:Sn.Err;return i({0:y,1:g.unwrap()},`${c}${h}.`)}if(_.includes("variant")&&_.includes("activeVariant")){const g=f,y=g.activeVariant(),k=Object.keys(g.variant).findIndex(b=>b===y);return typeof g.unwrap()=="object"&&Object.keys(g.unwrap()).length===0?[[`${c}${h}`,xt(k)]]:i({0:k,1:g.unwrap()},`${c}${h}.`)}return i(f,`${c}${h}.`)}return[[`${c}${h}`,xt(f)]]})};return Object.fromEntries(i(s))};let r;if(Array.isArray(t)){const s={...t},i=n(s);r=Object.values(i)}else{const s=n(t);r=Object.values(s)}return Object.defineProperty(r,"__compiled__",{enumerable:!1,writable:!1,value:!0}),r}parse(t,n){const{outputs:r}=this.abi.find(o=>o.name===t),s=n.flat()[Symbol.iterator](),i=r.flat().reduce((o,a,c)=>{const l=a.name??c;return o[l]=uf({responseIterator:s,output:a,structs:this.structs,enums:this.enums,parsedResult:o,parser:this.parser}),o[l]&&o[`${l}_len`]&&delete o[`${l}_len`],o},{});return Object.keys(i).length===1&&0 in i?i[0]:i}format(t,n,r){const s=this.parse(t,n);return yd(s,r)}static getAbiStruct(t){return t.filter(n=>n.type==="struct").reduce((n,r)=>({...n,[r.name]:r}),{})}static getAbiEnum(t){const n=t.filter(r=>r.type==="enum").reduce((r,s)=>({...r,[s.name]:s}),{});return delete n["core::bool"],n}static toCalldata(t=[]){return qc.compile(t)}static toHex(t=[]){return qc.compile(t).map(r=>M(r))}decodeParameters(t,n){const r=Array.isArray(t)?t:[t],s=n.flat()[Symbol.iterator](),i=r.map(o=>uf({responseIterator:s,output:{name:"",type:o},parser:this.parser,structs:this.structs,enums:this.enums}));return i.length===1?i[0]:i}},C4={};Se(C4,{calculateContractAddressFromHash:()=>al,calculateDeclareTransactionHash:()=>g2,calculateDeployAccountTransactionHash:()=>_2,calculateInvokeTransactionHash:()=>p2,calculateL2MessageTxHash:()=>h2,computeCompiledClassHash:()=>T2,computeContractClassHash:()=>S2,computeHashOnElements:()=>Rr,computeHintedClassHash:()=>w2,computeLegacyContractClassHash:()=>k2,computePedersenHash:()=>Dl,computePedersenHashOnElements:()=>m2,computePoseidonHash:()=>y2,computePoseidonHashOnElements:()=>b2,computeSierraContractClassHash:()=>v2,formatSpaces:()=>Ml,getL1MessageHash:()=>ZS,getL2MessageHash:()=>GS,getSelector:()=>ou,getSelectorFromName:()=>We,hashByteCodeSegments:()=>E2,keccakBn:()=>YS,poseidon:()=>t$,solidityUint256PackedKeccak256:()=>au,starknetKeccak:()=>Ym});var O4={};Se(O4,{calculateDeclareTransactionHash:()=>d2,calculateDeployAccountTransactionHash:()=>u2,calculateInvokeTransactionHash:()=>f2,calculateTransactionHashCommon:()=>Sh,encodeDataResourceBoundsL1:()=>c2,encodeResourceBoundsL1:()=>o2,encodeResourceBoundsL2:()=>a2,hashDAMode:()=>i2,hashFeeFieldV3B3:()=>l2});var Ps=e=>e.map(t=>BigInt(t)),B4=32n,$4=64n,vh=128n,ib=$4+vh,D4=BigInt(ht("L1_GAS")),M4=BigInt(ht("L2_GAS")),L4=BigInt(ht("L1_DATA"));function i2(e,t){return(BigInt(e)<<B4)+BigInt(t)}function o2(e){return(D4<<ib)+(e.l1_gas.max_amount<<vh)+e.l1_gas.max_price_per_unit}function a2(e){return(M4<<ib)+(e.l2_gas.max_amount<<vh)+e.l2_gas.max_price_per_unit}function c2(e){return(L4<<ib)+(e.l1_data_gas.max_amount<<vh)+e.l1_data_gas.max_price_per_unit}function l2(e,t){const n=o2(t),r=a2(t),s=c2(t);return bt([BigInt(e),n,r,s])}function Sh(e,t,n,r,s,i,o,a,c,l,u=[]){const d=l2(i,l),f=i2(a,c),h=Ps([e,t,n,d,bt(Ps(o)),r,s,f,...Ps(u)]);return M(bt(h))}function u2(e,t,n,r,s,i,o,a,c,l,u,d){return Sh(Ys.DEPLOY_ACCOUNT,s,e,i,o,u,d,a,c,l,[bt(Ps(n)),t,r])}function d2(e,t,n,r,s,i,o,a,c,l,u,d){return Sh(Ys.DECLARE,r,n,s,i,u,Ps(d),a,c,l,[bt(Ps(o)),e,t])}function f2(e,t,n,r,s,i,o,a,c,l,u){return Sh(Ys.INVOKE,t,e,r,s,l,u,o,a,c,[bt(Ps(i)),bt(Ps(n))])}var U4={};Se(U4,{calculateDeclareTransactionHash:()=>F4,calculateDeployAccountTransactionHash:()=>j4,calculateL2MessageTxHash:()=>h2,calculateTransactionHash:()=>V4,calculateTransactionHashCommon:()=>uu,computeHashOnElements:()=>m_});var P4={};Se(P4,{starkCurve:()=>N$,weierstrass:()=>d$});function m_(e){return[...e,e.length].reduce((t,n)=>Ja(Pt(t),Pt(n)),0).toString()}function uu(e,t,n,r,s,i,o,a=[]){const c=m_(s),l=[e,t,n,r,c,i,o,...a];return m_(l)}function F4(e,t,n,r,s,i,o){return uu(Ys.DECLARE,n,t,0,[e],r,s,[i,...o?[o]:[]])}function j4(e,t,n,r,s,i,o,a){const c=[t,r,...n];return uu(Ys.DEPLOY_ACCOUNT,s,e,0,c,i,o,[a])}function V4(e,t,n,r,s,i){return uu(Ys.INVOKE,t,e,0,n,r,s,[i])}function h2(e,t,n,r,s,i){const o=[e,...r];return uu(Ys.L1_HANDLER,0,t,ou(n),o,0,s,[i])}function z4(e){return[H.ETransactionVersion.V3,H.ETransactionVersion.F3].includes(e.version)}function p2(e){if(z4(e))return f2(e.senderAddress,e.version,e.compiledCalldata,e.chainId,e.nonce,e.accountDeploymentData,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData);throw new Error("Invalid Tx version for hash calculation")}function q4(e){return[H.ETransactionVersion.V3,H.ETransactionVersion.F3].includes(e.version)}function g2(e){if(q4(e))return d2(e.classHash,e.compiledClassHash,e.senderAddress,e.version,e.chainId,e.nonce,e.accountDeploymentData,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData);throw new Error("Invalid Tx version for hash calculation")}function H4(e){return[H.ETransactionVersion.V3,H.ETransactionVersion.F3].includes(e.version)}function _2(e){if(H4(e))return u2(e.contractAddress,e.classHash,e.compiledConstructorCalldata,e.salt,e.version,e.chainId,e.nonce,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData);throw new Error("Invalid Tx version for hash calculation")}function Dl(e,t){return Ja(BigInt(e),BigInt(t))}function y2(e,t){return M(Um(BigInt(e),BigInt(t)))}function Rr(e){return[...e,e.length].reduce((t,n)=>Ja(BigInt(t),BigInt(n)),0).toString()}var m2=Rr;function b2(e){return M(bt(e.map(t=>BigInt(t))))}function al(e,t,n,r){const s=ye.compile(n),i=Rr(s),o=xt("0x535441524b4e45545f434f4e54524143545f41444452455353"),a=Rr([o,r,e,t,i]);return M(BigInt(a)%BS)}function W4(e,t){return e==="attributes"||e==="accessible_scopes"?Array.isArray(t)&&t.length===0?void 0:t:e==="debug_info"?null:t===null?void 0:t}function Ml(e){let t=!1;const n=[];for(const r of e)r==='"'&&!(n.length>0&&n.slice(-1)[0]==="\\")&&(t=!t),t?n.push(r):n.push(r===":"?": ":r===","?", ":r);return n.join("")}function w2(e){const{abi:t,program:n}=e,s=Ml(Cn({abi:t,program:n},W4));return Y(zs(Zi(s)).toString(16))}function k2(e){const t=de(e)?ho(e):e,n=M(CS),r=Rr(t.entry_points_by_type.EXTERNAL.flatMap(l=>[l.selector,l.offset])),s=Rr(t.entry_points_by_type.L1_HANDLER.flatMap(l=>[l.selector,l.offset])),i=Rr(t.entry_points_by_type.CONSTRUCTOR.flatMap(l=>[l.selector,l.offset])),o=Rr(t.program.builtins.map(l=>ht(l))),a=w2(t),c=Rr(t.program.data);return Rr([n,r,s,i,o,a,c])}function K4(e){return bt(e.flatMap(t=>BigInt(ht(t))))}function Wp(e){const t=e.flatMap(n=>[BigInt(n.selector),BigInt(n.offset),K4(n.builtins)]);return bt(t)}function E2(e){const t=e.bytecode.map(i=>BigInt(i)),n=e.bytecode_segment_lengths??[];let r=0;const s=n.flatMap(i=>{const o=t.slice(r,r+=i);return[BigInt(i),bt(o)]});return 1n+bt(s)}function T2(e){const n=BigInt(ht("COMPILED_CLASS_V1")),r=Wp(e.entry_points_by_type.EXTERNAL),s=Wp(e.entry_points_by_type.L1_HANDLER),i=Wp(e.entry_points_by_type.CONSTRUCTOR),o=e.bytecode_segment_lengths?E2(e):bt(e.bytecode.map(a=>BigInt(a)));return M(bt([n,r,s,i,o]))}function Kp(e){const t=e.flatMap(n=>[BigInt(n.selector),BigInt(n.function_idx)]);return bt(t)}function Y4(e){const t=Ml(Cn(e.abi,null));return BigInt(Y(zs(Zi(t)).toString(16)))}function v2(e){const n=BigInt(ht("CONTRACT_CLASS_V0.1.0")),r=Kp(e.entry_points_by_type.EXTERNAL),s=Kp(e.entry_points_by_type.L1_HANDLER),i=Kp(e.entry_points_by_type.CONSTRUCTOR),o=Y4(e),a=bt(e.sierra_program.map(c=>BigInt(c)));return M(bt([n,r,s,i,o,a]))}function S2(e){const t=de(e)?ho(e):e;return"sierra_program"in t?v2(t):k2(t)}var G4={};Se(G4,{ZeroFeeEstimate:()=>N2,compressProgram:()=>ob,decompressProgram:()=>df,formatSignature:()=>du,getFullPublicKey:()=>J4,intDAM:()=>yi,randomAddress:()=>ab,resourceBoundsToBigInt:()=>X4,resourceBoundsToEstimateFeeResponse:()=>I2,resourceBoundsToHexString:()=>Vo,signatureToDecimalArray:()=>Z4,signatureToHexArray:()=>Lr,toFeeVersion:()=>x2,toOverheadOverallFee:()=>b_,toOverheadResourceBounds:()=>ff,toTransactionVersion:()=>cl,v3Details:()=>Qt,zeroResourceBounds:()=>A2});function ob(e){const t=de(e)?e:Cn(e),n=rM(t);return ES(n)}function df(e){if(Array.isArray(e))return e;const t=wS(sM(kS(e)));return ho(t)}function ab(){const e=$m.randomPrivateKey();return Mm(e)}function du(e){if(!e)throw Error("formatSignature: provided signature is undefined");if(Array.isArray(e))return e.map(t=>M(t));try{const{r:t,s:n}=e;return[M(t),M(n)]}catch{throw new Error("Signature need to be weierstrass.SignatureType or an array for custom")}}function Z4(e){return HS(du(e))}function Lr(e){return Ea(du(e))}function A2(){return ff(N2(),!1)}function ff(e,t=Gn.get("resourceBoundsOverhead")){return{l2_gas:{max_amount:vn(e.l2_gas_consumed,t!==!1?t.l2_gas.max_amount:0),max_price_per_unit:vn(e.l2_gas_price,t!==!1?t.l2_gas.max_price_per_unit:0)},l1_gas:{max_amount:vn(e.l1_gas_consumed,t!==!1?t.l1_gas.max_amount:0),max_price_per_unit:vn(e.l1_gas_price,t!==!1?t.l1_gas.max_price_per_unit:0)},l1_data_gas:{max_amount:vn(e.l1_data_gas_consumed,t!==!1?t.l1_data_gas.max_amount:0),max_price_per_unit:vn(e.l1_data_gas_price,t!==!1?t.l1_data_gas.max_price_per_unit:0)}}}function I2(e){return{resourceBounds:e,overall_fee:e.l1_gas.max_amount*e.l1_gas.max_price_per_unit+e.l1_data_gas.max_amount*e.l1_data_gas.max_price_per_unit+e.l2_gas.max_amount*e.l2_gas.max_price_per_unit,unit:"FRI"}}function b_(e,t=Gn.get("resourceBoundsOverhead")){return vn(e.l1_gas_consumed,t!==!1?t.l1_gas.max_amount:0)*vn(e.l1_gas_price,t!==!1?t.l1_gas.max_price_per_unit:0)+vn(e.l1_data_gas_consumed,t!==!1?t.l1_data_gas.max_amount:0)*vn(e.l1_data_gas_price,t!==!1?t.l1_data_gas.max_price_per_unit:0)+vn(e.l2_gas_consumed,t!==!1?t.l2_gas.max_amount:0)*vn(e.l2_gas_price,t!==!1?t.l2_gas.max_price_per_unit:0)}function N2(){return{l1_gas_consumed:"0",l1_gas_price:"0",l1_data_gas_consumed:"0",l1_data_gas_price:"0",l2_gas_consumed:"0",l2_gas_price:"0",overall_fee:"0",unit:"FRI"}}function yi(e){if(e===nf.L1)return gk.L1;if(e===nf.L2)return gk.L2;throw Error("EDAM conversion")}function cl(e,t){const n=M(t||e);if(!Object.values(jc).includes(n))throw Error(`${t?"providedVersion":"defaultVersion"} ${n} is not ETransactionVersion`);return n}function x2(e){if(!e)return;const t=M(e);if(t===wn.V0)return wn.F0;if(t===wn.V1)return wn.F1;if(t===wn.V2)return wn.F2;if(t===wn.V3)return wn.F3;throw Error(`toFeeVersion: ${t} is not supported`)}function Qt(e){return{tip:e.tip||0,paymasterData:e.paymasterData||[],accountDeploymentData:e.accountDeploymentData||[],nonceDataAvailabilityMode:e.nonceDataAvailabilityMode||nf.L1,feeDataAvailabilityMode:e.feeDataAvailabilityMode||nf.L1,resourceBounds:e.resourceBounds??A2()}}function J4(e){const t=M(e);return Y(fo(Bm(t,!1)))}function Vo(e){const t=n=>{if(dn(n))return M(n);if(xe(n)){const r={};return Object.keys(n).forEach(s=>{r[s]=t(n[s])}),r}return n};return t(e)}function X4(e){const t=n=>{if(de(n))return BigInt(n);if(xe(n)){const r={};return Object.keys(n).forEach(s=>{r[s]=t(n[s])}),r}return n};return t(e)}function cs(e){return"sierra_program"in(de(e)?ho(e):e)}function zo(e){const t={...e};if(cs(e.contract)&&(!e.compiledClassHash&&e.casm&&(t.compiledClassHash=T2(e.casm)),!t.compiledClassHash))throw new Error("Extract compiledClassHash failed, provide (CairoAssembly).casm file or compiledClassHash");if(t.classHash=e.classHash??S2(e.contract),!t.classHash)throw new Error("Extract classHash failed, provide (CompiledContract).json file or classHash");return t}var Q4={};Se(Q4,{ethRandomPrivateKey:()=>eL,validateAndParseEthAddress:()=>cb});function eL(){return AS(fo(hS.utils.randomPrivateKey()))}function cb(e){qS(e,un,2n**160n-1n,"Ethereum Address ");const t=Y(an(M(e)).padStart(40,"0"));return I(!!t.match(/^(0x)?[0-9a-f]{40}$/),"Invalid Ethereum Address Format"),t}var hf=typeof globalThis<"u"&&globalThis.fetch.bind(globalThis)||typeof window<"u"&&window.fetch.bind(window)||typeof global<"u"&&global.fetch.bind(global)||(()=>{throw new Bt("'fetch()' not detected, use the 'baseFetch' constructor parameter to set it")}),tL={};Se(tL,{Block:()=>he,createSierraContractClass:()=>R2,extractAbi:()=>sL,getDefaultNodeUrl:()=>Ll,getDefaultNodes:()=>O2,getSupportedRpcVersions:()=>iL,parseContract:()=>C2,validBlockTags:()=>B2,wait:()=>Ns});function Hc(e){const t=e.version?M(e.version):wn.V3;return t===wn.V3||t===wn.F3}function rs(e,t){const n=e.split("."),r=t.split(".");return n.every((s,i)=>s==="*"||s===r[i])}function lb(e,t={allowAnyPatchVersion:!1}){return Object.values(Ls).some(n=>rs(t.allowAnyPatchVersion?nL(n):n,e))}function nL(e){const t=e.split(".");return t.length<3?e:`${t[0]}.${t[1]}.*`}function rL(e){const[t,n]=e.replace(/^v/,"").split(".");return`v${t}_${n}`}function Ns(e){return new Promise(t=>{setTimeout(t,e)})}function R2(e){const t={...e};return delete t.sierra_program_debug_info,t.abi=Ml(Cn(e.abi)),t.sierra_program=Ml(Cn(e.sierra_program)),t.sierra_program=ob(t.sierra_program),t}function C2(e){const t=de(e)?ho(e):e;return cs(e)?R2(t):{...t,..."program"in t&&{program:ob(t.program)}}}function sL(e){return de(e.abi)?ho(e.abi):e.abi}var Ll=(e,t=!1,n)=>{t||Rt.info("Using default public node url, please provide nodeUrl in provider options!");const s=O2(n??Gn.get("rpcVersion"))[e??tc.SN_SEPOLIA],i=Math.floor(Math.random()*s.length);return s[i]};function O2(e){const t={...US};return Object.keys(t).forEach(function(n,r){t[n]=t[n].map(s=>`${s}${rL(e)}`)}),t}function iL(){return[...new Set(Object.values(Ls))]}var B2=Object.values(fr),he=class{hash=null;number=null;tag=null;setIdentifier(e){if(de(e))if(Zm(e))this.number=parseInt(e,10);else if(Yt(e))this.hash=e;else if(B2.includes(e))this.tag=e;else throw TypeError(`Block identifier unmanaged: ${e}`);else dn(e)?this.hash=M(e):$e(e)?this.number=e:this.tag=fr.LATEST;if($e(this.number)&&this.number<0)throw TypeError(`Block number (${this.number}) can't be negative`)}constructor(e){this.setIdentifier(e)}get queryIdentifier(){return this.number!==null?`blockNumber=${this.number}`:this.hash!==null?`blockHash=${this.hash}`:`blockNumber=${this.tag}`}get identifier(){return this.number!==null?{block_number:this.number}:this.hash!==null?{block_hash:this.hash}:this.tag}set identifier(e){this.setIdentifier(e)}valueOf=()=>this.number;toString=()=>this.hash},oL={};Se(oL,{fromCallsToExecuteCalldata:()=>M2,fromCallsToExecuteCalldata_cairo1:()=>L2,getCompiledCalldata:()=>$2,getExecuteCalldata:()=>ub,getVersionsByType:()=>db,transformCallsToMulticallArrays:()=>D2});function $2(e,t){return Array.isArray(e)&&"__compiled__"in e?e:Array.isArray(e)&&Array.isArray(e[0])&&"__compiled__"in e[0]?e[0]:t()}var D2=e=>{const t=[],n=[];return e.forEach(r=>{const s=ye.compile(r.calldata||[]);t.push({to:Pt(r.contractAddress).toString(10),selector:Pt(We(r.entrypoint)).toString(10),data_offset:n.length.toString(),data_len:s.length.toString()}),n.push(...s)}),{callArray:t,calldata:ye.compile({calldata:n})}},M2=e=>{const{callArray:t,calldata:n}=D2(e);return[...ye.compile({callArray:t}),...n]},L2=e=>{const t=e.map(n=>({contractAddress:n.contractAddress,entrypoint:n.entrypoint,calldata:Array.isArray(n.calldata)&&"__compiled__"in n.calldata?n.calldata:ye.compile(n.calldata)}));return ye.compile({orderCalls:t})},ub=(e,t="0")=>t==="1"?L2(e):M2(e);function db(e){return e==="fee"?{v3:wn.F3}:{v3:wn.V3}}var Yp={headers:{"Content-Type":"application/json"},blockIdentifier:fr.LATEST,retries:200},aL=class{id="RPC081";channelSpecVersion=Ls.v0_8_1;nodeUrl;headers;requestId;blockIdentifier;retries;waitMode;chainId;specVersion;transactionRetryIntervalFallback;batchClient;baseFetch;constructor(e){const{baseFetch:t,batch:n,blockIdentifier:r,chainId:s,headers:i,nodeUrl:o,retries:a,specVersion:c,transactionRetryIntervalFallback:l,waitMode:u}=e||{};Object.values(tc).includes(o)?this.nodeUrl=Ll(o,e?.default,this.channelSpecVersion):o?this.nodeUrl=o:this.nodeUrl=Ll(void 0,e?.default,this.channelSpecVersion),this.baseFetch=t||Gn.get("fetch")||hf,this.blockIdentifier=r??Yp.blockIdentifier,this.chainId=s,this.headers={...Yp.headers,...i},this.retries=a??Yp.retries,this.specVersion=c,this.transactionRetryIntervalFallback=l,this.waitMode=u??!1,this.requestId=0,$e(n)&&(this.batchClient=new FS({nodeUrl:this.nodeUrl,headers:this.headers,interval:n,baseFetch:this.baseFetch,rpcMethods:{}})),Rt.debug("Using Channel",this.id)}readSpecVersion(){return this.specVersion}get transactionRetryIntervalDefault(){return this.transactionRetryIntervalFallback??5e3}setChainId(e){this.chainId=e}fetch(e,t,n=0){const r={id:n,jsonrpc:"2.0",method:e,...t&&{params:t}};return this.baseFetch(this.nodeUrl,{method:"POST",body:Cn(r),headers:this.headers})}errorHandler(e,t,n,r){if(n)throw new $l(n,e,t);if(r instanceof Bt)throw r;if(r)throw Error(r.message)}async fetchEndpoint(e,t){try{if(this.batchClient){const{error:i,result:o}=await this.batchClient.fetch(e,t,this.requestId+=1);return this.errorHandler(e,t,i),o}const n=await this.fetch(e,t,this.requestId+=1),{error:r,result:s}=await n.json();return this.errorHandler(e,t,r),s}catch(n){throw this.errorHandler(e,t,n?.response?.data,n),n}}async getChainId(){return this.chainId??=await this.fetchEndpoint("starknet_chainId"),this.chainId}getSpecVersion(){return this.fetchEndpoint("starknet_specVersion")}async setUpSpecVersion(){if(!this.specVersion){const e=await this.fetchEndpoint("starknet_specVersion");if(rs(this.channelSpecVersion,e)||Rt.error(Qe.channelVersionMismatch,{channelId:this.id,channelSpecVersion:this.channelSpecVersion,nodeSpecVersion:this.specVersion}),!lb(e))throw new Bt(`${Qe.unsupportedSpecVersion}, channelId: ${this.id}`);this.specVersion=e}return this.specVersion}getMessagesStatus(e){const t=M(e);return this.fetchEndpoint("starknet_getMessagesStatus",{transaction_hash:t})}getStorageProof(e=[],t=[],n=[],r=this.blockIdentifier){const s=new he(r).identifier,i=Ea(e),o=Ea(t);return this.fetchEndpoint("starknet_getStorageProof",{block_id:s,class_hashes:i,contract_addresses:o,contracts_storage_keys:n})}getCompiledCasm(e){const t=M(e);return this.fetchEndpoint("starknet_getCompiledCasm",{class_hash:t})}getNonceForAddress(e,t=this.blockIdentifier){const n=M(e),r=new he(t).identifier;return this.fetchEndpoint("starknet_getNonce",{contract_address:n,block_id:r})}getBlockLatestAccepted(){return this.fetchEndpoint("starknet_blockHashAndNumber")}getBlockNumber(){return this.fetchEndpoint("starknet_blockNumber")}getBlockWithTxHashes(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxHashes",{block_id:t})}getBlockWithTxs(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxs",{block_id:t})}getBlockWithReceipts(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getBlockWithReceipts",{block_id:t})}getBlockStateUpdate(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getStateUpdate",{block_id:t})}getBlockTransactionsTraces(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_traceBlockTransactions",{block_id:t})}getBlockTransactionCount(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getBlockTransactionCount",{block_id:t})}getTransactionByHash(e){const t=M(e);return this.fetchEndpoint("starknet_getTransactionByHash",{transaction_hash:t})}getTransactionByBlockIdAndIndex(e,t){const n=new he(e).identifier;return this.fetchEndpoint("starknet_getTransactionByBlockIdAndIndex",{block_id:n,index:t})}getTransactionReceipt(e){const t=M(e);return this.fetchEndpoint("starknet_getTransactionReceipt",{transaction_hash:t})}getTransactionTrace(e){const t=M(e);return this.fetchEndpoint("starknet_traceTransaction",{transaction_hash:t})}getTransactionStatus(e){const t=M(e);return this.fetchEndpoint("starknet_getTransactionStatus",{transaction_hash:t})}simulateTransaction(e,t={}){const{blockIdentifier:n=this.blockIdentifier,skipValidate:r=!0,skipFeeCharge:s=!0}=t,i=new he(n).identifier,o=[];return r&&o.push(el.SKIP_VALIDATE),s&&o.push(el.SKIP_FEE_CHARGE),this.fetchEndpoint("starknet_simulateTransactions",{block_id:i,transactions:e.map(a=>this.buildTransaction(a)),simulation_flags:o})}async waitForTransaction(e,t){const n=M(e);let{retries:r}=this,s=!1,i=!1;const o=t?.retryInterval??this.transactionRetryIntervalDefault,a=t?.errorStates??[tl.REJECTED],c=t?.successStates??[tl.ACCEPTED_ON_L2,tl.ACCEPTED_ON_L1],l=[];let u;for(;!s;){await Ns(o);try{u=await this.getTransactionStatus(n),l.push(u.finality_status);const f=u.execution_status,h=u.finality_status;if(!h)throw new Error("waiting for transaction status");if(a.includes(f)||a.includes(h)){const p=`${f}: ${h}`,_=new Error(p);throw _.response=u,i=!0,_}else(c.includes(f)||c.includes(h))&&(s=!0)}catch(f){if(f instanceof Error&&i)throw f;if(f instanceof $l&&f.isType("TXN_HASH_NOT_FOUND")){Rt.info("txLife: ",l);const p={[Os.RECEIVED]:Qe.txEvictedFromMempool,[Os.PRE_CONFIRMED]:Qe.consensusFailed,[Os.CANDIDATE]:Qe.txFailsBlockBuildingValidation}[l.at(-1)];if(p)throw new Error(p)}if(r<=0)throw new Error(`waitForTransaction timed-out with retries ${this.retries}`)}r-=1}let d=null;for(;d===null;){try{d=await this.getTransactionReceipt(n)}catch{if(r<=0)throw new Error(`waitForTransaction timed-out with retries ${this.retries}`)}r-=1,await Ns(o)}return d}getStorageAt(e,t,n=this.blockIdentifier){const r=M(e),s=Wm(t),i=new he(n).identifier;return this.fetchEndpoint("starknet_getStorageAt",{contract_address:r,key:s,block_id:i})}getClassHashAt(e,t=this.blockIdentifier){const n=M(e),r=new he(t).identifier;return this.fetchEndpoint("starknet_getClassHashAt",{block_id:r,contract_address:n})}getClass(e,t=this.blockIdentifier){const n=M(e),r=new he(t).identifier;return this.fetchEndpoint("starknet_getClass",{class_hash:n,block_id:r})}getClassAt(e,t=this.blockIdentifier){const n=M(e),r=new he(t).identifier;return this.fetchEndpoint("starknet_getClassAt",{block_id:r,contract_address:n})}async getEstimateFee(e,{blockIdentifier:t=this.blockIdentifier,skipValidate:n=!0}={}){const r=new he(t).identifier,s={simulation_flags:n?[el.SKIP_VALIDATE]:[]};return this.fetchEndpoint("starknet_estimateFee",{request:e.map(i=>this.buildTransaction(i,"fee")),block_id:r,...s})}async invoke(e,t){let n;if(Hc(t))if(gd(t.resourceBounds))n=this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{type:es.INVOKE,sender_address:e.contractAddress,calldata:ye.toHex(e.calldata),version:Tn.V3,signature:Lr(e.signature),nonce:M(t.nonce),resource_bounds:Vo(t.resourceBounds),tip:M(t.tip),paymaster_data:t.paymasterData.map(r=>M(r)),account_deployment_data:t.accountDeploymentData.map(r=>M(r)),nonce_data_availability_mode:t.nonceDataAvailabilityMode,fee_data_availability_mode:t.feeDataAvailabilityMode}});else throw Error(Qe.SWOldV3);else throw Error(Qe.legacyTxRPC08Message);return this.waitMode?this.waitForTransaction((await n).transaction_hash):n}async declare({contract:e,signature:t,senderAddress:n,compiledClassHash:r},s){let i;if(cs(e)&&Hc(s))if(gd(s.resourceBounds))i=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:es.DECLARE,sender_address:n,compiled_class_hash:r||"",version:Tn.V3,signature:Lr(t),nonce:M(s.nonce),contract_class:{sierra_program:df(e.sierra_program),contract_class_version:e.contract_class_version,entry_points_by_type:e.entry_points_by_type,abi:e.abi},resource_bounds:Vo(s.resourceBounds),tip:M(s.tip),paymaster_data:s.paymasterData.map(o=>M(o)),account_deployment_data:s.accountDeploymentData.map(o=>M(o)),nonce_data_availability_mode:s.nonceDataAvailabilityMode,fee_data_availability_mode:s.feeDataAvailabilityMode}});else throw Error(Qe.SWOldV3);else throw Error(Qe.legacyTxRPC08Message);return this.waitMode?this.waitForTransaction((await i).transaction_hash):i}async deployAccount({classHash:e,constructorCalldata:t,addressSalt:n,signature:r},s){let i;if(Hc(s))if(gd(s.resourceBounds))i=this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{type:es.DEPLOY_ACCOUNT,version:Tn.V3,signature:Lr(r),nonce:M(s.nonce),contract_address_salt:M(n||0),constructor_calldata:ye.toHex(t||[]),class_hash:M(e),resource_bounds:Vo(s.resourceBounds),tip:M(s.tip),paymaster_data:s.paymasterData.map(o=>M(o)),nonce_data_availability_mode:s.nonceDataAvailabilityMode,fee_data_availability_mode:s.feeDataAvailabilityMode}});else throw Error(Qe.SWOldV3);else throw Error(Qe.legacyTxRPC08Message);return this.waitMode?this.waitForTransaction((await i).transaction_hash):i}callContract(e,t=this.blockIdentifier){const n=new he(t).identifier;return this.fetchEndpoint("starknet_call",{request:{contract_address:e.contractAddress,entry_point_selector:We(e.entrypoint),calldata:ye.toHex(e.calldata)},block_id:n})}estimateMessageFee(e,t=this.blockIdentifier){const{from_address:n,to_address:r,entry_point_selector:s,payload:i}=e,o={from_address:cb(n),to_address:M(r),entry_point_selector:ou(s),payload:Km(i)},a=new he(t).identifier;return this.fetchEndpoint("starknet_estimateMessageFee",{message:o,block_id:a})}getSyncingStats(){return this.fetchEndpoint("starknet_syncing")}getEvents(e){return this.fetchEndpoint("starknet_getEvents",{filter:e})}buildTransaction(e,t){const n=db(t);let r;if(Hc(e))r={signature:Lr(e.signature),nonce:M(e.nonce),resource_bounds:Vo(e.resourceBounds),tip:M(e.tip),paymaster_data:e.paymasterData.map(s=>M(s)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode,account_deployment_data:e.accountDeploymentData.map(s=>M(s))};else throw Error("v0,v1,v2 tx are not supported on RPC 0.8");if(e.type===es.INVOKE)return{type:es.INVOKE,sender_address:e.contractAddress,calldata:ye.toHex(e.calldata),version:M(e.version||n.v3),...r};if(e.type===es.DECLARE){if(!cs(e.contract))throw Rt.error("Cairo 0 -  non Sierra v1 tx are not supported"),Error("Declaring non Sierra contract using RPC 0.8");return{type:e.type,contract_class:{...e.contract,sierra_program:df(e.contract.sierra_program)},compiled_class_hash:e.compiledClassHash||"",sender_address:e.senderAddress,version:M(e.version||n.v3),...r}}if(e.type===es.DEPLOY_ACCOUNT){const{account_deployment_data:s,...i}=r;return{type:e.type,constructor_calldata:ye.toHex(e.constructorCalldata||[]),class_hash:M(e.classHash),contract_address_salt:M(e.addressSalt||0),version:M(e.version||n.v3),...i}}throw Error("RPC buildTransaction received unknown TransactionType")}},Ei={};Se(Ei,{RpcChannel:()=>cL});var Gp={headers:{"Content-Type":"application/json"},blockIdentifier:fr.LATEST,retries:200},cL=class{id="RPC090";channelSpecVersion=Ls.v0_9_0;nodeUrl;headers;requestId;blockIdentifier;retries;waitMode;chainId;specVersion;transactionRetryIntervalFallback;batchClient;baseFetch;constructor(e){const{baseFetch:t,batch:n,blockIdentifier:r,chainId:s,headers:i,nodeUrl:o,retries:a,specVersion:c,transactionRetryIntervalFallback:l,waitMode:u}=e||{};Object.values(tc).includes(o)?this.nodeUrl=Ll(o,e?.default,this.channelSpecVersion):o?this.nodeUrl=o:this.nodeUrl=Ll(void 0,e?.default,this.channelSpecVersion),this.baseFetch=t||Gn.get("fetch")||hf,this.blockIdentifier=r??Gp.blockIdentifier,this.chainId=s,this.headers={...Gp.headers,...i},this.retries=a??Gp.retries,this.specVersion=c,this.transactionRetryIntervalFallback=l,this.waitMode=u??!1,this.requestId=0,$e(n)&&(this.batchClient=new FS({nodeUrl:this.nodeUrl,headers:this.headers,interval:n,baseFetch:this.baseFetch,rpcMethods:{}})),Rt.debug("Using Channel",this.id)}readSpecVersion(){return this.specVersion}get transactionRetryIntervalDefault(){return this.transactionRetryIntervalFallback??5e3}setChainId(e){this.chainId=e}fetch(e,t,n=0){const r={id:n,jsonrpc:"2.0",method:e,...t&&{params:t}};return this.baseFetch(this.nodeUrl,{method:"POST",body:Cn(r),headers:this.headers})}errorHandler(e,t,n,r){if(n)throw new $l(n,e,t);if(r instanceof Bt)throw r;if(r)throw Error(r.message)}async fetchEndpoint(e,t){try{if(this.batchClient){const{error:i,result:o}=await this.batchClient.fetch(e,t,this.requestId+=1);return this.errorHandler(e,t,i),o}const n=await this.fetch(e,t,this.requestId+=1),{error:r,result:s}=await n.json();return this.errorHandler(e,t,r),s}catch(n){throw this.errorHandler(e,t,n?.response?.data,n),n}}async getChainId(){return this.chainId??=await this.fetchEndpoint("starknet_chainId"),this.chainId}getSpecVersion(){return this.fetchEndpoint("starknet_specVersion")}async setUpSpecVersion(){if(!this.specVersion){const e=await this.fetchEndpoint("starknet_specVersion");if(rs(this.channelSpecVersion,e)||Rt.error(Qe.channelVersionMismatch,{channelId:this.id,channelSpecVersion:this.channelSpecVersion,nodeSpecVersion:this.specVersion}),!lb(e))throw new Bt(`${Qe.unsupportedSpecVersion}, channelId: ${this.id}`);this.specVersion=e}return this.specVersion}getMessagesStatus(e){const t=M(e);return this.fetchEndpoint("starknet_getMessagesStatus",{transaction_hash:t})}getStorageProof(e=[],t=[],n=[],r=this.blockIdentifier){const s=new he(r).identifier,i=Ea(e),o=Ea(t);return this.fetchEndpoint("starknet_getStorageProof",{block_id:s,class_hashes:i,contract_addresses:o,contracts_storage_keys:n})}getCompiledCasm(e){const t=M(e);return this.fetchEndpoint("starknet_getCompiledCasm",{class_hash:t})}getNonceForAddress(e,t=this.blockIdentifier){const n=M(e),r=new he(t).identifier;return this.fetchEndpoint("starknet_getNonce",{contract_address:n,block_id:r})}getBlockLatestAccepted(){return this.fetchEndpoint("starknet_blockHashAndNumber")}getBlockNumber(){return this.fetchEndpoint("starknet_blockNumber")}getBlockWithTxHashes(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxHashes",{block_id:t})}getBlockWithTxs(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxs",{block_id:t})}getBlockWithReceipts(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getBlockWithReceipts",{block_id:t})}getBlockStateUpdate(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getStateUpdate",{block_id:t})}getBlockTransactionsTraces(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_traceBlockTransactions",{block_id:t})}getBlockTransactionCount(e=this.blockIdentifier){const t=new he(e).identifier;return this.fetchEndpoint("starknet_getBlockTransactionCount",{block_id:t})}getTransactionByHash(e){const t=M(e);return this.fetchEndpoint("starknet_getTransactionByHash",{transaction_hash:t})}getTransactionByBlockIdAndIndex(e,t){const n=new he(e).identifier;return this.fetchEndpoint("starknet_getTransactionByBlockIdAndIndex",{block_id:n,index:t})}getTransactionReceipt(e){const t=M(e);return this.fetchEndpoint("starknet_getTransactionReceipt",{transaction_hash:t})}getTransactionTrace(e){const t=M(e);return this.fetchEndpoint("starknet_traceTransaction",{transaction_hash:t})}getTransactionStatus(e){const t=M(e);return this.fetchEndpoint("starknet_getTransactionStatus",{transaction_hash:t})}simulateTransaction(e,t={}){const{blockIdentifier:n=this.blockIdentifier,skipValidate:r=!0,skipFeeCharge:s=!0}=t,i=new he(n).identifier,o=[];return r&&o.push(nl.SKIP_VALIDATE),s&&o.push(nl.SKIP_FEE_CHARGE),this.fetchEndpoint("starknet_simulateTransactions",{block_id:i,transactions:e.map(a=>this.buildTransaction(a)),simulation_flags:o})}async waitForTransaction(e,t){const n=M(e);let{retries:r}=this,s=!1,i=!1;const o=t?.retryInterval??this.transactionRetryIntervalDefault,a=t?.errorStates??[],c=t?.successStates??[wi.ACCEPTED_ON_L2,wi.ACCEPTED_ON_L1],l=[];let u;for(;!s;){await Ns(o);try{u=await this.getTransactionStatus(n),l.push(u.finality_status);const f=u.execution_status,h=u.finality_status;if(!h)throw new Error("waiting for transaction status");if(a.includes(f)||a.includes(h)){const p=`${f}: ${h}`,_=new Error(p);throw _.response=u,i=!0,_}else(c.includes(f)||c.includes(h))&&(s=!0)}catch(f){if(f instanceof Error&&i)throw f;if(f instanceof $l&&f.isType("TXN_HASH_NOT_FOUND")){Rt.info("txLife: ",l);const p={[Os.RECEIVED]:Qe.txEvictedFromMempool,[Os.PRE_CONFIRMED]:Qe.consensusFailed,[Os.CANDIDATE]:Qe.txFailsBlockBuildingValidation}[l.at(-1)];if(p)throw new Error(p)}if(r<=0)throw new Error(`waitForTransaction timed-out with retries ${this.retries}`)}r-=1}let d=null;for(;d===null;){try{d=await this.getTransactionReceipt(n)}catch{if(r<=0)throw new Error(`waitForTransaction timed-out with retries ${this.retries}`)}r-=1,await Ns(o)}return d}async fastWaitForTransaction(e,t,n,r){const s=BigInt(n);let i=r?.retries??50;const o=r?.retryInterval??500,a=[Em.REVERTED],c=[wi.ACCEPTED_ON_L2,wi.ACCEPTED_ON_L1,wi.PRE_CONFIRMED];let l;const u=new Date().getTime();for(;i>0;){await Ns(o),l=await this.getTransactionStatus(e),Rt.info(`${i} ${JSON.stringify(l)} ${(new Date().getTime()-u)/1e3}s.`);const d=l.execution_status??"",f=l.finality_status;if(a.includes(d)){const h=`${d}: ${f}`,p=new Error(h);throw p.response=l,p}else if(c.includes(f)){let h=s;for(;h===s&&i>0;){if(h=BigInt(await this.getNonceForAddress(t,fr.PRE_CONFIRMED)),Rt.info(`${i} Checking new nonce ${h} ${(new Date().getTime()-u)/1e3}s.`),h!==s)return!0;await Ns(o),i-=1}return!1}i-=1}return!1}getStorageAt(e,t,n=this.blockIdentifier){const r=M(e),s=Wm(t),i=new he(n).identifier;return this.fetchEndpoint("starknet_getStorageAt",{contract_address:r,key:s,block_id:i})}getClassHashAt(e,t=this.blockIdentifier){const n=M(e),r=new he(t).identifier;return this.fetchEndpoint("starknet_getClassHashAt",{block_id:r,contract_address:n})}getClass(e,t=this.blockIdentifier){const n=M(e),r=new he(t).identifier;return this.fetchEndpoint("starknet_getClass",{class_hash:n,block_id:r})}getClassAt(e,t=this.blockIdentifier){const n=M(e),r=new he(t).identifier;return this.fetchEndpoint("starknet_getClassAt",{block_id:r,contract_address:n})}async getEstimateFee(e,{blockIdentifier:t=this.blockIdentifier,skipValidate:n=!0}={}){const r=new he(t).identifier,s={simulation_flags:n?[nl.SKIP_VALIDATE]:[]};return this.fetchEndpoint("starknet_estimateFee",{request:e.map(i=>this.buildTransaction(i,"fee")),block_id:r,...s})}async invoke(e,t){const n=this.buildTransaction({type:H.ETransactionType.INVOKE,...e,...t},"transaction"),r=this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:n});return this.waitMode?this.waitForTransaction((await r).transaction_hash):r}async declare(e,t){const n=this.buildTransaction({type:H.ETransactionType.DECLARE,...e,...t},"transaction"),r=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:n});return this.waitMode?this.waitForTransaction((await r).transaction_hash):r}async deployAccount(e,t){const n=this.buildTransaction({type:H.ETransactionType.DEPLOY_ACCOUNT,...e,...t},"transaction"),r=this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:n});return this.waitMode?this.waitForTransaction((await r).transaction_hash):r}callContract(e,t=this.blockIdentifier){const n=new he(t).identifier;return this.fetchEndpoint("starknet_call",{request:{contract_address:e.contractAddress,entry_point_selector:We(e.entrypoint),calldata:ye.toHex(e.calldata)},block_id:n})}estimateMessageFee(e,t=this.blockIdentifier){const{from_address:n,to_address:r,entry_point_selector:s,payload:i}=e,o={from_address:cb(n),to_address:M(r),entry_point_selector:ou(s),payload:Km(i)},a=new he(t).identifier;return this.fetchEndpoint("starknet_estimateMessageFee",{message:o,block_id:a})}getSyncingStats(){return this.fetchEndpoint("starknet_syncing")}getEvents(e){return this.fetchEndpoint("starknet_getEvents",{filter:e})}buildTransaction(e,t){const n=db(t);I(Hc(e),Qe.legacyTxRPC08Message),I(t!=="transaction"||gd(e.resourceBounds),Qe.SWOldV3);const r={signature:Lr(e.signature),nonce:M(e.nonce),resource_bounds:Vo(e.resourceBounds),tip:M(e.tip),paymaster_data:e.paymasterData.map(s=>M(s)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode,account_deployment_data:e.accountDeploymentData.map(s=>M(s)),version:cl(n.v3,e.version)};if(e.type===H.ETransactionType.INVOKE)return{type:km.INVOKE,sender_address:e.contractAddress,calldata:ye.toHex(e.calldata),...r};if(e.type===H.ETransactionType.DECLARE)return I(cs(e.contract),"Declaring non Sierra contract using RPC 0.9"),{type:e.type,contract_class:{...e.contract,sierra_program:df(e.contract.sierra_program)},compiled_class_hash:e.compiledClassHash||"",sender_address:e.senderAddress,...r};if(e.type===H.ETransactionType.DEPLOY_ACCOUNT){const{account_deployment_data:s,...i}=r;return{type:e.type,constructor_calldata:ye.toHex(e.constructorCalldata||[]),class_hash:M(e.classHash),contract_address_salt:M(e.addressSalt||0),...i}}throw Error("RPC buildTransaction received unknown TransactionType")}};typeof WebSocket<"u"&&WebSocket||typeof globalThis<"u"&&globalThis.WebSocket||typeof window<"u"&&window.WebSocket&&window.WebSocket.bind(window)||typeof global<"u"&&global.WebSocket;var bk=class{resourceBoundsOverhead;constructor(e){this.resourceBoundsOverhead=e}parseGetBlockResponse(e){return e}parseTransactionReceipt(e){return e}parseFeeEstimateBulkResponse(e){return e.map(t=>({resourceBounds:ff(t,this.resourceBoundsOverhead),overall_fee:b_(t,this.resourceBoundsOverhead),unit:t.unit}))}parseSimulateTransactionResponse(e){return e.map(t=>({transaction_trace:t.transaction_trace,resourceBounds:ff(t.fee_estimation,this.resourceBoundsOverhead),overall_fee:b_(t.fee_estimation,this.resourceBoundsOverhead),unit:t.fee_estimation.unit}))}parseContractClassResponse(e){return{...e,abi:de(e.abi)?JSON.parse(e.abi):e.abi}}parseL1GasPriceResponse(e){return e.l1_gas_price.price_in_wei}};function lL(e){return e.version==="0x3"&&"tip"in e&&de(e.tip)&&(e.type==="INVOKE"||e.type==="DECLARE"||e.type==="DEPLOY_ACCOUNT")}function uL(e){return!!e.channel.batchClient}function U2(e,t=!0){return e.transactions.filter(lL).map(n=>BigInt(n.tip)).filter(n=>t||n>0n)}function P2(e,t){return{minTip:0n,maxTip:0n,averageTip:0n,medianTip:0n,modeTip:0n,recommendedTip:0n,p90Tip:0n,p95Tip:0n,metrics:{blocksAnalyzed:e,transactionsTipsFound:t}}}function wk(e,t){const n=t/100*(e.length-1),r=Math.floor(n),s=Math.ceil(n);if(r===s)return e[r];const i=n-r,o=e[r],l=(e[s]-o)*BigInt(Math.round(i*1e3))/1000n;return o+l}function F2(e){I(e.length>0,"Cannot calculate statistics from empty tip array");const t=e.reduce((h,p)=>p<h?p:h,tf.max),n=e.reduce((h,p)=>p>h?p:h,0n),s=e.reduce((h,p)=>h+p,0n)/BigInt(e.length),i=[...e].sort((h,p)=>h<p?-1:h>p?1:0),o=Math.floor(i.length/2);let a;i.length%2===0?a=(i[o-1]+i[o])/2n:a=i[o];const c=new Map;e.forEach(h=>{c.set(h,(c.get(h)||0)+1)});const{modeTip:l}=Array.from(c.entries()).reduce((h,[p,_])=>_>h.maxCount||_===h.maxCount&&p<h.modeTip?{maxCount:_,modeTip:p}:h,{maxCount:0,modeTip:0n}),u=wk(i,90),d=wk(i,95);return{minTip:t,maxTip:n,averageTip:s,medianTip:a,modeTip:l,recommendedTip:a,p90Tip:u,p95Tip:d}}async function j2(e,t){try{const n=await e.getBlockWithTxs(t);return $e(n.block_number)?n.block_number:(await e.getBlockLatestAccepted()).block_number}catch(n){throw new Bt(`Failed to determine starting block number: ${n instanceof Error?n.message:"Unknown error"}`)}}async function dL(e,t){try{return await e.getBlockWithTxs(t)}catch(n){return Rt.warn(`Failed to fetch block ${t}:`,n),null}}function V2(e,t){const n=Math.max(0,e-t+1),r=e-n+1;return Array.from({length:r},(s,i)=>e-i)}async function fL(e,t){const n=t.map(async r=>{try{return await e.getBlockWithTxs(r)}catch(s){return Rt.warn(`Failed to fetch block ${r} in parallel:`,s),null}});return Promise.all(n)}async function hL(e,t,n){const{maxBlocks:r=3,minTxsNecessary:s=10,includeZeroTips:i=!0}=n;try{const o=await j2(e,t),a=V2(o,r),c=await fL(e,a),l=c.filter(f=>f!==null).flatMap(f=>U2(f,i)),u=c.filter(f=>f!==null).length;return l.length<s?(Rt.error(`Insufficient transaction data: found ${l.length} V3 transactions with tips in ${u} blocks (block range: ${Math.max(0,o-r+1)}-${o}). Required: ${s} transactions. Consider reducing minTxsNecessary or increasing maxBlocks.`),P2(u,l)):{...F2(l),metrics:{blocksAnalyzed:u,transactionsTipsFound:l}}}catch(o){throw new Bt(`Failed to analyze tip statistics (parallel): ${o instanceof Error?o.message:"Unknown error"}`)}}async function pL(e,t,n){const{maxBlocks:r=3,minTxsNecessary:s=10,includeZeroTips:i=!0}=n;try{const o=await j2(e,t),a=V2(o,r),c=[];let l=0;for(const d of a){const f=await dL(e,d);if(f){l+=1;const h=U2(f,i);if(c.push(...h),c.length>=s)break}}return c.length<s?(Rt.error(`Insufficient transaction data: found ${c.length} V3 transactions with tips in ${l} blocks (block range: ${Math.max(0,o-r+1)}-${o}). Required: ${s} transactions. Consider reducing minTxsNecessary or increasing maxBlocks.`),P2(l,c)):{...F2(c),metrics:{blocksAnalyzed:l,transactionsTipsFound:c}}}catch(o){throw new Bt(`Failed to analyze tip statistics (sequential): ${o instanceof Error?o.message:"Unknown error"}`)}}async function gL(e,t=fr.LATEST,n={}){const{maxBlocks:r=3,minTxsNecessary:s=10}=n;return I(Number.isInteger(r),"maxBlocks parameter must be an integer"),I(r>=1,"maxBlocks parameter must be greater than or equal to 1"),I(r<=100,"maxBlocks parameter must be less than or equal to 100 for performance"),I(Number.isInteger(s),"minTxsNecessary parameter must be an integer"),I(s>=1,"minTxsNecessary parameter must be greater than or equal to 1"),uL(e)?hL(e,t,n):pL(e,t,n)}var kk=class w_{statusReceipt;value;constructor(t){Object.assign(this,t);const[n,r]=w_.isSuccess(t)?["SUCCEEDED",t]:w_.isReverted(t)?["REVERTED",t]:["ERROR",new Error("Unknown response type")];Object.defineProperties(this,{statusReceipt:{value:n,writable:!1,enumerable:!1,configurable:!1},value:{value:r,writable:!1,enumerable:!1,configurable:!1},match:{value(s){return n in s?s[n](r):s._()},writable:!1,enumerable:!1,configurable:!1},isSuccess:{value:()=>n==="SUCCEEDED",writable:!1,enumerable:!1,configurable:!1},isReverted:{value:()=>n==="REVERTED",writable:!1,enumerable:!1,configurable:!1},isError:{value:()=>n==="ERROR",writable:!1,enumerable:!1,configurable:!1}})}match;isSuccess;isReverted;isError;static isSuccess(t){return t.execution_status===rf.SUCCEEDED}static isReverted(t){return t.execution_status===rf.REVERTED}},_L={[rf.SUCCEEDED]:{statusReceipt:"SUCCEEDED",getBaseData:e=>e,getValue:e=>e},[rf.REVERTED]:{statusReceipt:"REVERTED",getBaseData:e=>e,getValue:e=>e}};function Ek(e){const t=_L[e.execution_status];let n;if(t){const{statusReceipt:r,getBaseData:s,getValue:i}=t,o=i(e);n={...s(e),statusReceipt:r,value:o,match(a){return r in a?a[r](o):a._()},isSuccess(){return r==="SUCCEEDED"},isReverted(){return r==="REVERTED"},isError(){return!1}}}else{const r=new Error("Unknown response type");n={statusReceipt:"ERROR",value:r,match(s){return"ERROR"in s?s.ERROR(r):s._()},isSuccess(){return!1},isReverted(){return!1},isError(){return!0}}}return Object.setPrototypeOf(n,kk.prototype),Object.defineProperty(n,"constructor",{value:kk,writable:!1,enumerable:!1,configurable:!1}),n}var yL={};Se(yL,{encodeData:()=>G2,encodeType:()=>K2,encodeValue:()=>ll,getDependencies:()=>hb,getMessageHash:()=>fu,getStructHash:()=>Ul,getTypeHash:()=>Y2,isMerkleTreeType:()=>W2,prepareSelector:()=>H2,validateTypedData:()=>Ah,verifyMessage:()=>kL});var mL={};Se(mL,{MerkleTree:()=>fb,proofMerklePath:()=>z2});var fb=class md{leaves;branches=[];root;hashMethod;constructor(t,n=Dl){this.hashMethod=n,this.leaves=t,this.root=this.build(t)}build(t){if(t.length===1)return t[0];t.length!==this.leaves.length&&this.branches.push(t);const n=[];for(let r=0;r<t.length;r+=2)r+1===t.length?n.push(md.hash(t[r],"0x0",this.hashMethod)):n.push(md.hash(t[r],t[r+1],this.hashMethod));return this.build(n)}static hash(t,n,r=Dl){const[s,i]=[BigInt(t),BigInt(n)].sort((o,a)=>o>=a?1:-1);return r(s,i)}getProof(t,n=this.leaves,r=[]){const s=n.indexOf(t);if(s===-1)throw new Error("leaf not found");if(n.length===1)return r;const i=s%2===0,o=(i?n[s+1]:n[s-1])??"0x0",a=[...r,o],c=this.leaves.length===n.length?-1:this.branches.findIndex(u=>u.length===n.length),l=this.branches[c+1]??[this.root];return this.getProof(md.hash(i?t:o,i?o:t,this.hashMethod),l,a)}};function z2(e,t,n,r=Dl){if(n.length===0)return e===t;const[s,...i]=n;return z2(e,fb.hash(t,s,r),i,r)}var bL={u256:JSON.parse('[{ "name": "low", "type": "u128" }, { "name": "high", "type": "u128" }]'),TokenAmount:JSON.parse('[{ "name": "token_address", "type": "ContractAddress" }, { "name": "amount", "type": "u256" }]'),NftId:JSON.parse('[{ "name": "collection_address", "type": "ContractAddress" }, { "name": "token_id", "type": "u256" }]')},An={[H.TypedDataRevision.ACTIVE]:{domain:"StarknetDomain",hashMethod:b2,hashMerkleMethod:y2,escapeTypeString:e=>`"${e}"`,presetTypes:bL},[H.TypedDataRevision.LEGACY]:{domain:"StarkNetDomain",hashMethod:m2,hashMerkleMethod:Dl,escapeTypeString:e=>e,presetTypes:{}}};function Gu(e,t,{min:n,max:r}){const s=BigInt(e);I(s>=n&&s<=r,`${s} (${t}) is out of bounds [${n}, ${r}]`)}function q2({types:e,domain:t}){if(An[H.TypedDataRevision.ACTIVE].domain in e&&t.revision?.toString()===H.TypedDataRevision.ACTIVE)return H.TypedDataRevision.ACTIVE;if(An[H.TypedDataRevision.LEGACY].domain in e&&(t.revision??H.TypedDataRevision.LEGACY)===H.TypedDataRevision.LEGACY)return H.TypedDataRevision.LEGACY}function Tr(e){try{return M(e)}catch{if(de(e))return M(ht(e));throw new Error(`Invalid BigNumberish: ${e}`)}}function Ah(e){const t=e;return!!(t.message&&t.primaryType&&t.types&&q2(t))}function H2(e){return Yt(e)?e:We(e)}function W2(e){return e.type==="merkletree"}function hb(e,t,n=[],r="",s=H.TypedDataRevision.LEGACY){let i=[t];return t[t.length-1]==="*"?i=[t.slice(0,-1)]:s===H.TypedDataRevision.ACTIVE&&(t==="enum"?i=[r]:t.match(/^\(.*\)$/)&&(i=t.slice(1,-1).split(",").map(o=>o[o.length-1]==="*"?o.slice(0,-1):o))),i.filter(o=>!n.includes(o)&&e[o]).reduce((o,a)=>[...o,...[a,...e[a].reduce((c,l)=>[...c,...hb(e,l.type,c,l.contains,s).filter(u=>!c.includes(u))],[])].filter(c=>!o.includes(c))],[])}function wL(e,t){if(t.parent&&t.key){const r=e[t.parent].find(i=>i.name===t.key);if(!W2(r))throw new Error(`${t.key} is not a merkle tree`);if(r.contains.endsWith("*"))throw new Error(`Merkle tree contain property must not be an array but was given ${t.key}`);return r.contains}return"raw"}function K2(e,t,n=H.TypedDataRevision.LEGACY){const r=n===H.TypedDataRevision.ACTIVE?{...e,...An[n].presetTypes}:e,[s,...i]=hb(r,t,void 0,void 0,n),o=s?[s,...i.sort()]:[],a=An[n].escapeTypeString;return o.map(c=>{const l=r[c].map(u=>{const d=u.type==="enum"&&n===H.TypedDataRevision.ACTIVE?u.contains:u.type,f=d.match(/^\(.*\)$/)?`(${d.slice(1,-1).split(",").map(h=>h&&a(h)).join(",")})`:a(d);return`${a(u.name)}:${f}`});return`${a(c)}(${l})`}).join("")}function Y2(e,t,n=H.TypedDataRevision.LEGACY){return We(K2(e,t,n))}function ll(e,t,n,r={},s=H.TypedDataRevision.LEGACY){if(e[t])return[t,Ul(e,t,n,s)];if(An[s].presetTypes[t])return[t,Ul(An[s].presetTypes,t,n,s)];if(t.endsWith("*")){const i=n.map(o=>ll(e,t.slice(0,-1),o,void 0,s)[1]);return[t,An[s].hashMethod(i)]}switch(t){case"enum":{if(s===H.TypedDataRevision.ACTIVE){const[i,o]=Object.entries(n)[0],a=e[r.parent].find(f=>f.name===r.key),c=e[a.contains],l=c.find(f=>f.name===i),u=c.indexOf(l),d=l.type.slice(1,-1).split(",").map((f,h)=>{if(!f)return f;const p=o[h];return ll(e,f,p,void 0,s)[1]});return[t,An[s].hashMethod([u,...d])]}return[t,Tr(n)]}case"merkletree":{const i=wL(e,r),o=n.map(c=>ll(e,i,c,void 0,s)[1]),{root:a}=new fb(o,An[s].hashMerkleMethod);return["felt",a]}case"selector":return["felt",H2(n)];case"string":{if(s===H.TypedDataRevision.ACTIVE){const i=Qm(n),o=[i.data.length,...i.data,i.pending_word,i.pending_word_len];return[t,An[s].hashMethod(o)]}return[t,Tr(n)]}case"i128":{if(s===H.TypedDataRevision.ACTIVE){const i=BigInt(n);return Gu(i,t,Fo),[t,Tr(i<0n?rt+i:i)]}return[t,Tr(n)]}case"timestamp":case"u128":return s===H.TypedDataRevision.ACTIVE&&Gu(n,t,Po),[t,Tr(n)];case"felt":case"shortstring":return s===H.TypedDataRevision.ACTIVE&&Gu(Tr(n),t,tf),[t,Tr(n)];case"ClassHash":case"ContractAddress":return s===H.TypedDataRevision.ACTIVE&&Gu(n,t,tf),[t,Tr(n)];case"bool":return s===H.TypedDataRevision.ACTIVE&&I(Cl(n),`Type mismatch for ${t} ${n}`),[t,Tr(n)];default:{if(s===H.TypedDataRevision.ACTIVE)throw new Error(`Unsupported type: ${t}`);return[t,Tr(n)]}}}function G2(e,t,n,r=H.TypedDataRevision.LEGACY){const s=e[t]??An[r].presetTypes[t],[i,o]=s.reduce(([a,c],l)=>{if(n[l.name]===void 0||n[l.name]===null&&l.type!=="enum")throw new Error(`Cannot encode data: missing data for '${l.name}'`);const u=n[l.name],d={parent:t,key:l.name},[f,h]=ll(e,l.type,u,d,r);return[[...a,f],[...c,h]]},[["felt"],[Y2(e,t,r)]]);return[i,o]}function Ul(e,t,n,r=H.TypedDataRevision.LEGACY){return An[r].hashMethod(G2(e,t,n,r)[1])}function fu(e,t){if(!Ah(e))throw new Error("Typed data does not match JSON schema");const n=q2(e),{domain:r,hashMethod:s}=An[n],i=[ht("StarkNet Message"),Ul(e.types,r,e.domain,n),t,Ul(e.types,e.primaryType,e.message,n)];return s(i)}function kL(e,t,n,r){const s=Ah(e);if(!Ji(e)&&!s)throw new Error("message has a wrong format.");if(s&&r===void 0)throw new Error("When providing a TypedData in message parameter, the accountAddress parameter has to be provided.");if(s&&!Ji(r))throw new Error("accountAddress shall be a BigNumberish");const i=s?fu(e,r):M(e),o=Array.isArray(t)?new rl(BigInt(t[0]),BigInt(t[1])):t,a=M(n);return Sv(o,i,a)}async function EL(e,t,n,r,s,i){const o=Ah(t);if(!Ji(t)&&!o)throw new Error("message has a wrong format.");if(!Ji(r))throw new Error("accountAddress shall be a BigNumberish");const a=o?fu(t,r):M(t),c=s?[s]:["isValidSignature","is_valid_signature"],l=i||{okResponse:[],nokResponse:["0x0","0x00"],error:["argent/invalid-signature","0x617267656e742f696e76616c69642d7369676e6174757265","is invalid, with respect to the public key","0x697320696e76616c6964","INVALID_SIG","0x494e56414c49445f534947"]};let u;for(const d of c)try{const f=await e.callContract({contractAddress:M(r),entrypoint:d,calldata:ye.compile({hash:Pt(a).toString(),signature:du(n)})});if(l.nokResponse.includes(f[0].toString()))return!1;if(l.okResponse.length===0||l.okResponse.includes(f[0].toString()))return!0;throw Error("signatureVerificationResponse Error: response is not part of known responses")}catch(f){if(l.error.some(h=>f.message.includes(h)))return!1;u=f}throw Error(`Signature verification Error: ${u}`)}async function TL(e,t=e.blockIdentifier){const n=await e.getBlockWithTxHashes(t);return{l1DataGasPrice:BigInt(n.l1_data_gas_price.price_in_fri),l1GasPrice:BigInt(n.l1_gas_price.price_in_fri),l2GasPrice:BigInt(n.l2_gas_price.price_in_fri)}}var Z2=class{responseParser;channel;constructor(e){if(e&&"channel"in e)this.channel=e.channel,this.responseParser="responseParser"in e?e.responseParser:new bk;else{const t=e;if(t&&t.specVersion)if(rs("0.8",t.specVersion))this.channel=new Fc.RpcChannel({...t,waitMode:!1});else if(rs("0.9",t.specVersion))this.channel=new Ei.RpcChannel({...t,waitMode:!1});else throw new Error(`unsupported channel for spec version: ${t.specVersion}`);else if(rs("0.8",Gn.get("rpcVersion")))this.channel=new Fc.RpcChannel({...t,waitMode:!1});else if(rs("0.9",Gn.get("rpcVersion")))this.channel=new Ei.RpcChannel({...t,waitMode:!1});else throw new Error("unable to define spec version for channel");this.responseParser=new bk(t?.resourceBoundsOverhead)}}static async create(e){const n=await new Fc.RpcChannel({...e}).getSpecVersion();if(lb(n)||Rt.warn(`Using incompatible node spec version ${n}`),rs("0.8",n))return new this({...e,specVersion:Ls.v0_8_1});if(rs("0.9",n))return new this({...e,specVersion:Ls.v0_9_0});throw new Bt(`Provided RPC node specification version ${n} is not compatible with the SDK. SDK supported RPC versions ${Object.keys(Ls).toString()}`)}fetch(e,t,n=0){return this.channel.fetch(e,t,n)}async getChainId(){return this.channel.getChainId()}readSpecVersion(){return this.channel.readSpecVersion()}async getSpecVersion(){return this.channel.getSpecVersion()}setUpSpecVersion(){return this.channel.setUpSpecVersion()}async getNonceForAddress(e,t){return this.channel.getNonceForAddress(e,t)}async getBlock(e){return this.channel.getBlockWithTxHashes(e).then(this.responseParser.parseGetBlockResponse)}async getBlockLatestAccepted(){return this.channel.getBlockLatestAccepted()}async getBlockNumber(){return this.channel.getBlockNumber()}async getBlockWithTxHashes(e){return this.channel.getBlockWithTxHashes(e)}async getBlockWithTxs(e){return this.channel.getBlockWithTxs(e)}async waitForBlock(e=fr.LATEST,t=5e3){if(e===fr.LATEST||e==="pending")return;const n=await this.getBlockNumber(),r=e===fr.PRE_CONFIRMED?n+1:Number(M(e));if(r<=n)return;const{retries:s}=this.channel;let i=s,o=!1;for(;!o;)if(await this.getBlockNumber()===r?o=!0:await Ns(t),i-=1,i<=0)throw new Error(`waitForBlock() timed-out after ${s} tries.`)}async getL1GasPrice(e){return this.channel.getBlockWithTxHashes(e).then(this.responseParser.parseL1GasPriceResponse)}async getGasPrices(e=this.channel.blockIdentifier){if(this.channel instanceof Ei.RpcChannel)return TL(this.channel,e);throw new Bt("Unsupported method for RPC version")}async getL1MessageHash(e){const t=await this.channel.getTransactionByHash(e);I(t.type==="L1_HANDLER","This L2 transaction is not a L1 message.");const{calldata:n,contract_address:r,entry_point_selector:s,nonce:i}=t,o=[n[0],r,i,s,n.length-1,...n.slice(1)];return au(o)}async getBlockWithReceipts(e){return this.channel.getBlockWithReceipts(e)}getStateUpdate=this.getBlockStateUpdate;async getBlockStateUpdate(e){return this.channel.getBlockStateUpdate(e)}async getBlockTransactionsTraces(e){return this.channel.getBlockTransactionsTraces(e)}async getBlockTransactionCount(e){return this.channel.getBlockTransactionCount(e)}async getTransaction(e){return this.channel.getTransactionByHash(e)}async getTransactionByHash(e){return this.channel.getTransactionByHash(e)}async getTransactionByBlockIdAndIndex(e,t){return this.channel.getTransactionByBlockIdAndIndex(e,t)}async getTransactionReceipt(e){const t=await this.channel.getTransactionReceipt(e),n=this.responseParser.parseTransactionReceipt(t);return Ek(n)}async getTransactionTrace(e){return this.channel.getTransactionTrace(e)}async getTransactionStatus(e){return this.channel.getTransactionStatus(e)}async getSimulateTransaction(e,t){return this.channel.simulateTransaction(e,t).then(n=>this.responseParser.parseSimulateTransactionResponse(n))}async waitForTransaction(e,t){const n=await this.channel.waitForTransaction(e,t);return Ek(n)}async fastWaitForTransaction(e,t,n,r){if(this.channel instanceof Ei.RpcChannel)return await this.channel.fastWaitForTransaction(e,t,n,r);throw new Error("Unsupported channel type")}async getStorageAt(e,t,n){return this.channel.getStorageAt(e,t,n)}async getClassHashAt(e,t){return this.channel.getClassHashAt(e,t)}async getClassByHash(e){return this.getClass(e)}async getClass(e,t){return this.channel.getClass(e,t).then(this.responseParser.parseContractClassResponse)}async getClassAt(e,t){return this.channel.getClassAt(e,t).then(this.responseParser.parseContractClassResponse)}async getContractVersion(e,t,{blockIdentifier:n=this.channel.blockIdentifier,compiler:r=!0}={}){let s;if(e)s=await this.getClassAt(e,n);else if(t)s=await this.getClass(t,n);else throw Error("getContractVersion require contractAddress or classHash");return cs(s)?r?{cairo:"1",compiler:nb(s.abi).compiler}:{cairo:"1",compiler:void 0}:{cairo:"0",compiler:"0"}}async getInvokeEstimateFee(e,t,n,r){return(await this.getEstimateFeeBulk([{type:H.ETransactionType.INVOKE,...e,...t}],{blockIdentifier:n,skipValidate:r}))[0]}async getDeclareEstimateFee(e,t,n,r){return(await this.getEstimateFeeBulk([{type:H.ETransactionType.DECLARE,...e,...t}],{blockIdentifier:n,skipValidate:r}))[0]}async getDeployAccountEstimateFee(e,t,n,r){return(await this.getEstimateFeeBulk([{type:H.ETransactionType.DEPLOY_ACCOUNT,...e,...t}],{blockIdentifier:n,skipValidate:r}))[0]}async getEstimateFeeBulk(e,t){return this.channel.getEstimateFee(e,t).then(n=>this.responseParser.parseFeeEstimateBulkResponse(n))}async invokeFunction(e,t){return this.channel.invoke(e,t)}async declareContract(e,t){return this.channel.declare(e,t)}async deployAccountContract(e,t){return this.channel.deployAccount(e,t)}async callContract(e,t){return this.channel.callContract(e,t)}async estimateMessageFee(e,t){return this.channel.estimateMessageFee(e,t)}async getSyncingStats(){return this.channel.getSyncingStats()}async getEvents(e){if(this.channel instanceof Fc.RpcChannel)return this.channel.getEvents(e);if(this.channel instanceof Ei.RpcChannel)return this.channel.getEvents(e);throw new Error("Unsupported channel type")}async verifyMessageInStarknet(e,t,n,r,s){return EL(this,e,t,n,r,s)}async isClassDeclared(e,t){let n;if(!e.classHash&&"contract"in e)n=zo(e).classHash;else if(e.classHash)n=e.classHash;else throw Error("contractClassIdentifier type not satisfied");try{return await this.getClass(n,t)instanceof Object}catch(r){if(r instanceof Bt)return!1;throw r}}async prepareInvocations(e){const t=[];for(const n of e)n.type===H.ETransactionType.DECLARE?await this.isClassDeclared("payload"in n?n.payload:n)||t.unshift(n):t.push(n);return t}async getL1MessagesStatus(e){return this.channel.getMessagesStatus(e)}async getStorageProof(e,t,n,r){return this.channel.getStorageProof(e,t,n,r)}async getCompiledCasm(e){return this.channel.getCompiledCasm(e)}async getEstimateTip(e,t={}){return gL(this,e,t)}},vL={};Se(vL,{StarknetIdContract:()=>T_,StarknetIdIdentityContract:()=>v_,StarknetIdMulticallContract:()=>S_,StarknetIdPfpContract:()=>I_,StarknetIdPopContract:()=>N_,StarknetIdVerifierContract:()=>A_,dynamicCallData:()=>me,dynamicFelt:()=>Et,execution:()=>vr,getStarknetIdContract:()=>bd,getStarknetIdIdentityContract:()=>J2,getStarknetIdMulticallContract:()=>X2,getStarknetIdPfpContract:()=>eA,getStarknetIdPopContract:()=>tA,getStarknetIdVerifierContract:()=>Q2,isStarkDomain:()=>nA,useDecoded:()=>pf,useEncoded:()=>pb});var Ur="abcdefghijklmnopqrstuvwxyz0123456789-",qo=BigInt(Ur.length+1),ft="这来",Tk=BigInt(Ur.length),k_=BigInt(ft.length),vk=BigInt(ft.length+1);function E_(e){let t=0;for(;e.endsWith(ft[ft.length-1]);)e=e.substring(0,e.length-1),t+=1;return[e,t]}function pf(e){let t="";return e.forEach(n=>{for(;n!==un;){const i=n%qo;if(n/=qo,i===BigInt(Ur.length)){const o=n/vk;if(o===un){const a=n%vk;n=o,a===un?t+=Ur[0]:t+=ft[Number(a)-1]}else{const a=n%k_;t+=ft[Number(a)],n/=k_}}else t+=Ur[Number(i)]}const[r,s]=E_(t);s&&(t=r+(s%2===0?ft[ft.length-1].repeat(s/2-1)+ft[0]+Ur[1]:ft[ft.length-1].repeat((s-1)/2+1))),t+="."}),t&&t.concat("stark")}function pb(e){let t=BigInt(0),n=BigInt(1);if(e.endsWith(ft[0]+Ur[1])){const[r,s]=E_(e.substring(0,e.length-2));e=r+ft[ft.length-1].repeat(2*(s+1))}else{const[r,s]=E_(e);s&&(e=r+ft[ft.length-1].repeat(1+2*(s-1)))}for(let r=0;r<e.length;r+=1){const s=e[r],i=Ur.indexOf(s),o=BigInt(Ur.indexOf(s));if(i!==-1)r===e.length-1&&e[r]===Ur[0]?(t+=n*Tk,n*=qo,n*=qo):(t+=n*o,n*=qo);else if(ft.indexOf(s)!==-1){t+=n*Tk,n*=qo;const a=(r===e.length-1?1:0)+ft.indexOf(s);t+=n*BigInt(a),n*=k_}}return t}var T_={MAINNET:"0x6ac597f8116f886fa1c97a23fa4e08299975ecaf6b598873ca6792b9bbfb678",TESTNET_SEPOLIA:"0x154bc2e1af9260b9e66af0e9c46fc757ff893b3ff6a85718a810baf1474"};function bd(e){switch(e){case fn.SN_MAIN:return T_.MAINNET;case fn.SN_SEPOLIA:return T_.TESTNET_SEPOLIA;default:throw new Error("Starknet.id is not yet deployed on this network")}}var v_={MAINNET:"0x05dbdedc203e92749e2e746e2d40a768d966bd243df04a6b712e222bc040a9af",TESTNET_SEPOLIA:"0x3697660a0981d734780731949ecb2b4a38d6a58fc41629ed611e8defda"};function J2(e){switch(e){case fn.SN_MAIN:return v_.MAINNET;case fn.SN_SEPOLIA:return v_.TESTNET_SEPOLIA;default:throw new Error("Starknet.id verifier contract is not yet deployed on this network")}}var S_="0x034ffb8f4452df7a613a0210824d6414dbadcddce6c6e19bf4ddc9e22ce5f970";function X2(e){switch(e){case fn.SN_MAIN:return S_;case fn.SN_SEPOLIA:return S_;default:throw new Error("Starknet.id multicall contract is not yet deployed on this network")}}var A_={MAINNET:"0x07d14dfd8ee95b41fce179170d88ba1f0d5a512e13aeb232f19cfeec0a88f8bf",TESTNET_SEPOLIA:"0x60B94fEDe525f815AE5E8377A463e121C787cCCf3a36358Aa9B18c12c4D566"};function Q2(e){switch(e){case fn.SN_MAIN:return A_.MAINNET;case fn.SN_SEPOLIA:return A_.TESTNET_SEPOLIA;default:throw new Error("Starknet.id verifier contract is not yet deployed on this network")}}var I_={MAINNET:"0x070aaa20ec4a46da57c932d9fd89ca5e6bb9ca3188d3df361a32306aff7d59c7",TESTNET_SEPOLIA:"0x9e7bdb8dabd02ea8cfc23b1d1c5278e46490f193f87516ed5ff2dfec02"};function eA(e){switch(e){case fn.SN_MAIN:return I_.MAINNET;case fn.SN_SEPOLIA:return I_.TESTNET_SEPOLIA;default:throw new Error("Starknet.id profile picture verifier contract is not yet deployed on this network")}}var N_={MAINNET:"0x0293eb2ba9862f762bd3036586d5755a782bd22e6f5028320f1d0405fd47bff4",TESTNET_SEPOLIA:"0x15ae88ae054caa74090b89025c1595683f12edf7a4ed2ad0274de3e1d4a"};function tA(e){switch(e){case fn.SN_MAIN:return N_.MAINNET;case fn.SN_SEPOLIA:return N_.TESTNET_SEPOLIA;default:throw new Error("Starknet.id proof of personhood verifier contract is not yet deployed on this network")}}function vr(e,t=void 0,n=void 0){return new nc({Static:e,IfEqual:t?Sa(t[0],t[1],t[2]):void 0,IfNotEqual:n?Sa(n[0],n[1],n[2]):void 0})}function Et(e,t=void 0){return new nc({Hardcoded:e,Reference:t?Sa(t[0],t[1]):void 0})}function me(e,t=void 0,n=void 0){return new nc({Hardcoded:e,Reference:t?Sa(t[0],t[1]):void 0,ArrayReference:n?Sa(n[0],n[1]):void 0})}function nA(e){return/^(?:[a-z0-9-]{1,48}(?:[a-z0-9-]{1,48}[a-z0-9-])?\.)*[a-z0-9-]{1,48}\.stark$/.test(e)}var SL=class wd{async getStarkName(t,n){return wd.getStarkName(this,t,n)}async getAddressFromStarkName(t,n){return wd.getAddressFromStarkName(this,t,n)}async getStarkProfile(t,n,r,s,i,o,a){return wd.getStarkProfile(this,t,n,r,s,i,o,a)}static async getStarkName(t,n,r){const s=await t.getChainId(),i=r??bd(s);try{const a=(await t.callContract({contractAddress:i,entrypoint:"address_to_domain",calldata:ye.compile({address:n,hint:[]})})).map(l=>BigInt(l)).slice(1),c=pf(a);if(!c)throw Error("Starkname not found");return c}catch(o){throw o instanceof Error&&o.message==="Starkname not found"?o:Error("Could not get stark name")}}static async getAddressFromStarkName(t,n,r){const s=n.endsWith(".stark")?n:`${n}.stark`;if(!nA(s))throw new Error("Invalid domain, must be a valid .stark domain");const i=await t.getChainId(),o=r??bd(i);try{const a=s.replace(".stark","").split(".").map(l=>pb(l).toString(10));return(await t.callContract({contractAddress:o,entrypoint:"domain_to_address",calldata:ye.compile({domain:a,hint:[]})}))[0]}catch{throw Error("Could not get address from stark name")}}static async getStarkProfile(t,n,r,s,i,o,a,c){const l=await t.getChainId(),u=r??bd(l),d=s??J2(l),f=i??Q2(l),h=o??eA(l),p=a??tA(l),_=c??X2(l);try{const g=[{execution:vr({}),to:me(u),selector:me(We("address_to_domain")),calldata:[me(n),me("0")]},{execution:vr({}),to:Et(u),selector:Et(We("domain_to_id")),calldata:[me(void 0,void 0,[0,0])]},{execution:vr({}),to:Et(d),selector:Et(We("get_verifier_data")),calldata:[me(void 0,[1,0]),me(ht("twitter")),me(f),me("0")]},{execution:vr({}),to:Et(d),selector:Et(We("get_verifier_data")),calldata:[me(void 0,[1,0]),me(ht("github")),me(f),me("0")]},{execution:vr({}),to:Et(d),selector:Et(We("get_verifier_data")),calldata:[me(void 0,[1,0]),me(ht("discord")),me(f),me("0")]},{execution:vr({}),to:Et(d),selector:Et(We("get_verifier_data")),calldata:[me(void 0,[1,0]),me(ht("proof_of_personhood")),me(p),me("0")]},{execution:vr({}),to:Et(d),selector:Et(We("get_verifier_data")),calldata:[me(void 0,[1,0]),me(ht("nft_pp_contract")),me(h),me("0")]},{execution:vr({}),to:Et(d),selector:Et(We("get_extended_verifier_data")),calldata:[me(void 0,[1,0]),me(ht("nft_pp_id")),me("2"),me(h),me("0")]},{execution:vr(void 0,void 0,[6,0,0]),to:Et(void 0,[6,0]),selector:Et(We("tokenURI")),calldata:[me(void 0,[7,1]),me(void 0,[7,2])]}],y=await t.callContract({contractAddress:_,entrypoint:"aggregate",calldata:ye.compile({calls:g})});if(Array.isArray(y)){const w=parseInt(y[0],16),k=[];let b=1;for(let z=0;z<w&&b<y.length;z+=1){const J=parseInt(y[b],16);b+=1;const R=y.slice(b,b+J);k.push(R),b+=J}const N=pf(k[0].slice(1).map(z=>BigInt(z))),S=k[2][0]!=="0x0"?BigInt(k[2][0]).toString():void 0,E=k[3][0]!=="0x0"?BigInt(k[3][0]).toString():void 0,A=k[4][0]!=="0x0"?BigInt(k[4][0]).toString():void 0,x=k[5][0]==="0x1",B=(y[0]==="0x9"?k[8].slice(1).map(z=>Ta(z)).join(""):void 0)||`https://starknet.id/api/identicons/${BigInt(k[1][0]).toString()}`;return{name:N,twitter:S,github:E,discord:A,proofOfPersonhood:x,profilePicture:B}}throw Error("Error while calling aggregate function")}catch(g){throw g instanceof Error?g:Error("Could not get user stark profile data from address")}}};function AL(e){return e.endsWith(".brother")}function Sk(e){const t=e.endsWith(".brother")?e.replace(".brother",""):e;return pb(t)}function Ak(e){const t=pf([e]);return t.endsWith(".stark")?t.replace(".stark",".brother"):t&&`${t}.brother`}function Zp(e){switch(e){case fn.SN_MAIN:return"0x0212f1c57700f5a3913dd11efba540196aad4cf67772f7090c62709dd804fa74";default:return"0x0212f1c57700f5a3913dd11efba540196aad4cf67772f7090c62709dd804fa74"}}var IL=class kd{async getBrotherName(t,n){return kd.getBrotherName(this,t,n)}async getAddressFromBrotherName(t,n){return kd.getAddressFromBrotherName(this,t,n)}async getBrotherProfile(t,n){return kd.getBrotherProfile(this,t,n)}static async getBrotherName(t,n,r){const s=await t.getChainId(),i=r??Zp(s);try{const o=await t.callContract({contractAddress:i,entrypoint:"getPrimary",calldata:ye.compile({user:n})});if(!o[0]||o[0]==="0x0")throw Error("Brother name not found");const a=BigInt(o[0]);return Ak(a)}catch(o){throw o instanceof Error&&o.message==="Brother name not found"?o:Error("Could not get brother name")}}static async getAddressFromBrotherName(t,n,r){const s=n.endsWith(".brother")?n:`${n}.brother`;if(!AL(s))throw new Error("Invalid domain, must be a valid .brother domain");const i=await t.getChainId(),o=r??Zp(i);try{const a=await t.callContract({contractAddress:o,entrypoint:"get_details_by_domain",calldata:ye.compile({domain:Sk(s)})});if(!a[0]||a[1]==="0x0")throw Error("Could not get address from brother name");return a[1]}catch{throw Error("Could not get address from brother name")}}static async getBrotherProfile(t,n,r){const s=await t.getChainId(),i=r??Zp(s);try{const o=await t.callContract({contractAddress:i,entrypoint:"getPrimary",calldata:ye.compile({user:n})});if(!o[0]||o[0]==="0x0")throw Error("Brother profile not found");const a=BigInt(o[0]),l=Ak(a).replace(".brother",""),u=await t.callContract({contractAddress:i,entrypoint:"get_details_by_domain",calldata:ye.compile({domain:Sk(l)})});return{name:l,resolver:u[1],tokenId:u[2],expiryDate:parseInt(u[3],16),lastTransferTime:parseInt(u[4],16)}}catch(o){throw o instanceof Error&&o.message==="Brother profile not found"?o:Error("Could not get brother profile")}}},NL=class extends pM(Z2,SL,IL){};new Z2({default:!0});var xL=class{pk;constructor(e=$m.randomPrivateKey()){this.pk=e instanceof Uint8Array?fo(e):M(e)}async getPubKey(){return Mm(this.pk)}async signMessage(e,t){const n=fu(e,t);return this.signRaw(n)}async signTransaction(e,t){const n=ub(e,t.cairoVersion);let r;if(Object.values(H.ETransactionVersion3).includes(t.version)){const s=t;r=p2({...s,senderAddress:s.walletAddress,compiledCalldata:n,version:s.version,nonceDataAvailabilityMode:yi(s.nonceDataAvailabilityMode),feeDataAvailabilityMode:yi(s.feeDataAvailabilityMode)})}else throw Error("unsupported signTransaction version");return this.signRaw(r)}async signDeployAccountTransaction(e){const t=ye.compile(e.constructorCalldata);let n;if(Object.values(H.ETransactionVersion3).includes(e.version)){const r=e;n=_2({...r,salt:r.addressSalt,compiledConstructorCalldata:t,version:r.version,nonceDataAvailabilityMode:yi(r.nonceDataAvailabilityMode),feeDataAvailabilityMode:yi(r.feeDataAvailabilityMode)})}else throw Error("unsupported signDeployAccountTransaction version");return this.signRaw(n)}async signDeclareTransaction(e){let t;if(Object.values(H.ETransactionVersion3).includes(e.version)){const n=e;t=g2({...n,version:n.version,nonceDataAvailabilityMode:yi(n.nonceDataAvailabilityMode),feeDataAvailabilityMode:yi(n.feeDataAvailabilityMode)})}else throw Error("unsupported signDeclareTransaction version");return this.signRaw(t)}async signRaw(e){return vv(e,this.pk)}},RL={};Se(RL,{bnToUint256:()=>BL,isUint256:()=>OL,uint256ToBN:()=>CL});function CL(e){return new Ot(e).toBigInt()}function OL(e){return Ot.is(e)}function BL(e){return new Ot(e).toUint256HexString()}function x_(e){const t=M(de(e)?Y(e):e),n=an(t).padStart(64,"0");return Y(n)}var $L={};Se($L,{buildExecuteFromOutsideCall:()=>iA,buildExecuteFromOutsideCallData:()=>sA,getOutsideCall:()=>gb,getTypedData:()=>rA,toOutsideCallV2:()=>Ih});function Ih(e){return"calldata_len"in e?{To:e.to,Selector:e.selector,Calldata:e.calldata}:e}function gb(e){const t=e.calldata??[],n=Array.isArray(t)?t:ye.compile(t);return{to:e.contractAddress,selector:We(e.entrypoint),calldata:n}}function Ik(e,t){const n=gb(e);return t==="1"?{...n,calldata_len:n.calldata.length,calldata:n.calldata}:{To:n.to,Selector:n.selector,Calldata:n.calldata}}function Nk(e,t){return{name:"Account.execute_from_outside",version:t,chainId:e,...t==="2"?{revision:"1"}:{}}}function rA(e,t,n,r,s){return s==="1"?{types:DM,primaryType:"OutsideExecution",domain:Nk(e,s),message:{...t,nonce:n,calls_len:r.length,calls:r.map(i=>Ik(i,s))}}:{types:MM,primaryType:"OutsideExecution",domain:Nk(e,s),message:{Caller:t.caller,Nonce:n,"Execute After":t.execute_after,"Execute Before":t.execute_before,Calls:r.map(i=>Ik(i,s))}}}function sA(e){const t=e.outsideExecution,n=du(e.signature);return ye.compile({outside_execution:t,signature:n})}function iA(e){return(Array.isArray(e)?e:[e]).map(r=>{let s;if(r.version===jo.V1)s="execute_from_outside";else if(r.version===jo.V2)s="execute_from_outside_v2";else throw new Error("Unsupported OutsideExecution version");return{contractAddress:M(r.signerAddress),entrypoint:s,calldata:sA(r)}})}var DL={};Se(DL,{supportsInterface:()=>R_});async function R_(e,t,n){const r={contractAddress:M(t),entrypoint:"supports_interface",calldata:[M(n)]};try{const s=await e.callContract(r);return BigInt(s[0])!==0n}catch{return!1}}var ML={};Se(ML,{assertCallsAreStrictlyEqual:()=>oA,assertPaymasterTransactionSafety:()=>aA,getDefaultPaymasterNodeUrl:()=>Ed});var Ed=(e,t=!1)=>{t||Rt.info("Using default public node url, please provide nodeUrl in provider options!");const n=PS[e??tc.SN_SEPOLIA],r=Math.floor(Math.random()*n.length);return n[r]},LL=(e,t)=>{const n=Ih(e[e.length-1]),s=ye.toCalldata(n.Calldata)[1];I(BigInt(s)===BigInt(t),"Gas token value is not equal to the provided gas fees")},UL=(e,t)=>{const n=Ih(e[e.length-1]);I(BigInt(n.To)===BigInt(t),"Gas token address is not equal to the provided gas token")};function oA(e,t){const n="Provided calls are not strictly equal to the returned calls";I(t.length-1===e.length,`${n}: Expected ${e.length+1} calls, got ${t.length}`);for(let r=0;r<e.length;r+=1){const s=e[r],i=Ih(t[r]),o=d=>Pt(d).toString(16).toLowerCase(),a=o(s.contractAddress),c=o(i.To);I(a===c,`${n}: Contract address mismatch at call ${r}. Expected: ${s.contractAddress}, Got: ${i.To}`),I(We(s.entrypoint)===i.Selector,`${n}: Entrypoint mismatch at call ${r}. Expected: ${s.entrypoint}, Got: ${i.Selector}`);const l=ye.toCalldata(s.calldata),u=ye.toCalldata(i.Calldata);I(l.length===u.length,`${n}: Calldata length mismatch at call ${r}. Expected length: ${l.length}, Got length: ${u.length}`);for(let d=0;d<l.length;d+=1){const f=BigInt(l[d]),h=BigInt(u[d]);I(f===h,`${n}: Calldata value mismatch at call ${r}, parameter ${d}. Expected: ${l[d]}, Got: ${u[d]}`)}}}var aA=(e,t,n,r)=>{if(n.feeMode.mode!=="sponsored"&&(e.type==="invoke"||e.type==="deploy_and_invoke")){const s="calls"in e.typed_data.message?e.typed_data.message.calls:e.typed_data.message.Calls;oA(t,s),UL(s,n.feeMode.gasToken),r&&(I(e.fee.suggested_max_fee_in_gas_token<=r,"Gas token price is too high"),LL(s,e.fee.suggested_max_fee_in_gas_token))}},xk=e=>e.map(t=>({to:t.contractAddress,selector:We(t.entrypoint),calldata:ye.toHex(t.calldata)})),Rk=e=>e.mode==="sponsored"?{mode:"sponsored"}:{mode:"default",gas_token:e.gasToken},PL=e=>e.mode==="sponsored"?{mode:"sponsored"}:{mode:"default",gasToken:e.gas_token},Ck=e=>e?{execute_after:e.executeAfter||1,execute_before:e.executeBefore}:void 0,FL=e=>e?{executeAfter:e.execute_after,executeBefore:e.execute_before}:void 0,Jp=e=>({version:e.version,feeMode:PL(e.fee_mode),timeBounds:FL(e.time_bounds)}),Xp={headers:{"Content-Type":"application/json"}},cA=class lA{nodeUrl;headers;baseFetch;requestId;constructor(t){if(t instanceof lA){this.nodeUrl=t.nodeUrl,this.headers={...Xp.headers,...t.headers},this.baseFetch=t.baseFetch,this.requestId=t.requestId;return}if(t&&"nodeUrl"in t&&"headers"in t&&"baseFetch"in t){this.nodeUrl=t.nodeUrl??Ed(void 0),this.headers={...Xp.headers,...t.headers},this.baseFetch=t.baseFetch??hf,this.requestId=0;return}const{nodeUrl:n,headers:r,baseFetch:s}=t||{};n&&Object.values(tc).includes(n)?this.nodeUrl=Ed(n,t?.default):n?this.nodeUrl=n:this.nodeUrl=Ed(void 0,t?.default),this.baseFetch=s??hf,this.headers={...Xp.headers,...r},this.requestId=0}fetch(t,n,r=0){const s={id:r,jsonrpc:"2.0",method:t,...n&&{params:n}};return this.baseFetch(this.nodeUrl,{method:"POST",body:Cn(s),headers:this.headers})}errorHandler(t,n,r,s){if(r)throw new $l(r,t,n);if(s instanceof Bt)throw s;if(s)throw Error(s.message)}async fetchEndpoint(t,n){try{this.requestId+=1;const r=await this.fetch(t,n,this.requestId),{error:s,result:i}=await r.json();return this.errorHandler(t,n,s),i}catch(r){throw this.errorHandler(t,n,r?.response?.data,r),r}}async isAvailable(){return this.fetchEndpoint("paymaster_isAvailable")}async buildTransaction(t,n){let r;switch(t.type){case"invoke":r={...t,invoke:{user_address:t.invoke.userAddress,calls:xk(t.invoke.calls)}};break;case"deploy_and_invoke":r={...t,invoke:{user_address:t.invoke.userAddress,calls:xk(t.invoke.calls)}};break;case"deploy":default:r=t;break}const s={version:n.version,fee_mode:Rk(n.feeMode),time_bounds:Ck(n.timeBounds)},i=await this.fetchEndpoint("paymaster_buildTransaction",{transaction:r,parameters:s}),o={gas_token_price_in_strk:BigInt(i.fee.gas_token_price_in_strk),estimated_fee_in_strk:BigInt(i.fee.estimated_fee_in_strk),estimated_fee_in_gas_token:BigInt(i.fee.estimated_fee_in_gas_token),suggested_max_fee_in_strk:BigInt(i.fee.suggested_max_fee_in_strk),suggested_max_fee_in_gas_token:BigInt(i.fee.suggested_max_fee_in_gas_token)};switch(i.type){case"invoke":return{type:"invoke",typed_data:i.typed_data,parameters:Jp(i.parameters),fee:o};case"deploy_and_invoke":return{type:"deploy_and_invoke",deployment:i.deployment,typed_data:i.typed_data,parameters:Jp(i.parameters),fee:o};case"deploy":default:return{type:"deploy",deployment:i.deployment,parameters:Jp(i.parameters),fee:o}}}async executeTransaction(t,n){let r;switch(t.type){case"invoke":r={...t,invoke:{user_address:t.invoke.userAddress,typed_data:t.invoke.typedData,signature:Lr(t.invoke.signature)}};break;case"deploy_and_invoke":r={...t,invoke:{user_address:t.invoke.userAddress,typed_data:t.invoke.typedData,signature:Lr(t.invoke.signature)}};break;case"deploy":default:r=t;break}const s={version:n.version,fee_mode:Rk(n.feeMode),time_bounds:Ck(n.timeBounds)};return this.fetchEndpoint("paymaster_executeTransaction",{transaction:r,parameters:s})}async getSupportedTokens(){return this.fetchEndpoint("paymaster_getSupportedTokens").then(t=>t.map(n=>({token_address:n.token_address,decimals:n.decimals,priceInStrk:BigInt(n.price_in_strk)})))}},jL=new cA({default:!0}),VL=class{address;entryPoint;constructor(e,t){this.address=e??Rl.ADDRESS,this.entryPoint=t??Rl.ENTRYPOINT}buildDeployerCall(e,t){const n=[].concat(e).map(r=>{const{classHash:s,salt:i,unique:o=!0,constructorCalldata:a=[],abi:c}=r,l=$2(a,()=>{if(c){const d=new ye(c),f=Object.values(a);return d.validate(Vc.DEPLOY,"constructor",f),d.compile("constructor",f)}return ye.compile(a)}),u=i??ab();return{call:{contractAddress:M(this.address),entrypoint:this.entryPoint,calldata:[s,u,KS(o),l.length,...l]},address:al(o?Ja(t,u):u,s,l,o?this.address:0)}});return{calls:n.map(r=>r.call),addresses:n.map(r=>r.address)}}parseDeployerEvent(e){if(!e.events?.length)throw new Error("Deployer emitted event is empty");const t=e.events.find(n=>p_(n.from_address)===p_(M(this.address)))||{data:[]};return{transaction_hash:e.transaction_hash,contract_address:t.data[0],address:t.data[0],deployer:t.data[1],unique:t.data[2],classHash:t.data[3],calldata_len:t.data[4],calldata:t.data.slice(5,5+parseInt(t.data[4],16)),salt:t.data[t.data.length-1]}}},zL=new VL(Rl.ADDRESS,Rl.ENTRYPOINT),qL=class extends NL{signer;address;cairoVersion;transactionVersion;paymaster;deployer;defaultTipType;constructor(t){const{provider:n,address:r,signer:s,cairoVersion:i,transactionVersion:o,paymaster:a,defaultTipType:c}=t;super(n),this.address=r.toLowerCase(),this.signer=de(s)||s instanceof Uint8Array?new xL(s):s,i&&(this.cairoVersion=i.toString()),this.transactionVersion=o??Gn.get("transactionVersion"),this.paymaster=a?new cA(a):jL,this.deployer=t.deployer??zL,this.defaultTipType=c??Gn.get("defaultTipType"),Rt.debug("Account setup",{transactionVersion:this.transactionVersion,cairoVersion:this.cairoVersion,channel:this.channel.id})}static async create(){throw new Bt("Not supported")}async getNonce(t){return super.getNonceForAddress(this.address,t)}async getNonceSafe(t){try{return Pt(t??await this.getNonce())}catch{return 0n}}async getCairoVersion(t){if(!this.cairoVersion){const{cairo:n}=t?await super.getContractVersion(void 0,t):await super.getContractVersion(this.address);this.cairoVersion=n}return this.cairoVersion}async estimateInvokeFee(t,n={}){const r=[{type:H.ETransactionType.INVOKE,payload:[t].flat()}];return(await this.estimateFeeBulk(r,n))[0]}async estimateDeclareFee(t,n={}){I(cs(t.contract),"Declare fee estimation is not supported for Cairo0 contracts");const r=[{type:H.ETransactionType.DECLARE,payload:zo(t)}];return(await this.estimateFeeBulk(r,n))[0]}async estimateAccountDeployFee({classHash:t,addressSalt:n=0,constructorCalldata:r=[],contractAddress:s},i={}){const o=ye.compile(r),a=s??al(n,t,o,0),c=[{type:H.ETransactionType.DEPLOY_ACCOUNT,payload:{classHash:t,constructorCalldata:o,addressSalt:n,contractAddress:a}}];return(await this.estimateFeeBulk(c,i))[0]}async estimateDeployFee(t,n={}){const{calls:r}=this.deployer.buildDeployerCall(t,this.address);return this.estimateInvokeFee(r,n)}async estimateFeeBulk(t,n={}){if(!t.length)throw TypeError("Invocations should be non-empty array");if(n.resourceBounds)return[I2(n.resourceBounds)];const{nonce:r,blockIdentifier:s,version:i,skipValidate:o}=n,a=await this.resolveDetailsWithTip(n),c=await this.accountInvocationsFactory(t,{...Qt(a),versions:[cl(x2(this.transactionVersion)||jc.F3,i)],nonce:r,blockIdentifier:s,skipValidate:o});return super.getEstimateFeeBulk(c,{blockIdentifier:s,skipValidate:o})}async simulateTransaction(t,n={}){if(!t.length)throw TypeError("Invocations should be non-empty array");const{nonce:r,blockIdentifier:s,skipValidate:i=!0,skipExecute:o,version:a}=n,c=await this.resolveDetailsWithTip(n),l=await this.accountInvocationsFactory(t,{...Qt(c),versions:[this.resolveTransactionVersion(a)],nonce:r,blockIdentifier:s,skipValidate:i});return super.getSimulateTransaction(l,{blockIdentifier:s,skipValidate:i,skipExecute:o})}async execute(t,n={}){const r=[t].flat(),s=await this.resolveDetailsWithTip(n),{resourceBounds:i}=n;let o=i;o||(o=(await this.estimateInvokeFee(r,s)).resourceBounds);const c=(await this.accountInvocationsFactory([{type:H.ETransactionType.INVOKE,payload:r}],{...Qt(s),resourceBounds:o,versions:[this.resolveTransactionVersion(n.version)],nonce:n.nonce,skipValidate:!1}))[0];return this.invokeFunction({contractAddress:c.contractAddress,calldata:c.calldata,signature:c.signature},{...Qt(s),resourceBounds:c.resourceBounds,nonce:c.nonce,version:c.version})}async fastExecute(t,n={},r={}){I(this.channel instanceof Ei.RpcChannel,"Wrong Rpc version in Provider. At least Rpc v0.9 required."),I(this.channel.blockIdentifier===fr.PRE_CONFIRMED,"Provider needs to be initialized with `pre_confirmed` blockIdentifier option.");const s=BigInt(n.nonce??await this.getNonceForAddress(this.address,fr.PRE_CONFIRMED)),i={...n,nonce:s},o=await this.execute(t,i),a=await this.fastWaitForTransaction(o.transaction_hash,this.address,s,r);return{txResult:o,isReady:a}}async declareIfNot(t,n={}){const r=zo(t);try{await this.getClassByHash(r.classHash)}catch{return this.declare(t,n)}return{transaction_hash:"",class_hash:r.classHash}}async declare(t,n={}){I(cs(t.contract),Qe.declareNonSierra);const r=zo(t),s=await this.resolveDetailsWithTip(n),{resourceBounds:i}=n;let o=i;o||(o=(await this.estimateDeclareFee(t,s)).resourceBounds);const c=(await this.accountInvocationsFactory([{type:H.ETransactionType.DECLARE,payload:r}],{...Qt(s),resourceBounds:o,versions:[this.resolveTransactionVersion(n.version)],nonce:n.nonce,skipValidate:!1}))[0];return super.declareContract({senderAddress:c.senderAddress,signature:c.signature,contract:c.contract,compiledClassHash:c.compiledClassHash},{...Qt(s),nonce:c.nonce,resourceBounds:c.resourceBounds,version:c.version})}async deploy(t,n={}){const{calls:r,addresses:s}=this.deployer.buildDeployerCall(t,this.address);return{...await this.execute(r,n),contract_address:s}}async deployContract(t,n={}){const r=await this.deploy(t,n),s=await this.waitForTransaction(r.transaction_hash,n);return this.deployer.parseDeployerEvent(s)}async declareAndDeploy(t,n={}){let r=await this.declareIfNot(t,n);if(r.transaction_hash!==""){const i=await this.waitForTransaction(r.transaction_hash,n);r={...r,...i}}const s=await this.deployContract({...t,classHash:r.class_hash},n);return{declare:{...r},deploy:s}}deploySelf=this.deployAccount;async deployAccount({classHash:t,constructorCalldata:n=[],addressSalt:r=0,contractAddress:s},i={}){const o=ye.compile(n),a=s??al(r,t,o,0),c=await this.resolveDetailsWithTip(i),{resourceBounds:l}=i;let u=l;u||(u=(await this.estimateAccountDeployFee({classHash:t,constructorCalldata:n,addressSalt:r,contractAddress:a},c)).resourceBounds);const f=(await this.accountInvocationsFactory([{type:H.ETransactionType.DEPLOY_ACCOUNT,payload:{classHash:t,constructorCalldata:o,addressSalt:r,contractAddress:a}}],{...Qt(c),resourceBounds:u,versions:[this.resolveTransactionVersion(i.version)],nonce:un,skipValidate:!1}))[0];return super.deployAccountContract({classHash:f.classHash,addressSalt:f.addressSalt,constructorCalldata:f.constructorCalldata,signature:f.signature},{...Qt(c),nonce:f.nonce,resourceBounds:f.resourceBounds,version:f.version})}async signMessage(t){return this.signer.signMessage(t,this.address)}async hashMessage(t){return fu(t,this.address)}async getSnip9Version(){return await R_(this,this.address,MS)?jo.V2:await R_(this,this.address,DS)?jo.V1:jo.UNSUPPORTED}async isValidSnip9Nonce(t){try{const n={contractAddress:this.address,entrypoint:"is_valid_outside_execution_nonce",calldata:[M(t)]},r=await this.callContract(n);return BigInt(r[0])!==0n}catch(n){throw new Error(`Failed to check if nonce is valid: ${n}`)}}async getSnip9Nonce(){const t=ab();return await this.isValidSnip9Nonce(t)?t:this.getSnip9Nonce()}async getOutsideTransaction(t,n,r,s){if(!Yt(t.caller)&&t.caller!=="ANY_CALLER")throw new Error(`The caller ${t.caller} is not valid.`);const i=Yt(t.caller)?t.caller:$S,o=[n].flat(),a=r??await this.getSnip9Version();if(!a)throw new Error("This account is not handling outside transactions.");const c=s?M(s):await this.getSnip9Nonce(),l=rA(await this.getChainId(),{caller:i,execute_after:t.execute_after,execute_before:t.execute_before},c,o,a),u=await this.signMessage(l);return{outsideExecution:{caller:i,nonce:c,execute_after:t.execute_after,execute_before:t.execute_before,calls:o.map(gb)},signature:u,signerAddress:this.address,version:a}}async executeFromOutside(t,n){const r=iA(t);return this.execute(r,n)}async resolveDetailsWithTip(t){return{...t,tip:t.tip??(await this.getEstimateTip())[this.defaultTipType]}}resolveTransactionVersion(t){return cl(this.transactionVersion||jc.V3,t)}async buildInvocation(t,n){const r=ub(t,await this.getCairoVersion()),s=n.skipValidate?[]:await this.signer.signTransaction(t,n);return{...Qt(n),contractAddress:this.address,calldata:r,signature:s}}async buildDeclarePayload(t,n){const{classHash:r,contract:s,compiledClassHash:i}=zo(t),o=C2(s);I(!Ct(i)&&(n.version===jc.F3||n.version===jc.V3),"V3 Transaction work with Cairo1 Contracts and require compiledClassHash");const a=n.skipValidate?[]:await this.signer.signDeclareTransaction({...n,...Qt(n),classHash:r,compiledClassHash:i,senderAddress:n.walletAddress});return{senderAddress:n.walletAddress,signature:a,contract:o,compiledClassHash:i}}async buildAccountDeployPayload({classHash:t,addressSalt:n=0,constructorCalldata:r=[],contractAddress:s},i){const o=ye.compile(r),a=s??al(n,t,o,0),c=i.skipValidate?[]:await this.signer.signDeployAccountTransaction({...i,...Qt(i),classHash:t,contractAddress:a,addressSalt:n,constructorCalldata:o});return{...Qt(i),classHash:t,addressSalt:n,constructorCalldata:o,signature:c}}async accountInvocationsFactory(t,n){const{nonce:r,blockIdentifier:s,skipValidate:i=!0}=n,o=await this.getNonceSafe(r),a=await this.getChainId(),c=n.versions.map(d=>cl(d)),l="payload"in t[0]?t[0].payload:t[0],u=t[0].type===H.ETransactionType.DEPLOY_ACCOUNT?await this.getCairoVersion(l.classHash):await this.getCairoVersion();return Promise.all([].concat(t).map(async(d,f)=>{const h="payload"in d?d.payload:d,p={...Qt(n),walletAddress:this.address,nonce:Pt(Number(o)+f),chainId:a,cairoVersion:u,version:c[0],skipValidate:i},_={type:d.type,nonce:Pt(Number(o)+f),blockIdentifier:s,version:c[0]};if(d.type===H.ETransactionType.INVOKE){const g=await this.buildInvocation([].concat(h),p);return{..._,...g,...p}}if(d.type===H.ETransactionType.DEPLOY){const{calls:g}=this.deployer.buildDeployerCall(h,this.address),y=await this.buildInvocation(g,p);return{..._,...y,...p,type:H.ETransactionType.INVOKE}}if(d.type===H.ETransactionType.DECLARE){I(cs(h.contract),"Declare fee estimation is not supported for Cairo0 contracts");const g=await this.buildDeclarePayload(h,p);return{..._,...g,...p}}if(d.type===H.ETransactionType.DEPLOY_ACCOUNT){const g=await this.buildAccountDeployPayload(h,p);return{..._,...g,...p}}throw Error(`accountInvocationsFactory: unsupported transaction type: ${d}`)}))}async buildPaymasterTransaction(t,n){if(!n.deploymentData&&await this.getSnip9Version()===jo.UNSUPPORTED)throw Error("Account is not compatible with SNIP-9");const r={version:"0x1",feeMode:n.feeMode,timeBounds:n.timeBounds};let s;return n.deploymentData?t.length>0?s={type:"deploy_and_invoke",invoke:{userAddress:this.address,calls:t},deployment:n.deploymentData}:s={type:"deploy",deployment:n.deploymentData}:s={type:"invoke",invoke:{userAddress:this.address,calls:t}},this.paymaster.buildTransaction(s,r)}async estimatePaymasterTransactionFee(t,n){return(await this.buildPaymasterTransaction(t,n)).fee}async preparePaymasterTransaction(t){let n;switch(t.type){case"deploy_and_invoke":{const r=await this.signMessage(t.typed_data);n={type:"deploy_and_invoke",invoke:{userAddress:this.address,typedData:t.typed_data,signature:Lr(r)},deployment:t.deployment};break}case"invoke":{const r=await this.signMessage(t.typed_data);n={type:"invoke",invoke:{userAddress:this.address,typedData:t.typed_data,signature:Lr(r)}};break}case"deploy":{n={type:"deploy",deployment:t.deployment};break}default:throw Error("Invalid transaction type")}return n}async executePaymasterTransaction(t,n,r){const s=await this.buildPaymasterTransaction(t,n);aA(s,t,n,r);const i=await this.preparePaymasterTransaction(s);return this.paymaster.executeTransaction(i,s.parameters).then(o=>({transaction_hash:o.transaction_hash}))}async getStarkName(t=this.address,n){return super.getStarkName(t,n)}},HL={};Se(HL,{addDeclareTransaction:()=>gA,addInvokeTransaction:()=>pA,addStarknetChain:()=>fA,deploymentData:()=>KL,getPermissions:()=>uA,onAccountChange:()=>yA,onNetworkChanged:()=>mA,requestAccounts:()=>C_,requestChainId:()=>WL,signMessage:()=>_A,supportedSpecs:()=>YL,switchStarknetChain:()=>hA,watchAsset:()=>dA});function C_(e,t=!1){return e.request({type:"wallet_requestAccounts",params:{silent_mode:t}})}function uA(e){return e.request({type:"wallet_getPermissions"})}function dA(e,t){return e.request({type:"wallet_watchAsset",params:t})}function fA(e,t){return e.request({type:"wallet_addStarknetChain",params:t})}function hA(e,t){return e.request({type:"wallet_switchStarknetChain",params:{chainId:t}})}function WL(e){return e.request({type:"wallet_requestChainId"})}function KL(e){return e.request({type:"wallet_deploymentData"})}function pA(e,t){return e.request({type:"wallet_addInvokeTransaction",params:t})}function gA(e,t){return e.request({type:"wallet_addDeclareTransaction",params:t})}function _A(e,t){return e.request({type:"wallet_signTypedData",params:t})}function YL(e){return e.request({type:"wallet_supportedSpecs"})}function yA(e,t){e.on("accountsChanged",t)}function mA(e,t){e.on("networkChanged",t)}var GL=class O_ extends qL{walletProvider;constructor(t){super({...t,signer:""}),this.walletProvider=t.walletProvider,this.walletProvider.on("accountsChanged",n=>{n&&(this.address=n[0].toLowerCase())}),this.walletProvider.on("networkChanged",n=>{n&&this.channel.setChainId(n)})}onAccountChange(t){yA(this.walletProvider,t)}onNetworkChanged(t){mA(this.walletProvider,t)}requestAccounts(t=!1){return C_(this.walletProvider,t)}getPermissions(){return uA(this.walletProvider)}switchStarknetChain(t){return hA(this.walletProvider,t)}watchAsset(t){return dA(this.walletProvider,t)}addStarknetChain(t){return fA(this.walletProvider,t)}execute(t){const r={calls:[].concat(t).map(s=>{const{contractAddress:i,entrypoint:o,calldata:a}=s;return{contract_address:i,entry_point:o,calldata:a}})};return pA(this.walletProvider,r)}declare(t){const n=zo(t),r=t.contract,s={...r,abi:Cn(r.abi)};if(!n.compiledClassHash)throw Error("compiledClassHash is required");const i={compiled_class_hash:n.compiledClassHash,contract_class:s};return gA(this.walletProvider,i)}async deploy(t){const{calls:n,addresses:r}=this.deployer.buildDeployerCall(t,this.address);return{...await this.execute(n),contract_address:r}}signMessage(t){return _A(this.walletProvider,t)}static async connect(t,n,r,s,i=!1){const[o]=await C_(n,i);return new O_({provider:t,walletProvider:n,address:o,cairoVersion:r,paymaster:s})}static async connectSilent(t,n,r,s){return O_.connect(t,n,r,s,!0)}},ZL={};Se(ZL,{getAbiEvents:()=>QL,isAbiEvent:()=>B_,parseEvents:()=>e6});function B_(e){return e.type==="event"}function JL(e){return e.filter(t=>t.type==="event").reduce((t,n)=>{const r=n.name,s={...n};return s.name=r,{...t,[Y(zs(Zi(r)).toString(16))]:s}},{})}function XL(e){const t=e.filter(s=>B_(s)&&s.kind==="struct"),n=e.filter(s=>B_(s)&&s.kind==="enum");return t.reduce((s,i)=>{let o=[],{name:a}=i,c=!1;const l=f=>f.type===a;for(;;){const f=n.find(p=>p.variants.some(l));if(Ct(f))break;const h=f.variants.find(l);o.unshift(h.name),h.kind==="flat"&&(c=!0),a=f.name}if(o.length===0)throw new Error("inconsistency in ABI events definition.");c&&(o=[o[o.length-1]]);const u=o.pop();let d={[Y(zs(Zi(u)).toString(16))]:i};for(;o.length>0;)d={[Y(zs(Zi(o.pop())).toString(16))]:d};return d={...d},bA(s,d)},{})}function QL(e){return tb(e)?XL(e):JL(e)}function bA(e,t){const n={...e};return xe(e)&&xe(t)&&Object.keys(t).forEach(r=>{xe(t[r])?r in e?n[r]=bA(e[r],t[r]):Object.assign(n,{[r]:t[r]}):Object.assign(n,{[r]:t[r]})}),n}function e6(e,t,n,r,s){return e.flat().reduce((o,a)=>{const c=JSON.parse(JSON.stringify(a));let l=t[c.keys.shift()??0];if(!l)return o;for(;!l.name;){const _=c.keys.shift();I(!!_,'Not enough data in "keys" property of this event.'),l=l[_]}const u={};u[l.name]={};const d=c.keys[Symbol.iterator](),f=c.data[Symbol.iterator](),h=l.members?.filter(_=>_.kind==="key")||l.keys,p=l.members?.filter(_=>_.kind==="data")||l.data;return h.forEach(_=>{u[l.name][_.name]=uf({responseIterator:d,output:_,structs:n,enums:r,parser:s,parsedResult:u[l.name]})}),p.forEach(_=>{u[l.name][_.name]=uf({responseIterator:f,output:_,structs:n,enums:r,parser:s,parsedResult:u[l.name]})}),"block_hash"in c&&(u.block_hash=c.block_hash),"block_number"in c&&(u.block_number=c.block_number),"transaction_hash"in c&&(u.transaction_hash=c.transaction_hash),o.push(u),o},[])}H.TypedDataRevision;const wA="0.10.5",t6={version:wA};var Fi=(e=>(e.SUCCESS="SUCCESS",e.NOT_CONNECTED="NOT_CONNECTED",e.ERROR="ERROR",e.CANCELED="CANCELED",e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e))(Fi||{});function n6(e){return Array.isArray(e)?e:[e]}function r6(e){const t=e.pathname.split("/");if(e.hostname==="localhost"||e.hostname==="127.0.0.1"||e.hostname==="0.0.0.0"){if(typeof XMLHttpRequest>"u")return console.warn(`Cannot make synchronous HTTP call in Node.js environment for ${e.toString()}`),Us.encodeShortString("LOCALHOST");const n=new XMLHttpRequest;n.open("POST",e.toString(),!1),n.setRequestHeader("Content-Type","application/json");const r=JSON.stringify({jsonrpc:"2.0",method:"starknet_chainId",params:[],id:1});try{if(n.send(r),n.status===200){const s=JSON.parse(n.responseText);if(s.result)return s.result}throw new Error(`Failed to get chain ID from ${e.toString()}: ${n.status} ${n.statusText}`)}catch(s){throw new Error(`Failed to connect to ${e.toString()}: ${s}`)}}if(t.includes("starknet")){if(t.includes("mainnet"))return Ms.StarknetChainId.SN_MAIN;if(t.includes("sepolia"))return Ms.StarknetChainId.SN_SEPOLIA}else if(t.length>=3){const n=t[2];if(t.includes("katana"))return Us.encodeShortString(`WP_${n.toUpperCase().replace(/-/g,"_")}`);if(t.includes("mainnet"))return Us.encodeShortString(`GG_${n.toUpperCase().replace(/-/g,"_")}`)}throw new Error(`Chain ${e.toString()} not supported`)}class vt extends Error{constructor(){super("Not ready to connect"),Object.setPrototypeOf(this,vt.prototype)}}const s6="https://x.cartridge.gg",i6={ACCOUNTS:"accounts"},o6="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjgwMCIgdmlld0JveD0iMCAwIDgwMCA4MDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2RfNTExMl83ODIpIj4KPHBhdGggZD0iTTQ2OS4yMzYgNzBDNDgyLjM5IDcwIDQ5My4wNTMgODAuNjYzIDQ5My4wNTMgOTMuODE2NFYxNDcuMTQ3TDUxNS4zMzggMTQ3LjE0N0w1MTUuNDI4IDE0Ny4xNDdMNTE1LjU1NCAxNDcuMTQ3TDUxNS44MjYgMTQ3LjE0OUM1MTYuMDE2IDE0Ny4xNTEgNTE2LjIyNSAxNDcuMTUzIDUxNi40NTEgMTQ3LjE1N0M1MTYuOTA0IDE0Ny4xNjQgNTE3LjQyOCAxNDcuMTc2IDUxOC4wMiAxNDcuMTk1QzUxOS4yMDEgMTQ3LjIzNCA1MjAuNjYgMTQ3LjMwNCA1MjIuMzYxIDE0Ny40MjRDNTI1Ljc0MSAxNDcuNjYzIDUzMC4xODUgMTQ4LjExNCA1MzUuMzYzIDE0OC45NjlDNTQ1LjAwMSAxNTAuNTYyIDU1OC41NTYgMTUzLjc4IDU3Mi45MTggMTYwLjYwM0w3MzAuNDIgMjI2LjY3MUw3MzIuMTAxIDIyNy41MDVDNzcxLjc4NyAyNDcuMTc3IDc4OS45OTMgMjg2LjI5NiA3ODkuOTkzIDMyMi4wMzZWNTg1Ljg2NUM3ODkuOTkzIDU4Ni4wNTQgNzg5Ljk5NCA1ODYuMjU0IDc4OS45OTQgNTg2LjQ2M0w3ODkuOTk2IDU4Ni45MTNDNzkwLjAzOCA1OTcuMDk2IDc5MC4xNjEgNjI2Ljk5NiA3NjQuMjMxIDY1Mi44MjNMNzE0Ljc2IDcwMi4wOTVMNzE0LjY0MSA3MDIuMjE1QzcwNC42MDEgNzEyLjI3NSA2OTIuMTIzIDcyMC42NTIgNjc2LjI4NCA3MjQuODc5QzY2NC4zOSA3MjguMDU0IDY1Mi44MjcgNzI3Ljk2NiA2NDguNjM3IDcyNy45MzRMNjQ4LjYxOSA3MjcuOTMzQzY0OC40MDkgNzI3LjkzMiA2NDguMjE5IDcyNy45MyA2NDguMDQ3IDcyNy45M0w2NDcuNzUyIDcyNy45MjlINDgwLjcyMUM0NzQuMDk0IDcyNy45MjkgNDY4LjcyMSA3MjIuNTU2IDQ2OC43MjEgNzE1LjkyOVY2NjguMzg4SDMyOC41ODZDMzI4LjU4NiA2NzIuNjI5IDMyOC41NzIgNjk4LjA1MiAzMjguNTYxIDcxNS45NDRDMzI4LjU1NyA3MjIuNTY5IDMyMy4xODYgNzI3LjkyOSAzMTYuNTYxIDcyNy45MjlIMTUyLjI0NkMxNTIuMTA0IDcyNy45MjkgMTUxLjk0MiA3MjcuOTI5IDE1MS43NjIgNzI3LjkzMUwxNTEuMzYyIDcyNy45MzRDMTQ3LjE3MiA3MjcuOTY2IDEzNS42MDkgNzI4LjA1NCAxMjMuNzE0IDcyNC44NzlDMTA3Ljg3MyA3MjAuNjUxIDk1LjM5MzggNzEyLjI3MiA4NS4zNTI5IDcwMi4yMUw4NS4yMzg2IDcwMi4wOTVMMzUuNjcgNjUyLjcyNUwzNS41NzIzIDY1Mi42MjdDOS44NjI0MiA2MjYuNzggOS45NjY3IDU5Ny4xODUgMTAuMDAzIDU4Ni44NzRDMTAuMDA0MyA1ODYuNTEzIDEwLjAwNTUgNTg2LjE3NyAxMC4wMDU1IDU4NS44NjVWMzIyLjAzNkMxMC4wMDU1IDI4Ni40MyAyOC4xNjYyIDI0Ny4xOTkgNjcuODk3NyAyMjcuNTA1TDY5LjU3OSAyMjYuNjcxTDIyNy4wODEgMTYwLjYwM0MyNDEuNDQzIDE1My43OCAyNTQuOTk4IDE1MC41NjIgMjY0LjYzNiAxNDguOTY5QzI2OS44MTQgMTQ4LjExNCAyNzQuMjU4IDE0Ny42NjMgMjc3LjYzOCAxNDcuNDI0QzI3OS4zMzggMTQ3LjMwNCAyODAuNzk4IDE0Ny4yMzQgMjgxLjk3OSAxNDcuMTk1QzI4Mi41NzEgMTQ3LjE3NiAyODMuMDk1IDE0Ny4xNjQgMjgzLjU0NyAxNDcuMTU3TDI4My45MTcgMTQ3LjE1MkwyODQuMTczIDE0Ny4xNDlMMjg0LjQ0NSAxNDcuMTQ3TDI4NC41NzEgMTQ3LjE0N0wyODQuNjYgMTQ3LjE0N0wzMDYuOTQyIDE0Ny4xNDdWOTMuODE2NEMzMDYuOTQyIDgwLjY2MyAzMTcuNjA1IDcwIDMzMC43NTggNzBINDY5LjIzNloiIGZpbGw9IiMxOTFBMUEiLz4KPHBhdGggZD0iTTM2Ni40ODMgMTI5LjU0SDQzMy41MTJWMjA2LjY4N0gzNjYuNDgzVjEyOS41NFoiIGZpbGw9IiNGQkNCNEEiLz4KPHBhdGggZD0iTTI2OS4wMSA2MDIuNDI5SDE0NC4wMDhDMTM1Ljc2OCA2MDIuNDI5IDEzNS43NjggNTk0LjE0NiAxMzUuNzY4IDU5NC4xNDZWMjgwLjg1QzEzNS43NjggMjgwLjg1IDEzNS43NjggMjcyLjY0NCAxNDQuMDA4IDI3Mi42NDRIMzY2LjQ4M0wzNjYuNDgzIDIwNi42ODdIMjg0LjY5QzI4NC42OSAyMDYuNjg3IDI2OC4xMzQgMjA2LjY4NyAyNTEuNTc5IDIxNC44OTNMOTQuMzQxNCAyODAuODVDNzcuNzg2MSAyODkuMDU3IDY5LjU0NjkgMzA1LjYyMyA2OS41NDY5IDMyMi4wMzVWNTg1Ljg2M0M2OS41NDY5IDU5NC4xNDcgNjkuNTQ2OSA2MDIuMzUzIDc3Ljc4NjEgNjEwLjYzNkwxMjcuNDUyIDY2MC4xMDRDMTM1LjY5MSA2NjguMzg3IDE0MS45MjggNjY4LjM4NyAxNTIuMjQ3IDY2OC4zODdIMjY5LjAyOUMyNjkuMDM3IDY0OC4zNCAyNjkuMDQ2IDYyNC42NTUgMjY5LjA1NCA2MDIuODg3SDUyOC4wMTNWNjY4LjM4N0g2NDcuNzUzQzY1OC4wNzEgNjY4LjM4NyA2NjQuMzA4IDY2OC4zODcgNjcyLjU0NyA2NjAuMTA0TDcyMi4yMTMgNjEwLjYzNkM3MzAuNDUzIDYwMi40MjkgNzMwLjQ1MyA1OTQuMTQ3IDczMC40NTMgNTg1Ljg2M1YzMjIuMDM1QzczMC40NTMgMzA1LjU0NiA3MjIuMjEzIDI4OS4wNTcgNzA1LjY1OCAyODAuODVMNTQ4LjQyMSAyMTQuODkzQzUzMS44NjUgMjA2LjY4NyA1MTUuMzEgMjA2LjY4NyA1MTUuMzEgMjA2LjY4N0g0MzMuNTEyTDQzMy41MTIgMjcyLjY0NEg2NTYuMDY5QzY2NC4zMDggMjcyLjY0NCA2NjQuMzA4IDI4MC44NSA2NjQuMzA4IDI4MC44NVY1OTQuMTQ2QzY2NC4zMDggNTk0LjE0NiA2NjQuMzA4IDYwMi40MjkgNjU2LjA2OSA2MDIuNDI5SDUyOC4yNjJWNTM3LjM5NkgyNjkuMDc1QzI2OS4wNzUgNTQzLjcwNyAyNjkuMDE3IDU5Ni45MTIgMjY5LjAxIDYwMi40MjlaIiBmaWxsPSIjRkJDQjRBIi8+CjxwYXRoIGQ9Ik0yNjkuMDA5IDQzNi4xNzJINTI4LjI2MlYzNzAuNjgxSDI2OS4wNzVDMjY5LjA3NSAzNzcuMzczIDI2OS4wMDkgNDM2Ljc4OCAyNjkuMDA5IDQzNi4xNzJaIiBmaWxsPSIjRkJDQjRBIi8+CjwvZz4KPGRlZnM+CjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZF81MTEyXzc4MiIgeD0iLTQiIHk9IjAiIHdpZHRoPSI4MDgiIGhlaWdodD0iODA4IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjQiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMiIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd181MTEyXzc4MiIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd181MTEyXzc4MiIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPC9kZWZzPgo8L3N2Zz4K";function a6(){}let c6=class{m_lastPromise=Promise.resolve();async obtain(t=!1){let n=a6;if(t)return n;const r=this.m_lastPromise;return this.m_lastPromise=new Promise(s=>n=s),await r,n}};const l6=new c6;let u6=class{id="controller";name="Controller";version=t6.version;icon=o6;account;subscriptions=[];_probePromise=null;async safeProbe(){if(this.account)return this.account;if(this._probePromise)return this._probePromise;const t=await l6.obtain();return await new Promise(async n=>{try{this._probePromise=this.probe();const r=await this._probePromise;n(r)}finally{this._probePromise=null}}).finally(()=>{t()})}request=async t=>{switch(t.type){case"wallet_getPermissions":return await this.safeProbe(),this.account?[i6.ACCOUNTS]:[];case"wallet_requestAccounts":{if(this.account)return[this.account.address];const r=t.params&&t.params.silent_mode;return this.account=await this.safeProbe(),!this.account&&!r&&(this.account=await this.connect()),this.account?[this.account.address]:[]}case"wallet_watchAsset":throw{code:63,message:"An unexpected error occurred",data:"wallet_watchAsset not implemented"};case"wallet_addStarknetChain":{let r=t.params;return this.addStarknetChain(r)}case"wallet_switchStarknetChain":{let r=t.params;return this.switchStarknetChain(r.chainId)}case"wallet_requestChainId":if(!this.account)throw{code:63,message:"An unexpected error occurred",data:"Account not initialized"};return await this.account.getChainId();case"wallet_deploymentData":throw{code:63,message:"An unexpected error occurred",data:"wallet_deploymentData not implemented"};case"wallet_addInvokeTransaction":if(!this.account)throw{code:63,message:"An unexpected error occurred",data:"Account not initialized"};let n=t.params;return await this.account.execute(n.calls.map(r=>({contractAddress:r.contract_address,entrypoint:r.entry_point,calldata:r.calldata})));case"wallet_addDeclareTransaction":throw{code:63,message:"An unexpected error occurred",data:"wallet_addDeclareTransaction not implemented"};case"wallet_signTypedData":{if(!this.account)throw{code:63,message:"An unexpected error occurred",data:"Account not initialized"};return await this.account.signMessage(t.params)}case"wallet_supportedSpecs":return[];case"wallet_supportedWalletApi":return[];default:throw{code:63,message:"An unexpected error occurred",data:`Unknown RPC call type: ${t.type}`}}};on=(t,n)=>{if(t!=="accountsChanged"&&t!=="networkChanged")throw new Error(`Unknown event: ${t}`);this.subscriptions.push({type:t,handler:n})};off=(t,n)=>{if(t!=="accountsChanged"&&t!=="networkChanged")throw new Error(`Unknown event: ${t}`);const r=this.subscriptions.findIndex(s=>s.type===t&&s.handler===n);r>=0&&this.subscriptions.splice(r,1)};emitNetworkChanged(t){this.subscriptions.filter(n=>n.type==="networkChanged").forEach(n=>{n.handler(t)})}emitAccountsChanged(t){this.subscriptions.filter(n=>n.type==="accountsChanged").forEach(n=>{n.handler(t)})}};class Ok extends GL{keychain;modal;options;constructor(t,n,r,s,i,o){super({provider:{nodeUrl:n},walletProvider:t,address:r}),this.keychain=s,this.options=i,this.modal=o}async execute(t){return t=n6(t),new Promise(async(n,r)=>{const s=await this.keychain.execute(t,void 0,void 0,!1,this.options?.feeSource);if(s.code===Fi.SUCCESS){n(s);return}if(this.options?.propagateSessionErrors&&s.code!==Fi.USER_INTERACTION_REQUIRED){r(s.error);return}this.modal.open();const i=await this.keychain.execute(t,void 0,void 0,!0,s.error);if(i.code===Fi.SUCCESS){n(i),this.modal.close();return}r(i.error)})}async signMessage(t){return new Promise(async(n,r)=>{const s=await this.keychain.signMessage(t,"",!0);if(!("code"in s)){n(s);return}this.modal.open();const i=await this.keychain.signMessage(t,"",!1);"code"in i?r(i.error):n(i),this.modal.close()})}}var Vr;(function(e){e.Call="call",e.Reply="reply",e.Syn="syn",e.SynAck="synAck",e.Ack="ack"})(Vr||(Vr={}));var xi;(function(e){e.Fulfilled="fulfilled",e.Rejected="rejected"})(xi||(xi={}));var Pl;(function(e){e.ConnectionDestroyed="ConnectionDestroyed",e.ConnectionTimeout="ConnectionTimeout",e.NoIframeSrc="NoIframeSrc"})(Pl||(Pl={}));var $_;(function(e){e.DataCloneError="DataCloneError"})($_||($_={}));var Hs;(function(e){e.Message="message"})(Hs||(Hs={}));const d6=(e,t)=>{const n=[];let r=!1;return{destroy(s){r||(r=!0,t(`${e}: Destroying connection`),n.forEach(i=>{i(s)}))},onDestroy(s){r?s():n.push(s)}}},f6=e=>(...t)=>{e&&console.log("[Penpal]",...t)},h6={"http:":"80","https:":"443"},p6=/^(https?:)?\/\/([^/:]+)?(:(\d+))?/,g6=["file:","data:"],_6=e=>{if(e&&g6.find(a=>e.startsWith(a)))return"null";const t=document.location,n=p6.exec(e);let r,s,i;n?(r=n[1]?n[1]:t.protocol,s=n[2],i=n[4]):(r=t.protocol,s=t.hostname,i=t.port);const o=i&&i!==h6[r]?`:${i}`:"";return`${r}//${s}${o}`},Bk=({name:e,message:t,stack:n})=>({name:e,message:t,stack:n}),y6=e=>{const t=new Error;return Object.keys(e).forEach(n=>t[n]=e[n]),t},m6=(e,t,n)=>{const{localName:r,local:s,remote:i,originForSending:o,originForReceiving:a}=e;let c=!1;const l=u=>{if(u.source!==i||u.data.penpal!==Vr.Call)return;if(a!=="*"&&u.origin!==a){n(`${r} received message from origin ${u.origin} which did not match expected origin ${a}`);return}const d=u.data,{methodName:f,args:h,id:p}=d;n(`${r}: Received ${f}() call`);const _=g=>y=>{if(n(`${r}: Sending ${f}() reply`),c){n(`${r}: Unable to send ${f}() reply due to destroyed connection`);return}const w={penpal:Vr.Reply,id:p,resolution:g,returnValue:y};g===xi.Rejected&&y instanceof Error&&(w.returnValue=Bk(y),w.returnValueIsError=!0);try{i.postMessage(w,o)}catch(k){if(k.name===$_.DataCloneError){const b={penpal:Vr.Reply,id:p,resolution:xi.Rejected,returnValue:Bk(k),returnValueIsError:!0};i.postMessage(b,o)}throw k}};new Promise(g=>g(t[f].call(t,u.origin).apply(t,h))).then(_(xi.Fulfilled),_(xi.Rejected))};return s.addEventListener(Hs.Message,l),()=>{c=!0,s.removeEventListener(Hs.Message,l)}};let b6=0;const w6=()=>++b6,kA=".",EA=e=>e?e.split(kA):[],k6=e=>e.join(kA),E6=(e,t)=>{const n=EA(t||"");return n.push(e),k6(n)},T6=(e,t,n)=>{const r=EA(t);return r.reduce((s,i,o)=>(typeof s[i]>"u"&&(s[i]={}),o===r.length-1&&(s[i]=n),s[i]),e),e},TA=(e,t)=>{const n={};return Object.keys(e).forEach(r=>{const s=e[r],i=E6(r,t);typeof s=="object"&&Object.assign(n,TA(s,i)),typeof s=="function"&&(n[i]=s)}),n},v6=e=>{const t={};for(const n in e)T6(t,n,e[n]);return t},S6=(e,t,n,r,s)=>{const{localName:i,local:o,remote:a,originForSending:c,originForReceiving:l}=t;let u=!1;s(`${i}: Connecting call sender`);const d=h=>(...p)=>{s(`${i}: Sending ${h}() call`);let _;try{a.closed&&(_=!0)}catch{_=!0}if(_&&r(),u){const g=new Error(`Unable to send ${h}() call due to destroyed connection`);throw g.code=Pl.ConnectionDestroyed,g}return new Promise((g,y)=>{const w=w6(),k=N=>{if(N.source!==a||N.data.penpal!==Vr.Reply||N.data.id!==w)return;if(l!=="*"&&N.origin!==l){s(`${i} received message from origin ${N.origin} which did not match expected origin ${l}`);return}const S=N.data;s(`${i}: Received ${h}() reply`),o.removeEventListener(Hs.Message,k);let E=S.returnValue;S.returnValueIsError&&(E=y6(E)),(S.resolution===xi.Fulfilled?g:y)(E)};o.addEventListener(Hs.Message,k);const b={penpal:Vr.Call,id:w,methodName:h,args:p};a.postMessage(b,c)})},f=n.reduce((h,p)=>(h[p]=d(p),h),{});return Object.assign(e,v6(f)),()=>{u=!0}},A6=(e,t,n,r,s)=>{const{destroy:i,onDestroy:o}=r;let a,c;const l={};return u=>{if(t!=="*"&&u.origin!==t){s(`Parent: Handshake - Received ACK message from origin ${u.origin} which did not match expected origin ${t}`);return}s("Parent: Handshake - Received ACK");const d={localName:"Parent",local:window,remote:u.source,originForSending:n,originForReceiving:t};a&&a(),a=m6(d,e,s),o(a),c&&c.forEach(h=>{delete l[h]}),c=u.data.methodNames;const f=S6(l,d,c,i,s);return o(f),l}},I6=(e,t,n,r)=>s=>{if(!s.source)return;if(n!=="*"&&s.origin!==n){e(`Parent: Handshake - Received SYN message from origin ${s.origin} which did not match expected origin ${n}`);return}e("Parent: Handshake - Received SYN, responding with SYN-ACK");const i={penpal:Vr.SynAck,methodNames:Object.keys(t)};s.source.postMessage(i,r)},N6=6e4,x6=(e,t)=>{const{destroy:n,onDestroy:r}=t,s=setInterval(()=>{e.isConnected||(clearInterval(s),n())},N6);r(()=>{clearInterval(s)})},R6=(e,t)=>{let n;return e!==void 0&&(n=window.setTimeout(()=>{const r=new Error(`Connection timed out after ${e}ms`);r.code=Pl.ConnectionTimeout,t(r)},e)),()=>{clearTimeout(n)}},C6=e=>{if(!e.src&&!e.srcdoc){const t=new Error("Iframe must have src or srcdoc property defined.");throw t.code=Pl.NoIframeSrc,t}},O6=e=>{let{iframe:t,methods:n={},childOrigin:r,timeout:s,debug:i=!1}=e;const o=f6(i),a=d6("Parent",o),{onDestroy:c,destroy:l}=a;r||(C6(t),r=_6(t.src));const u=r==="null"?"*":r,d=TA(n),f=I6(o,d,r,u),h=A6(d,r,u,a,o);return{promise:new Promise((p,_)=>{const g=R6(s,l),y=w=>{if(!(w.source!==t.contentWindow||!w.data)){if(w.data.penpal===Vr.Syn){f(w);return}if(w.data.penpal===Vr.Ack){const k=h(w);k&&(g(),p(k));return}}};window.addEventListener(Hs.Message,y),o("Parent: Awaiting handshake"),x6(t,a),c(w=>{window.removeEventListener(Hs.Message,y),w&&_(w)})}),destroy(){l()}}};class B6{url;iframe;container;onClose;child;closeTimeout;constructor({id:t,url:n,preset:r,onClose:s,onConnect:i,methods:o={}}){if(typeof document>"u"||typeof window>"u")return;r&&n.searchParams.set("preset",r),this.url=n;const a=document.createElement("iframe");a.src=n.toString(),a.id=t,a.style.border="none",a.sandbox.add("allow-forms"),a.sandbox.add("allow-popups"),a.sandbox.add("allow-popups-to-escape-sandbox"),a.sandbox.add("allow-scripts"),a.sandbox.add("allow-same-origin"),a.allow="publickey-credentials-create *; publickey-credentials-get *; clipboard-write",document.hasStorageAccess&&a.sandbox.add("allow-storage-access-by-user-activation");const c=document.createElement("div");c.id="controller",c.style.position="fixed",c.style.height="100%",c.style.width="100%",c.style.top="0",c.style.left="0",c.style.zIndex="10000",c.style.backgroundColor="rgba(0,0,0,0.6)",c.style.display="none",c.style.alignItems="center",c.style.justifyContent="center",c.style.transition="opacity 0.2s ease",c.style.opacity="0",c.style.pointerEvents="auto",c.appendChild(a),c.addEventListener("click",d=>{d.target===c&&(t==="controller-keychain"&&this.child&&this.child.reset?.().catch(f=>console.error("Error resetting context:",f)),this.close())}),this.iframe=a,this.container=c,O6({iframe:this.iframe,methods:{close:d=>()=>this.close(),reload:d=>()=>window.location.reload(),...o}}).promise.then(d=>{this.child=d,i(d)}),this.resize(),window.addEventListener("resize",()=>this.resize());const l=new MutationObserver(()=>{if(typeof document>"u")return;const d=document.getElementById("controller");document.body&&t==="controller-keychain"&&!d&&(document.body.appendChild(c),l.disconnect())});l.observe(document.documentElement,{childList:!0,subtree:!0});const u=document.getElementById("controller");document.body&&t==="controller-keychain"&&!u&&document.body.appendChild(c),this.onClose=s}open(){!this.container||typeof document>"u"||!document.body||(this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=void 0),document.body.style.overflow="hidden",this.container.style.display="flex",requestAnimationFrame(()=>{this.container&&(this.container.style.opacity="1")}))}close(){!this.container||typeof document>"u"||!document.body||(this.onClose?.(),document.body.style.overflow="auto",this.container.style.opacity="0",this.closeTimeout=setTimeout(()=>{this.container&&(this.container.style.display="none"),this.closeTimeout=void 0},200))}sendBackward(){this.container&&(this.container.style.zIndex="9999")}sendForward(){this.container&&(this.container.style.zIndex="10000")}resize(){if(!(!this.iframe||typeof window>"u")){if(this.iframe.style.userSelect="none",window.innerWidth<768){this.iframe.style.height="100%",this.iframe.style.width="100%",this.iframe.style.borderRadius="0";return}this.iframe.style.height="600px",this.iframe.style.width="432px",this.iframe.style.borderRadius="8px"}}isOpen(){return this.container?.style.display!=="none"}}const $6="6.13.7";function $k(e,t,n){for(let r in t){let s=t[r];Object.defineProperty(e,r,{enumerable:!0,value:s,writable:!1})}}function Ho(e){if(e==null)return"null";if(Array.isArray(e))return"[ "+e.map(Ho).join(", ")+" ]";if(e instanceof Uint8Array){const t="0123456789abcdef";let n="0x";for(let r=0;r<e.length;r++)n+=t[e[r]>>4],n+=t[e[r]&15];return n}if(typeof e=="object"&&typeof e.toJSON=="function")return Ho(e.toJSON());switch(typeof e){case"boolean":case"symbol":return e.toString();case"bigint":return BigInt(e).toString();case"number":return e.toString();case"string":return JSON.stringify(e);case"object":{const t=Object.keys(e);return t.sort(),"{ "+t.map(n=>`${Ho(n)}: ${Ho(e[n])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function D6(e,t,n){let r=e;{const i=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${Ho(n)}`);for(const o in n){if(o==="shortMessage")continue;const a=n[o];i.push(o+"="+Ho(a))}}i.push(`code=${t}`),i.push(`version=${$6}`),i.length&&(e+=" ("+i.join(", ")+")")}let s;switch(t){case"INVALID_ARGUMENT":s=new TypeError(e);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(e);break;default:s=new Error(e)}return $k(s,{code:t}),n&&Object.assign(s,n),s.shortMessage==null&&$k(s,{shortMessage:r}),s}function M6(e,t,n,r){if(!e)throw D6(t,n,r)}function Wc(e,t,n,r){M6(e,t,"INVALID_ARGUMENT",{argument:n,value:r})}["NFD","NFC","NFKD","NFKC"].reduce((e,t)=>{try{if("test".normalize(t)!=="test")throw new Error("bad");if(t==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");e.push(t)}catch{}return e},[]);function L6(e,t,n){if(e instanceof Uint8Array)return e;if(typeof e=="string"&&e.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((e.length-2)/2);let s=2;for(let i=0;i<r.length;i++)r[i]=parseInt(e.substring(s,s+2),16),s+=2;return r}Wc(!1,"invalid BytesLike value",t||"value",e)}function _b(e,t){return L6(e,t)}const Dk="0123456789abcdef";function U6(e){const t=_b(e);let n="0x";for(let r=0;r<t.length;r++){const s=t[r];n+=Dk[(s&240)>>4]+Dk[s&15]}return n}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function P6(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Mk(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function gf(e,...t){if(!P6(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Lk(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function F6(e,t){gf(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function j6(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function vA(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const V6=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function z6(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function q6(e){for(let t=0;t<e.length;t++)e[t]=z6(e[t]);return e}const Uk=V6?e=>e:q6;function H6(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function SA(e){return typeof e=="string"&&(e=H6(e)),gf(e),e}class W6{}function K6(e){const t=r=>e().update(SA(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}const Zu=BigInt(2**32-1),Pk=BigInt(32);function Y6(e,t=!1){return t?{h:Number(e&Zu),l:Number(e>>Pk&Zu)}:{h:Number(e>>Pk&Zu)|0,l:Number(e&Zu)|0}}function G6(e,t=!1){const n=e.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=Y6(e[i],t);[r[i],s[i]]=[o,a]}return[r,s]}const Z6=(e,t,n)=>e<<n|t>>>32-n,J6=(e,t,n)=>t<<n|e>>>32-n,X6=(e,t,n)=>t<<n-32|e>>>64-n,Q6=(e,t,n)=>e<<n-32|t>>>64-n,eU=BigInt(0),bc=BigInt(1),tU=BigInt(2),nU=BigInt(7),rU=BigInt(256),sU=BigInt(113),AA=[],IA=[],NA=[];for(let e=0,t=bc,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],AA.push(2*(5*r+n)),IA.push((e+1)*(e+2)/2%64);let s=eU;for(let i=0;i<7;i++)t=(t<<bc^(t>>nU)*sU)%rU,t&tU&&(s^=bc<<(bc<<BigInt(i))-bc);NA.push(s)}const xA=G6(NA,!0),iU=xA[0],oU=xA[1],Fk=(e,t,n)=>n>32?X6(e,t,n):Z6(e,t,n),jk=(e,t,n)=>n>32?Q6(e,t,n):J6(e,t,n);function aU(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=Fk(l,u,1)^n[a],f=jk(l,u,1)^n[a+1];for(let h=0;h<50;h+=10)e[o+h]^=d,e[o+h+1]^=f}let s=e[2],i=e[3];for(let o=0;o<24;o++){const a=IA[o],c=Fk(s,i,a),l=jk(s,i,a),u=AA[o];s=e[u],i=e[u+1],e[u]=c,e[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=iU[r],e[1]^=oU[r]}vA(n)}class yb extends W6{constructor(t,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Mk(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=j6(this.state)}clone(){return this._cloneInto()}keccak(){Uk(this.state32),aU(this.state32,this.rounds),Uk(this.state32),this.posOut=0,this.pos=0}update(t){Lk(this),t=SA(t),gf(t);const{blockLen:n,state:r}=this,s=t.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=t[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){Lk(this,!1),gf(t),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=t.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);t.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Mk(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(F6(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,vA(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return t||(t=new yb(n,r,s,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=s,t.enableXOF=o,t.destroyed=this.destroyed,t}}const cU=(e,t,n)=>K6(()=>new yb(t,e,n)),lU=cU(1,136,256/8);let RA=!1;const CA=function(e){return lU(e)};let OA=CA;function hu(e){const t=_b(e,"data");return U6(OA(t))}hu._=CA;hu.lock=function(){RA=!0};hu.register=function(e){if(RA)throw new TypeError("keccak256 is locked");OA=e};Object.freeze(hu);const uU=BigInt(0),dU=BigInt(36);function Vk(e){e=e.toLowerCase();const t=e.substring(2).split(""),n=new Uint8Array(40);for(let s=0;s<40;s++)n[s]=t[s].charCodeAt(0);const r=_b(hu(n));for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&(t[s]=t[s].toUpperCase()),(r[s>>1]&15)>=8&&(t[s+1]=t[s+1].toUpperCase());return"0x"+t.join("")}const mb={};for(let e=0;e<10;e++)mb[String(e)]=String(e);for(let e=0;e<26;e++)mb[String.fromCharCode(65+e)]=String(10+e);const zk=15;function fU(e){e=e.toUpperCase(),e=e.substring(4)+e.substring(0,2)+"00";let t=e.split("").map(r=>mb[r]).join("");for(;t.length>=zk;){let r=t.substring(0,zk);t=parseInt(r,10)%97+t.substring(r.length)}let n=String(98-parseInt(t,10)%97);for(;n.length<2;)n="0"+n;return n}const hU=function(){const e={};for(let t=0;t<36;t++){const n="0123456789abcdefghijklmnopqrstuvwxyz"[t];e[n]=BigInt(t)}return e}();function pU(e){e=e.toLowerCase();let t=uU;for(let n=0;n<e.length;n++)t=t*dU+hU[e[n]];return t}function Qr(e){if(Wc(typeof e=="string","invalid address","address",e),e.match(/^(0x)?[0-9a-fA-F]{40}$/)){e.startsWith("0x")||(e="0x"+e);const t=Vk(e);return Wc(!e.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||t===e,"bad address checksum","address",e),t}if(e.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){Wc(e.substring(2,4)===fU(e),"bad icap checksum","address",e);let t=pU(e.substring(4)).toString(16);for(;t.length<40;)t="0"+t;return Vk("0x"+t)}Wc(!1,"invalid address","address",e)}class gU{type="argent";platform="starknet";wallet=void 0;account=void 0;connectedAccounts=[];accountChangeListener=void 0;isAvailable(){return typeof window<"u"&&!!window.starknet_argentX}getInfo(){const t=this.isAvailable();return{type:this.type,available:t,version:t?window.starknet_argentX?.version||"Unknown":void 0,chainId:t?window.starknet_argentX?.chainId:void 0,name:"Argent",platform:this.platform}}async connect(){if(this.account)return{success:!0,wallet:this.type,account:this.account};try{if(!this.isAvailable())throw new Error("Argent is not available");const t=window.starknet_argentX;if(!t)throw new Error("No wallet found");const n=await t.request({type:"wallet_requestAccounts",params:{silent_mode:!1}});if(!n||n.length===0)throw new Error("No accounts found");return this.removeAccountChangeListener(),this.wallet=t,this.account=n[0],this.connectedAccounts=n,this.setupAccountChangeListener(),{success:!0,wallet:this.type,account:this.account}}catch(t){return console.error("Error connecting to Argent:",t),{success:!1,wallet:this.type,error:t.message||"Unknown error"}}}getConnectedAccounts(){return this.connectedAccounts}async signTypedData(t){try{if(!this.isAvailable()||!this.wallet)throw new Error("Argent is not connected");const n=await this.wallet.request({type:"wallet_signTypedData",params:t});return{success:!0,wallet:this.type,result:n}}catch(n){return console.error("Error signing typed data with Argent:",n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async sendTransaction(t){if(!this.wallet)throw new Error("No wallet found");try{const n=await this.wallet.request({type:"wallet_addInvokeTransaction",params:{calls:t}});return{success:!0,wallet:this.type,result:n}}catch(n){return console.error("Error sending transaction with Argent:",n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async switchChain(t){if(!this.wallet)throw new Error("No wallet found");return await this.wallet.request({type:"wallet_switchStarknetChain",params:{chainId:t}})}async getBalance(t){try{if(!this.isAvailable()||!this.wallet)throw new Error("Argent is not connected");return{success:!0,wallet:this.type,result:"Implement based on Argent API"}}catch(n){return console.error("Error getting balance from Argent:",n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async waitForTransaction(t,n){return{success:!1,wallet:this.type,error:"waitForTransaction not supported for Argent wallet"}}setupAccountChangeListener(){this.wallet&&(this.accountChangeListener=t=>{t&&t.length>0?(this.account=t[0],this.connectedAccounts=t):(this.account=void 0,this.connectedAccounts=[])},this.wallet.on("accountsChanged",this.accountChangeListener))}removeAccountChangeListener(){this.wallet&&this.accountChangeListener&&(this.wallet.off("accountsChanged",this.accountChangeListener),this.accountChangeListener=void 0)}disconnect(){this.removeAccountChangeListener(),this.wallet=void 0,this.account=void 0,this.connectedAccounts=[]}}function _U(e){if(typeof window>"u")return;const t=n=>e(n.detail);return window.addEventListener("eip6963:announceProvider",t),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",t)}function yU(){const e=new Set;let t=[];const n=()=>_U(s=>{t.some(({info:i})=>i.uuid===s.info.uuid)||(t=[...t,s],e.forEach(i=>i(t,{added:[s]})))});let r=n();return{_listeners(){return e},clear(){e.forEach(s=>s([],{removed:[...t]})),t=[]},destroy(){this.clear(),e.clear(),r?.()},findProvider({rdns:s}){return t.find(i=>i.info.rdns===s)},getProviders(){return t},reset(){this.clear(),r?.(),r=n()},subscribe(s,{emitImmediately:i}={}){return e.add(s),i&&s(t,{added:t}),()=>e.delete(s)}}}const mU={"0x1":"ethereum","0xaa36a7":"ethereum","0x14a34":"base","0x2105":"base","0x66eee":"arbitrum","0xa4b1":"arbitrum","0xa":"optimism","0xaa37dc":"optimism",[Ms.StarknetChainId.SN_MAIN]:"starknet",[Ms.StarknetChainId.SN_SEPOLIA]:"starknet"},Qp=e=>{const t=jS.toHex(e),n=mU[t];return n||console.warn(`Unknown chain ID: ${t}`),n};class bb{platform;account=void 0;store=yU();provider;connectedAccounts=[];constructor(){this.initializeIfAvailable()}getProvider(){return this.provider||(this.provider=this.store.getProviders().find(t=>t.info.rdns===this.rdns)),this.provider}getEthereumProvider(){const t=this.getProvider();return t?t.provider:this.rdns==="io.metamask"&&typeof window<"u"&&window.ethereum?.isMetaMask?window.ethereum:null}initializeIfAvailable(){this.getProvider()&&!this.initialized&&(this.initialized=!0,this.initializeProvider())}initialized=!1;initializeProvider(){const t=this.getProvider();t&&(t.provider.request({method:"eth_accounts"}).then(n=>{this.connectedAccounts=n.map(Qr),n.length>0&&(this.account=Qr(n[0]))}).catch(console.error),t.provider.request({method:"eth_chainId"}).then(n=>{this.platform=Qp(n)}).catch(console.error),t.provider?.on("chainChanged",n=>{this.platform=Qp(n)}),t.provider?.on("accountsChanged",n=>{n&&(this.connectedAccounts=n.map(r=>Qr(r)),this.account=n.length>0?Qr(n[0]):void 0)}))}isAvailable(){const t=this.getProvider();return!t&&this.rdns==="io.metamask"&&typeof window<"u"?!!window.ethereum?.isMetaMask:(t&&!this.initialized&&this.initializeIfAvailable(),typeof window<"u"&&!!t)}getInfo(){const t=this.isAvailable();return{type:this.type,available:t,version:t?window.ethereum?.version||"Unknown":void 0,chainId:t?window.ethereum?.chainId:void 0,name:this.displayName,platform:this.platform,connectedAccounts:this.connectedAccounts}}getConnectedAccounts(){return this.connectedAccounts}async connect(t){if(t&&this.connectedAccounts.includes(Qr(t))&&(this.account=Qr(t)),this.account)return{success:!0,wallet:this.type,account:this.account};try{if(!this.isAvailable())throw new Error(`${this.displayName} is not available`);let n;const r=this.getProvider();if(r?n=r.provider:this.rdns==="io.metamask"&&window.ethereum?.isMetaMask&&(n=window.ethereum),!n)throw new Error(`${this.displayName} provider not found`);const s=await n.request({method:"eth_requestAccounts"});if(s&&s.length>0)return this.account=Qr(s[0]),this.connectedAccounts=s.map(Qr),!r&&this.rdns==="io.metamask"&&(this.provider={info:{uuid:"metamask-fallback",name:"MetaMask",icon:"data:image/svg+xml;base64,",rdns:"io.metamask"},provider:n},this.initializeIfAvailable()),{success:!0,wallet:this.type,account:this.account};throw new Error("No accounts found")}catch(n){return console.error(`Error connecting to ${this.displayName}:`,n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async signTransaction(t){try{if(!this.isAvailable()||!this.account)throw new Error(`${this.displayName} is not connected`);const n=this.getEthereumProvider();if(!n)throw new Error(`${this.displayName} is not connected`);const r=await n.request({method:"eth_sendTransaction",params:[t]});return{success:!0,wallet:this.type,result:r}}catch(n){return console.error(`Error signing transaction with ${this.displayName}:`,n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async signMessage(t,n){try{if(!this.isAvailable()||!this.account)throw new Error(`${this.displayName} is not connected`);const r=this.getEthereumProvider();if(!r)throw new Error(`${this.displayName} provider not found`);const s=await r.request({method:"personal_sign",params:[t,n||this.account]});return{success:!0,wallet:this.type,result:s}}catch(r){return console.error(`Error signing message with ${this.displayName}:`,r),{success:!1,wallet:this.type,error:r.message||"Unknown error"}}}async signTypedData(t){try{if(!this.isAvailable()||!this.account)throw new Error(`${this.displayName} is not connected`);const n=this.getEthereumProvider();if(!n)throw new Error(`${this.displayName} is not connected`);const r=await n.request({method:"eth_signTypedData_v4",params:[this.account,JSON.stringify(t)]});return{success:!0,wallet:this.type,result:r}}catch(n){return console.error(`Error signing typed data with ${this.displayName}:`,n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async sendTransaction(t){try{if(!this.isAvailable()||!this.account)throw new Error(`${this.displayName} is not connected`);const n=this.getEthereumProvider();if(!n)throw new Error(`${this.displayName} is not connected`);const r=await n.request({method:"eth_sendTransaction",params:[t]});return{success:!0,wallet:this.type,result:r}}catch(n){return console.error(`Error sending transaction with ${this.displayName}:`,n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async switchChain(t){try{if(!this.isAvailable())throw new Error(`${this.displayName} is not available`);const n=this.getEthereumProvider();if(!n)throw new Error(`${this.displayName} is not connected`);try{return await n.request({method:"wallet_switchEthereumChain",params:[{chainId:t}]}),this.platform=Qp(t),!0}catch(r){throw r.code===4902&&console.warn(`Chain not added to ${this.displayName}`),r}}catch(n){return console.error(`Error switching chain for ${this.displayName}:`,n),!1}}async getBalance(t){try{if(!this.isAvailable()||!this.account)throw new Error(`${this.displayName} is not connected`);if(t)return{success:!1,wallet:this.type,error:"Not implemented for ERC20"};{const n=this.getEthereumProvider();if(!n)throw new Error(`${this.displayName} is not connected`);const r=await n.request({method:"eth_getBalance",params:[this.account,"latest"]});return{success:!0,wallet:this.type,result:r}}}catch(n){return console.error(`Error getting balance from ${this.displayName}:`,n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async waitForTransaction(t,n=6e4){try{if(!this.isAvailable())throw new Error(`${this.displayName} is not connected`);const r=this.getEthereumProvider();if(!r)throw new Error(`${this.displayName} is not connected`);const s=Date.now(),i=1e3;for(;Date.now()-s<n;){const o=await r.request({method:"eth_getTransactionReceipt",params:[t]});if(o)return{success:!0,wallet:this.type,result:o};await new Promise(a=>setTimeout(a,i))}throw new Error("Transaction confirmation timed out")}catch(r){return console.error(`Error waiting for transaction with ${this.displayName}:`,r),{success:!1,wallet:this.type,error:r.message||"Unknown error"}}}}class bU extends bb{type="base";rdns="com.coinbase.wallet";displayName="Base Wallet"}class wU extends bb{type="metamask";rdns="io.metamask";displayName="MetaMask"}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function wb(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function BA(e,...t){if(!wb(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function $A(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function kU(e){if(typeof e!="function")throw new Error("function expected");return!0}function Aa(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function pu(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function _f(e){if(!Array.isArray(e))throw new Error("array expected")}function yf(e,t){if(!$A(!0,t))throw new Error(`${e}: array of strings expected`)}function DA(e,t){if(!$A(!1,t))throw new Error(`${e}: array of numbers expected`)}function kb(...e){const t=i=>i,n=(i,o)=>a=>i(o(a)),r=e.map(i=>i.encode).reduceRight(n,t),s=e.map(i=>i.decode).reduce(n,t);return{encode:r,decode:s}}function Eb(e){const t=typeof e=="string"?e.split(""):e,n=t.length;yf("alphabet",t);const r=new Map(t.map((s,i)=>[s,i]));return{encode:s=>(_f(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${e}`);return t[i]})),decode:s=>(_f(s),s.map(i=>{Aa("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${e}`);return o}))}}function Tb(e=""){return Aa("join",e),{encode:t=>(yf("join.decode",t),t.join(e)),decode:t=>(Aa("join.decode",t),t.split(e))}}function EU(e,t="="){return pu(e),Aa("padding",t),{encode(n){for(yf("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){yf("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}function TU(e){return kU(e),{encode:t=>t,decode:t=>e(t)}}function qk(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(_f(e),!e.length)return[];let r=0;const s=[],i=Array.from(e,a=>{if(pu(a),a<0||a>=t)throw new Error(`invalid integer: ${a}`);return a}),o=i.length;for(;;){let a=0,c=!0;for(let l=r;l<o;l++){const u=i[l],d=t*a,f=d+u;if(!Number.isSafeInteger(f)||d/t!==a||f-u!==d)throw new Error("convertRadix: carry overflow");const h=f/n;a=f%n;const p=Math.floor(h);if(i[l]=p,!Number.isSafeInteger(p)||p*n+a!==f)throw new Error("convertRadix: carry overflow");if(c)p?c=!1:r=l;else continue}if(s.push(a),c)break}for(let a=0;a<e.length-1&&e[a]===0;a++)s.push(0);return s.reverse()}const MA=(e,t)=>t===0?e:MA(t,e%t),mf=(e,t)=>e+(t-MA(e,t)),eg=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function Hk(e,t,n,r){if(_f(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(mf(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${mf(t,n)}`);let s=0,i=0;const o=eg[t],a=eg[n]-1,c=[];for(const l of e){if(pu(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${t}`);if(s=s<<t|l,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)c.push((s>>i-n&a)>>>0);const u=eg[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-i&a,!r&&i>=t)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&c.push(s>>>0),c}function vU(e){pu(e);const t=2**8;return{encode:n=>{if(!wb(n))throw new Error("radix.encode input should be Uint8Array");return qk(Array.from(n),t,e)},decode:n=>(DA("radix.decode",n),Uint8Array.from(qk(n,e,t)))}}function LA(e,t=!1){if(pu(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(mf(8,e)>32||mf(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!wb(n))throw new Error("radix2.encode input should be Uint8Array");return Hk(Array.from(n),8,e,!t)},decode:n=>(DA("radix2.decode",n),Uint8Array.from(Hk(n,e,8,t)))}}const SU=typeof Uint8Array.from([]).toBase64=="function"&&typeof Uint8Array.fromBase64=="function",AU=SU?{encode(e){return BA(e),e.toBase64()},decode(e){return Aa("base64",e),Uint8Array.fromBase64(e,{lastChunkHandling:"strict"})}}:kb(LA(6),Eb("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),EU(6),Tb("")),IU=e=>kb(vU(58),Eb(e),Tb("")),D_=IU("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),NU={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},xU=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",RU={encode(e){return BA(e),e.toHex()},decode(e){return Aa("hex",e),Uint8Array.fromHex(e)}},tg=xU?RU:kb(LA(4),Eb("0123456789abcdef"),Tb(""),TU(e=>{if(typeof e!="string"||e.length%2!==0)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));function M_(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function xs(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}const UA=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function mo(e){return Object.prototype.toString.call(e)==="[object Object]"}function Hr(e){return Number.isSafeInteger(e)}const PA=e=>{if(e!==null&&typeof e!="string"&&!Rn(e)&&!xs(e)&&!Hr(e))throw new Error(`lengthCoder: expected null | number | Uint8Array | CoderType, got ${e} (${typeof e})`);return{encodeStream(t,n){if(e===null)return;if(Rn(e))return e.encodeStream(t,n);let r;if(typeof e=="number"?r=e:typeof e=="string"&&(r=Qi.resolve(t.stack,e)),typeof r=="bigint"&&(r=Number(r)),r===void 0||r!==n)throw t.err(`Wrong length: ${r} len=${e} exp=${n} (${typeof n})`)},decodeStream(t){let n;if(Rn(e)?n=Number(e.decodeStream(t)):typeof e=="number"?n=e:typeof e=="string"&&(n=Qi.resolve(t.stack,e)),typeof n=="bigint"&&(n=Number(n)),typeof n!="number")throw t.err(`Wrong length: ${n}`);return n}}},ut={BITS:32,FULL_MASK:-1>>>0,len:e=>Math.ceil(e/32),create:e=>new Uint32Array(ut.len(e)),clean:e=>e.fill(0),debug:e=>Array.from(e).map(t=>(t>>>0).toString(2).padStart(32,"0")),checkLen:(e,t)=>{if(ut.len(t)!==e.length)throw new Error(`wrong length=${e.length}. Expected: ${ut.len(t)}`)},chunkLen:(e,t,n)=>{if(t<0)throw new Error(`wrong pos=${t}`);if(t+n>e)throw new Error(`wrong range=${t}/${n} of ${e}`)},set:(e,t,n,r=!0)=>!r&&(e[t]&n)!==0?!1:(e[t]|=n,!0),pos:(e,t)=>({chunk:Math.floor((e+t)/32),mask:1<<32-(e+t)%32-1}),indices:(e,t,n=!1)=>{ut.checkLen(e,t);const{FULL_MASK:r,BITS:s}=ut,i=s-t%s,o=i?r>>>i<<i:r,a=[];for(let c=0;c<e.length;c++){let l=e[c];if(n&&(l=~l),c===e.length-1&&(l&=o),l!==0)for(let u=0;u<s;u++){const d=1<<s-u-1;l&d&&a.push(c*s+u)}}return a},range:e=>{const t=[];let n;for(const r of e)n===void 0||r!==n.pos+n.length?t.push(n={pos:r,length:1}):n.length+=1;return t},rangeDebug:(e,t,n=!1)=>`[${ut.range(ut.indices(e,t,n)).map(r=>`(${r.pos}/${r.length})`).join(", ")}]`,setRange:(e,t,n,r,s=!0)=>{ut.chunkLen(t,n,r);const{FULL_MASK:i,BITS:o}=ut,a=n%o?Math.floor(n/o):void 0,c=n+r,l=c%o?Math.floor(c/o):void 0;if(a!==void 0&&a===l)return ut.set(e,a,i>>>o-r<<o-r-n,s);if(a!==void 0&&!ut.set(e,a,i>>>n%o,s))return!1;const u=a!==void 0?a+1:n/o,d=l!==void 0?l:c/o;for(let f=u;f<d;f++)if(!ut.set(e,f,i,s))return!1;return!(l!==void 0&&a!==l&&!ut.set(e,l,i<<o-c%o,s))}},Qi={pushObj:(e,t,n)=>{const r={obj:t};e.push(r),n((s,i)=>{r.field=s,i(),r.field=void 0}),e.pop()},path:e=>{const t=[];for(const n of e)n.field!==void 0&&t.push(n.field);return t.join("/")},err:(e,t,n)=>{const r=new Error(`${e}(${Qi.path(t)}): ${typeof n=="string"?n:n.message}`);return n instanceof Error&&n.stack&&(r.stack=n.stack),r},resolve:(e,t)=>{const n=t.split("/"),r=e.map(o=>o.obj);let s=0;for(;s<n.length&&n[s]==="..";s++)r.pop();let i=r.pop();for(;s<n.length;s++){if(!i||i[n[s]]===void 0)return;i=i[n[s]]}return i}};class vb{constructor(t,n={},r=[],s=void 0,i=0){this.pos=0,this.bitBuf=0,this.bitPos=0,this.data=t,this.opts=n,this.stack=r,this.parent=s,this.parentOffset=i,this.view=UA(t)}_enablePointers(){if(this.parent)return this.parent._enablePointers();this.bs||(this.bs=ut.create(this.data.length),ut.setRange(this.bs,this.data.length,0,this.pos,this.opts.allowMultipleReads))}markBytesBS(t,n){return this.parent?this.parent.markBytesBS(this.parentOffset+t,n):!n||!this.bs?!0:ut.setRange(this.bs,this.data.length,t,n,!1)}markBytes(t){const n=this.pos;this.pos+=t;const r=this.markBytesBS(n,t);if(!this.opts.allowMultipleReads&&!r)throw this.err(`multiple read pos=${this.pos} len=${t}`);return r}pushObj(t,n){return Qi.pushObj(this.stack,t,n)}readView(t,n){if(!Number.isFinite(t))throw this.err(`readView: wrong length=${t}`);if(this.pos+t>this.data.length)throw this.err("readView: Unexpected end of buffer");const r=n(this.view,this.pos);return this.markBytes(t),r}absBytes(t){if(t>this.data.length)throw new Error("Unexpected end of buffer");return this.data.subarray(t)}finish(){if(!this.opts.allowUnreadBytes){if(this.bitPos)throw this.err(`${this.bitPos} bits left after unpack: ${tg.encode(this.data.slice(this.pos))}`);if(this.bs&&!this.parent){const t=ut.indices(this.bs,this.data.length,!0);if(t.length){const n=ut.range(t).map(({pos:r,length:s})=>`(${r}/${s})[${tg.encode(this.data.subarray(r,r+s))}]`).join(", ");throw this.err(`unread byte ranges: ${n} (total=${this.data.length})`)}else return}if(!this.isEnd())throw this.err(`${this.leftBytes} bytes ${this.bitPos} bits left after unpack: ${tg.encode(this.data.slice(this.pos))}`)}}err(t){return Qi.err("Reader",this.stack,t)}offsetReader(t){if(t>this.data.length)throw this.err("offsetReader: Unexpected end of buffer");return new vb(this.absBytes(t),this.opts,this.stack,this,t)}bytes(t,n=!1){if(this.bitPos)throw this.err("readBytes: bitPos not empty");if(!Number.isFinite(t))throw this.err(`readBytes: wrong length=${t}`);if(this.pos+t>this.data.length)throw this.err("readBytes: Unexpected end of buffer");const r=this.data.subarray(this.pos,this.pos+t);return n||this.markBytes(t),r}byte(t=!1){if(this.bitPos)throw this.err("readByte: bitPos not empty");if(this.pos+1>this.data.length)throw this.err("readBytes: Unexpected end of buffer");const n=this.data[this.pos];return t||this.markBytes(1),n}get leftBytes(){return this.data.length-this.pos}get totalBytes(){return this.data.length}isEnd(){return this.pos>=this.data.length&&!this.bitPos}bits(t){if(t>32)throw this.err("BitReader: cannot read more than 32 bits in single call");let n=0;for(;t;){this.bitPos||(this.bitBuf=this.byte(),this.bitPos=8);const r=Math.min(t,this.bitPos);this.bitPos-=r,n=n<<r|this.bitBuf>>this.bitPos&2**r-1,this.bitBuf&=2**this.bitPos-1,t-=r}return n>>>0}find(t,n=this.pos){if(!xs(t))throw this.err(`find: needle is not bytes! ${t}`);if(this.bitPos)throw this.err("findByte: bitPos not empty");if(!t.length)throw this.err("find: needle is empty");for(let r=n;(r=this.data.indexOf(t[0],r))!==-1;r++){if(r===-1||this.data.length-r<t.length)return;if(M_(t,this.data.subarray(r,r+t.length)))return r}}}class CU{constructor(t=[]){this.pos=0,this.buffers=[],this.ptrs=[],this.bitBuf=0,this.bitPos=0,this.viewBuf=new Uint8Array(8),this.finished=!1,this.stack=t,this.view=UA(this.viewBuf)}pushObj(t,n){return Qi.pushObj(this.stack,t,n)}writeView(t,n){if(this.finished)throw this.err("buffer: finished");if(!Hr(t)||t>8)throw new Error(`wrong writeView length=${t}`);n(this.view),this.bytes(this.viewBuf.slice(0,t)),this.viewBuf.fill(0)}err(t){if(this.finished)throw this.err("buffer: finished");return Qi.err("Reader",this.stack,t)}bytes(t){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("writeBytes: ends with non-empty bit buffer");this.buffers.push(t),this.pos+=t.length}byte(t){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("writeByte: ends with non-empty bit buffer");this.buffers.push(new Uint8Array([t])),this.pos++}finish(t=!0){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("buffer: ends with non-empty bit buffer");const n=this.buffers.concat(this.ptrs.map(i=>i.buffer)),r=n.map(i=>i.length).reduce((i,o)=>i+o,0),s=new Uint8Array(r);for(let i=0,o=0;i<n.length;i++){const a=n[i];s.set(a,o),o+=a.length}for(let i=this.pos,o=0;o<this.ptrs.length;o++){const a=this.ptrs[o];s.set(a.ptr.encode(i),a.pos),i+=a.buffer.length}if(t){this.buffers=[];for(const i of this.ptrs)i.buffer.fill(0);this.ptrs=[],this.finished=!0,this.bitBuf=0}return s}bits(t,n){if(n>32)throw this.err("writeBits: cannot write more than 32 bits in single call");if(t>=2**n)throw this.err(`writeBits: value (${t}) >= 2**bits (${n})`);for(;n;){const r=Math.min(n,8-this.bitPos);this.bitBuf=this.bitBuf<<r|t>>n-r,this.bitPos+=r,n-=r,t&=2**n-1,this.bitPos===8&&(this.bitPos=0,this.buffers.push(new Uint8Array([this.bitBuf])),this.pos++)}}}const L_=e=>Uint8Array.from(e).reverse();function OU(e,t,n){if(n){const r=2n**(t-1n);if(e<-r||e>=r)throw new Error(`value out of signed bounds. Expected ${-r} <= ${e} < ${r}`)}else if(0n>e||e>=2n**t)throw new Error(`value out of unsigned bounds. Expected 0 <= ${e} < ${2n**t}`)}function FA(e){return{encodeStream:e.encodeStream,decodeStream:e.decodeStream,size:e.size,encode:t=>{const n=new CU;return e.encodeStream(n,t),n.finish()},decode:(t,n={})=>{const r=new vb(t,n),s=e.decodeStream(r);return r.finish(),s}}}function jA(e,t){if(!Rn(e))throw new Error(`validate: invalid inner value ${e}`);if(typeof t!="function")throw new Error("validate: fn should be function");return FA({size:e.size,encodeStream:(n,r)=>{let s;try{s=t(r)}catch(i){throw n.err(i)}e.encodeStream(n,s)},decodeStream:n=>{const r=e.decodeStream(n);try{return t(r)}catch(s){throw n.err(s)}}})}const Zt=e=>{const t=FA(e);return e.validate?jA(t,e.validate):t},Nh=e=>mo(e)&&typeof e.decode=="function"&&typeof e.encode=="function";function Rn(e){return mo(e)&&Nh(e)&&typeof e.encodeStream=="function"&&typeof e.decodeStream=="function"&&(e.size===void 0||Hr(e.size))}function BU(){return{encode:e=>{if(!Array.isArray(e))throw new Error("array expected");const t={};for(const n of e){if(!Array.isArray(n)||n.length!==2)throw new Error("array of two elements expected");const r=n[0],s=n[1];if(t[r]!==void 0)throw new Error(`key(${r}) appears twice in struct`);t[r]=s}return t},decode:e=>{if(!mo(e))throw new Error(`expected plain object, got ${e}`);return Object.entries(e)}}}const $U={encode:e=>{if(typeof e!="bigint")throw new Error(`expected bigint, got ${typeof e}`);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error(`element bigger than MAX_SAFE_INTEGER=${e}`);return Number(e)},decode:e=>{if(!Hr(e))throw new Error("element is not a safe integer");return BigInt(e)}};function DU(e){if(!mo(e))throw new Error("plain object expected");return{encode:t=>{if(!Hr(t)||!(t in e))throw new Error(`wrong value ${t}`);return e[t]},decode:t=>{if(typeof t!="string")throw new Error(`wrong value ${typeof t}`);return e[t]}}}function MU(e,t=!1){if(!Hr(e))throw new Error(`decimal/precision: wrong value ${e}`);if(typeof t!="boolean")throw new Error(`decimal/round: expected boolean, got ${typeof t}`);const n=10n**BigInt(e);return{encode:r=>{if(typeof r!="bigint")throw new Error(`expected bigint, got ${typeof r}`);let s=(r<0n?-r:r).toString(10),i=s.length-e;i<0&&(s=s.padStart(s.length-i,"0"),i=0);let o=s.length-1;for(;o>=i&&s[o]==="0";o--);let a=s.slice(0,i),c=s.slice(i,o+1);return a||(a="0"),r<0n&&(a="-"+a),c?`${a}.${c}`:a},decode:r=>{if(typeof r!="string")throw new Error(`expected string, got ${typeof r}`);if(r==="-0")throw new Error("negative zero is not allowed");let s=!1;if(r.startsWith("-")&&(s=!0,r=r.slice(1)),!/^(0|[1-9]\d*)(\.\d+)?$/.test(r))throw new Error(`wrong string value=${r}`);let i=r.indexOf(".");i=i===-1?r.length:i;const o=r.slice(0,i),a=r.slice(i+1).replace(/0+$/,""),c=BigInt(o)*n;if(!t&&a.length>e)throw new Error(`fractional part cannot be represented with this precision (num=${r}, prec=${e})`);const l=Math.min(a.length,e),u=BigInt(a.slice(0,l))*10n**BigInt(e-l),d=c+u;return s?-d:d}}}function LU(e){if(!Array.isArray(e))throw new Error(`expected array, got ${typeof e}`);for(const t of e)if(!Nh(t))throw new Error(`wrong base coder ${t}`);return{encode:t=>{for(const n of e){const r=n.encode(t);if(r!==void 0)return r}throw new Error(`match/encode: cannot find match in ${t}`)},decode:t=>{for(const n of e){const r=n.decode(t);if(r!==void 0)return r}throw new Error(`match/decode: cannot find match in ${t}`)}}}const UU=e=>{if(!Nh(e))throw new Error("BaseCoder expected");return{encode:e.decode,decode:e.encode}},Kc={dict:BU,numberBigint:$U,tsEnum:DU,decimal:MU,match:LU,reverse:UU},PU=(e,t=!1,n=!1,r=!0)=>{if(!Hr(e))throw new Error(`bigint/size: wrong value ${e}`);if(typeof t!="boolean")throw new Error(`bigint/le: expected boolean, got ${typeof t}`);if(typeof n!="boolean")throw new Error(`bigint/signed: expected boolean, got ${typeof n}`);if(typeof r!="boolean")throw new Error(`bigint/sized: expected boolean, got ${typeof r}`);const s=BigInt(e),i=2n**(8n*s-1n);return Zt({size:r?e:void 0,encodeStream:(o,a)=>{n&&a<0&&(a=a|i);const c=[];for(let u=0;u<e;u++)c.push(Number(a&255n)),a>>=8n;let l=new Uint8Array(c).reverse();if(!r){let u=0;for(u=0;u<l.length&&l[u]===0;u++);l=l.subarray(u)}o.bytes(t?l.reverse():l)},decodeStream:o=>{const a=o.bytes(r?e:Math.min(e,o.leftBytes)),c=t?a:L_(a);let l=0n;for(let u=0;u<c.length;u++)l|=BigInt(c[u])<<8n*BigInt(u);return n&&l&i&&(l=(l^i)-i),l},validate:o=>{if(typeof o!="bigint")throw new Error(`bigint: invalid value: ${o}`);return OU(o,8n*s,!!n),o}})},Ke=PU(8,!0),FU=(e,t)=>Zt({size:e,encodeStream:(n,r)=>n.writeView(e,s=>t.write(s,r)),decodeStream:n=>n.readView(e,t.read),validate:n=>{if(typeof n!="number")throw new Error(`viewCoder: expected number, got ${typeof n}`);return t.validate&&t.validate(n),n}}),VA=(e,t,n)=>{const r=e*8,s=2**r,i=o=>{if(!Hr(o))throw new Error(`uintView: value is not safe integer: ${o}`);if(0>o||o>=s)throw new Error(`uintView: value out of bounds. Expected 0 <= ${o} < ${s}`)};return FU(e,{write:n.write,read:n.read,validate:i})},bf=VA(4,!1,{read:(e,t)=>e.getUint32(t,!0),write:(e,t)=>e.setUint32(0,t,!0)}),tn=VA(1,!1,{read:(e,t)=>e.getUint8(t),write:(e,t)=>e.setUint8(0,t)}),U_=Zt({size:1,encodeStream:(e,t)=>e.byte(t?1:0),decodeStream:e=>{const t=e.byte();if(t!==0&&t!==1)throw e.err(`bool: invalid value ${t}`);return t===1},validate:e=>{if(typeof e!="boolean")throw new Error(`bool: invalid value ${e}`);return e}}),xh=(e,t=!1)=>{if(typeof t!="boolean")throw new Error(`bytes/le: expected boolean, got ${typeof t}`);const n=PA(e),r=xs(e);return Zt({size:typeof e=="number"?e:void 0,encodeStream:(s,i)=>{r||n.encodeStream(s,i.length),s.bytes(t?L_(i):i),r&&s.bytes(e)},decodeStream:s=>{let i;if(r){const o=s.find(e);if(!o)throw s.err("bytes: cannot find terminator");i=s.bytes(o-s.pos),s.bytes(e.length)}else i=s.bytes(e===null?s.leftBytes:n.decodeStream(s));return t?L_(i):i},validate:s=>{if(!xs(s))throw new Error(`bytes: invalid value ${s}`);return s}})},jU=(e,t=!1)=>jA(VU(xh(e,t),NU),n=>{if(typeof n!="string")throw new Error(`expected string, got ${typeof n}`);return n});function VU(e,t){if(!Rn(e))throw new Error(`apply: invalid inner value ${e}`);if(!Nh(t))throw new Error(`apply: invalid base value ${e}`);return Zt({size:e.size,encodeStream:(n,r)=>{let s;try{s=t.decode(r)}catch(i){throw n.err(""+i)}return e.encodeStream(n,s)},decodeStream:n=>{const r=e.decodeStream(n);try{return t.encode(r)}catch(s){throw n.err(""+s)}}})}function ul(e,t,n){if(!Rn(e)||!Rn(t))throw new Error(`optional: invalid flag or inner value flag=${e} inner=${t}`);return Zt({size:n!==void 0&&e.size&&t.size?e.size+t.size:void 0,encodeStream:(r,s)=>{e.encodeStream(r,!!s),s?t.encodeStream(r,s):n!==void 0&&t.encodeStream(r,n)},decodeStream:r=>{if(e.decodeStream(r))return t.decodeStream(r);n!==void 0&&t.decodeStream(r)}})}function zU(e){return Zt({encodeStream:(t,n)=>{if(n!==e)throw new Error(`constant: invalid value ${n} (exp: ${e})`)},decodeStream:t=>e})}function qU(e){let t=0;for(const n of e){if(n.size===void 0)return;if(!Hr(n.size))throw new Error(`sizeof: wrong element size=${t}`);t+=n.size}return t}function fe(e){if(!mo(e))throw new Error(`struct: expected plain object, got ${e}`);for(const t in e)if(!Rn(e[t]))throw new Error(`struct: field ${t} is not CoderType`);return Zt({size:qU(Object.values(e)),encodeStream:(t,n)=>{t.pushObj(n,r=>{for(const s in e)r(s,()=>e[s].encodeStream(t,n[s]))})},decodeStream:t=>{const n={};return t.pushObj(n,r=>{for(const s in e)r(s,()=>n[s]=e[s].decodeStream(t))}),n},validate:t=>{if(typeof t!="object"||t===null)throw new Error(`struct: invalid value ${t}`);return t}})}function Td(e,t){if(!Rn(t))throw new Error(`array: invalid inner value ${t}`);const n=PA(typeof e=="string"?`../${e}`:e);return Zt({size:typeof e=="number"&&t.size?e*t.size:void 0,encodeStream:(r,s)=>{const i=r;i.pushObj(s,o=>{xs(e)||n.encodeStream(r,s.length);for(let a=0;a<s.length;a++)o(`${a}`,()=>{const c=s[a],l=r.pos;if(t.encodeStream(r,c),xs(e)){if(e.length>i.pos-l)return;const u=i.finish(!1).subarray(l,i.pos);if(M_(u.subarray(0,e.length),e))throw i.err(`array: inner element encoding same as separator. elm=${c} data=${u}`)}})}),xs(e)&&r.bytes(e)},decodeStream:r=>{const s=[];return r.pushObj(s,i=>{if(e===null)for(let o=0;!r.isEnd()&&(i(`${o}`,()=>s.push(t.decodeStream(r))),!(t.size&&r.leftBytes<t.size));o++);else if(xs(e))for(let o=0;;o++){if(M_(r.bytes(e.length,!0),e)){r.bytes(e.length);break}i(`${o}`,()=>s.push(t.decodeStream(r)))}else{let o;i("arrayLen",()=>o=n.decodeStream(r));for(let a=0;a<o;a++)i(`${a}`,()=>s.push(t.decodeStream(r)))}}),s},validate:r=>{if(!Array.isArray(r))throw new Error(`array: invalid value ${r}`);return r}})}function Sb(e,t){if(!Rn(e))throw new Error(`map: invalid inner value ${e}`);if(!mo(t))throw new Error("map: variants should be plain object");const n=new Map;for(const r in t)n.set(t[r],r);return Zt({size:e.size,encodeStream:(r,s)=>e.encodeStream(r,t[s]),decodeStream:r=>{const s=e.decodeStream(r),i=n.get(s);if(i===void 0)throw r.err(`Enum: unknown value: ${s} ${Array.from(n.keys())}`);return i},validate:r=>{if(typeof r!="string")throw new Error(`map: invalid value ${r}`);if(!(r in t))throw new Error(`Map: unknown variant: ${r}`);return r}})}function HU(e,t){if(!Rn(e))throw new Error(`tag: invalid tag value ${e}`);if(!mo(t))throw new Error("tag: variants should be plain object");for(const n in t)if(!Rn(t[n]))throw new Error(`tag: variant ${n} is not CoderType`);return Zt({size:e.size,encodeStream:(n,r)=>{const{TAG:s,data:i}=r,o=t[s];e.encodeStream(n,s),o.encodeStream(n,i)},decodeStream:n=>{const r=e.decodeStream(n),s=t[r];if(!s)throw n.err(`Tag: invalid tag ${r}`);return{TAG:r,data:s.decodeStream(n)}},validate:n=>{const{TAG:r}=n;if(!t[r])throw new Error(`Tag: invalid tag ${r.toString()}`);return n}})}const WU=e=>0;function ng(e,t){return t%e===0?0:e-t%e}function zA(e,t,n){if(!Rn(t))throw new Error(`padRight: invalid inner value ${t}`);if(!Hr(e)||e<=0)throw new Error(`padLeft: wrong blockSize=${e}`);if(n!==void 0&&typeof n!="function")throw new Error(`padRight: wrong padFn=${typeof n}`);const r=n||WU;return Zt({size:t.size?t.size+ng(e,t.size):void 0,encodeStream:(s,i)=>{const o=s,a=o.pos;t.encodeStream(s,i);const c=ng(e,o.pos-a);for(let l=0;l<c;l++)s.byte(r(l))},decodeStream:s=>{const i=s.pos,o=t.decodeStream(s);return s.bytes(ng(e,s.pos-i)),o}})}const KU=9,rg=Kc.decimal(KU),Yc=Zt({encodeStream:(e,t)=>{if(!t)return e.byte(0);for(;t;t>>=7)e.bits(t>127?1:0,1),e.bits(t&127,7)},decodeStream:e=>{let t=0;for(let n=0;!e.isEnd();n++){const r=!e.bits(1);if(t|=e.bits(7)<<n*7,r)break}return t}}),Ju=jU(zA(8,bf,void 0)),YU=()=>{const e=xh(32);return Zt({size:e.size,encodeStream:(t,n)=>e.encodeStream(t,D_.decode(n)),decodeStream:t=>D_.encode(e.decodeStream(t))})},Ue=YU(),GU=fe({requiredSignatures:tn,readSigned:tn,readUnsigned:tn,keys:Td(Yc,Ue),blockhash:Ue,instructions:Td(Yc,fe({programIdx:tn,keys:Td(Yc,tn),data:xh(Yc)}))});function ZU(e){if(D_.decode(e).length!==32)throw new Error("Invalid Solana address")}const JU=(e,t,n,r,s)=>({sign:e<t,write:e<t-n||e>=t&&e<s-r}),Wk=fe({signatures:Td(Yc,xh(64)),msg:GU}),P_=Zt({encodeStream:(e,t)=>{const{msg:n,signatures:r}=t,s={},i=(d,f,h)=>{let p=s[d]||(s[d]={sign:!1,write:!1});p.write||(p.write=h),p.sign||(p.sign=f)};i(n.feePayer,!0,!0);for(let d of n.instructions)for(let f of d.keys)i(f.address,f.sign,f.write);for(let d of n.instructions)i(d.program,!1,!1);const o=Object.keys(s),a=[n.feePayer,...o.filter(d=>s[d].sign&&s[d].write&&d!==n.feePayer),...o.filter(d=>s[d].sign&&!s[d].write),...o.filter(d=>!s[d].sign&&s[d].write),...o.filter(d=>!s[d].sign&&!s[d].write)];let c=0,l=0,u=0;for(let d of a)s[d].sign&&c++,!s[d].write&&(s[d].sign?l++:u++);Wk.encodeStream(e,{signatures:a.filter(d=>s[d].sign).map(d=>r[d]||new Uint8Array(64)),msg:{requiredSignatures:c,readSigned:l,readUnsigned:u,keys:a,instructions:n.instructions.map(d=>({programIdx:a.indexOf(d.program),keys:d.keys.map(f=>a.indexOf(f.address)),data:d.data})),blockhash:n.blockhash}})},decodeStream:e=>{const{signatures:t,msg:n}=Wk.decodeStream(e);if(t.length!==n.requiredSignatures)throw new Error("SOL.tx: wrong signatures length");if(n.keys.length<t.length)throw new Error("SOL.tx: invalid keys length");const r={};for(let i=0;i<t.length;i++)r[n.keys[i]]=t[i];let s=[];for(let i=0;i<n.keys.length;i++)s.push({address:n.keys[i],...JU(i,n.requiredSignatures,n.readSigned,n.readUnsigned,n.keys.length)});if(!s.length)throw new Error("SOL.tx: empty accounts array");return{msg:{feePayer:s[0].address,blockhash:n.blockhash,instructions:n.instructions.map(i=>({program:s[i.programIdx].address,keys:i.keys.map(o=>s[o]),data:i.data}))},signatures:r}}}),Kk={};function Ab(e,t,n){if(Kk[e])throw new Error("SOL: program for this address already defined");const r=Sb(t,Object.keys(n).reduce((a,c,l)=>({...a,[c]:l}),{})),s=Object.keys(n).reduce((a,c)=>({...a,[c]:n[c].coder}),{}),i=HU(r,s);Kk[e]=(a,c)=>{if(a.program!==e)throw new Error("SOL.parseInstruction: Wrong instruction program address");const{TAG:l,data:u}=i.decode(a.data),d={type:l,info:u},f=Object.keys(n[l].keys);if(f.length!==a.keys.length)throw new Error("SOL.parseInstruction: Keys length mismatch");for(let h=0;h<f.length;h++){const p=f[h];if(n[l].keys[p].address){if(n[l].keys[p].address!==a.keys[h].address)throw new Error(`SOL.parseInstruction(${e}/${l}): Invalid constant address for key exp=${n[l].keys[p].address} got=${a.keys[h].address}`);continue}d.info[f[h]]=a.keys[h].address}return n[l].hint&&(d.hint=n[l].hint(u,c)),d};const o={};for(const a in n)o[a]=c=>({program:e,data:i.encode({TAG:a,data:c}),keys:Object.keys(n[a].keys).map(l=>{let{sign:u,write:d,address:f}=n[a].keys[l];return f||(f=c[l]),ZU(f),{address:f,sign:u,write:d}})});return o}const sg="SysvarRecentB1ockHashes11111111111111111111",Ri="SysvarRent111111111111111111111111111111111",qA="11111111111111111111111111111111",HA=Ab(qA,bf,{createAccount:{coder:fe({lamports:Ke,space:Ke,owner:Ue}),keys:{source:{sign:!0,write:!0},newAccount:{sign:!0,write:!0}},hint:e=>`Create new account=${e.newAccount} with balance of ${rg.encode(e.lamports)} and owner program ${e.owner}, using funding account ${e.source}`},assign:{coder:fe({owner:Ue}),keys:{account:{sign:!0,write:!0}},hint:e=>`Assign account=${e.account} to owner program=${e.owner}`},transfer:{coder:fe({lamports:Ke}),keys:{source:{sign:!0,write:!0},destination:{sign:!1,write:!0}},hint:e=>`Transfer ${rg.encode(e.lamports)} SOL from ${e.source} to ${e.destination}`},createAccountWithSeed:{coder:fe({base:Ue,seed:Ju,lamports:Ke,space:Ke,owner:Ue}),keys:{source:{sign:!0,write:!0},newAccount:{sign:!1,write:!0},base:{sign:!0,write:!1}}},advanceNonce:{coder:fe({}),keys:{nonceAccount:{sign:!1,write:!0},_recent_bh:{address:sg,sign:!1,write:!1},nonceAuthority:{sign:!0,write:!1}},hint:e=>`Consume nonce in nonce account=${e.nonceAccount} (owner: ${e.nonceAuthority})`},withdrawFromNonce:{coder:fe({lamports:Ke}),keys:{nonceAccount:{sign:!1,write:!0},destination:{sign:!1,write:!0},_recent_bh:{address:sg,sign:!1,write:!1},_rent:{address:Ri,sign:!1,write:!1},nonceAuthority:{sign:!0,write:!1}},hint:e=>`Withdraw ${rg.encode(e.lamports)} SOL from nonce account=${e.nonceAccount} (owner: ${e.nonceAuthority}) to ${e.destination}`},initializeNonce:{coder:fe({nonceAuthority:Ue}),keys:{nonceAccount:{sign:!1,write:!0},_recent_bh:{address:sg,sign:!1,write:!1},_rent:{address:Ri,sign:!1,write:!1}}},authorizeNonce:{coder:fe({newAuthorized:Ue}),keys:{nonceAccount:{sign:!1,write:!0},nonceAuthority:{sign:!0,write:!1}},hint:e=>`Change owner of nonce account=${e.nonceAccount} from ${e.nonceAuthority} to ${e.newAuthorized}`},allocate:{coder:fe({space:Ke}),keys:{account:{sign:!0,write:!0}}},allocateWithSeed:{coder:fe({base:Ue,seed:Ju,space:Ke,owner:Ue}),keys:{account:{sign:!1,write:!0},base:{sign:!0,write:!1}}},assignWithSeed:{coder:fe({base:Ue,seed:Ju,owner:Ue}),keys:{account:{sign:!1,write:!0},base:{sign:!0,write:!1}}},transferWithSeed:{coder:fe({lamports:Ke,sourceSeed:Ju,sourceOwner:Ue}),keys:{source:{sign:!1,write:!0},sourceBase:{sign:!0,write:!1},destination:{sign:!1,write:!0}}}}),WA=e=>{};WA(HA.transfer);WA(HA.advanceNonce);const XU=Sb(tn,{MintTokens:0,FreezeAccount:1,AccountOwner:2,CloseAccount:3}),mi=(e,t)=>t[e]?.symbol||e,KA="TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA";Ab(KA,tn,{initializeMint:{coder:fe({decimals:tn,mintAuthority:Ue,freezeAuthority:ul(U_,Ue,"11111111111111111111111111111111")}),keys:{mint:{sign:!1,write:!0},_rent:{address:Ri,sign:!1,write:!1}}},initializeAccount:{coder:fe({}),keys:{account:{sign:!1,write:!0},mint:{sign:!1,write:!1},owner:{sign:!1,write:!1},_rent:{address:Ri,sign:!1,write:!1}},hint:(e,t)=>`Initialize token account=${e.account} with owner=${e.owner} token=${mi(e.mint,t)}`},initializeMultisig:{coder:fe({m:tn}),keys:{account:{sign:!1,write:!0},_rent:{address:Ri,sign:!1,write:!1}},hint:(e,t)=>`Initialize multi-sig token account=${e.account} with signatures=${e.m}`},transfer:{coder:fe({amount:Ke}),keys:{source:{sign:!1,write:!0},destination:{sign:!1,write:!0},owner:{sign:!0,write:!1}},hint:(e,t)=>`Transfer ${e.amount} from token account=${e.source} of owner=${e.owner} to ${e.destination}`},approve:{coder:fe({amount:Ke}),keys:{account:{sign:!1,write:!0},delegate:{sign:!1,write:!1},owner:{sign:!0,write:!1}},hint:(e,t)=>`Approve authority of delegate=${e.delegate} over tokens on account=${e.account} on behalf of owner=${e.owner}`},revoke:{coder:fe({}),keys:{account:{sign:!1,write:!0},owner:{sign:!0,write:!1}},hint:(e,t)=>`Revoke delegate's authority over tokens on account=${e.account} on behalf of owner=${e.owner}`},setAuthority:{coder:fe({authorityType:XU,newAuthority:ul(U_,Ue,"11111111111111111111111111111111")}),keys:{account:{sign:!1,write:!0},currentAuthority:{sign:!0,write:!1}},hint:(e,t)=>`Sets a new authority=${e.newAuthority} of a mint or account=${e.account}. Current authority=${e.currentAuthority}. Authority Type: ${e.authorityType}`},mintTo:{coder:fe({amount:Ke}),keys:{mint:{sign:!1,write:!0},dest:{sign:!1,write:!0},authority:{sign:!0,write:!1}}},burn:{coder:fe({amount:Ke}),keys:{account:{sign:!1,write:!0},mint:{sign:!1,write:!0},owner:{sign:!0,write:!1}},hint:(e,t)=>`Burn ${e.amount} tokens from account=${e.account} of owner=${e.owner} mint=${e.mint}`},closeAccount:{coder:fe({}),keys:{account:{sign:!1,write:!0},dest:{sign:!1,write:!0},owner:{sign:!0,write:!1}},hint:(e,t)=>`Close token account=${e.account} of owner=${e.owner}, transferring all its SOL to destionation account=${e.dest}`},freezeAccount:{coder:fe({}),keys:{account:{sign:!1,write:!0},mint:{sign:!1,write:!0},authority:{sign:!0,write:!1}},hint:(e,t)=>`Freeze token account=${e.account} of mint=${e.mint} using freeze_authority=${e.authority}`},thawAccount:{coder:fe({}),keys:{account:{sign:!1,write:!0},mint:{sign:!1,write:!1},authority:{sign:!0,write:!1}},hint:(e,t)=>`Thaw a frozne token account=${e.account} of mint=${e.mint} using freeze_authority=${e.authority}`},transferChecked:{coder:fe({amount:Ke,decimals:tn}),keys:{source:{sign:!1,write:!0},mint:{sign:!1,write:!1},destination:{sign:!1,write:!0},owner:{sign:!0,write:!1}},hint:(e,t)=>`Transfer ${Kc.decimal(e.decimals).encode(e.amount)} ${mi(e.mint,t)} from token account=${e.source} of owner=${e.owner} to ${e.destination}`},approveChecked:{coder:fe({amount:Ke,decimals:tn}),keys:{source:{sign:!1,write:!0},mint:{sign:!1,write:!1},delegate:{sign:!1,write:!1},owner:{sign:!0,write:!1}},hint:(e,t)=>`Approve delgate=${e.delegate} authority on behalf account=${e.source} owner=${e.owner} over ${Kc.decimal(e.decimals).encode(e.amount)} ${mi(e.mint,t)}`},mintToChecked:{coder:fe({amount:Ke,decimals:tn}),keys:{mint:{sign:!1,write:!0},dest:{sign:!1,write:!0},authority:{sign:!0,write:!1}},hint:(e,t)=>`Mint new tokens (${Kc.decimal(e.decimals).encode(e.amount)} ${mi(e.mint,t)}) to account=${e.dest} using authority=${e.authority}`},burnChecked:{coder:fe({amount:Ke,decimals:tn}),keys:{mint:{sign:!1,write:!0},account:{sign:!1,write:!0},owner:{sign:!0,write:!1}},hint:(e,t)=>`Burn tokens (${Kc.decimal(e.decimals).encode(e.amount)} ${mi(e.mint,t)}) on account=${e.account} of owner=${e.owner}`},initializeAccount2:{coder:fe({owner:Ue}),keys:{account:{sign:!1,write:!0},mint:{sign:!1,write:!1},_rent:{address:Ri,sign:!1,write:!1}},hint:(e,t)=>`Initialize token account=${e.account} with owner=${e.owner} token=${mi(e.mint,t)}`},syncNative:{coder:fe({}),keys:{nativeAccount:{sign:!1,write:!0}},hint:e=>`Sync SOL balance for wrapped account ${e.nativeAccount}`}});fe({version:bf,state:bf,authority:Ue,nonce:Ue,lamportPerSignature:Ke});const QU="ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL";Ab(QU,zU(0),{create:{coder:fe({}),keys:{source:{sign:!0,write:!0},account:{sign:!1,write:!0},wallet:{sign:!1,write:!1},mint:{sign:!1,write:!1},_sys:{address:qA,sign:!1,write:!1},_token:{address:KA,sign:!1,write:!1},_rent:{address:Ri,sign:!1,write:!1}},hint:(e,t)=>`Initialize associated token account=${e.account} with owner=${e.wallet} for token=${mi(e.mint,t)}, payed by ${e.source}`}});const ig=zA(4,U_,()=>0);fe({mint:Ue,owner:Ue,amount:Ke,delegate:ul(ig,Ue,"11111111111111111111111111111111"),state:Sb(tn,{uninitialized:0,initialized:1,frozen:2}),isNative:ul(ig,Ke,0n),delegateAmount:Ke,closeAuthority:ul(ig,Ue,"11111111111111111111111111111111")});function Yk(e,t,n){if(!t.length)throw new Error("SOLPublic: empty instructions array");return AU.encode(P_.encode({msg:{feePayer:e,blockhash:n,instructions:t},signatures:{}}))}function eP(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let l=0;l<t.length;l++)t[l]=255;for(let l=0;l<e.length;l++){const u=e.charAt(l),d=u.charCodeAt(0);if(t[d]!==255)throw new TypeError(u+" is ambiguous");t[d]=l}const n=e.length,r=e.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,f=0;const h=l.length;for(;f!==h&&l[f]===0;)f++,u++;const p=(h-f)*i+1>>>0,_=new Uint8Array(p);for(;f!==h;){let w=l[f],k=0;for(let b=p-1;(w!==0||k<d)&&b!==-1;b--,k++)w+=256*_[b]>>>0,_[b]=w%n>>>0,w=w/n>>>0;if(w!==0)throw new Error("Non-zero carry");d=k,f++}let g=p-d;for(;g!==p&&_[g]===0;)g++;let y=r.repeat(u);for(;g<p;++g)y+=e.charAt(_[g]);return y}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,f=0;for(;l[u]===r;)d++,u++;const h=(l.length-u)*s+1>>>0,p=new Uint8Array(h);for(;u<l.length;){const w=l.charCodeAt(u);if(w>255)return;let k=t[w];if(k===255)return;let b=0;for(let N=h-1;(k!==0||b<f)&&N!==-1;N--,b++)k+=n*p[N]>>>0,p[N]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");f=b,u++}let _=h-f;for(;_!==h&&p[_]===0;)_++;const g=new Uint8Array(d+(h-_));let y=d;for(;_!==h;)g[y++]=p[_++];return g}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var tP="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";eP(tP);class Ib{_transaction;signatures=[];feePayer;recentBlockhash;_instructions;constructor(){this._instructions=[]}add(...t){return this._instructions.push(...t),this}static from(t){const n=t instanceof Uint8Array?t:new Uint8Array(t),r=P_.decode(n),s=new Ib;return s._transaction=r,s}serialize(t){if(this._transaction)return Buffer.from(P_.encode(this._transaction));if(!this.feePayer||!this.recentBlockhash)throw new Error("Transaction requires feePayer and recentBlockhash");const n=Yk(this.feePayer.toString(),this._instructions,this.recentBlockhash);return Buffer.from(n,"hex")}serializeMessage(){if(!this.feePayer||!this.recentBlockhash)throw new Error("Transaction requires feePayer and recentBlockhash");const t=Yk(this.feePayer.toString(),this._instructions,this.recentBlockhash);return Buffer.from(t,"hex")}}class nP{type="phantom";platform="solana";account=void 0;connectedAccounts=[];getProvider(){if(typeof window>"u")throw new Error("Not ready");const t=window.solana;if(!t?.isPhantom)throw new Error("Phantom is not available");return t}isAvailable(){return typeof window<"u"&&!!window.solana?.isPhantom}getInfo(){const t=this.isAvailable();return{type:this.type,available:t,version:"Unknown",name:"Phantom",platform:this.platform}}async connect(){if(this.account)return{success:!0,wallet:this.type,account:this.account};try{if(!this.isAvailable())throw new Error("Phantom is not available");const t=await this.getProvider().connect();if(t.publicKey)return this.account=t.publicKey.toString(),{success:!0,wallet:this.type,account:this.account};throw new Error("No accounts found")}catch(t){return console.error("Error connecting to Phantom:",t),{success:!1,wallet:this.type,error:t.message||"Unknown error"}}}getConnectedAccounts(){return this.connectedAccounts}async signMessage(t){try{if(!this.isAvailable()||!this.account)throw new Error("Phantom is not connected");const n=new TextEncoder().encode(t),r=await this.getProvider().signMessage(n,"utf8");return{success:!0,wallet:this.type,result:r}}catch(n){return console.error("Error signing message with Phantom:",n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async sendTransaction(t){if(!this.isAvailable()||!this.account)throw new Error("Phantom is not connected");try{const n=Ib.from(t),r=await this.getProvider().signAndSendTransaction(n);return{success:!0,wallet:this.type,result:r}}catch(n){return console.error("Error sending transaction with Phantom:",n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async switchChain(t){return console.warn("Chain switching not supported for Phantom"),!1}async getBalance(t){try{if(!this.isAvailable()||!this.account)throw new Error("Phantom is not connected");return{success:!0,wallet:this.type,result:"Implement based on Phantom API"}}catch(n){return console.error("Error getting balance from Phantom:",n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async waitForTransaction(t,n){return{success:!1,wallet:this.type,error:"waitForTransaction not supported for Phantom wallet"}}}class rP extends bb{type="rabby";rdns="io.rabby";displayName="Rabby"}class sP{type="braavos";platform="starknet";wallet=void 0;account=void 0;connectedAccounts=[];accountChangeListener=void 0;isAvailable(){return typeof window<"u"&&!!window.starknet_braavos}getInfo(){const t=this.isAvailable();return{type:this.type,available:t,version:t?window.starknet_braavos?.version||"Unknown":void 0,chainId:t?window.starknet_braavos?.chainId:void 0,name:"Braavos",platform:this.platform}}async connect(){if(this.account)return{success:!0,wallet:this.type,account:this.account};try{if(!this.isAvailable())throw new Error("Braavos is not available");const t=window.starknet_braavos;if(!t)throw new Error("No wallet found");const n=await t.request({type:"wallet_requestAccounts",params:{silent_mode:!1}});if(!n||n.length===0)throw new Error("No accounts found");return this.removeAccountChangeListener(),this.wallet=t,this.account=n[0],this.connectedAccounts=n,this.setupAccountChangeListener(),{success:!0,wallet:this.type,account:this.account}}catch(t){return console.error("Error connecting to Braavos:",t),{success:!1,wallet:this.type,error:t.message||"Unknown error"}}}getConnectedAccounts(){return this.connectedAccounts}async signTypedData(t){try{if(!this.isAvailable()||!this.wallet)throw new Error("Braavos is not connected");const n=await this.wallet.request({type:"wallet_signTypedData",params:t});return{success:!0,wallet:this.type,result:n}}catch(n){return console.error("Error signing typed data with Braavos:",n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async sendTransaction(t){if(!this.wallet)throw new Error("No wallet found");try{const n=await this.wallet.request({type:"wallet_addInvokeTransaction",params:{calls:t}});return{success:!0,wallet:this.type,result:n}}catch(n){return console.error("Error sending transaction with Braavos:",n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async switchChain(t){if(!this.wallet)throw new Error("No wallet found");return await this.wallet.request({type:"wallet_switchStarknetChain",params:{chainId:t}})}async getBalance(t){try{if(!this.isAvailable()||!this.wallet)throw new Error("Braavos is not connected");return{success:!0,wallet:this.type,result:"Implement based on Braavos API"}}catch(n){return console.error("Error getting balance from Braavos:",n),{success:!1,wallet:this.type,error:n.message||"Unknown error"}}}async waitForTransaction(t,n){return{success:!1,wallet:this.type,error:"waitForTransaction not supported for Braavos wallet"}}setupAccountChangeListener(){this.wallet&&(this.accountChangeListener=t=>{t&&t.length>0?(this.account=t[0],this.connectedAccounts=t):(this.account=void 0,this.connectedAccounts=[])},this.wallet.on("accountsChanged",this.accountChangeListener))}removeAccountChangeListener(){this.wallet&&this.accountChangeListener&&(this.wallet.off("accountsChanged",this.accountChangeListener),this.accountChangeListener=void 0)}disconnect(){this.removeAccountChangeListener(),this.wallet=void 0,this.account=void 0,this.connectedAccounts=[]}}class iP{walletAdapters;constructor(){if(this.walletAdapters=new Map,typeof window>"u")return;const t=new wU;this.walletAdapters.set("metamask",t);const n=new nP;this.walletAdapters.set("phantom",n);const r=new gU;this.walletAdapters.set("argent",r);const s=new sP;this.walletAdapters.set("braavos",s);const i=new rP;this.walletAdapters.set("rabby",i);const o=new bU;this.walletAdapters.set("base",o),window.wallet_bridge=this}getIFrameMethods(){return{externalDetectWallets:t=>()=>this.detectWallets(),externalConnectWallet:t=>n=>this.connectWallet(n),externalSignMessage:t=>(n,r)=>this.signMessage(n,r),externalSignTypedData:t=>(n,r)=>this.signTypedData(n,r),externalSendTransaction:t=>(n,r)=>this.sendTransaction(n,r),externalGetBalance:t=>(n,r)=>this.getBalance(n,r),externalSwitchChain:t=>(n,r)=>this.switchChain(n,r),externalWaitForTransaction:t=>(n,r,s)=>this.waitForTransaction(n,r,s)}}async detectWallets(){return Array.from(this.walletAdapters.values()).map(t=>t.getInfo())}getWalletAdapterByType(t){const n=this.walletAdapters.get(t);if(!n)throw new Error(`Unsupported wallet type: ${t}`);return n}handleError(t,n,r,s){const i=n instanceof Error?n.message:"Unknown error";let o="unknown";if(typeof t=="string"){const a=this.getConnectedWalletAdapter(t);o=s??a?.type??t}else o=t;return console.error(`Error ${r} with ${t} wallet:`,n),{success:!1,wallet:o,error:i}}async connectWallet(t){try{const n=await this.getWalletAdapterByType(t).connect();if(n.success&&n.account)console.log(`Wallet ${t} connected with address ${n.account}`);else if(n.success&&!n.account)return console.error(`Wallet ${t} connected successfully but did not provide an address.`),{...n,success:!1,error:"Wallet connected but address not found."};return n}catch(n){return this.handleError(t,n,"connecting to")}}getConnectedWalletAdapter(t){let n,r;try{r=Qr(t)}catch{if(n=this.walletAdapters.get(t),!n)throw new Error(`Wallet ${t} is not connected or supported`);return n}if(n=this.walletAdapters.values().find(s=>s.getConnectedAccounts().includes(r)),!n)throw new Error(`No wallet found with connected address ${t}`);return n}async signMessage(t,n){let r;try{if(r=this.getConnectedWalletAdapter(t),!r.signMessage)throw new Error(`Wallet type ${r.type} (identifier: ${t}) does not support signing messages`);return await r.signMessage(n,t)}catch(s){return this.handleError(t,s,"signing message with",r?.type)}}async signTypedData(t,n){let r;try{if(r=this.getConnectedWalletAdapter(t),!r.signTypedData)throw new Error(`Wallet type ${r.type} (identifier: ${t}) does not support signing typed data`);return await r.signTypedData(n)}catch(s){return this.handleError(t,s,"signing typed data with",r?.type)}}async sendTransaction(t,n){let r;try{return r=this.getConnectedWalletAdapter(t),await r.sendTransaction(n)}catch(s){return this.handleError(t,s,"sending transaction with",r?.type)}}async getBalance(t,n){let r;try{return r=this.getConnectedWalletAdapter(t),await r.getBalance(n)}catch(s){return this.handleError(t,s,"getting balance from",r?.type)}}async switchChain(t,n){try{return await this.getConnectedWalletAdapter(t).switchChain(n)}catch(r){return console.error(`Error switching chain for ${t} wallet:`,r),!1}}async waitForTransaction(t,n,r){let s;try{return s=this.getConnectedWalletAdapter(t),await s.waitForTransaction(n,r)}catch(i){return this.handleError(t,i,"waiting for transaction with",s?.type)}}}class oP extends B6{walletBridge;constructor({url:t,policies:n,version:r,slot:s,namespace:i,tokens:o,...a}){const c=new URL(t??s6),l=new iP;n&&c.searchParams.set("policies",encodeURIComponent(JSON.stringify(n))),r&&c.searchParams.set("v",encodeURIComponent(r)),s&&c.searchParams.set("ps",encodeURIComponent(s)),i&&c.searchParams.set("ns",encodeURIComponent(i)),o?.erc20&&c.searchParams.set("erc20",encodeURIComponent(o.erc20.toString())),super({...a,id:"controller-keychain",url:c,methods:l.getIFrameMethods()}),this.walletBridge=l,typeof window<"u"&&(window.external_wallets=this.walletBridge)}getWalletBridge(){return this.walletBridge}}class aP extends u6{keychain;options;iframes;selectedChain;chains;isReady(){return!!this.keychain}constructor(t={}){super();const n=[{rpcUrl:"https://api.cartridge.gg/x/starknet/sepolia/rpc/v0_9"},{rpcUrl:"https://api.cartridge.gg/x/starknet/mainnet/rpc/v0_9"},...t.chains||[]],r=t.defaultChainId||Ms.StarknetChainId.SN_MAIN;this.selectedChain=r,this.chains=new Map,this.options={...t,chains:n,defaultChainId:r},this.iframes={keychain:t.lazyload?void 0:this.createKeychainIframe()},this.initializeChains(n),typeof window<"u"&&(window.starknet_controller=this)}async logout(){if(!this.keychain){console.error(new vt().message);return}try{await this.disconnect(),document.querySelectorAll('iframe[id^="controller-"]').forEach(t=>{const n=t.parentElement;n&&(n.style.opacity="0",setTimeout(()=>{n.style.display="none"},200))}),document.body&&(document.body.style.overflow="auto"),window.location.reload()}catch(t){throw console.error("Logout failed:",t),t}}async probe(){try{if(this.iframes.keychain||(this.iframes.keychain=this.createKeychainIframe()),await this.waitForKeychain(),!this.keychain){console.error(new vt().message);return}const t=await this.keychain.probe(this.rpcUrl());let n=t?.rpcUrl||this.rpcUrl();this.account=new Ok(this,n,t.address,this.keychain,this.options,this.iframes.keychain)}catch(t){console.error(t);return}return this.account}async connect(){if(this.account)return this.account;if(this.iframes.keychain||(this.iframes.keychain=this.createKeychainIframe(),await this.waitForKeychain()),!this.keychain||!this.iframes.keychain){console.error(new vt().message);return}typeof document<"u"&&document.hasStorageAccess&&(await document.hasStorageAccess()||await document.requestStorageAccess()),this.iframes.keychain.open();try{let t=await this.keychain.connect(this.options.shouldOverridePresetPolicies&&this.options.policies?this.options.policies:this.options.preset?{}:this.options.policies||{},this.rpcUrl(),this.options.signupOptions);if(t.code!==Fi.SUCCESS)throw new Error(t.message);return t=t,this.account=new Ok(this,this.rpcUrl(),t.address,this.keychain,this.options,this.iframes.keychain),this.account}catch(t){console.log(t)}finally{this.iframes.keychain.close()}}async switchStarknetChain(t){if(!this.keychain||!this.iframes.keychain)return console.error(new vt().message),!1;const n=this.selectedChain;try{this.selectedChain=t,await this.keychain.switchChain(this.rpcUrl())}catch(r){return console.error(r),this.selectedChain=n,!1}return this.emitNetworkChanged(t),!0}addStarknetChain(t){return Promise.resolve(!0)}async disconnect(){if(!this.keychain){console.error(new vt().message);return}return typeof document<"u"&&document.hasStorageAccess&&(await document.hasStorageAccess()||await document.requestStorageAccess()),this.account=void 0,this.keychain.disconnect()}async openProfile(t="inventory"){if(!this.keychain||!this.iframes.keychain){console.error(new vt().message);return}if(!this.account){console.error("Account is not ready");return}const n=await this.keychain.username(),r=[];this.options.slot&&r.push(`ps=${this.options.slot}`),await this.keychain.navigate(`/account/${n}/${t}?${r.join("&")}`),this.iframes.keychain.open()}async openProfileTo(t){if(!this.keychain||!this.iframes.keychain){console.error(new vt().message);return}if(!this.account){console.error("Account is not ready");return}const n=await this.keychain.username(),r=[];this.options.slot&&r.push(`ps=${this.options.slot}`),await this.keychain.navigate(`/account/${n}/${t}?${r.join("&")}`),this.iframes.keychain.open()}async openProfileAt(t){if(!this.keychain||!this.iframes.keychain){console.error(new vt().message);return}if(!this.account){console.error("Account is not ready");return}await this.keychain.navigate(t),this.iframes.keychain.open()}openSettings(){if(!this.keychain||!this.iframes.keychain){console.error(new vt().message);return}this.iframes.keychain.open(),this.keychain.openSettings()}revoke(t,n){return this.keychain?this.keychain.revoke(t):(console.error(new vt().message),null)}rpcUrl(){const t=this.chains.get(this.selectedChain);if(!t){const n=Array.from(this.chains.keys()).map(r=>Us.decodeShortString(r));throw new Error(`Chain not found: ${Us.decodeShortString(this.selectedChain)}. Available chains: ${n.join(", ")}`)}return t.rpcUrl}username(){if(!this.keychain){console.error(new vt().message);return}return this.keychain.username()}openPurchaseCredits(){if(!this.keychain||!this.iframes.keychain){console.error(new vt().message);return}this.keychain.navigate("/purchase/credits").then(()=>{this.iframes.keychain?.open()})}async openStarterPack(t){if(!this.keychain||!this.iframes.keychain){console.error(new vt().message);return}await this.keychain.openStarterPack(t),this.iframes.keychain?.open()}async openExecute(t,n){if(!this.keychain||!this.iframes.keychain){console.error(new vt().message);return}let r=this.selectedChain;n&&this.switchStarknetChain(n),this.iframes.keychain.open();const s=await this.keychain.execute(t,void 0,void 0,!0);return this.iframes.keychain.close(),n&&this.switchStarknetChain(r),{status:!(s&&(s.code===Fi.NOT_CONNECTED||s.code===Fi.CANCELED)),transactionHash:s?.transaction_hash}}async delegateAccount(){return this.keychain?await this.keychain.delegateAccount():(console.error(new vt().message),null)}initializeChains(t){for(const n of t)try{const r=new URL(n.rpcUrl),s=r6(r),i=s===Ms.StarknetChainId.SN_MAIN,o=s===Ms.StarknetChainId.SN_SEPOLIA,a=r.hostname==="api.cartridge.gg",c=r.hostname==="localhost"||r.hostname==="127.0.0.1";if((i||o)&&!(a||c))throw new Error(`Only Cartridge RPC providers are allowed for ${i?"mainnet":"sepolia"}. Please use: https://api.cartridge.gg/x/starknet/${i?"mainnet":"sepolia"}/rpc/v0_9`);this.chains.set(s,n)}catch(r){throw console.error(`Failed to parse chainId for ${n.rpcUrl}:`,r),r}this.chains.has(this.selectedChain)||console.warn(`Selected chain ${this.selectedChain} not found in configured chains. Available chains: ${Array.from(this.chains.keys()).join(", ")}`)}createKeychainIframe(){return new oP({...this.options,onClose:this.keychain?.reset,onConnect:t=>{this.keychain=t},version:wA})}waitForKeychain({timeout:t=5e4,interval:n=100}={}){return new Promise((r,s)=>{const i=Date.now(),o=setInterval(()=>{if(Date.now()-i>t){clearInterval(o),s(new Error("Timeout waiting for keychain"));return}this.keychain&&(clearInterval(o),r())},n)})}}const cP="/assets/dojo_c_bg-BPJvF_nG.wasm",lP=async(e={},t)=>{let n;if(t.startsWith("data:")){const r=t.replace(/^data:.*?base64,/,"");let s;if(typeof Buffer=="function"&&typeof Buffer.from=="function")s=Buffer.from(r,"base64");else if(typeof atob=="function"){const i=atob(r);s=new Uint8Array(i.length);for(let o=0;o<i.length;o++)s[o]=i.charCodeAt(o)}else throw new Error("Cannot decode base64-encoded data URL");n=await WebAssembly.instantiate(s,e)}else{const r=await fetch(t),s=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&s.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(r,e);else{const i=await r.arrayBuffer();n=await WebAssembly.instantiate(i,e)}}return n.instance.exports};let O;function uP(e){O=e}let Xu=null;function dl(){return(Xu===null||Xu.byteLength===0)&&(Xu=new Uint8Array(O.memory.buffer)),Xu}const YA=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let vd=new YA("utf-8",{ignoreBOM:!0,fatal:!0});vd.decode();const dP=2146435072;let og=0;function fP(e,t){return og+=t,og>=dP&&(vd=new YA("utf-8",{ignoreBOM:!0,fatal:!0}),vd.decode(),og=t),vd.decode(dl().subarray(e,e+t))}function hn(e,t){return e=e>>>0,fP(e,t)}let Ce=0;const hP=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder,Sd=new hP("utf-8"),pP=typeof Sd.encodeInto=="function"?function(e,t){return Sd.encodeInto(e,t)}:function(e,t){const n=Sd.encode(e);return t.set(n),{read:e.length,written:n.length}};function Hn(e,t,n){if(n===void 0){const a=Sd.encode(e),c=t(a.length,1)>>>0;return dl().subarray(c,c+a.length).set(a),Ce=a.length,c}let r=e.length,s=t(r,1)>>>0;const i=dl();let o=0;for(;o<r;o++){const a=e.charCodeAt(o);if(a>127)break;i[s+o]=a}if(o!==r){o!==0&&(e=e.slice(o)),s=n(s,r,r=o+e.length*3,1)>>>0;const a=dl().subarray(s+o,s+r),c=pP(e,a);o+=c.written,s=n(s,r,o,1)>>>0}return Ce=o,s}let xo=null;function pn(){return(xo===null||xo.buffer.detached===!0||xo.buffer.detached===void 0&&xo.buffer!==O.memory.buffer)&&(xo=new DataView(O.memory.buffer)),xo}function sn(e){const t=O.__externref_table_alloc();return O.__wbindgen_export_4.set(t,e),t}function je(e,t){try{return e.apply(this,t)}catch(n){const r=sn(n);O.__wbindgen_exn_store(r)}}function Oe(e){return e==null}function Rh(e,t){return e=e>>>0,dl().subarray(e/1,e/1+t)}function F_(e){const t=typeof e;if(t=="number"||t=="boolean"||e==null)return`${e}`;if(t=="string")return`"${e}"`;if(t=="symbol"){const s=e.description;return s==null?"Symbol":`Symbol(${s})`}if(t=="function"){const s=e.name;return typeof s=="string"&&s.length>0?`Function(${s})`:"Function"}if(Array.isArray(e)){const s=e.length;let i="[";s>0&&(i+=F_(e[0]));for(let o=1;o<s;o++)i+=", "+F_(e[o]);return i+="]",i}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(n&&n.length>1)r=n[1];else return toString.call(e);if(r=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:r}function gP(e,t){e=e>>>0;const n=pn(),r=[];for(let s=e;s<e+4*t;s+=4)r.push(O.__wbindgen_export_4.get(n.getUint32(s,!0)));return O.__externref_drop_slice(e,t),r}const Gk=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>{O.__wbindgen_export_7.get(e.dtor)(e.a,e.b)});function Nb(e,t,n,r){const s={a:e,b:t,cnt:1,dtor:n},i=(...o)=>{s.cnt++;const a=s.a;s.a=0;try{return r(a,s.b,...o)}finally{--s.cnt===0?(O.__wbindgen_export_7.get(s.dtor)(a,s.b),Gk.unregister(s)):s.a=a}};return i.original=s,Gk.register(i,s,s),i}function Ad(e){const t=O.__wbindgen_export_4.get(e);return O.__externref_table_dealloc(e),t}function Id(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`)}function tr(e,t){const n=t(e.length*4,4)>>>0;for(let r=0;r<e.length;r++){const s=sn(e[r]);pn().setUint32(n+4*r,s,!0)}return Ce=e.length,n}function _P(e,t){O.wasm_bindgen__convert__closures_____invoke__h48c1f7f6b2e7507f(e,t)}function yP(e,t){O.wasm_bindgen__convert__closures_____invoke__ha650cbf29b909d89(e,t)}function mP(e,t,n){O.closure974_externref_shim(e,t,n)}function bP(e,t,n,r){O.closure1148_externref_shim(e,t,n,r)}const wP=["","no-referrer","no-referrer-when-downgrade","origin","origin-when-cross-origin","unsafe-url","same-origin","strict-origin","strict-origin-when-cross-origin"],kP=["default","no-store","reload","no-cache","force-cache","only-if-cached"],EP=["omit","same-origin","include"],TP=["same-origin","no-cors","cors","navigate"],vP=["follow","error","manual"],Zk=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>O.__wbg_account_free(e>>>0,1));class xb{static __wrap(t){t=t>>>0;const n=Object.create(xb.prototype);return n.__wbg_ptr=t,Zk.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Zk.unregister(this),t}free(){const t=this.__destroy_into_raw();O.__wbg_account_free(t,0)}constructor(t,n,r){Id(t,wf);const s=Hn(n,O.__wbindgen_malloc,O.__wbindgen_realloc),i=Ce,o=Hn(r,O.__wbindgen_malloc,O.__wbindgen_realloc),a=Ce;return O.account_new(t.__wbg_ptr,s,i,o,a)}address(){let t,n;try{const i=O.account_address(this.__wbg_ptr);var r=i[0],s=i[1];if(i[3])throw r=0,s=0,Ad(i[2]);return t=r,n=s,hn(r,s)}finally{O.__wbindgen_free(t,n,1)}}chainId(){let t,n;try{const i=O.account_chainId(this.__wbg_ptr);var r=i[0],s=i[1];if(i[3])throw r=0,s=0,Ad(i[2]);return t=r,n=s,hn(r,s)}finally{O.__wbindgen_free(t,n,1)}}setBlockId(t){const n=Hn(t,O.__wbindgen_malloc,O.__wbindgen_realloc),r=Ce,s=O.account_setBlockId(this.__wbg_ptr,n,r);if(s[1])throw Ad(s[0])}executeRaw(t){const n=tr(t,O.__wbindgen_malloc),r=Ce;return O.account_executeRaw(this.__wbg_ptr,n,r)}deployBurner(t){const n=Hn(t,O.__wbindgen_malloc,O.__wbindgen_realloc),r=Ce;return O.account_deployBurner(this.__wbg_ptr,n,r)}nonce(){return O.account_nonce(this.__wbg_ptr)}provider(){const t=O.account_provider(this.__wbg_ptr);return wf.__wrap(t)}}typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>O.__wbg_bytearray_free(e>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>O.__wbg_controlleraccount_free(e>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>O.__wbg_intounderlyingbytesource_free(e>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>O.__wbg_intounderlyingsink_free(e>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>O.__wbg_intounderlyingsource_free(e>>>0,1));const ag=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>O.__wbg_provider_free(e>>>0,1));class wf{static __wrap(t){t=t>>>0;const n=Object.create(wf.prototype);return n.__wbg_ptr=t,ag.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,ag.unregister(this),t}free(){const t=this.__destroy_into_raw();O.__wbg_provider_free(t,0)}constructor(t){const n=Hn(t,O.__wbindgen_malloc,O.__wbindgen_realloc),r=Ce,s=O.provider_new(n,r);if(s[2])throw Ad(s[1]);return this.__wbg_ptr=s[0]>>>0,ag.register(this,this.__wbg_ptr,this),this}call(t,n){return O.provider_call(this.__wbg_ptr,t,n)}waitForTransaction(t){const n=Hn(t,O.__wbindgen_malloc,O.__wbindgen_realloc),r=Ce;return O.provider_waitForTransaction(this.__wbg_ptr,n,r)}chainId(){return O.provider_chainId(this.__wbg_ptr)}}typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>O.__wbg_signingkey_free(e>>>0,1));const Jk=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>O.__wbg_subscription_free(e>>>0,1));let Nd=class GA{static __wrap(t){t=t>>>0;const n=Object.create(GA.prototype);return n.__wbg_ptr=t,Jk.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Jk.unregister(this),t}free(){const t=this.__destroy_into_raw();O.__wbg_subscription_free(t,0)}get id(){const t=O.__wbg_get_subscription_id(this.__wbg_ptr);return BigInt.asUintN(64,t)}set id(t){O.__wbg_set_subscription_id(this.__wbg_ptr,t)}cancel(){const t=this.__destroy_into_raw();O.subscription_cancel(t)}};const Xk=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>O.__wbg_toriiclient_free(e>>>0,1));class Ch{static __wrap(t){t=t>>>0;const n=Object.create(Ch.prototype);return n.__wbg_ptr=t,Xk.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Xk.unregister(this),t}free(){const t=this.__destroy_into_raw();O.__wbg_toriiclient_free(t,0)}constructor(t){return O.toriiclient_new(t)}getControllers(t){return O.toriiclient_getControllers(this.__wbg_ptr,t)}getContracts(t){return O.toriiclient_getContracts(this.__wbg_ptr,t)}getTransactions(t){return O.toriiclient_getTransactions(this.__wbg_ptr,t)}onTransaction(t,n){return O.toriiclient_onTransaction(this.__wbg_ptr,Oe(t)?0:sn(t),n)}getTokens(t){return O.toriiclient_getTokens(this.__wbg_ptr,t)}onTokenUpdated(t,n,r){var s=Oe(t)?0:tr(t,O.__wbindgen_malloc),i=Ce,o=Oe(n)?0:tr(n,O.__wbindgen_malloc),a=Ce;return O.toriiclient_onTokenUpdated(this.__wbg_ptr,s,i,o,a,r)}getTokenBalances(t){return O.toriiclient_getTokenBalances(this.__wbg_ptr,t)}getTokenContracts(t){return O.toriiclient_getTokenContracts(this.__wbg_ptr,t)}getEntities(t){return O.toriiclient_getEntities(this.__wbg_ptr,t)}getAllEntities(t,n){var r=Oe(n)?0:Hn(n,O.__wbindgen_malloc,O.__wbindgen_realloc),s=Ce;return O.toriiclient_getAllEntities(this.__wbg_ptr,t,r,s)}getEventMessages(t){return O.toriiclient_getEventMessages(this.__wbg_ptr,t)}onEntityUpdated(t,n){return O.toriiclient_onEntityUpdated(this.__wbg_ptr,Oe(t)?0:sn(t),n)}updateEntitySubscription(t,n){return Id(t,Nd),O.toriiclient_updateEntitySubscription(this.__wbg_ptr,t.__wbg_ptr,Oe(n)?0:sn(n))}onEventMessageUpdated(t,n){return O.toriiclient_onEventMessageUpdated(this.__wbg_ptr,Oe(t)?0:sn(t),n)}updateEventMessageSubscription(t,n){return Id(t,Nd),O.toriiclient_updateEventMessageSubscription(this.__wbg_ptr,t.__wbg_ptr,Oe(n)?0:sn(n))}onStarknetEvent(t,n){const r=tr(t,O.__wbindgen_malloc),s=Ce;return O.toriiclient_onStarknetEvent(this.__wbg_ptr,r,s,n)}onIndexerUpdated(t,n){var r=Oe(t)?0:Hn(t,O.__wbindgen_malloc,O.__wbindgen_realloc),s=Ce;return O.toriiclient_onIndexerUpdated(this.__wbg_ptr,r,s,n)}onTokenBalanceUpdated(t,n,r,s){var i=Oe(t)?0:tr(t,O.__wbindgen_malloc),o=Ce,a=Oe(n)?0:tr(n,O.__wbindgen_malloc),c=Ce,l=Oe(r)?0:tr(r,O.__wbindgen_malloc),u=Ce;return O.toriiclient_onTokenBalanceUpdated(this.__wbg_ptr,i,o,a,c,l,u,s)}updateTokenBalanceSubscription(t,n,r,s){Id(t,Nd);const i=tr(n,O.__wbindgen_malloc),o=Ce,a=tr(r,O.__wbindgen_malloc),c=Ce,l=tr(s,O.__wbindgen_malloc),u=Ce;return O.toriiclient_updateTokenBalanceSubscription(this.__wbg_ptr,t.__wbg_ptr,i,o,a,c,l,u)}publishMessage(t){return O.toriiclient_publishMessage(this.__wbg_ptr,t)}publishMessageBatch(t){const n=tr(t,O.__wbindgen_malloc),r=Ce;return O.toriiclient_publishMessageBatch(this.__wbg_ptr,n,r)}}typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>O.__wbg_typeddata_free(e>>>0,1));typeof FinalizationRegistry>"u"||new FinalizationRegistry(e=>O.__wbg_verifyingkey_free(e>>>0,1));function SP(e,t){return Error(hn(e,t))}function AP(e){return Number(e)}function IP(e,t){const n=String(t),r=Hn(n,O.__wbindgen_malloc,O.__wbindgen_realloc),s=Ce;pn().setInt32(e+4*1,s,!0),pn().setInt32(e+4*0,r,!0)}function NP(e){e.abort()}function xP(e,t){e.abort(t)}function RP(e){return xb.__wrap(e)}function CP(){return je(function(e,t,n,r,s){e.append(hn(t,n),hn(r,s))},arguments)}function OP(e){const t=e.body;return Oe(t)?0:sn(t)}function BP(e){return e.buffer}function $P(e){const t=e.byobRequest;return Oe(t)?0:sn(t)}function DP(e){return e.byteLength}function MP(e){return e.byteOffset}function LP(){return je(function(e,t){return e.call(t)},arguments)}function UP(){return je(function(e,t,n){return e.call(t,n)},arguments)}function PP(e){return e.cancel()}function FP(e,t){return e.catch(t)}function jP(e){return clearTimeout(e)}function VP(e){return clearTimeout(e)}function zP(){return je(function(e){e.close()},arguments)}function qP(){return je(function(e){e.close()},arguments)}function HP(e){return e.crypto}function WP(e){return e.done}function KP(){return je(function(e,t){e.enqueue(t)},arguments)}function YP(e){return Object.entries(e)}function GP(e,t,n){return e.fetch(t,n)}function ZP(e,t){return fetch(e,t)}function JP(e,t){return e.fetch(t)}function XP(e){return fetch(e)}function QP(){return je(function(e,t){e.getRandomValues(t)},arguments)}function e8(){return je(function(e){return e.getReader()},arguments)}function t8(){return je(function(e,t){return Reflect.get(e,t)},arguments)}function n8(e,t){return e[t>>>0]}function r8(e){const t=e.done;return Oe(t)?16777215:t?1:0}function s8(e){return e.value}function i8(e,t){return e[t]}function o8(){return je(function(e,t){return Reflect.has(e,t)},arguments)}function a8(e){return e.headers}function c8(e){let t;try{t=e instanceof ArrayBuffer}catch{t=!1}return t}function l8(e){let t;try{t=e instanceof Response}catch{t=!1}return t}function u8(e){let t;try{t=e instanceof Uint8Array}catch{t=!1}return t}function d8(e){return Array.isArray(e)}function f8(e){return Number.isSafeInteger(e)}function h8(){return Symbol.iterator}function p8(e){return e.length}function g8(e){return e.length}function _8(e){return e.msCrypto}function y8(){return je(function(){return new Headers},arguments)}function m8(){return new Object}function b8(){return new Map}function w8(){return je(function(){return new AbortController},arguments)}function k8(e){return new Uint8Array(e)}function E8(e,t){return new Error(hn(e,t))}function T8(e,t){try{var n={a:e,b:t},r=(i,o)=>{const a=n.a;n.a=0;try{return bP(a,n.b,i,o)}finally{n.a=a}};return new Promise(r)}finally{n.a=n.b=0}}function v8(){return new Array}function S8(e,t){return new Uint8Array(Rh(e,t))}function A8(e,t){return new Function(hn(e,t))}function I8(e,t,n){return new Uint8Array(e,t>>>0,n>>>0)}function N8(e){return new Uint8Array(e>>>0)}function x8(){return je(function(e,t,n){return new Request(hn(e,t),n)},arguments)}function R8(){return je(function(e){return e.next()},arguments)}function C8(e){return e.next}function O8(e){return e.node}function B8(){return je(function(e,t){return JSON.parse(hn(e,t))},arguments)}function $8(e){return e.process}function D8(e,t,n){Uint8Array.prototype.set.call(Rh(e,t),n)}function M8(e,t){return e.push(t)}function L8(e){return e.queueMicrotask}function U8(e){queueMicrotask(e)}function P8(){return je(function(e,t){e.randomFillSync(t)},arguments)}function F8(e){return e.read()}function j8(e){e.releaseLock()}function V8(){return je(function(){return module.require},arguments)}function z8(e){return Promise.resolve(e)}function q8(){return je(function(e,t){e.respond(t>>>0)},arguments)}function H8(e,t){return setTimeout(e,t)}function W8(){return je(function(e,t){return setTimeout(e,t)},arguments)}function K8(e,t,n){e.set(Rh(t,n))}function Y8(e,t,n){return e.set(t,n)}function G8(e,t,n){e[t]=n}function Z8(){return je(function(e,t,n){return Reflect.set(e,t,n)},arguments)}function J8(e,t,n){e[t>>>0]=n}function X8(e,t){e.body=t}function Q8(e,t){e.cache=kP[t]}function eF(e,t){e.credentials=EP[t]}function tF(e,t){e.headers=t}function nF(e,t,n){e.integrity=hn(t,n)}function rF(e,t,n){e.method=hn(t,n)}function sF(e,t){e.mode=TP[t]}function iF(e,t){e.redirect=vP[t]}function oF(e,t,n){e.referrer=hn(t,n)}function aF(e,t){e.referrerPolicy=wP[t]}function cF(e,t){e.signal=t}function lF(e){return e.signal}function uF(){const e=typeof global>"u"?null:global;return Oe(e)?0:sn(e)}function dF(){const e=typeof globalThis>"u"?null:globalThis;return Oe(e)?0:sn(e)}function fF(){const e=typeof self>"u"?null:self;return Oe(e)?0:sn(e)}function hF(){const e=typeof window>"u"?null:window;return Oe(e)?0:sn(e)}function pF(e){return e.status}function gF(){return je(function(e){return JSON.stringify(e)},arguments)}function _F(e,t,n){return e.subarray(t>>>0,n>>>0)}function yF(e){return Nd.__wrap(e)}function mF(){return je(function(e){return e.text()},arguments)}function bF(e,t,n){return e.then(t,n)}function wF(e,t){return e.then(t)}function kF(e){return e.toString()}function EF(e){return Ch.__wrap(e)}function TF(e,t){const n=t.url,r=Hn(n,O.__wbindgen_malloc,O.__wbindgen_realloc),s=Ce;pn().setInt32(e+4*1,s,!0),pn().setInt32(e+4*0,r,!0)}function vF(e){return e.value}function SF(e){return e.versions}function AF(e){const t=e.view;return Oe(t)?0:sn(t)}function IF(e,t){const n=t,r=typeof n=="bigint"?n:void 0;pn().setBigInt64(e+8*1,Oe(r)?BigInt(0):r,!0),pn().setInt32(e+4*0,!Oe(r),!0)}function NF(e){const t=e,n=typeof t=="boolean"?t:void 0;return Oe(n)?16777215:n?1:0}function xF(e){const t=e.original;return t.cnt--==1?(t.a=0,!0):!1}function RF(e,t){const n=F_(t),r=Hn(n,O.__wbindgen_malloc,O.__wbindgen_realloc),s=Ce;pn().setInt32(e+4*1,s,!0),pn().setInt32(e+4*0,r,!0)}function CF(e,t){return e in t}function OF(e){return typeof e=="bigint"}function BF(e){return typeof e=="function"}function $F(e){const t=e;return typeof t=="object"&&t!==null}function DF(e){return typeof e=="string"}function MF(e){return e===void 0}function LF(e,t){return e===t}function UF(e,t){return e==t}function PF(e,t){const n=t,r=typeof n=="number"?n:void 0;pn().setFloat64(e+8*1,Oe(r)?0:r,!0),pn().setInt32(e+4*0,!Oe(r),!0)}function FF(e,t){const n=t,r=typeof n=="string"?n:void 0;var s=Oe(r)?0:Hn(r,O.__wbindgen_malloc,O.__wbindgen_realloc),i=Ce;pn().setInt32(e+4*1,i,!0),pn().setInt32(e+4*0,s,!0)}function jF(e,t){throw new Error(hn(e,t))}function VF(e,t){return hn(e,t)}function zF(e,t){var n=gP(e,t).slice();return O.__wbindgen_free(e,t*4,4),n}function qF(e,t){return Nb(e,t,625,_P)}function HF(e){return BigInt.asUintN(64,e)}function WF(e,t){return Nb(e,t,953,yP)}function KF(e,t){return Nb(e,t,973,mP)}function YF(e){return e}function GF(e,t){return Rh(e,t)}function ZF(e){return e}function JF(){const e=O.__wbindgen_export_4,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)}URL=globalThis.URL;const L=await lP({"./dojo_c_bg.js":{__wbg_subscription_new:yF,__wbg_toriiclient_new:EF,__wbg_account_new:RP,__wbg_clearTimeout_5a54f8841c30079a:jP,__wbg_setTimeout_db2dbaeefb6f39c7:W8,__wbg_getwithrefkey_1dc361bd10053bfe:i8,__wbg_set_3f1d0b984ed272ed:G8,__wbg_String_8f0eb39a4a4c2f66:IP,__wbg_fetch_769f3df592e37b75:ZP,__wbg_getReader_48e00749fe3f6089:e8,__wbg_setTimeout_2b339866a2aa3789:H8,__wbg_clearTimeout_6222fede17abcb1a:VP,__wbg_fetch_f156d10be9a5c88a:XP,__wbg_queueMicrotask_bcc6e26d899696db:L8,__wbg_queueMicrotask_f24a794d09c42640:U8,__wbg_fetch_9885d2e26ad251bb:JP,__wbg_fetch_4fae101547df73b6:GP,__wbg_signal_bdb003fe19e53a13:lF,__wbg_new_6a8b180049d9484e:w8,__wbg_abort_6665281623826052:NP,__wbg_abort_c11a5d245a242912:xP,__wbg_getdone_8d12e2c5bfa23fbd:r8,__wbg_getvalue_8d746ccec318477b:s8,__wbg_view_d36d28552eb70661:AF,__wbg_respond_0003f7c68aa35ef6:q8,__wbg_byobRequest_ba853121442653bf:$P,__wbg_close_f602227805f17f95:qP,__wbg_close_a90439b2444e47b4:zP,__wbg_enqueue_1e58bed4477a141f:KP,__wbg_read_dc3d89b58ce2ae65:F8,__wbg_releaseLock_fbec365467db2e6c:j8,__wbg_cancel_8fc34c38a41c5d07:PP,__wbg_newwithstrandinit_e8e22e9851f3c2fe:x8,__wbg_setbody_e324371c31597f2a:X8,__wbg_setcache_7c95e3469a5bfb76:Q8,__wbg_setcredentials_55a9317ed2777533:eF,__wbg_setheaders_ac0b1e4890a949cd:tF,__wbg_setintegrity_b99a69a0174d6d2d:nF,__wbg_setmethod_9ce6e95af1ae0eaf:rF,__wbg_setmode_b89d1784e7e7f118:sF,__wbg_setredirect_4017ceebe5aecf8c:iF,__wbg_setreferrer_4625041984f4c279:oF,__wbg_setreferrerpolicy_16cc29e0e528b435:aF,__wbg_setsignal_e663c6d962763cd5:cF,__wbg_instanceof_Response_0ab386c6818f788a:l8,__wbg_url_d5273b9e10503471:TF,__wbg_status_31874648c8651949:pF,__wbg_headers_177bc880a5823968:a8,__wbg_body_be60ee806470b990:OP,__wbg_text_42c080764c927da6:mF,__wbg_new_12588505388d0897:y8,__wbg_append_3e86b0cd6215edd8:CP,__wbg_crypto_574e78ad8b13b65f:HP,__wbg_process_dc0fbacc7c1c06f7:$8,__wbg_versions_c01dfd4722a88165:SF,__wbg_node_905d3e251edff8a2:O8,__wbg_require_60cc747a6bc5215a:V8,__wbg_msCrypto_a61aeb35a24c1329:_8,__wbg_randomFillSync_ac0988aba3254290:P8,__wbg_getRandomValues_b8f5dbd5f3995a9e:QP,__wbg_get_59c6316d15f9f1d0:n8,__wbg_length_246fa1f85a0dea5b:p8,__wbg_new_e969dc3f68d25093:v8,__wbg_newnoargs_a81330f6e05d8aca:A8,__wbg_new_56407f99198feff7:b8,__wbg_next_3de8f2669431a3ff:C8,__wbg_next_2e6b37020ac5fe58:R8,__wbg_done_4a7743b6f942c9f3:WP,__wbg_value_09d0b4eaab48b91d:vF,__wbg_iterator_96378c3c9a17347c:h8,__wbg_get_27b4bcbec57323ca:t8,__wbg_call_2f8d426a20a307fe:LP,__wbg_new_1930cbb8d9ffc31b:m8,__wbg_set_d636a0463acf1dbc:J8,__wbg_isArray_bc2498eba6fcb71f:d8,__wbg_push_cd3ac7d5b094565d:M8,__wbg_instanceof_ArrayBuffer_59339a3a6f0c10ea:c8,__wbg_new_97ddeb994a38bb69:E8,__wbg_call_f53f0647ceb9c567:UP,__wbg_set_31197016f65a6a19:Y8,__wbg_isSafeInteger_6091d6e3ee1b65fd:f8,__wbg_entries_17f7acbc2d691c0d:YP,__wbg_toString_1144ec2f872e8cf3:kF,__wbg_new_d5e3800b120e37e1:T8,__wbg_resolve_5775c0ef9222f556:z8,__wbg_catch_70a1618b6f59db8a:FP,__wbg_then_9cc266be2bf537b6:wF,__wbg_then_8d2fcccde5380a03:bF,__wbg_static_accessor_GLOBAL_THIS_df7ae94b1e0ed6a3:dF,__wbg_static_accessor_SELF_6265471db3b3c228:fF,__wbg_static_accessor_WINDOW_16fb482f8ec52863:hF,__wbg_static_accessor_GLOBAL_1f13249cc3acc96d:uF,__wbg_length_904c0910ed998bf3:g8,__wbg_prototypesetcall_c5f74efd31aea86b:D8,__wbg_set_1d5fe1e3f51a48d8:K8,__wbg_new_9190433fb67ed635:k8,__wbg_instanceof_Uint8Array_91f3c5adee7e6672:u8,__wbg_newwithlength_ed0ee6c1edca86fc:N8,__wbg_newfromslice_d0d56929c6d9c842:S8,__wbg_newwithbyteoffsetandlength_9aade108cd45cf37:I8,__wbg_buffer_1f897e9f3ed6b41d:BP,__wbg_subarray_a219824899e59712:_F,__wbg_byteLength_7029fecd0c136e6d:DP,__wbg_byteOffset_8161a341c0d72844:MP,__wbg_parse_0eaa937cfd6388c4:B8,__wbg_stringify_1f41b6198e0932e0:gF,__wbg_has_85abdd8aeb8edebf:o8,__wbg_set_b33e7a98099eed58:Z8,__wbg_wbindgendebugstring_bb652b1bc2061b6d:RF,__wbg_Error_1f3748b298f99708:SP,__wbg_Number_577a493fc95ea223:AP,__wbg_wbindgenisundefined_71f08a6ade4354e7:MF,__wbg_wbindgenisobject_dfe064a121d87553:$F,__wbg_wbindgenisfunction_ea72b9d66a0e1705:BF,__wbg_wbindgenisstring_4b74e4111ba029e6:DF,__wbg_wbindgenisbigint_7d76a1ca6454e439:OF,__wbg_wbindgenin_192b210aa1c401e9:CF,__wbg_wbindgennumberget_d855f947247a3fbc:PF,__wbg_wbindgenbooleanget_59f830b1a70d2530:NF,__wbg_wbindgenstringget_43fe05afe34b0cb1:FF,__wbg_wbindgenbigintgetasi64_7637cb1a7fb9a81e:IF,__wbg_wbindgenthrow_4c11a24fca429ccf:jF,__wbg_wbindgencbdrop_a85ed476c6a370b9:xF,__wbg_wbindgenjsvaleq_f27272c0a890df7f:LF,__wbg_wbindgenjsvallooseeq_9dd7bb4b95ac195c:UF,__wbindgen_init_externref_table:JF,__wbindgen_cast_3f095b8139316065:qF,__wbindgen_cast_9ae0607507abb057:YF,__wbindgen_cast_571913e56af74cc3:WF,__wbindgen_cast_cb9088102bce6b30:GF,__wbindgen_cast_4625c577ab2ec9ee:HF,__wbindgen_cast_d6cd19b81560fd6e:ZF,__wbindgen_cast_2241b6af4c4b2941:VF,__wbindgen_cast_25a0a844437d0e92:zF,__wbindgen_cast_708ec70d61ede8c8:KF}},cP),XF=L.memory,QF=L.__wbg_toriiclient_free,e5=L.__wbg_provider_free,t5=L.__wbg_account_free,n5=L.__wbg_controlleraccount_free,r5=L.__wbg_subscription_free,s5=L.__wbg_get_subscription_id,i5=L.__wbg_set_subscription_id,o5=L.__wbg_signingkey_free,a5=L.__wbg_verifyingkey_free,c5=L.__wbg_typeddata_free,l5=L.__wbg_bytearray_free,u5=L.signingkey_new,d5=L.signingkey_fromRandom,f5=L.signingkey_secretScalar,h5=L.signingkey_sign,p5=L.signingkey_verifyingKey,g5=L.verifyingkey_new,_5=L.verifyingkey_scalar,y5=L.verifyingkey_verify,m5=L.typeddata_new,b5=L.typeddata_encode,w5=L.provider_new,k5=L.provider_call,E5=L.provider_waitForTransaction,T5=L.provider_chainId,v5=L.account_new,S5=L.account_address,A5=L.account_chainId,I5=L.account_setBlockId,N5=L.account_executeRaw,x5=L.account_deployBurner,R5=L.account_nonce,C5=L.account_provider,O5=L.getContractAddress,B5=L.getSelectorFromTag,$5=L.bytearray_new,D5=L.bytearray_toRaw,M5=L.bytearray_fromRaw,L5=L.bytearray_toString,U5=L.poseidonHash,P5=L.getSelectorFromName,F5=L.starknetKeccak,j5=L.cairoShortStringToFelt,V5=L.parseCairoShortString,z5=L.toriiclient_new,q5=L.toriiclient_getControllers,H5=L.toriiclient_getContracts,W5=L.toriiclient_getTransactions,K5=L.toriiclient_onTransaction,Y5=L.toriiclient_getTokens,G5=L.toriiclient_onTokenUpdated,Z5=L.toriiclient_getTokenBalances,J5=L.toriiclient_getTokenContracts,X5=L.toriiclient_getEntities,Q5=L.toriiclient_getAllEntities,ej=L.toriiclient_getEventMessages,tj=L.toriiclient_onEntityUpdated,nj=L.toriiclient_updateEntitySubscription,rj=L.toriiclient_onEventMessageUpdated,sj=L.toriiclient_updateEventMessageSubscription,ij=L.toriiclient_onStarknetEvent,oj=L.toriiclient_onIndexerUpdated,aj=L.toriiclient_onTokenBalanceUpdated,cj=L.toriiclient_updateTokenBalanceSubscription,lj=L.toriiclient_publishMessage,uj=L.toriiclient_publishMessageBatch,dj=L.subscription_cancel,fj=L.__wbg_intounderlyingbytesource_free,hj=L.intounderlyingbytesource_type,pj=L.intounderlyingbytesource_autoAllocateChunkSize,gj=L.intounderlyingbytesource_start,_j=L.intounderlyingbytesource_pull,yj=L.intounderlyingbytesource_cancel,mj=L.__wbg_intounderlyingsink_free,bj=L.intounderlyingsink_write,wj=L.intounderlyingsink_close,kj=L.intounderlyingsink_abort,Ej=L.__wbg_intounderlyingsource_free,Tj=L.intounderlyingsource_pull,vj=L.intounderlyingsource_cancel,Sj=L.__wbindgen_malloc,Aj=L.__wbindgen_realloc,Ij=L.__wbindgen_exn_store,Nj=L.__externref_table_alloc,xj=L.__wbindgen_export_4,Rj=L.__externref_drop_slice,Cj=L.__wbindgen_free,Oj=L.__wbindgen_export_7,Bj=L.__externref_table_dealloc,$j=L.wasm_bindgen__convert__closures_____invoke__h48c1f7f6b2e7507f,Dj=L.wasm_bindgen__convert__closures_____invoke__ha650cbf29b909d89,Mj=L.closure974_externref_shim,Lj=L.closure1148_externref_shim,ZA=L.__wbindgen_start,Uj=Object.freeze(Object.defineProperty({__proto__:null,__externref_drop_slice:Rj,__externref_table_alloc:Nj,__externref_table_dealloc:Bj,__wbg_account_free:t5,__wbg_bytearray_free:l5,__wbg_controlleraccount_free:n5,__wbg_get_subscription_id:s5,__wbg_intounderlyingbytesource_free:fj,__wbg_intounderlyingsink_free:mj,__wbg_intounderlyingsource_free:Ej,__wbg_provider_free:e5,__wbg_set_subscription_id:i5,__wbg_signingkey_free:o5,__wbg_subscription_free:r5,__wbg_toriiclient_free:QF,__wbg_typeddata_free:c5,__wbg_verifyingkey_free:a5,__wbindgen_exn_store:Ij,__wbindgen_export_4:xj,__wbindgen_export_7:Oj,__wbindgen_free:Cj,__wbindgen_malloc:Sj,__wbindgen_realloc:Aj,__wbindgen_start:ZA,account_address:S5,account_chainId:A5,account_deployBurner:x5,account_executeRaw:N5,account_new:v5,account_nonce:R5,account_provider:C5,account_setBlockId:I5,bytearray_fromRaw:M5,bytearray_new:$5,bytearray_toRaw:D5,bytearray_toString:L5,cairoShortStringToFelt:j5,closure1148_externref_shim:Lj,closure974_externref_shim:Mj,getContractAddress:O5,getSelectorFromName:P5,getSelectorFromTag:B5,intounderlyingbytesource_autoAllocateChunkSize:pj,intounderlyingbytesource_cancel:yj,intounderlyingbytesource_pull:_j,intounderlyingbytesource_start:gj,intounderlyingbytesource_type:hj,intounderlyingsink_abort:kj,intounderlyingsink_close:wj,intounderlyingsink_write:bj,intounderlyingsource_cancel:vj,intounderlyingsource_pull:Tj,memory:XF,parseCairoShortString:V5,poseidonHash:U5,provider_call:k5,provider_chainId:T5,provider_new:w5,provider_waitForTransaction:E5,signingkey_fromRandom:d5,signingkey_new:u5,signingkey_secretScalar:f5,signingkey_sign:h5,signingkey_verifyingKey:p5,starknetKeccak:F5,subscription_cancel:dj,toriiclient_getAllEntities:Q5,toriiclient_getContracts:H5,toriiclient_getControllers:q5,toriiclient_getEntities:X5,toriiclient_getEventMessages:ej,toriiclient_getTokenBalances:Z5,toriiclient_getTokenContracts:J5,toriiclient_getTokens:Y5,toriiclient_getTransactions:W5,toriiclient_new:z5,toriiclient_onEntityUpdated:tj,toriiclient_onEventMessageUpdated:rj,toriiclient_onIndexerUpdated:oj,toriiclient_onStarknetEvent:ij,toriiclient_onTokenBalanceUpdated:aj,toriiclient_onTokenUpdated:G5,toriiclient_onTransaction:K5,toriiclient_publishMessage:lj,toriiclient_publishMessageBatch:uj,toriiclient_updateEntitySubscription:nj,toriiclient_updateEventMessageSubscription:sj,toriiclient_updateTokenBalanceSubscription:cj,typeddata_encode:b5,typeddata_new:m5,verifyingkey_new:g5,verifyingkey_scalar:_5,verifyingkey_verify:y5,wasm_bindgen__convert__closures_____invoke__h48c1f7f6b2e7507f:$j,wasm_bindgen__convert__closures_____invoke__ha650cbf29b909d89:Dj},Symbol.toStringTag,{value:"Module"}));uP(Uj);ZA();const Pj={withStackTrace:!1},JA=(e,t,n=Pj)=>{const r=t.isOk()?{type:"Ok",value:t.value}:{type:"Err",value:t.error},s=n.withStackTrace?new Error().stack:void 0;return{data:r,message:e,stack:s}};function Qs(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(e,[])).next())})}function Qk(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cr(e){return this instanceof Cr?(this.v=e,this):new Cr(e)}function e1(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(h){return function(p){return Promise.resolve(p).then(h,d)}}function a(h,p){r[h]&&(s[h]=function(_){return new Promise(function(g,y){i.push([h,_,g,y])>1||c(h,_)})},p&&(s[h]=p(s[h])))}function c(h,p){try{l(r[h](p))}catch(_){f(i[0][3],_)}}function l(h){h.value instanceof Cr?Promise.resolve(h.value.v).then(u,d):f(i[0][2],h)}function u(h){c("next",h)}function d(h){c("throw",h)}function f(h,p){h(p),i.shift(),i.length&&c(i[0][0],i[0][1])}}function Fj(e){var t,n;return t={},r("next"),r("throw",function(s){throw s}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(s,i){t[s]=e[s]?function(o){return(n=!n)?{value:Cr(e[s](o)),done:!1}:i?i(o):o}:i}}function jj(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Qk=="function"?Qk(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=e[i]&&function(o){return new Promise(function(a,c){o=e[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}class Lt{constructor(t){this._promise=t}static fromSafePromise(t){const n=t.then(r=>new Sr(r));return new Lt(n)}static fromPromise(t,n){const r=t.then(s=>new Sr(s)).catch(s=>new nr(n(s)));return new Lt(r)}static fromThrowable(t,n){return(...r)=>new Lt(Qs(this,void 0,void 0,function*(){try{return new Sr(yield t(...r))}catch(s){return new nr(n?n(s):s)}}))}static combine(t){return Vj(t)}static combineWithAllErrors(t){return zj(t)}map(t){return new Lt(this._promise.then(n=>Qs(this,void 0,void 0,function*(){return n.isErr()?new nr(n.error):new Sr(yield t(n.value))})))}andThrough(t){return new Lt(this._promise.then(n=>Qs(this,void 0,void 0,function*(){if(n.isErr())return new nr(n.error);const r=yield t(n.value);return r.isErr()?new nr(r.error):new Sr(n.value)})))}andTee(t){return new Lt(this._promise.then(n=>Qs(this,void 0,void 0,function*(){if(n.isErr())return new nr(n.error);try{yield t(n.value)}catch{}return new Sr(n.value)})))}orTee(t){return new Lt(this._promise.then(n=>Qs(this,void 0,void 0,function*(){if(n.isOk())return new Sr(n.value);try{yield t(n.error)}catch{}return new nr(n.error)})))}mapErr(t){return new Lt(this._promise.then(n=>Qs(this,void 0,void 0,function*(){return n.isOk()?new Sr(n.value):new nr(yield t(n.error))})))}andThen(t){return new Lt(this._promise.then(n=>{if(n.isErr())return new nr(n.error);const r=t(n.value);return r instanceof Lt?r._promise:r}))}orElse(t){return new Lt(this._promise.then(n=>Qs(this,void 0,void 0,function*(){return n.isErr()?t(n.error):new Sr(n.value)})))}match(t,n){return this._promise.then(r=>r.match(t,n))}unwrapOr(t){return this._promise.then(n=>n.unwrapOr(t))}safeUnwrap(){return e1(this,arguments,function*(){return yield Cr(yield Cr(yield*Fj(jj(yield Cr(this._promise.then(n=>n.safeUnwrap()))))))})}then(t,n){return this._promise.then(t,n)}[Symbol.asyncIterator](){return e1(this,arguments,function*(){const n=yield Cr(this._promise);return n.isErr()&&(yield yield Cr(xd(n.error))),yield Cr(n.value)})}}function xd(e){return new Lt(Promise.resolve(new nr(e)))}const XA=e=>{let t=qn([]);for(const n of e)if(n.isErr()){t=En(n.error);break}else t.map(r=>r.push(n.value));return t},Vj=e=>Lt.fromSafePromise(Promise.all(e)).andThen(XA),QA=e=>{let t=qn([]);for(const n of e)n.isErr()&&t.isErr()?t.error.push(n.error):n.isErr()&&t.isOk()?t=En([n.error]):n.isOk()&&t.isOk()&&t.value.push(n.value);return t},zj=e=>Lt.fromSafePromise(Promise.all(e)).andThen(QA);var j_;(function(e){function t(s,i){return(...o)=>{try{const a=s(...o);return qn(a)}catch(a){return En(i?i(a):a)}}}e.fromThrowable=t;function n(s){return XA(s)}e.combine=n;function r(s){return QA(s)}e.combineWithAllErrors=r})(j_||(j_={}));function qn(e){return new Sr(e)}function En(e){return new nr(e)}class Sr{constructor(t){this.value=t}isOk(){return!0}isErr(){return!this.isOk()}map(t){return qn(t(this.value))}mapErr(t){return qn(this.value)}andThen(t){return t(this.value)}andThrough(t){return t(this.value).map(n=>this.value)}andTee(t){try{t(this.value)}catch{}return qn(this.value)}orTee(t){return qn(this.value)}orElse(t){return qn(this.value)}asyncAndThen(t){return t(this.value)}asyncAndThrough(t){return t(this.value).map(()=>this.value)}asyncMap(t){return Lt.fromSafePromise(t(this.value))}unwrapOr(t){return this.value}match(t,n){return t(this.value)}safeUnwrap(){const t=this.value;return function*(){return t}()}_unsafeUnwrap(t){return this.value}_unsafeUnwrapErr(t){throw JA("Called `_unsafeUnwrapErr` on an Ok",this,t)}*[Symbol.iterator](){return this.value}}class nr{constructor(t){this.error=t}isOk(){return!1}isErr(){return!this.isOk()}map(t){return En(this.error)}mapErr(t){return En(t(this.error))}andThrough(t){return En(this.error)}andTee(t){return En(this.error)}orTee(t){try{t(this.error)}catch{}return En(this.error)}andThen(t){return En(this.error)}orElse(t){return t(this.error)}asyncAndThen(t){return xd(this.error)}asyncAndThrough(t){return xd(this.error)}asyncMap(t){return xd(this.error)}unwrapOr(t){return t}match(t,n){return n(this.error)}safeUnwrap(){const t=this.error;return function*(){throw yield En(t),new Error("Do not use this generator out of `safeTry`")}()}_unsafeUnwrap(t){throw JA("Called `_unsafeUnwrap` on an Err",this,t)}_unsafeUnwrapErr(t){return this.error}*[Symbol.iterator](){const t=this;return yield t,t}}j_.fromThrowable;function eI(e){let t=typeof e;if(t=="object"){if(Array.isArray(e))return"array";if(e===null)return"null"}return t}function qj(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}let is="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Oh=[];for(let e=0;e<is.length;e++)Oh[is[e].charCodeAt(0)]=e;Oh[45]=is.indexOf("+");Oh[95]=is.indexOf("/");function tI(e){let t=e.length*3/4;e[e.length-2]=="="?t-=2:e[e.length-1]=="="&&(t-=1);let n=new Uint8Array(t),r=0,s=0,i,o=0;for(let a=0;a<e.length;a++){if(i=Oh[e.charCodeAt(a)],i===void 0)switch(e[a]){case"=":s=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(s){case 0:o=i,s=1;break;case 1:n[r++]=o<<2|(i&48)>>4,o=i,s=2;break;case 2:n[r++]=(o&15)<<4|(i&60)>>2,o=i,s=3;break;case 3:n[r++]=(o&3)<<6|i,s=0;break}}if(s==1)throw Error("invalid base64 string.");return n.subarray(0,r)}function nI(e){let t="",n=0,r,s=0;for(let i=0;i<e.length;i++)switch(r=e[i],n){case 0:t+=is[r>>2],s=(r&3)<<4,n=1;break;case 1:t+=is[s|r>>4],s=(r&15)<<2,n=2;break;case 2:t+=is[s|r>>6],t+=is[r&63],n=0;break}return n&&(t+=is[s],t+="=",n==1&&(t+="=")),t}var T;(function(e){e.symbol=Symbol.for("protobuf-ts/unknown"),e.onRead=(n,r,s,i,o)=>{(t(r)?r[e.symbol]:r[e.symbol]=[]).push({no:s,wireType:i,data:o})},e.onWrite=(n,r,s)=>{for(let{no:i,wireType:o,data:a}of e.list(r))s.tag(i,o).raw(a)},e.list=(n,r)=>{if(t(n)){let s=n[e.symbol];return r?s.filter(i=>i.no==r):s}return[]},e.last=(n,r)=>e.list(n,r).slice(-1)[0];const t=n=>n&&Array.isArray(n[e.symbol])})(T||(T={}));function Hj(e,t){return Object.assign(Object.assign({},e),t)}var m;(function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"})(m||(m={}));function Wj(){let e=0,t=0;for(let r=0;r<28;r+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(n&15)<<28,t=(n&112)>>4,(n&128)==0)return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let s=this.buf[this.pos++];if(t|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function cg(e,t,n){for(let i=0;i<28;i=i+7){const o=e>>>i,a=!(!(o>>>7)&&t==0),c=(a?o|128:o)&255;if(n.push(c),!a)return}const r=e>>>28&15|(t&7)<<4,s=t>>3!=0;if(n.push((s?r|128:r)&255),!!s){for(let i=3;i<31;i=i+7){const o=t>>>i,a=!!(o>>>7),c=(a?o|128:o)&255;if(n.push(c),!a)return}n.push(t>>>31&1)}}const Rd=65536*65536;function rI(e){let t=e[0]=="-";t&&(e=e.slice(1));const n=1e6;let r=0,s=0;function i(o,a){const c=Number(e.slice(o,a));s*=n,r=r*n+c,r>=Rd&&(s=s+(r/Rd|0),r=r%Rd)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),[t,r,s]}function V_(e,t){if(t>>>0<=2097151)return""+(Rd*t+(e>>>0));let n=e&16777215,r=(e>>>24|t<<8)>>>0&16777215,s=t>>16&65535,i=n+r*6777216+s*6710656,o=r+s*8147497,a=s*2,c=1e7;i>=c&&(o+=Math.floor(i/c),i%=c),o>=c&&(a+=Math.floor(o/c),o%=c);function l(u,d){let f=u?String(u):"";return d?"0000000".slice(f.length)+f:f}return l(a,0)+l(o,a)+l(i,1)}function t1(e,t){if(e>=0){for(;e>127;)t.push(e&127|128),e=e>>>7;t.push(e)}else{for(let n=0;n<9;n++)t.push(e&127|128),e=e>>7;t.push(1)}}function Kj(){let e=this.buf[this.pos++],t=e&127;if((e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<7,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<14,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<21,(e&128)==0)return this.assertBounds(),t;e=this.buf[this.pos++],t|=(e&15)<<28;for(let n=5;(e&128)!==0&&n<10;n++)e=this.buf[this.pos++];if((e&128)!=0)throw new Error("invalid varint");return this.assertBounds(),t>>>0}let Ie;function Yj(){const e=new DataView(new ArrayBuffer(8));Ie=globalThis.BigInt!==void 0&&typeof e.getBigInt64=="function"&&typeof e.getBigUint64=="function"&&typeof e.setBigInt64=="function"&&typeof e.setBigUint64=="function"?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:e}:void 0}Yj();function sI(e){if(!e)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}const iI=/^-?[0-9]+$/,kf=4294967296,Qu=2147483648;class oI{constructor(t,n){this.lo=t|0,this.hi=n|0}isZero(){return this.lo==0&&this.hi==0}toNumber(){let t=this.hi*kf+(this.lo>>>0);if(!Number.isSafeInteger(t))throw new Error("cannot convert to safe number");return t}}class Ft extends oI{static from(t){if(Ie)switch(typeof t){case"string":if(t=="0")return this.ZERO;if(t=="")throw new Error("string is no integer");t=Ie.C(t);case"number":if(t===0)return this.ZERO;t=Ie.C(t);case"bigint":if(!t)return this.ZERO;if(t<Ie.UMIN)throw new Error("signed value for ulong");if(t>Ie.UMAX)throw new Error("ulong too large");return Ie.V.setBigUint64(0,t,!0),new Ft(Ie.V.getInt32(0,!0),Ie.V.getInt32(4,!0))}else switch(typeof t){case"string":if(t=="0")return this.ZERO;if(t=t.trim(),!iI.test(t))throw new Error("string is no integer");let[n,r,s]=rI(t);if(n)throw new Error("signed value for ulong");return new Ft(r,s);case"number":if(t==0)return this.ZERO;if(!Number.isSafeInteger(t))throw new Error("number is no integer");if(t<0)throw new Error("signed value for ulong");return new Ft(t,t/kf)}throw new Error("unknown value "+typeof t)}toString(){return Ie?this.toBigInt().toString():V_(this.lo,this.hi)}toBigInt(){return sI(Ie),Ie.V.setInt32(0,this.lo,!0),Ie.V.setInt32(4,this.hi,!0),Ie.V.getBigUint64(0,!0)}}Ft.ZERO=new Ft(0,0);class Ge extends oI{static from(t){if(Ie)switch(typeof t){case"string":if(t=="0")return this.ZERO;if(t=="")throw new Error("string is no integer");t=Ie.C(t);case"number":if(t===0)return this.ZERO;t=Ie.C(t);case"bigint":if(!t)return this.ZERO;if(t<Ie.MIN)throw new Error("signed long too small");if(t>Ie.MAX)throw new Error("signed long too large");return Ie.V.setBigInt64(0,t,!0),new Ge(Ie.V.getInt32(0,!0),Ie.V.getInt32(4,!0))}else switch(typeof t){case"string":if(t=="0")return this.ZERO;if(t=t.trim(),!iI.test(t))throw new Error("string is no integer");let[n,r,s]=rI(t);if(n){if(s>Qu||s==Qu&&r!=0)throw new Error("signed long too small")}else if(s>=Qu)throw new Error("signed long too large");let i=new Ge(r,s);return n?i.negate():i;case"number":if(t==0)return this.ZERO;if(!Number.isSafeInteger(t))throw new Error("number is no integer");return t>0?new Ge(t,t/kf):new Ge(-t,-t/kf).negate()}throw new Error("unknown value "+typeof t)}isNegative(){return(this.hi&Qu)!==0}negate(){let t=~this.hi,n=this.lo;return n?n=~n+1:t+=1,new Ge(n,t)}toString(){if(Ie)return this.toBigInt().toString();if(this.isNegative()){let t=this.negate();return"-"+V_(t.lo,t.hi)}return V_(this.lo,this.hi)}toBigInt(){return sI(Ie),Ie.V.setInt32(0,this.lo,!0),Ie.V.setInt32(4,this.hi,!0),Ie.V.getBigInt64(0,!0)}}Ge.ZERO=new Ge(0,0);const n1={readUnknownField:!0,readerFactory:e=>new Zj(e)};function Gj(e){return e?Object.assign(Object.assign({},n1),e):n1}class Zj{constructor(t,n){this.varint64=Wj,this.uint32=Kj,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.textDecoder=n??new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0})}tag(){let t=this.uint32(),n=t>>>3,r=t&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(t){let n=this.pos;switch(t){case m.Varint:for(;this.buf[this.pos++]&128;);break;case m.Bit64:this.pos+=4;case m.Bit32:this.pos+=4;break;case m.LengthDelimited:let r=this.uint32();this.pos+=r;break;case m.StartGroup:let s;for(;(s=this.tag()[1])!==m.EndGroup;)this.skip(s);break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return new Ge(...this.varint64())}uint64(){return new Ft(...this.varint64())}sint64(){let[t,n]=this.varint64(),r=-(t&1);return t=(t>>>1|(n&1)<<31)^r,n=n>>>1^r,new Ge(t,n)}bool(){let[t,n]=this.varint64();return t!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return new Ft(this.sfixed32(),this.sfixed32())}sfixed64(){return new Ge(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),n=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(n,n+t)}string(){return this.textDecoder.decode(this.bytes())}}function ce(e,t){if(!e)throw new Error(t)}function Jj(e,t){throw new Error("Unexpected object: "+e)}const Xj=34028234663852886e22,Qj=-34028234663852886e22,eV=4294967295,tV=2147483647,nV=-2147483648;function fl(e){if(typeof e!="number")throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>tV||e<nV)throw new Error("invalid int 32: "+e)}function Ef(e){if(typeof e!="number")throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>eV||e<0)throw new Error("invalid uint 32: "+e)}function Rb(e){if(typeof e!="number")throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>Xj||e<Qj))throw new Error("invalid float 32: "+e)}const r1={writeUnknownFields:!0,writerFactory:()=>new sV};function rV(e){return e?Object.assign(Object.assign({},r1),e):r1}class sV{constructor(t){this.stack=[],this.textEncoder=t??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let t=0;for(let s=0;s<this.chunks.length;s++)t+=this.chunks[s].length;let n=new Uint8Array(t),r=0;for(let s=0;s<this.chunks.length;s++)n.set(this.chunks[s],r),r+=this.chunks[s].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,n){return this.uint32((t<<3|n)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for(Ef(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return fl(t),t1(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let n=this.textEncoder.encode(t);return this.uint32(n.byteLength),this.raw(n)}float(t){Rb(t);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,t,!0),this.raw(n)}double(t){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),this.raw(n)}fixed32(t){Ef(t);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t,!0),this.raw(n)}sfixed32(t){fl(t);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,t,!0),this.raw(n)}sint32(t){return fl(t),t=(t<<1^t>>31)>>>0,t1(t,this.buf),this}sfixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=Ge.from(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}fixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=Ft.from(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}int64(t){let n=Ge.from(t);return cg(n.lo,n.hi,this.buf),this}sint64(t){let n=Ge.from(t),r=n.hi>>31,s=n.lo<<1^r,i=(n.hi<<1|n.lo>>>31)^r;return cg(s,i,this.buf),this}uint64(t){let n=Ft.from(t);return cg(n.lo,n.hi,this.buf),this}}const s1={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},i1={ignoreUnknownFields:!1};function iV(e){return e?Object.assign(Object.assign({},i1),e):i1}function oV(e){return e?Object.assign(Object.assign({},s1),e):s1}function aV(e,t){var n,r;let s=Object.assign(Object.assign({},e),t);return s.typeRegistry=[...(n=e?.typeRegistry)!==null&&n!==void 0?n:[],...(r=t?.typeRegistry)!==null&&r!==void 0?r:[]],s}const aI=Symbol.for("protobuf-ts/message-type");function z_(e){let t=!1;const n=[];for(let r=0;r<e.length;r++){let s=e.charAt(r);s=="_"?t=!0:/\d/.test(s)?(n.push(s),t=!0):t?(n.push(s.toUpperCase()),t=!1):r==0?n.push(s.toLowerCase()):n.push(s)}return n.join("")}var C;(function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"})(C||(C={}));var zr;(function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER"})(zr||(zr={}));var Tf;(function(e){e[e.NO=0]="NO",e[e.PACKED=1]="PACKED",e[e.UNPACKED=2]="UNPACKED"})(Tf||(Tf={}));function cV(e){var t,n,r,s;return e.localName=(t=e.localName)!==null&&t!==void 0?t:z_(e.name),e.jsonName=(n=e.jsonName)!==null&&n!==void 0?n:z_(e.name),e.repeat=(r=e.repeat)!==null&&r!==void 0?r:Tf.NO,e.opt=(s=e.opt)!==null&&s!==void 0?s:e.repeat||e.oneof?!1:e.kind=="message",e}function lV(e){if(typeof e!="object"||e===null||!e.hasOwnProperty("oneofKind"))return!1;switch(typeof e.oneofKind){case"string":return e[e.oneofKind]===void 0?!1:Object.keys(e).length==2;case"undefined":return Object.keys(e).length==1;default:return!1}}class uV{constructor(t){var n;this.fields=(n=t.fields)!==null&&n!==void 0?n:[]}prepare(){if(this.data)return;const t=[],n=[],r=[];for(let s of this.fields)if(s.oneof)r.includes(s.oneof)||(r.push(s.oneof),t.push(s.oneof),n.push(s.oneof));else switch(n.push(s.localName),s.kind){case"scalar":case"enum":(!s.opt||s.repeat)&&t.push(s.localName);break;case"message":s.repeat&&t.push(s.localName);break;case"map":t.push(s.localName);break}this.data={req:t,known:n,oneofs:Object.values(r)}}is(t,n,r=!1){if(n<0)return!0;if(t==null||typeof t!="object")return!1;this.prepare();let s=Object.keys(t),i=this.data;if(s.length<i.req.length||i.req.some(o=>!s.includes(o))||!r&&s.some(o=>!i.known.includes(o)))return!1;if(n<1)return!0;for(const o of i.oneofs){const a=t[o];if(!lV(a))return!1;if(a.oneofKind===void 0)continue;const c=this.fields.find(l=>l.localName===a.oneofKind);if(!c||!this.field(a[a.oneofKind],c,r,n))return!1}for(const o of this.fields)if(o.oneof===void 0&&!this.field(t[o.localName],o,r,n))return!1;return!0}field(t,n,r,s){let i=n.repeat;switch(n.kind){case"scalar":return t===void 0?n.opt:i?this.scalars(t,n.T,s,n.L):this.scalar(t,n.T,n.L);case"enum":return t===void 0?n.opt:i?this.scalars(t,C.INT32,s):this.scalar(t,C.INT32);case"message":return t===void 0?!0:i?this.messages(t,n.T(),r,s):this.message(t,n.T(),r,s);case"map":if(typeof t!="object"||t===null)return!1;if(s<2)return!0;if(!this.mapKeys(t,n.K,s))return!1;switch(n.V.kind){case"scalar":return this.scalars(Object.values(t),n.V.T,s,n.V.L);case"enum":return this.scalars(Object.values(t),C.INT32,s);case"message":return this.messages(Object.values(t),n.V.T(),r,s)}break}return!0}message(t,n,r,s){return r?n.isAssignable(t,s):n.is(t,s)}messages(t,n,r,s){if(!Array.isArray(t))return!1;if(s<2)return!0;if(r){for(let i=0;i<t.length&&i<s;i++)if(!n.isAssignable(t[i],s-1))return!1}else for(let i=0;i<t.length&&i<s;i++)if(!n.is(t[i],s-1))return!1;return!0}scalar(t,n,r){let s=typeof t;switch(n){case C.UINT64:case C.FIXED64:case C.INT64:case C.SFIXED64:case C.SINT64:switch(r){case zr.BIGINT:return s=="bigint";case zr.NUMBER:return s=="number"&&!isNaN(t);default:return s=="string"}case C.BOOL:return s=="boolean";case C.STRING:return s=="string";case C.BYTES:return t instanceof Uint8Array;case C.DOUBLE:case C.FLOAT:return s=="number"&&!isNaN(t);default:return s=="number"&&Number.isInteger(t)}}scalars(t,n,r,s){if(!Array.isArray(t))return!1;if(r<2)return!0;if(Array.isArray(t)){for(let i=0;i<t.length&&i<r;i++)if(!this.scalar(t[i],n,s))return!1}return!0}mapKeys(t,n,r){let s=Object.keys(t);switch(n){case C.INT32:case C.FIXED32:case C.SFIXED32:case C.SINT32:case C.UINT32:return this.scalars(s.slice(0,r).map(i=>parseInt(i)),n,r);case C.BOOL:return this.scalars(s.slice(0,r).map(i=>i=="true"?!0:i=="false"?!1:i),n,r);default:return this.scalars(s,n,r,zr.STRING)}}}function ar(e,t){switch(t){case zr.BIGINT:return e.toBigInt();case zr.NUMBER:return e.toNumber();default:return e.toString()}}class dV{constructor(t){this.info=t}prepare(){var t;if(this.fMap===void 0){this.fMap={};const n=(t=this.info.fields)!==null&&t!==void 0?t:[];for(const r of n)this.fMap[r.name]=r,this.fMap[r.jsonName]=r,this.fMap[r.localName]=r}}assert(t,n,r){if(!t){let s=eI(r);throw(s=="number"||s=="boolean")&&(s=r.toString()),new Error(`Cannot parse JSON ${s} for ${this.info.typeName}#${n}`)}}read(t,n,r){this.prepare();const s=[];for(const[i,o]of Object.entries(t)){const a=this.fMap[i];if(!a){if(!r.ignoreUnknownFields)throw new Error(`Found unknown field while reading ${this.info.typeName} from JSON format. JSON key: ${i}`);continue}const c=a.localName;let l;if(a.oneof){if(o===null&&(a.kind!=="enum"||a.T()[0]!=="google.protobuf.NullValue"))continue;if(s.includes(a.oneof))throw new Error(`Multiple members of the oneof group "${a.oneof}" of ${this.info.typeName} are present in JSON.`);s.push(a.oneof),l=n[a.oneof]={oneofKind:c}}else l=n;if(a.kind=="map"){if(o===null)continue;this.assert(qj(o),a.name,o);const u=l[c];for(const[d,f]of Object.entries(o)){this.assert(f!==null,a.name+" map value",null);let h;switch(a.V.kind){case"message":h=a.V.T().internalJsonRead(f,r);break;case"enum":if(h=this.enum(a.V.T(),f,a.name,r.ignoreUnknownFields),h===!1)continue;break;case"scalar":h=this.scalar(f,a.V.T,a.V.L,a.name);break}this.assert(h!==void 0,a.name+" map value",f);let p=d;a.K==C.BOOL&&(p=p=="true"?!0:p=="false"?!1:p),p=this.scalar(p,a.K,zr.STRING,a.name).toString(),u[p]=h}}else if(a.repeat){if(o===null)continue;this.assert(Array.isArray(o),a.name,o);const u=l[c];for(const d of o){this.assert(d!==null,a.name,null);let f;switch(a.kind){case"message":f=a.T().internalJsonRead(d,r);break;case"enum":if(f=this.enum(a.T(),d,a.name,r.ignoreUnknownFields),f===!1)continue;break;case"scalar":f=this.scalar(d,a.T,a.L,a.name);break}this.assert(f!==void 0,a.name,o),u.push(f)}}else switch(a.kind){case"message":if(o===null&&a.T().typeName!="google.protobuf.Value"){this.assert(a.oneof===void 0,a.name+" (oneof member)",null);continue}l[c]=a.T().internalJsonRead(o,r,l[c]);break;case"enum":if(o===null)continue;let u=this.enum(a.T(),o,a.name,r.ignoreUnknownFields);if(u===!1)continue;l[c]=u;break;case"scalar":if(o===null)continue;l[c]=this.scalar(o,a.T,a.L,a.name);break}}}enum(t,n,r,s){if(t[0]=="google.protobuf.NullValue"&&ce(n===null||n==="NULL_VALUE",`Unable to parse field ${this.info.typeName}#${r}, enum ${t[0]} only accepts null.`),n===null)return 0;switch(typeof n){case"number":return ce(Number.isInteger(n),`Unable to parse field ${this.info.typeName}#${r}, enum can only be integral number, got ${n}.`),n;case"string":let i=n;t[2]&&n.substring(0,t[2].length)===t[2]&&(i=n.substring(t[2].length));let o=t[1][i];return typeof o>"u"&&s?!1:(ce(typeof o=="number",`Unable to parse field ${this.info.typeName}#${r}, enum ${t[0]} has no value for "${n}".`),o)}ce(!1,`Unable to parse field ${this.info.typeName}#${r}, cannot parse enum value from ${typeof n}".`)}scalar(t,n,r,s){let i;try{switch(n){case C.DOUBLE:case C.FLOAT:if(t===null)return 0;if(t==="NaN")return Number.NaN;if(t==="Infinity")return Number.POSITIVE_INFINITY;if(t==="-Infinity")return Number.NEGATIVE_INFINITY;if(t===""){i="empty string";break}if(typeof t=="string"&&t.trim().length!==t.length){i="extra whitespace";break}if(typeof t!="string"&&typeof t!="number")break;let o=Number(t);if(Number.isNaN(o)){i="not a number";break}if(!Number.isFinite(o)){i="too large or small";break}return n==C.FLOAT&&Rb(o),o;case C.INT32:case C.FIXED32:case C.SFIXED32:case C.SINT32:case C.UINT32:if(t===null)return 0;let a;if(typeof t=="number"?a=t:t===""?i="empty string":typeof t=="string"&&(t.trim().length!==t.length?i="extra whitespace":a=Number(t)),a===void 0)break;return n==C.UINT32?Ef(a):fl(a),a;case C.INT64:case C.SFIXED64:case C.SINT64:if(t===null)return ar(Ge.ZERO,r);if(typeof t!="number"&&typeof t!="string")break;return ar(Ge.from(t),r);case C.FIXED64:case C.UINT64:if(t===null)return ar(Ft.ZERO,r);if(typeof t!="number"&&typeof t!="string")break;return ar(Ft.from(t),r);case C.BOOL:if(t===null)return!1;if(typeof t!="boolean")break;return t;case C.STRING:if(t===null)return"";if(typeof t!="string"){i="extra whitespace";break}try{encodeURIComponent(t)}catch(c){c="invalid UTF8";break}return t;case C.BYTES:if(t===null||t==="")return new Uint8Array(0);if(typeof t!="string")break;return tI(t)}}catch(o){i=o.message}this.assert(!1,s+(i?" - "+i:""),t)}}class fV{constructor(t){var n;this.fields=(n=t.fields)!==null&&n!==void 0?n:[]}write(t,n){const r={},s=t;for(const i of this.fields){if(!i.oneof){let l=this.field(i,s[i.localName],n);l!==void 0&&(r[n.useProtoFieldName?i.name:i.jsonName]=l);continue}const o=s[i.oneof];if(o.oneofKind!==i.localName)continue;const a=i.kind=="scalar"||i.kind=="enum"?Object.assign(Object.assign({},n),{emitDefaultValues:!0}):n;let c=this.field(i,o[i.localName],a);ce(c!==void 0),r[n.useProtoFieldName?i.name:i.jsonName]=c}return r}field(t,n,r){let s;if(t.kind=="map"){ce(typeof n=="object"&&n!==null);const i={};switch(t.V.kind){case"scalar":for(const[c,l]of Object.entries(n)){const u=this.scalar(t.V.T,l,t.name,!1,!0);ce(u!==void 0),i[c.toString()]=u}break;case"message":const o=t.V.T();for(const[c,l]of Object.entries(n)){const u=this.message(o,l,t.name,r);ce(u!==void 0),i[c.toString()]=u}break;case"enum":const a=t.V.T();for(const[c,l]of Object.entries(n)){ce(l===void 0||typeof l=="number");const u=this.enum(a,l,t.name,!1,!0,r.enumAsInteger);ce(u!==void 0),i[c.toString()]=u}break}(r.emitDefaultValues||Object.keys(i).length>0)&&(s=i)}else if(t.repeat){ce(Array.isArray(n));const i=[];switch(t.kind){case"scalar":for(let c=0;c<n.length;c++){const l=this.scalar(t.T,n[c],t.name,t.opt,!0);ce(l!==void 0),i.push(l)}break;case"enum":const o=t.T();for(let c=0;c<n.length;c++){ce(n[c]===void 0||typeof n[c]=="number");const l=this.enum(o,n[c],t.name,t.opt,!0,r.enumAsInteger);ce(l!==void 0),i.push(l)}break;case"message":const a=t.T();for(let c=0;c<n.length;c++){const l=this.message(a,n[c],t.name,r);ce(l!==void 0),i.push(l)}break}(r.emitDefaultValues||i.length>0||r.emitDefaultValues)&&(s=i)}else switch(t.kind){case"scalar":s=this.scalar(t.T,n,t.name,t.opt,r.emitDefaultValues);break;case"enum":s=this.enum(t.T(),n,t.name,t.opt,r.emitDefaultValues,r.enumAsInteger);break;case"message":s=this.message(t.T(),n,t.name,r);break}return s}enum(t,n,r,s,i,o){if(t[0]=="google.protobuf.NullValue")return!i&&!s?void 0:null;if(n===void 0){ce(s);return}if(!(n===0&&!i&&!s))return ce(typeof n=="number"),ce(Number.isInteger(n)),o||!t[1].hasOwnProperty(n)?n:t[2]?t[2]+t[1][n]:t[1][n]}message(t,n,r,s){return n===void 0?s.emitDefaultValues?null:void 0:t.internalJsonWrite(n,s)}scalar(t,n,r,s,i){if(n===void 0){ce(s);return}const o=i||s;switch(t){case C.INT32:case C.SFIXED32:case C.SINT32:return n===0?o?0:void 0:(fl(n),n);case C.FIXED32:case C.UINT32:return n===0?o?0:void 0:(Ef(n),n);case C.FLOAT:Rb(n);case C.DOUBLE:return n===0?o?0:void 0:(ce(typeof n=="number"),Number.isNaN(n)?"NaN":n===Number.POSITIVE_INFINITY?"Infinity":n===Number.NEGATIVE_INFINITY?"-Infinity":n);case C.STRING:return n===""?o?"":void 0:(ce(typeof n=="string"),n);case C.BOOL:return n===!1?o?!1:void 0:(ce(typeof n=="boolean"),n);case C.UINT64:case C.FIXED64:ce(typeof n=="number"||typeof n=="string"||typeof n=="bigint");let a=Ft.from(n);return a.isZero()&&!o?void 0:a.toString();case C.INT64:case C.SFIXED64:case C.SINT64:ce(typeof n=="number"||typeof n=="string"||typeof n=="bigint");let c=Ge.from(n);return c.isZero()&&!o?void 0:c.toString();case C.BYTES:return ce(n instanceof Uint8Array),n.byteLength?nI(n):o?"":void 0}}}function q_(e,t=zr.STRING){switch(e){case C.BOOL:return!1;case C.UINT64:case C.FIXED64:return ar(Ft.ZERO,t);case C.INT64:case C.SFIXED64:case C.SINT64:return ar(Ge.ZERO,t);case C.DOUBLE:case C.FLOAT:return 0;case C.BYTES:return new Uint8Array(0);case C.STRING:return"";default:return 0}}class hV{constructor(t){this.info=t}prepare(){var t;if(!this.fieldNoToField){const n=(t=this.info.fields)!==null&&t!==void 0?t:[];this.fieldNoToField=new Map(n.map(r=>[r.no,r]))}}read(t,n,r,s){this.prepare();const i=s===void 0?t.len:t.pos+s;for(;t.pos<i;){const[o,a]=t.tag(),c=this.fieldNoToField.get(o);if(!c){let f=r.readUnknownField;if(f=="throw")throw new Error(`Unknown field ${o} (wire type ${a}) for ${this.info.typeName}`);let h=t.skip(a);f!==!1&&(f===!0?T.onRead:f)(this.info.typeName,n,o,a,h);continue}let l=n,u=c.repeat,d=c.localName;switch(c.oneof&&(l=l[c.oneof],l.oneofKind!==d&&(l=n[c.oneof]={oneofKind:d})),c.kind){case"scalar":case"enum":let f=c.kind=="enum"?C.INT32:c.T,h=c.kind=="scalar"?c.L:void 0;if(u){let g=l[d];if(a==m.LengthDelimited&&f!=C.STRING&&f!=C.BYTES){let y=t.uint32()+t.pos;for(;t.pos<y;)g.push(this.scalar(t,f,h))}else g.push(this.scalar(t,f,h))}else l[d]=this.scalar(t,f,h);break;case"message":if(u){let g=l[d],y=c.T().internalBinaryRead(t,t.uint32(),r);g.push(y)}else l[d]=c.T().internalBinaryRead(t,t.uint32(),r,l[d]);break;case"map":let[p,_]=this.mapEntry(c,t,r);l[d][p]=_;break}}}mapEntry(t,n,r){let s=n.uint32(),i=n.pos+s,o,a;for(;n.pos<i;){let[c,l]=n.tag();switch(c){case 1:t.K==C.BOOL?o=n.bool().toString():o=this.scalar(n,t.K,zr.STRING);break;case 2:switch(t.V.kind){case"scalar":a=this.scalar(n,t.V.T,t.V.L);break;case"enum":a=n.int32();break;case"message":a=t.V.T().internalBinaryRead(n,n.uint32(),r);break}break;default:throw new Error(`Unknown field ${c} (wire type ${l}) in map entry for ${this.info.typeName}#${t.name}`)}}if(o===void 0){let c=q_(t.K);o=t.K==C.BOOL?c.toString():c}if(a===void 0)switch(t.V.kind){case"scalar":a=q_(t.V.T,t.V.L);break;case"enum":a=0;break;case"message":a=t.V.T().create();break}return[o,a]}scalar(t,n,r){switch(n){case C.INT32:return t.int32();case C.STRING:return t.string();case C.BOOL:return t.bool();case C.DOUBLE:return t.double();case C.FLOAT:return t.float();case C.INT64:return ar(t.int64(),r);case C.UINT64:return ar(t.uint64(),r);case C.FIXED64:return ar(t.fixed64(),r);case C.FIXED32:return t.fixed32();case C.BYTES:return t.bytes();case C.UINT32:return t.uint32();case C.SFIXED32:return t.sfixed32();case C.SFIXED64:return ar(t.sfixed64(),r);case C.SINT32:return t.sint32();case C.SINT64:return ar(t.sint64(),r)}}}class pV{constructor(t){this.info=t}prepare(){if(!this.fields){const t=this.info.fields?this.info.fields.concat():[];this.fields=t.sort((n,r)=>n.no-r.no)}}write(t,n,r){this.prepare();for(const i of this.fields){let o,a,c=i.repeat,l=i.localName;if(i.oneof){const u=t[i.oneof];if(u.oneofKind!==l)continue;o=u[l],a=!0}else o=t[l],a=!1;switch(i.kind){case"scalar":case"enum":let u=i.kind=="enum"?C.INT32:i.T;if(c)if(ce(Array.isArray(o)),c==Tf.PACKED)this.packed(n,u,i.no,o);else for(const d of o)this.scalar(n,u,i.no,d,!0);else o===void 0?ce(i.opt):this.scalar(n,u,i.no,o,a||i.opt);break;case"message":if(c){ce(Array.isArray(o));for(const d of o)this.message(n,r,i.T(),i.no,d)}else this.message(n,r,i.T(),i.no,o);break;case"map":ce(typeof o=="object"&&o!==null);for(const[d,f]of Object.entries(o))this.mapEntry(n,r,i,d,f);break}}let s=r.writeUnknownFields;s!==!1&&(s===!0?T.onWrite:s)(this.info.typeName,t,n)}mapEntry(t,n,r,s,i){t.tag(r.no,m.LengthDelimited),t.fork();let o=s;switch(r.K){case C.INT32:case C.FIXED32:case C.UINT32:case C.SFIXED32:case C.SINT32:o=Number.parseInt(s);break;case C.BOOL:ce(s=="true"||s=="false"),o=s=="true";break}switch(this.scalar(t,r.K,1,o,!0),r.V.kind){case"scalar":this.scalar(t,r.V.T,2,i,!0);break;case"enum":this.scalar(t,C.INT32,2,i,!0);break;case"message":this.message(t,n,r.V.T(),2,i);break}t.join()}message(t,n,r,s,i){i!==void 0&&(r.internalBinaryWrite(i,t.tag(s,m.LengthDelimited).fork(),n),t.join())}scalar(t,n,r,s,i){let[o,a,c]=this.scalarInfo(n,s);(!c||i)&&(t.tag(r,o),t[a](s))}packed(t,n,r,s){if(!s.length)return;ce(n!==C.BYTES&&n!==C.STRING),t.tag(r,m.LengthDelimited),t.fork();let[,i]=this.scalarInfo(n);for(let o=0;o<s.length;o++)t[i](s[o]);t.join()}scalarInfo(t,n){let r=m.Varint,s,i=n===void 0,o=n===0;switch(t){case C.INT32:s="int32";break;case C.STRING:o=i||!n.length,r=m.LengthDelimited,s="string";break;case C.BOOL:o=n===!1,s="bool";break;case C.UINT32:s="uint32";break;case C.DOUBLE:r=m.Bit64,s="double";break;case C.FLOAT:r=m.Bit32,s="float";break;case C.INT64:o=i||Ge.from(n).isZero(),s="int64";break;case C.UINT64:o=i||Ft.from(n).isZero(),s="uint64";break;case C.FIXED64:o=i||Ft.from(n).isZero(),r=m.Bit64,s="fixed64";break;case C.BYTES:o=i||!n.byteLength,r=m.LengthDelimited,s="bytes";break;case C.FIXED32:r=m.Bit32,s="fixed32";break;case C.SFIXED32:r=m.Bit32,s="sfixed32";break;case C.SFIXED64:o=i||Ge.from(n).isZero(),r=m.Bit64,s="sfixed64";break;case C.SINT32:s="sint32";break;case C.SINT64:o=i||Ge.from(n).isZero(),s="sint64";break}return[r,s,i||o]}}function gV(e){const t=e.messagePrototype?Object.create(e.messagePrototype):Object.defineProperty({},aI,{value:e});for(let n of e.fields){let r=n.localName;if(!n.opt)if(n.oneof)t[n.oneof]={oneofKind:void 0};else if(n.repeat)t[r]=[];else switch(n.kind){case"scalar":t[r]=q_(n.T,n.L);break;case"enum":t[r]=0;break;case"map":t[r]={};break}}return t}function F(e,t,n){let r,s=n,i;for(let o of e.fields){let a=o.localName;if(o.oneof){const c=s[o.oneof];if(c?.oneofKind==null)continue;if(r=c[a],i=t[o.oneof],i.oneofKind=c.oneofKind,r==null){delete i[a];continue}}else if(r=s[a],i=t,r==null)continue;switch(o.repeat&&(i[a].length=r.length),o.kind){case"scalar":case"enum":if(o.repeat)for(let l=0;l<r.length;l++)i[a][l]=r[l];else i[a]=r;break;case"message":let c=o.T();if(o.repeat)for(let l=0;l<r.length;l++)i[a][l]=c.create(r[l]);else i[a]===void 0?i[a]=c.create(r):c.mergePartial(i[a],r);break;case"map":switch(o.V.kind){case"scalar":case"enum":Object.assign(i[a],r);break;case"message":let l=o.V.T();for(let u of Object.keys(r))i[a][u]=l.create(r[u]);break}break}}}function _V(e,t,n){if(t===n)return!0;if(!t||!n)return!1;for(let r of e.fields){let s=r.localName,i=r.oneof?t[r.oneof][s]:t[s],o=r.oneof?n[r.oneof][s]:n[s];switch(r.kind){case"enum":case"scalar":let a=r.kind=="enum"?C.INT32:r.T;if(!(r.repeat?o1(a,i,o):cI(a,i,o)))return!1;break;case"map":if(!(r.V.kind=="message"?a1(r.V.T(),ed(i),ed(o)):o1(r.V.kind=="enum"?C.INT32:r.V.T,ed(i),ed(o))))return!1;break;case"message":let c=r.T();if(!(r.repeat?a1(c,i,o):c.equals(i,o)))return!1;break}}return!0}const ed=Object.values;function cI(e,t,n){if(t===n)return!0;if(e!==C.BYTES)return!1;let r=t,s=n;if(r.length!==s.length)return!1;for(let i=0;i<r.length;i++)if(r[i]!=s[i])return!1;return!0}function o1(e,t,n){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!cI(e,t[r],n[r]))return!1;return!0}function a1(e,t,n){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!e.equals(t[r],n[r]))return!1;return!0}const lI=Object.getOwnPropertyDescriptors(Object.getPrototypeOf({})),yV=lI[aI]={};class j{constructor(t,n,r){this.defaultCheckDepth=16,this.typeName=t,this.fields=n.map(cV),this.options=r??{},yV.value=this,this.messagePrototype=Object.create(null,lI),this.refTypeCheck=new uV(this),this.refJsonReader=new dV(this),this.refJsonWriter=new fV(this),this.refBinReader=new hV(this),this.refBinWriter=new pV(this)}create(t){let n=gV(this);return t!==void 0&&F(this,n,t),n}clone(t){let n=this.create();return F(this,n,t),n}equals(t,n){return _V(this,t,n)}is(t,n=this.defaultCheckDepth){return this.refTypeCheck.is(t,n,!1)}isAssignable(t,n=this.defaultCheckDepth){return this.refTypeCheck.is(t,n,!0)}mergePartial(t,n){F(this,t,n)}fromBinary(t,n){let r=Gj(n);return this.internalBinaryRead(r.readerFactory(t),t.byteLength,r)}fromJson(t,n){return this.internalJsonRead(t,iV(n))}fromJsonString(t,n){let r=JSON.parse(t);return this.fromJson(r,n)}toJson(t,n){return this.internalJsonWrite(t,oV(n))}toJsonString(t,n){var r;let s=this.toJson(t,n);return JSON.stringify(s,null,(r=n?.prettySpaces)!==null&&r!==void 0?r:0)}toBinary(t,n){let r=rV(n);return this.internalBinaryWrite(t,r.writerFactory(),r).finish()}internalJsonRead(t,n,r){if(t!==null&&typeof t=="object"&&!Array.isArray(t)){let s=r??this.create();return this.refJsonReader.read(t,s,n),s}throw new Error(`Unable to parse message ${this.typeName} from JSON ${eI(t)}.`)}internalJsonWrite(t,n){return this.refJsonWriter.write(t,n)}internalBinaryWrite(t,n,r){return this.refBinWriter.write(t,n,r),n}internalBinaryRead(t,n,r,s){let i=s??this.create();return this.refBinReader.read(t,i,r,n),i}}function mV(e,t){var n,r,s;let i=e;return i.service=t,i.localName=(n=i.localName)!==null&&n!==void 0?n:z_(i.name),i.serverStreaming=!!i.serverStreaming,i.clientStreaming=!!i.clientStreaming,i.options=(r=i.options)!==null&&r!==void 0?r:{},i.idempotency=(s=i.idempotency)!==null&&s!==void 0?s:void 0,i}class bV{constructor(t,n,r){this.typeName=t,this.methods=n.map(s=>mV(s,this)),this.options=r??{}}}class Ae extends Error{constructor(t,n="UNKNOWN",r){super(t),this.name="RpcError",Object.setPrototypeOf(this,new.target.prototype),this.code=n,this.meta=r??{}}toString(){const t=[this.name+": "+this.message];this.code&&(t.push(""),t.push("Code: "+this.code)),this.serviceName&&this.methodName&&t.push("Method: "+this.serviceName+"/"+this.methodName);let n=Object.entries(this.meta);if(n.length){t.push(""),t.push("Meta:");for(let[r,s]of n)t.push(`  ${r}: ${s}`)}return t.join(`
`)}}function wV(e,t){if(!t)return e;let n={};td(e,n),td(t,n);for(let r of Object.keys(t)){let s=t[r];switch(r){case"jsonOptions":n.jsonOptions=aV(e.jsonOptions,n.jsonOptions);break;case"binaryOptions":n.binaryOptions=Hj(e.binaryOptions,n.binaryOptions);break;case"meta":n.meta={},td(e.meta,n.meta),td(t.meta,n.meta);break;case"interceptors":n.interceptors=e.interceptors?e.interceptors.concat(s):s.concat();break}}return n}function td(e,t){if(!e)return;let n=t;for(let[r,s]of Object.entries(e))s instanceof Date?n[r]=new Date(s.getTime()):Array.isArray(s)?n[r]=s.concat():n[r]=s}var Pn;(function(e){e[e.PENDING=0]="PENDING",e[e.REJECTED=1]="REJECTED",e[e.RESOLVED=2]="RESOLVED"})(Pn||(Pn={}));class ks{constructor(t=!0){this._state=Pn.PENDING,this._promise=new Promise((n,r)=>{this._resolve=n,this._reject=r}),t&&this._promise.catch(n=>{})}get state(){return this._state}get promise(){return this._promise}resolve(t){if(this.state!==Pn.PENDING)throw new Error(`cannot resolve ${Pn[this.state].toLowerCase()}`);this._resolve(t),this._state=Pn.RESOLVED}reject(t){if(this.state!==Pn.PENDING)throw new Error(`cannot reject ${Pn[this.state].toLowerCase()}`);this._reject(t),this._state=Pn.REJECTED}resolvePending(t){this._state===Pn.PENDING&&this.resolve(t)}rejectPending(t){this._state===Pn.PENDING&&this.reject(t)}}class kV{constructor(){this._lis={nxt:[],msg:[],err:[],cmp:[]},this._closed=!1,this._itState={q:[]}}onNext(t){return this.addLis(t,this._lis.nxt)}onMessage(t){return this.addLis(t,this._lis.msg)}onError(t){return this.addLis(t,this._lis.err)}onComplete(t){return this.addLis(t,this._lis.cmp)}addLis(t,n){return n.push(t),()=>{let r=n.indexOf(t);r>=0&&n.splice(r,1)}}clearLis(){for(let t of Object.values(this._lis))t.splice(0,t.length)}get closed(){return this._closed!==!1}notifyNext(t,n,r){ce((t?1:0)+(n?1:0)+(r?1:0)<=1,"only one emission at a time"),t&&this.notifyMessage(t),n&&this.notifyError(n),r&&this.notifyComplete()}notifyMessage(t){ce(!this.closed,"stream is closed"),this.pushIt({value:t,done:!1}),this._lis.msg.forEach(n=>n(t)),this._lis.nxt.forEach(n=>n(t,void 0,!1))}notifyError(t){ce(!this.closed,"stream is closed"),this._closed=t,this.pushIt(t),this._lis.err.forEach(n=>n(t)),this._lis.nxt.forEach(n=>n(void 0,t,!1)),this.clearLis()}notifyComplete(){ce(!this.closed,"stream is closed"),this._closed=!0,this.pushIt({value:null,done:!0}),this._lis.cmp.forEach(t=>t()),this._lis.nxt.forEach(t=>t(void 0,void 0,!0)),this.clearLis()}[Symbol.asyncIterator](){return this._closed===!0?this.pushIt({value:null,done:!0}):this._closed!==!1&&this.pushIt(this._closed),{next:()=>{let t=this._itState;ce(t,"bad state"),ce(!t.p,"iterator contract broken");let n=t.q.shift();return n?"value"in n?Promise.resolve(n):Promise.reject(n):(t.p=new ks,t.p.promise)}}}pushIt(t){let n=this._itState;if(n.p){const r=n.p;ce(r.state==Pn.PENDING,"iterator contract broken"),"value"in t?r.resolve(t):r.reject(t),delete n.p}else n.q.push(t)}}var EV=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})};class TV{constructor(t,n,r,s,i,o,a){this.method=t,this.requestHeaders=n,this.request=r,this.headers=s,this.response=i,this.status=o,this.trailers=a}then(t,n){return this.promiseFinished().then(r=>t?Promise.resolve(t(r)):r,r=>n?Promise.resolve(n(r)):Promise.reject(r))}promiseFinished(){return EV(this,void 0,void 0,function*(){let[t,n,r,s]=yield Promise.all([this.headers,this.response,this.status,this.trailers]);return{method:this.method,requestHeaders:this.requestHeaders,request:this.request,headers:t,response:n,status:r,trailers:s}})}}var vV=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})};class SV{constructor(t,n,r,s,i,o,a){this.method=t,this.requestHeaders=n,this.request=r,this.headers=s,this.responses=i,this.status=o,this.trailers=a}then(t,n){return this.promiseFinished().then(r=>t?Promise.resolve(t(r)):r,r=>n?Promise.resolve(n(r)):Promise.reject(r))}promiseFinished(){return vV(this,void 0,void 0,function*(){let[t,n,r]=yield Promise.all([this.headers,this.status,this.trailers]);return{method:this.method,requestHeaders:this.requestHeaders,request:this.request,headers:t,status:n,trailers:r}})}}function Me(e,t,n,r,s){var i,o,a,c;if(e=="unary"){let l=(u,d,f)=>t.unary(u,d,f);for(const u of((i=r.interceptors)!==null&&i!==void 0?i:[]).filter(d=>d.interceptUnary).reverse()){const d=l;l=(f,h,p)=>u.interceptUnary(d,f,h,p)}return l(n,s,r)}if(e=="serverStreaming"){let l=(u,d,f)=>t.serverStreaming(u,d,f);for(const u of((o=r.interceptors)!==null&&o!==void 0?o:[]).filter(d=>d.interceptServerStreaming).reverse()){const d=l;l=(f,h,p)=>u.interceptServerStreaming(d,f,h,p)}return l(n,s,r)}if(e=="clientStreaming"){let l=(u,d)=>t.clientStreaming(u,d);for(const u of((a=r.interceptors)!==null&&a!==void 0?a:[]).filter(d=>d.interceptClientStreaming).reverse()){const d=l;l=(f,h)=>u.interceptClientStreaming(d,f,h)}return l(n,r)}if(e=="duplex"){let l=(u,d)=>t.duplex(u,d);for(const u of((c=r.interceptors)!==null&&c!==void 0?c:[]).filter(d=>d.interceptDuplex).reverse()){const d=l;l=(f,h)=>u.interceptDuplex(d,f,h)}return l(n,r)}Jj(e)}var V;(function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS"})(V||(V={}));var AV=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})};function c1(e,t,n,r,s){if(r)for(let[i,o]of Object.entries(r))if(typeof o=="string")e.append(i,o);else for(let a of o)e.append(i,a);if(e.set("Content-Type",t==="text"?"application/grpc-web-text":"application/grpc-web+proto"),t=="text"&&e.set("Accept","application/grpc-web-text"),e.set("X-Grpc-Web","1"),typeof n=="number"){if(n<=0)throw new Ae(`timeout ${n} ms exceeded`,V[V.DEADLINE_EXCEEDED]);e.set("grpc-timeout",`${n}m`)}else if(n){const i=n.getTime(),o=Date.now();if(i<=o)throw new Ae(`deadline ${n} exceeded`,V[V.DEADLINE_EXCEEDED]);e.set("grpc-timeout",`${i-o}m`)}return e}function l1(e,t){let n=new Uint8Array(5+e.length);n[0]=lr.DATA;for(let r=e.length,s=4;s>0;s--)n[s]=r%256,r>>>=8;return n.set(e,5),t==="binary"?n:nI(n)}function H_(e,t,n){if(arguments.length===1){let c=e,l;try{l=c.type}catch{}switch(l){case"error":case"opaque":case"opaqueredirect":throw new Ae(`fetch response type ${c.type}`,V[V.UNKNOWN])}return H_(RV(c.headers),c.status,c.statusText)}let r=e,s=t>=200&&t<300,i=dI(r),[o,a]=uI(r);return(o===void 0||o===V.OK)&&!s&&(o=CV(t),a=n),[o,a,i]}function u1(e){let t=xV(e),[n,r]=uI(t),s=dI(t);return[n??V.OK,r,s]}var lr;(function(e){e[e.DATA=0]="DATA",e[e.TRAILER=128]="TRAILER"})(lr||(lr={}));function d1(e,t,n){return AV(this,void 0,void 0,function*(){let r,s="",i=new Uint8Array(0),o=NV(t);if(IV(e)){let a=e.getReader();r={next:()=>a.read()}}else r=e[Symbol.asyncIterator]();for(;;){let a=yield r.next();if(a.value!==void 0){if(o==="text"){for(let l=0;l<a.value.length;l++)s+=String.fromCharCode(a.value[l]);let c=s.length-s.length%4;if(c===0)continue;i=f1(i,tI(s.substring(0,c))),s=s.substring(c)}else i=f1(i,a.value);for(;i.length>=5&&i[0]===lr.DATA;){let c=0;for(let l=1;l<5;l++)c=(c<<8)+i[l];if(i.length-5>=c)n(lr.DATA,i.subarray(5,5+c)),i=i.subarray(5+c);else break}}if(a.done){if(i.length===0)break;if(i[0]!==lr.TRAILER||i.length<5)throw new Ae("premature EOF",V[V.DATA_LOSS]);n(lr.TRAILER,i.subarray(5));break}}})}const IV=e=>typeof e.getReader=="function";function f1(e,t){let n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function NV(e){switch(e){case"application/grpc-web-text":case"application/grpc-web-text+proto":return"text";case"application/grpc-web":case"application/grpc-web+proto":return"binary";case void 0:case null:throw new Ae("missing response content type",V[V.INTERNAL]);default:throw new Ae("unexpected response content type: "+e,V[V.INTERNAL])}}function uI(e){let t,n,r=e["grpc-message"];if(r!==void 0){if(Array.isArray(r))return[V.INTERNAL,"invalid grpc-web message"];n=r}let s=e["grpc-status"];if(s!==void 0){if(Array.isArray(s))return[V.INTERNAL,"invalid grpc-web status"];if(t=parseInt(s,10),V[t]===void 0)return[V.INTERNAL,"invalid grpc-web status"]}return[t,n]}function dI(e){let t={};for(let[n,r]of Object.entries(e))switch(n){case"grpc-message":case"grpc-status":case"content-type":break;default:t[n]=r}return t}function xV(e){let t={};for(let n of String.fromCharCode.apply(String,e).trim().split(`\r
`)){if(n=="")continue;let[r,...s]=n.split(":");const i=s.join(":").trim();r=r.trim();let o=t[r];typeof o=="string"?t[r]=[o,i]:Array.isArray(o)?o.push(i):t[r]=i}return t}function RV(e){let t={};return e.forEach((n,r)=>{let s=t[r];typeof s=="string"?t[r]=[s,n]:Array.isArray(s)?s.push(n):t[r]=n}),t}function CV(e){switch(e){case 200:return V.OK;case 400:return V.INVALID_ARGUMENT;case 401:return V.UNAUTHENTICATED;case 403:return V.PERMISSION_DENIED;case 404:return V.NOT_FOUND;case 409:return V.ABORTED;case 412:return V.FAILED_PRECONDITION;case 429:return V.RESOURCE_EXHAUSTED;case 499:return V.CANCELLED;case 500:return V.UNKNOWN;case 501:return V.UNIMPLEMENTED;case 503:return V.UNAVAILABLE;case 504:return V.DEADLINE_EXCEEDED;default:return V.UNKNOWN}}class OV{constructor(t){this.defaultOptions=t}mergeOptions(t){return wV(this.defaultOptions,t)}makeUrl(t,n){let r=n.baseUrl;return r.endsWith("/")&&(r=r.substring(0,r.length-1)),`${r}/${t.service.typeName}/${t.name}`}clientStreaming(t){const n=new Ae("Client streaming is not supported by grpc-web",V[V.UNIMPLEMENTED]);throw n.methodName=t.name,n.serviceName=t.service.typeName,n}duplex(t){const n=new Ae("Duplex streaming is not supported by grpc-web",V[V.UNIMPLEMENTED]);throw n.methodName=t.name,n.serviceName=t.service.typeName,n}serverStreaming(t,n,r){var s,i,o,a,c;let l=r,u=(s=l.format)!==null&&s!==void 0?s:"text",d=(i=l.fetch)!==null&&i!==void 0?i:globalThis.fetch,f=(o=l.fetchInit)!==null&&o!==void 0?o:{},h=this.makeUrl(t,l),p=t.I.toBinary(n,l.binaryOptions),_=new ks,g=new kV,y=!0,w,k=new ks,b,N=new ks;return d(h,Object.assign(Object.assign({},f),{method:"POST",headers:c1(new globalThis.Headers,u,l.timeout,l.meta),body:l1(p,u),signal:(a=r.abort)!==null&&a!==void 0?a:null})).then(S=>{let[E,A,x]=H_(S);if(_.resolve(x),E!=null&&E!==V.OK)throw new Ae(A??V[E],V[E],x);return E!=null&&(w={code:V[E],detail:A??V[E]}),S}).then(S=>{if(!S.body)throw new Ae("missing response body",V[V.INTERNAL]);return d1(S.body,S.headers.get("content-type"),(E,A)=>{switch(E){case lr.DATA:g.notifyMessage(t.O.fromBinary(A,l.binaryOptions)),y=!1;break;case lr.TRAILER:let x,D;[x,D,b]=u1(A),w={code:V[x],detail:D??V[x]};break}})}).then(()=>{if(!b&&!y)throw new Ae("missing trailers",V[V.DATA_LOSS]);if(!w)throw new Ae("missing status",V[V.INTERNAL]);if(w.code!=="OK")throw new Ae(w.detail,w.code,b);g.notifyComplete(),k.resolve(w),N.resolve(b||{})}).catch(S=>{let E;S instanceof Ae?E=S:S instanceof Error&&S.name==="AbortError"?E=new Ae(S.message,V[V.CANCELLED]):E=new Ae(S instanceof Error?S.message:""+S,V[V.INTERNAL]),E.methodName=t.name,E.serviceName=t.service.typeName,_.rejectPending(E),g.notifyError(E),k.rejectPending(E),N.rejectPending(E)}),new SV(t,(c=l.meta)!==null&&c!==void 0?c:{},n,_.promise,g,k.promise,N.promise)}unary(t,n,r){var s,i,o,a,c;let l=r,u=(s=l.format)!==null&&s!==void 0?s:"text",d=(i=l.fetch)!==null&&i!==void 0?i:globalThis.fetch,f=(o=l.fetchInit)!==null&&o!==void 0?o:{},h=this.makeUrl(t,l),p=t.I.toBinary(n,l.binaryOptions),_=new ks,g,y=new ks,w,k=new ks,b,N=new ks;return d(h,Object.assign(Object.assign({},f),{method:"POST",headers:c1(new globalThis.Headers,u,l.timeout,l.meta),body:l1(p,u),signal:(a=r.abort)!==null&&a!==void 0?a:null})).then(S=>{let[E,A,x]=H_(S);if(_.resolve(x),E!=null&&E!==V.OK)throw new Ae(A??V[E],V[E],x);return E!=null&&(w={code:V[E],detail:A??V[E]}),S}).then(S=>{if(!S.body)throw new Ae("missing response body",V[V.INTERNAL]);return d1(S.body,S.headers.get("content-type"),(E,A)=>{switch(E){case lr.DATA:if(g)throw new Ae("unary call received 2nd message",V[V.DATA_LOSS]);g=t.O.fromBinary(A,l.binaryOptions);break;case lr.TRAILER:let x,D;[x,D,b]=u1(A),w={code:V[x],detail:D??V[x]};break}})}).then(()=>{if(!b&&g)throw new Ae("missing trailers",V[V.DATA_LOSS]);if(!w)throw new Ae("missing status",V[V.INTERNAL]);if(!g&&w.code==="OK")throw new Ae("expected error status",V[V.DATA_LOSS]);if(!g)throw new Ae(w.detail,w.code,b);if(y.resolve(g),w.code!=="OK")throw new Ae(w.detail,w.code,b);k.resolve(w),N.resolve(b||{})}).catch(S=>{let E;S instanceof Ae?E=S:S instanceof Error&&S.name==="AbortError"?E=new Ae(S.message,V[V.CANCELLED]):E=new Ae(S instanceof Error?S.message:""+S,V[V.INTERNAL]),E.methodName=t.name,E.serviceName=t.service.typeName,_.rejectPending(E),y.rejectPending(E),k.rejectPending(E),N.rejectPending(E)}),new TV(t,(c=l.meta)!==null&&c!==void 0?c:{},n,_.promise,y.promise,k.promise,N.promise)}}const BV=e=>typeof e=="function",v=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):n=>t(n,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(n,r){return arguments.length>=2?t(n,r):function(s){return t(s,n)}};case 3:return function(n,r,s){return arguments.length>=3?t(n,r,s):function(i){return t(i,n,r)}};case 4:return function(n,r,s,i){return arguments.length>=4?t(n,r,s,i):function(o){return t(o,n,r,s)}};case 5:return function(n,r,s,i,o){return arguments.length>=5?t(n,r,s,i,o):function(a){return t(a,n,r,s,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);const n=arguments;return function(r){return t(r,...n)}}}},nt=e=>e,Bh=e=>()=>e,h1=Bh(!0),W_=Bh(!1),fI=Bh(void 0),$V=fI;function $(e,t,n,r,s,i,o,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return s(r(n(t(e))));case 6:return i(s(r(n(t(e)))));case 7:return o(i(s(r(n(t(e))))));case 8:return a(o(i(s(r(n(t(e)))))));case 9:return c(a(o(i(s(r(n(t(e))))))));default:{let l=arguments[0];for(let u=1;u<arguments.length;u++)l=arguments[u](l);return l}}}const Cb=e=>(t,n)=>t===n||e(t,n),DV=v(2,(e,t)=>Cb((n,r)=>e(t(n),t(r)))),MV=e=>Cb((t,n)=>{if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0}),p1="effect/GlobalValue";let wc;const ge=(e,t)=>(wc||(globalThis[p1]??=new Map,wc=globalThis[p1]),wc.has(e)||wc.set(e,t()),wc.get(e)),gr=e=>typeof e=="string",eo=e=>typeof e=="number",$h=e=>typeof e=="boolean",Dh=e=>typeof e=="bigint",K_=e=>typeof e=="symbol",gu=BV,LV=e=>e===void 0,UV=e=>!1,Ob=e=>typeof e=="object"&&e!==null,_s=e=>Ob(e)||gu(e),re=v(2,(e,t)=>_s(e)&&t in e),hI=v(2,(e,t)=>re(e,"_tag")&&e._tag===t),Ro=e=>e==null,PV=e=>e!=null,FV=e=>e instanceof Uint8Array,jV=e=>e instanceof Date,VV=e=>typeof e=="string"||re(e,Symbol.iterator),zV=e=>Ob(e)&&!Array.isArray(e),qV=e=>re(e,"then")&&gu(e.then),Mh=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;let pI=class gI{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new gI(this.self)}};const HV=335903614,WV=4150755663,KV=1481765933,YV=1284865837,GV=9007199254740992,ZV=134217728;class JV{_state;constructor(t,n,r,s){return Ro(n)&&Ro(t)?(n=Math.random()*4294967295>>>0,t=0):Ro(n)&&(n=t,t=0),Ro(s)&&Ro(r)?(s=this._state?this._state[3]:WV,r=this._state?this._state[2]:HV):Ro(s)&&(s=r,r=0),this._state=new Int32Array([0,0,r>>>0,((s||0)|1)>>>0]),this._next(),g1(this._state,this._state[0],this._state[1],t>>>0,n>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%t}number(){const t=(this._next()&67108863)*1,n=(this._next()&134217727)*1;return(t*ZV+n)/GV}_next(){const t=this._state[0]>>>0,n=this._state[1]>>>0;XV(this._state,t,n,KV,YV),g1(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let r=t>>>18,s=(n>>>18|t<<14)>>>0;r=(r^t)>>>0,s=(s^n)>>>0;const i=(s>>>27|r<<5)>>>0,o=t>>>27,a=(-o>>>0&31)>>>0;return(i>>>o|i<<a)>>>0}}function XV(e,t,n,r,s){let i=(n>>>16)*(s&65535)>>>0,o=(n&65535)*(s>>>16)>>>0,a=(n&65535)*(s&65535)>>>0,c=(n>>>16)*(s>>>16)+((o>>>16)+(i>>>16))>>>0;o=o<<16>>>0,a=a+o>>>0,a>>>0<o>>>0&&(c=c+1>>>0),i=i<<16>>>0,a=a+i>>>0,a>>>0<i>>>0&&(c=c+1>>>0),c=c+Math.imul(n,r)>>>0,c=c+Math.imul(t,s)>>>0,e[0]=c,e[1]=a}function g1(e,t,n,r,s){let i=t+r>>>0;const o=n+s>>>0;o>>>0<n>>>0&&(i=i+1|0),e[0]=i,e[1]=o}const Y_=Symbol.for("effect/Utils/YieldWrap");class _u{#e;constructor(t){this.#e=t}[Y_](){return this.#e}}function QV(e){if(typeof e=="object"&&e!==null&&Y_ in e)return e[Y_]();throw new Error(Mh("yieldWrapGet"))}const Ln=ge("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),_I={effect_internal_function:e=>e()},e9={effect_internal_function:e=>{try{return e()}finally{}}},t9=_I.effect_internal_function(()=>new Error().stack)?.includes("effect_internal_function")===!0,zt=t9?_I.effect_internal_function:e9.effect_internal_function,lg=ge(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),ae=Symbol.for("effect/Hash"),K=e=>{if(Ln.enabled===!0)return 0;switch(typeof e){case"number":return $b(e);case"bigint":return et(e.toString(10));case"boolean":return et(String(e));case"symbol":return et(String(e));case"string":return et(e);case"undefined":return et("undefined");case"function":case"object":return e===null?et("null"):e instanceof Date?K(e.toISOString()):e instanceof URL?K(e.href):n9(e)?e[ae]():Bb(e);default:throw new Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},Bb=e=>(lg.has(e)||lg.set(e,$b(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),lg.get(e)),_e=e=>t=>t*53^e,Lh=e=>e&3221225471|e>>>1&1073741824,n9=e=>re(e,ae),$b=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return Lh(t)},et=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return Lh(t)},r9=(e,t)=>{let n=12289;for(let r=0;r<t.length;r++)n^=$(et(t[r]),_e(K(e[t[r]])));return Lh(n)},yI=e=>r9(e,Object.keys(e)),yu=e=>{let t=6151;for(let n=0;n<e.length;n++)t=$(t,_e(K(e[n])));return Lh(t)},Ve=function(){if(arguments.length===1){const n=arguments[0];return function(r){return Object.defineProperty(n,ae,{value(){return r},enumerable:!1}),r}}const e=arguments[0],t=arguments[1];return Object.defineProperty(e,ae,{value(){return t},enumerable:!1}),t},ie=Symbol.for("effect/Equal");function ne(){return arguments.length===1?e=>vf(e,arguments[0]):vf(arguments[0],arguments[1])}function vf(e,t){if(e===t)return!0;const n=typeof e;if(n!==typeof t)return!1;if(n==="object"||n==="function"){if(e!==null&&t!==null){if(Sf(e)&&Sf(t))return K(e)===K(t)&&e[ie](t)?!0:Ln.enabled&&Ln.tester?Ln.tester(e,t):!1;if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(Ln.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((r,s)=>vf(r,t[s]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const r=Object.keys(e),s=Object.keys(t);if(r.length===s.length){for(const i of r)if(!(i in t&&vf(e[i],t[i])))return Ln.tester?Ln.tester(e,t):!1;return!0}}return Ln.tester?Ln.tester(e,t):!1}}return Ln.enabled&&Ln.tester?Ln.tester(e,t):!1}const Sf=e=>re(e,ie),Db=()=>ne,Fe=Symbol.for("nodejs.util.inspect.custom"),at=e=>{try{if(re(e,"toJSON")&&gu(e.toJSON)&&e.toJSON.length===0)return e.toJSON();if(Array.isArray(e))return e.map(at)}catch{return{}}return i9(e)},wt=e=>JSON.stringify(e,null,2),Ia=(e,t=2)=>{if(typeof e=="string")return e;try{return typeof e=="object"?mI(e,t):String(e)}catch{return String(e)}},mI=(e,t)=>{let n=[];const r=JSON.stringify(e,(s,i)=>typeof i=="object"&&i!==null?n.includes(i)?void 0:n.push(i)&&(ji.fiberRefs!==void 0&&bI(i)?i[Mb](ji.fiberRefs):i):i,t);return n=void 0,r},Mb=Symbol.for("effect/Inspectable/Redactable"),bI=e=>typeof e=="object"&&e!==null&&Mb in e,ji=ge("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),s9=(e,t)=>{const n=ji.fiberRefs;ji.fiberRefs=e;try{return t()}finally{ji.fiberRefs=n}},i9=e=>bI(e)&&ji.fiberRefs!==void 0?e[Mb](ji.fiberRefs):e,X=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let n=e;for(let r=0,s=t.length;r<s;r++)n=t[r](n);return n}}},hl="Async",Uh="Commit",hr="Failure",ug="OnFailure",Af="OnSuccess",If="OnSuccessAndFailure",pr="Success",wI="Sync",o9="Tag",mu="UpdateRuntimeFlags",Nf="While",Cd="Iterator",kI="WithRuntime",Od="Yield",Lb="RevertFlags";let a9="3.17.13";const Ub=()=>a9,c9=Symbol.for("effect/Effect"),l9=Symbol.for("effect/Stream"),u9=Symbol.for("effect/Sink"),d9=Symbol.for("effect/Channel"),Na={_R:e=>e,_E:e=>e,_A:e=>e,_V:Ub()},f9={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},h9={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},bu={[c9]:Na,[l9]:Na,[u9]:f9,[d9]:h9,[ie](e){return this===e},[ae](){return Ve(this,Bb(this))},[Symbol.iterator](){return new pI(new _u(this))},pipe(){return X(this,arguments)}},Pb={[ae](){return Ve(this,yI(this))},[ie](e){const t=Object.keys(this),n=Object.keys(e);if(t.length!==n.length)return!1;for(const r of t)if(!(r in e&&ne(this[r],e[r])))return!1;return!0}},wu={...bu,_op:Uh},p9={...wu,...Pb},g9=function(){function e(){}return e.prototype=wu,e}(),EI=Symbol.for("effect/Option"),TI={...bu,[EI]:{_A:e=>e},[Fe](){return this.toJSON()},toString(){return wt(this.toJSON())}},_9=Object.assign(Object.create(TI),{_tag:"Some",_op:"Some",[ie](e){return vI(e)&&AI(e)&&ne(this.value,e.value)},[ae](){return Ve(this,_e(K(this._tag))(K(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:at(this.value)}}}),y9=K("None"),m9=Object.assign(Object.create(TI),{_tag:"None",_op:"None",[ie](e){return vI(e)&&SI(e)},[ae](){return y9},toJSON(){return{_id:"Option",_tag:this._tag}}}),vI=e=>re(e,EI),SI=e=>e._tag==="None",AI=e=>e._tag==="Some",II=Object.create(m9),G_=e=>{const t=Object.create(_9);return t.value=e,t},NI=Symbol.for("effect/Either"),xI={...bu,[NI]:{_R:e=>e},[Fe](){return this.toJSON()},toString(){return wt(this.toJSON())}},b9=Object.assign(Object.create(xI),{_tag:"Right",_op:"Right",[ie](e){return Fb(e)&&CI(e)&&ne(this.right,e.right)},[ae](){return _e(K(this._tag))(K(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:at(this.right)}}}),w9=Object.assign(Object.create(xI),{_tag:"Left",_op:"Left",[ie](e){return Fb(e)&&RI(e)&&ne(this.left,e.left)},[ae](){return _e(K(this._tag))(K(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:at(this.left)}}}),Fb=e=>re(e,NI),RI=e=>e._tag==="Left",CI=e=>e._tag==="Right",k9=e=>{const t=Object.create(w9);return t.left=e,t},E9=e=>{const t=Object.create(b9);return t.right=e,t},be=E9,oe=k9,T9=Fb,At=RI,as=CI,v9=v(2,(e,t)=>At(e)?oe(t(e.left)):be(e.right)),S9=v(2,(e,t)=>as(e)?be(t(e.right)):oe(e.left)),jb=v(2,(e,{onLeft:t,onRight:n})=>At(e)?t(e.left):n(e.right)),A9=jb({onLeft:nt,onRight:nt}),OI=v(2,(e,t)=>{if(as(e))return e.right;throw t(e.left)}),I9=OI(()=>new Error("getOrThrow called on a Left")),BI=e=>e.length>0,$I=e=>(t,n)=>t===n?0:e(t,n),N9=$I((e,t)=>e<t?-1:1),DI=v(2,(e,t)=>$I((n,r)=>e(t(n),t(r)))),x9=e=>v(2,(t,n)=>e(t,n)===1),G=()=>II,te=G_,_t=SI,kt=AI,Zn=v(2,(e,{onNone:t,onSome:n})=>_t(e)?t():n(e.value)),ct=v(2,(e,t)=>_t(e)?t():e.value),Fs=v(2,(e,t)=>_t(e)?t():e),R9=v(2,(e,t)=>_t(e)?te(t()):e),Ph=e=>e==null?G():te(e),Or=ct(fI),C9=e=>(...t)=>{try{return te(e(...t))}catch{return G()}},MI=v(2,(e,t)=>_t(e)?G():te(t(e.value))),Fh=v(2,(e,t)=>_t(e)?G():t(e.value)),O9=v(2,(e,t)=>_t(e)?G():Ph(t(e.value))),B9=e=>v(2,(t,n)=>_t(t)?!1:e(t.value,n)),$9=Db(),D9=B9($9),M9=v(2,(e,t)=>_t(e)?!1:t(e.value)),L9=(...e)=>e,jh=e=>new Array(e),U9=v(2,(e,t)=>{const n=Math.max(1,Math.floor(e)),r=new Array(n);for(let s=0;s<n;s++)r[s]=t(s);return r}),Ze=e=>Array.isArray(e)?e:Array.from(e),P9=e=>Array.isArray(e)?e:[e],F9=v(2,(e,{onEmpty:t,onNonEmpty:n})=>Je(e)?n(Kt(e),to(e)):t()),xf=v(2,(e,t)=>[t,...e]),j9=v(2,(e,t)=>[...e,t]),LI=v(2,(e,t)=>Ze(e).concat(Ze(t))),V9=Array.isArray,z9=e=>e.length===0,q9=z9,Bd=BI,Je=BI,UI=(e,t)=>e<0||e>=t.length,H9=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),W9=v(2,(e,t)=>{const n=Math.floor(t);return UI(n,e)?G():te(e[n])}),PI=v(2,(e,t)=>{const n=Math.floor(t);if(UI(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]}),pl=W9(0),Kt=PI(0),K9=e=>Je(e)?te(FI(e)):G(),FI=e=>e[e.length-1],to=e=>e.slice(1),Y9=(e,t)=>{let n=0;for(const r of e){if(!t(r,n))break;n++}return n},G9=v(2,(e,t)=>Q9(e,Y9(e,t))),Z9=v(2,(e,t)=>{const n=Ze(e);return n.slice(H9(t,n),n.length)}),_1=e=>Array.from(e).reverse(),Fl=v(2,(e,t)=>{const n=Array.from(e);return n.sort(t),n}),y1=v(2,(e,t)=>J9(e,t,L9)),J9=v(3,(e,t,n)=>{const r=Ze(e),s=Ze(t);if(Je(r)&&Je(s)){const i=[n(Kt(r),Kt(s))],o=Math.min(r.length,s.length);for(let a=1;a<o;a++)i[a]=n(r[a],s[a]);return i}return[]}),X9=Db(),Q9=v(2,(e,t)=>{const n=Array.from(e),r=Math.floor(t);return Je(n)?r>=1?e7(n,r):[[],n]:[n,[]]}),e7=v(2,(e,t)=>{const n=Math.max(1,Math.floor(t));return n>=e.length?[Gc(e),[]]:[xf(e.slice(1,n),Kt(e)),e.slice(n)]}),Gc=e=>e.slice(),t7=v(3,(e,t,n)=>{const r=Ze(e),s=Ze(t);return Je(r)?Je(s)?zI(n)(LI(r,s)):r:s}),$d=v(2,(e,t)=>t7(e,t,X9)),xa=()=>[],sr=e=>[e],Jo=v(2,(e,t)=>e.map(t)),jI=v(2,(e,t)=>{if(q9(e))return[];const n=[];for(let r=0;r<e.length;r++){const s=t(e[r],r);for(let i=0;i<s.length;i++)n.push(s[i])}return n}),n7=jI(nt),r7=v(2,(e,t)=>{const n=Ze(e),r=[];for(let s=0;s<n.length;s++){const i=t(n[s],s);kt(i)&&r.push(i.value)}return r}),VI=v(3,(e,t,n)=>Ze(e).reduce((r,s,i)=>n(r,s,i),t)),m1=(e,t)=>{const n=[];let r=e,s;for(;kt(s=t(r));){const[i,o]=s.value;n.push(i),r=o}return n},Vh=MV,zI=v(2,(e,t)=>{const n=Ze(e);if(Je(n)){const r=[Kt(n)],s=to(n);for(const i of s)r.every(o=>!t(i,o))&&r.push(i);return r}return[]}),s7=e=>zI(e,Db()),rc=v(2,(e,t)=>Ze(e).join(t)),qI=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return qI(e,t.from)}},HI=e=>{let t=!1,n;return()=>(t||(n=e(),t=!0),n)},i7=e=>{try{return e.toISOString()}catch{return String(e)}},dg="[Circular]";function bo(e,t=0){const n=new WeakSet,r=t?typeof t=="number"?" ".repeat(t):t:"",s=l=>r.repeat(l),i=l=>{try{const u=l.toString();return typeof u=="string"?u:String(u)}catch{return"[toString threw]"}},o=(l,u)=>{const d=l?.constructor;return d&&d!==Object.prototype.constructor&&d.name?`${d.name}(${u})`:u},a=l=>{try{return Reflect.ownKeys(l)}catch{return["[ownKeys threw]"]}};function c(l,u=0){if(Array.isArray(l)){if(n.has(l))return dg;if(n.add(l),!r||l.length<=1)return`[${l.map(f=>c(f,u)).join(",")}]`;const d=l.map(f=>c(f,u+1)).join(`,
`+s(u+1));return`[
${s(u+1)}${d}
${s(u)}]`}if(jV(l))return i7(l);if(re(l,"toString")&&gu(l.toString)&&l.toString!==Object.prototype.toString)return i(l);if(gr(l))return JSON.stringify(l);if(eo(l)||l==null||$h(l)||K_(l))return String(l);if(Dh(l))return String(l)+"n";if(l instanceof Set||l instanceof Map)return n.has(l)?dg:(n.add(l),`${l.constructor.name}(${c(Array.from(l),u)})`);if(_s(l)){if(n.has(l))return dg;n.add(l);const d=a(l);if(!r||d.length<=1){const h=`{${d.map(p=>`${Z_(p)}:${c(l[p],u)}`).join(",")}}`;return o(l,h)}const f=`{
${d.map(h=>`${s(u+1)}${Z_(h)}: ${c(l[h],u+1)}`).join(`,
`)}
${s(u)}}`;return o(l,f)}return String(l)}return c(e,0)}function Z_(e){return gr(e)?JSON.stringify(e):String(e)}const WI=e=>Array.isArray(e),o7=e=>!Array.isArray(e),b1=e=>`[${Z_(e)}]`,a7=e=>WI(e)?e.map(b1).join(""):b1(e),wo=(e,t,n,r)=>{let s=e;return t!==void 0&&(s+=`
details: ${t}`),r&&(s+=`
schema (${r._tag}): ${r}`),s},c7=e=>wo("Unsupported key schema",void 0,void 0,e),l7=e=>wo("Unsupported literal",`literal value: ${bo(e)}`),w1=e=>wo("Duplicate index signature",`${e} index signature`),u7=wo("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),d7=wo("Invalid element","A required element cannot follow an optional element. ts(1257)"),k1=e=>wo("Duplicate property signature transformation",`Duplicate key ${bo(e)}`),f7=e=>wo("Duplicate property signature",`Duplicate key ${bo(e)}`),Ra=N9,Rf=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&"),h7=Symbol.for("effect/annotation/Brand"),p7=Symbol.for("effect/annotation/SchemaId"),KI=Symbol.for("effect/annotation/Message"),Vb=Symbol.for("effect/annotation/MissingMessage"),zb=Symbol.for("effect/annotation/Identifier"),Wr=Symbol.for("effect/annotation/Title"),J_=Symbol.for("effect/annotation/AutoTitle"),sc=Symbol.for("effect/annotation/Description"),YI=Symbol.for("effect/annotation/Examples"),GI=Symbol.for("effect/annotation/Default"),ZI=Symbol.for("effect/annotation/JSONSchema"),JI=Symbol.for("effect/annotation/Arbitrary"),XI=Symbol.for("effect/annotation/Pretty"),QI=Symbol.for("effect/annotation/Equivalence"),g7=Symbol.for("effect/annotation/Documentation"),eN=Symbol.for("effect/annotation/Concurrency"),tN=Symbol.for("effect/annotation/Batching"),nN=Symbol.for("effect/annotation/ParseIssueTitle"),rN=Symbol.for("effect/annotation/ParseOptions"),sN=Symbol.for("effect/annotation/DecodingFallback"),iN=Symbol.for("effect/annotation/Surrogate"),_7=Symbol.for("effect/annotation/StableFilter"),Jt=v(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?te(e.annotations[t]):G()),y7=Jt(h7),m7=Jt(KI),b7=Jt(Vb),oN=Jt(Wr),aN=Jt(J_),zh=Jt(zb),cN=Jt(sc),w7=Jt(eN),k7=Jt(tN),E7=Jt(nN),T7=Jt(rN),v7=Jt(sN),lN=Jt(iN),S7=Jt(_7),A7=e=>M9(S7(e),t=>t===!0),uN=Symbol.for("effect/annotation/JSONIdentifier"),I7=Jt(uN),N7=e=>Fs(I7(e),()=>zh(e));class qh{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(t,n,r,s={}){this.typeParameters=t,this.decodeUnknown=n,this.encodeUnknown=r,this.annotations=s}toString(){return ct(_r(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(t=>t.toJSON()),annotations:Xe(this.annotations)}}}const ku=e=>t=>t._tag===e;let X_=class{literal;annotations;_tag="Literal";constructor(t,n={}){this.literal=t,this.annotations=n}toString(){return ct(_r(this),()=>bo(this.literal))}toJSON(){return{_tag:this._tag,literal:Dh(this.literal)?String(this.literal):this.literal,annotations:Xe(this.annotations)}}};const E1=ku("Literal");class x7{symbol;annotations;_tag="UniqueSymbol";constructor(t,n={}){this.symbol=t,this.annotations=n}toString(){return ct(_r(this),()=>bo(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:Xe(this.annotations)}}}class R7{annotations;_tag="UndefinedKeyword";constructor(t={}){this.annotations=t}toString(){return Zs(this)}toJSON(){return{_tag:this._tag,annotations:Xe(this.annotations)}}}const Q_=new R7({[Wr]:"undefined"});class C7{annotations;_tag="NeverKeyword";constructor(t={}){this.annotations=t}toString(){return Zs(this)}toJSON(){return{_tag:this._tag,annotations:Xe(this.annotations)}}}const qb=new C7({[Wr]:"never"});class O7{annotations;_tag="UnknownKeyword";constructor(t={}){this.annotations=t}toString(){return Zs(this)}toJSON(){return{_tag:this._tag,annotations:Xe(this.annotations)}}}const dN=new O7({[Wr]:"unknown"});class B7{annotations;_tag="AnyKeyword";constructor(t={}){this.annotations=t}toString(){return Zs(this)}toJSON(){return{_tag:this._tag,annotations:Xe(this.annotations)}}}const $7=new B7({[Wr]:"any"});class D7{annotations;_tag="StringKeyword";constructor(t={}){this.annotations=t}toString(){return Zs(this)}toJSON(){return{_tag:this._tag,annotations:Xe(this.annotations)}}}const M7=new D7({[Wr]:"string",[sc]:"a string"}),L7=ku("StringKeyword");class U7{annotations;_tag="NumberKeyword";constructor(t={}){this.annotations=t}toString(){return Zs(this)}toJSON(){return{_tag:this._tag,annotations:Xe(this.annotations)}}}const P7=new U7({[Wr]:"number",[sc]:"a number"});class F7{annotations;_tag="BooleanKeyword";constructor(t={}){this.annotations=t}toString(){return Zs(this)}toJSON(){return{_tag:this._tag,annotations:Xe(this.annotations)}}}const j7=new F7({[Wr]:"boolean",[sc]:"a boolean"});class V7{annotations;_tag="BigIntKeyword";constructor(t={}){this.annotations=t}toString(){return Zs(this)}toJSON(){return{_tag:this._tag,annotations:Xe(this.annotations)}}}const z7=new V7({[Wr]:"bigint",[sc]:"a bigint"}),q7=ku("SymbolKeyword");let H7=class{enums;annotations;_tag="Enums";constructor(t,n={}){this.enums=t,this.annotations=n}toString(){return ct(_r(this),()=>`<enum ${this.enums.length} value(s): ${this.enums.map(([t,n])=>JSON.stringify(n)).join(" | ")}>`)}toJSON(){return{_tag:this._tag,enums:this.enums,annotations:Xe(this.annotations)}}},Hh=class{type;annotations;constructor(t,n={}){this.type=t,this.annotations=n}toJSON(){return{type:this.type.toJSON(),annotations:Xe(this.annotations)}}toString(){return String(this.type)}};class ic extends Hh{isOptional;constructor(t,n,r={}){super(t,r),this.isOptional=n}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:Xe(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}const fN=e=>e.map(t=>t.type);class Hb{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(t,n,r,s={}){this.elements=t,this.rest=n,this.isReadonly=r,this.annotations=s;let i=!1,o=!1;for(const a of t)if(a.isOptional)i=!0;else if(i){o=!0;break}if(o||i&&n.length>1)throw new Error(d7)}toString(){return ct(_r(this),()=>W7(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(t=>t.toJSON()),rest:this.rest.map(t=>t.toJSON()),isReadonly:this.isReadonly,annotations:Xe(this.annotations)}}}const W7=e=>{const t=e.elements.map(String).join(", ");return F9(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(n,r)=>{const s=String(n),i=s.includes(" | ")?`(${s})`:s;if(r.length>0){const o=r.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${i}[], ${o}]`:`readonly [...${i}[], ${o}]`}else return e.elements.length>0?`readonly [${t}, ...${i}[]]`:`ReadonlyArray<${s}>`}})};class Ut extends ic{name;isReadonly;constructor(t,n,r,s,i){super(n,r,i),this.name=t,this.isReadonly=s}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:Xe(this.annotations)}}}const hN=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return hN(e.from)}return!1};class Wh{type;isReadonly;parameter;constructor(t,n,r){if(this.type=n,this.isReadonly=r,hN(t))this.parameter=t;else throw new Error(u7)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class Vi{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(t,n,r={}){this.annotations=r;const s={};for(let o=0;o<t.length;o++){const a=t[o].name;if(Object.prototype.hasOwnProperty.call(s,a))throw new Error(f7(a));s[a]=null}const i={string:!1,symbol:!1};for(let o=0;o<n.length;o++){const a=kN(n[o].parameter);if(L7(a)){if(i.string)throw new Error(w1("string"));i.string=!0}else if(q7(a)){if(i.symbol)throw new Error(w1("symbol"));i.symbol=!0}}this.propertySignatures=t,this.indexSignatures=n}toString(){return ct(_r(this),()=>K7(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(t=>t.toJSON()),indexSignatures:this.indexSignatures.map(t=>t.toJSON()),annotations:Xe(this.annotations)}}}const T1=e=>e.map(String).join("; "),K7=e=>{if(e.propertySignatures.length>0){const t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${T1(e.indexSignatures)} }`:`{ ${t} }`}else return e.indexSignatures.length>0?`{ ${T1(e.indexSignatures)} }`:"{}"},Y7=Fl(DI(Ra,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),G7={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},pN=e=>jI(e,t=>gN(t)?pN(t.types):[t]),Z7=e=>{const t=Y7(e),n=[],r={},s=[];for(const i of t)switch(i._tag){case"NeverKeyword":break;case"AnyKeyword":return[$7];case"UnknownKeyword":return[dN];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":{r[i._tag]||(r[i._tag]=i,n.push(i));break}case"Literal":{const o=typeof i.literal;switch(o){case"string":case"number":case"bigint":case"boolean":{const a=G7[o];!r[a]&&!s.includes(i.literal)&&(s.push(i.literal),n.push(i));break}case"object":{s.includes(i.literal)||(s.push(i.literal),n.push(i));break}}break}case"UniqueSymbol":{!r.SymbolKeyword&&!s.includes(i.symbol)&&(s.push(i.symbol),n.push(i));break}case"TupleType":{r.ObjectKeyword||n.push(i);break}case"TypeLiteral":{i.propertySignatures.length===0&&i.indexSignatures.length===0?r["{}"]||(r["{}"]=i,n.push(i)):r.ObjectKeyword||n.push(i);break}default:n.push(i)}return n};let Br=class ey{types;annotations;static make=(t,n)=>Wb(t)?new ey(t,n):t.length===1?t[0]:qb;static unify=(t,n)=>ey.make(Z7(pN(t)),n);_tag="Union";constructor(t,n={}){this.types=t,this.annotations=n}toString(){return ct(_r(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(t=>t.toJSON()),annotations:Xe(this.annotations)}}};const J7=(e,t)=>e.map(t),Wb=e=>e.length>1,gN=ku("Union"),fg=ge(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class Kb{f;annotations;_tag="Suspend";constructor(t,n={}){this.f=t,this.annotations=n,this.f=HI(t)}toString(){return _r(this).pipe(Fs(()=>Fh(C9(this.f)(),t=>_r(t))),ct(()=>"<suspended schema>"))}toJSON(){const t=this.f();let n=fg.get(t);return n||(fg.set(t,{_tag:this._tag}),n={_tag:this._tag,ast:t.toJSON(),annotations:Xe(this.annotations)},fg.set(t,n),n)}}let _N=class{from;filter;annotations;_tag="Refinement";constructor(t,n,r={}){this.from=t,this.filter=n,this.annotations=r}toString(){return zh(this).pipe(ct(()=>Zn(EN(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:t=>Yb(this.from)?String(this.from)+" & "+t:t})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:Xe(this.annotations)}}};const Yb=ku("Refinement"),hg={};let yN=class{from;to;transformation;annotations;_tag="Transformation";constructor(t,n,r,s={}){this.from=t,this.to=n,this.transformation=r,this.annotations=s}toString(){return ct(_r(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:Xe(this.annotations)}}};class X7{decode;encode;_tag="FinalTransformation";constructor(t,n){this.decode=t,this.encode=n}}let Q7=class{from;to;decode;encode;constructor(t,n,r,s){this.from=t,this.to=n,this.decode=r,this.encode=s}};class ez{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(t){this.propertySignatureTransformations=t;const n={},r={};for(const s of t){const i=s.from;if(n[i])throw new Error(k1(i));n[i]=!0;const o=s.to;if(r[o])throw new Error(k1(o));r[o]=!0}}}const Gb=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={...e.annotations};delete r[zb];const s={...r,...t},i=lN(e);return kt(i)&&(s[iN]=Gb(i.value,t)),n.annotations.value=s,Object.create(Object.getPrototypeOf(e),n)},tz="[\\s\\S]*?",nz="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?",mN=(e,t)=>{switch(e._tag){case"Literal":return Rf(String(e.literal));case"StringKeyword":return tz;case"NumberKeyword":return nz;case"TemplateLiteral":return bN(e);case"Union":return e.types.map(n=>mN(n)).join("|")}},rz=(e,t,n,r)=>gN(e)?`(${t})`:t,bN=(e,t,n)=>{let r="";if(e.head!==""){const s=Rf(e.head);r+=s}for(const s of e.spans){const i=mN(s.type);if(r+=rz(s.type,i),s.literal!==""){const o=Rf(s.literal);r+=o}}return r},sz=e=>new RegExp(`^${bN(e)}$`),v1=(e,t)=>{const n=[],r=[],s=i=>{switch(i._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":r.push(new Wh(i,t,!0));break;case"Literal":if(gr(i.literal)||eo(i.literal))n.push(new Ut(i.literal,t,!1,!0));else throw new Error(l7(i.literal));break;case"Enums":{for(const[o,a]of i.enums)n.push(new Ut(a,t,!1,!0));break}case"UniqueSymbol":n.push(new Ut(i.symbol,t,!1,!0));break;case"Union":i.types.forEach(s);break;default:throw new Error(c7(i))}};return s(e),{propertySignatures:n,indexSignatures:r}},wN=e=>t=>{let n;for(const r of e)Object.prototype.hasOwnProperty.call(t.annotations,r)&&(n===void 0&&(n={}),n[r]=t.annotations[r]);return n},iz=wN([YI,GI,ZI,JI,XI,QI]),It=e=>{switch(e._tag){case"Declaration":{const t=Vn(e.typeParameters,It);return t===e.typeParameters?e:new qh(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const t=Vn(e.elements,s=>{const i=It(s.type);return i===s.type?s:new ic(i,s.isOptional)}),n=fN(e.rest),r=Vn(n,It);return t===e.elements&&r===n?e:new Hb(t,r.map(s=>new Hh(s)),e.isReadonly,e.annotations)}case"TypeLiteral":{const t=Vn(e.propertySignatures,r=>{const s=It(r.type);return s===r.type?r:new Ut(r.name,s,r.isOptional,r.isReadonly)}),n=Vn(e.indexSignatures,r=>{const s=It(r.type);return s===r.type?r:new Wh(r.parameter,s,r.isReadonly)});return t===e.propertySignatures&&n===e.indexSignatures?e:new Vi(t,n,e.annotations)}case"Union":{const t=Vn(e.types,It);return t===e.types?e:Br.make(t,e.annotations)}case"Suspend":return new Kb(()=>It(e.f()),e.annotations);case"Refinement":{const t=It(e.from);return t===e.from?e:new _N(t,e.filter,e.annotations)}case"Transformation":{const t=iz(e);return It(t!==void 0?Gb(e.to,t):e.to)}}return e};function Vn(e,t){let n=!1;const r=jh(e.length);for(let s=0;s<e.length;s++){const i=e[s],o=t(i);o!==i&&(n=!0),r[s]=o}return n?r:e}const Ar=(e,t)=>{switch(e._tag){case"Declaration":{const n=Vn(e.typeParameters,r=>Ar(r));return n===e.typeParameters?e:new qh(n,e.decodeUnknown,e.encodeUnknown)}case"TupleType":{const n=Vn(e.elements,i=>{const o=Ar(i.type);return o===i.type?i:new ic(o,i.isOptional)}),r=fN(e.rest),s=Vn(r,i=>Ar(i));return n===e.elements&&s===r?e:new Hb(n,s.map(i=>new Hh(i)),e.isReadonly)}case"TypeLiteral":{const n=Vn(e.propertySignatures,s=>{const i=Ar(s.type);return i===s.type?s:new Ut(s.name,i,s.isOptional,s.isReadonly)}),r=Vn(e.indexSignatures,s=>{const i=Ar(s.type);return i===s.type?s:new Wh(s.parameter,i,s.isReadonly)});return n===e.propertySignatures&&r===e.indexSignatures?e:new Vi(n,r)}case"Union":{const n=Vn(e.types,r=>Ar(r));return n===e.types?e:Br.make(n)}case"Suspend":{let n;const r=N7(e);if(kt(r)){const s="";n={[uN]:`${r.value}Encoded${s}`}}return new Kb(()=>Ar(e.f()),n)}case"Refinement":return Ar(e.from);case"Transformation":return Ar(e.from)}return e},S1=e=>Ar(e),Xe=e=>{const t={};for(const n of Object.getOwnPropertySymbols(e))t[String(n)]=e[n];return t},kN=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return kN(e.from)}},Zs=e=>ct(_r(e),()=>e._tag);function oz(e){return Zn(y7(e),{onNone:()=>"",onSome:t=>t.map(n=>` & Brand<${bo(n)}>`).join("")})}const EN=e=>oN(e).pipe(Fs(()=>cN(e)),Fs(()=>aN(e)),MI(t=>t+oz(e))),_r=e=>Fs(zh(e),()=>EN(e)),az=Symbol.for("effect/Context/Tag"),Cf=Symbol.for("effect/Context/Reference"),cz="effect/STM",lz=Symbol.for(cz),TN={...bu,_op:"Tag",[lz]:Na,[az]:{_Service:e=>e,_Identifier:e=>e},toString(){return wt(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[Fe](){return this.toJSON()},of(e){return e},context(e){return SN(this,e)}},uz={...TN,[Cf]:Cf},dz=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;const r=Object.create(TN);return Object.defineProperty(r,"stack",{get(){return n.stack}}),r.key=e,r},fz=()=>(e,t)=>{const n=Error.stackTraceLimit;Error.stackTraceLimit=2;const r=new Error;Error.stackTraceLimit=n;function s(){}return Object.setPrototypeOf(s,uz),s.key=e,s.defaultValue=t.defaultValue,Object.defineProperty(s,"stack",{get(){return r.stack}}),s},vN=Symbol.for("effect/Context"),hz={[vN]:{_Services:e=>e},[ie](e){if(gz(e)&&this.unsafeMap.size===e.unsafeMap.size){for(const t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!ne(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[ae](){return Ve(this,$b(this.unsafeMap.size))},pipe(){return X(this,arguments)},toString(){return wt(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(at)}},[Fe](){return this.toJSON()}},Ca=e=>{const t=Object.create(hz);return t.unsafeMap=e,t},pz=e=>{const t=new Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){const n=e.stack.split(`
`);if(n.length>2){const r=n[2].match(/at (.*)/);r&&(t.message=t.message+` (defined at ${r[1]})`)}}if(t.stack){const n=t.stack.split(`
`);n.splice(1,3),t.stack=n.join(`
`)}return t},gz=e=>re(e,vN),_z=e=>re(e,Cf),yz=Ca(new Map),mz=()=>yz,SN=(e,t)=>Ca(new Map([[e.key,t]])),bz=v(3,(e,t,n)=>{const r=new Map(e.unsafeMap);return r.set(t.key,n),Ca(r)}),pg=ge("effect/Context/defaultValueCache",()=>new Map),Zb=e=>{if(pg.has(e.key))return pg.get(e.key);const t=e.defaultValue();return pg.set(e.key,t),t},wz=(e,t)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):Zb(t),AN=v(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(Cf in t)return Zb(t);throw pz(t)}return e.unsafeMap.get(t.key)}),kz=AN,Ez=v(2,(e,t)=>e.unsafeMap.has(t.key)?G_(e.unsafeMap.get(t.key)):_z(t)?G_(Zb(t)):II),Tz=v(2,(e,t)=>{const n=new Map(e.unsafeMap);for(const[r,s]of t.unsafeMap)n.set(r,s);return Ca(n)}),ko=dz,Jb=mz,vz=SN,kc=bz,IN=kz,NN=AN,Eu=Ez,xN=Tz,RN=fz,CN=Symbol.for("effect/Chunk");function Sz(e,t,n,r,s){for(let i=t;i<Math.min(e.length,t+s);i++)n[r+i-t]=e[i];return n}const ON=[],Az=e=>Cb((t,n)=>t.length===n.length&&zi(t).every((r,s)=>e(r,Xo(n,s)))),Iz=Az(ne),Nz={[CN]:{_A:e=>e},toString(){return wt(this.toJSON())},toJSON(){return{_id:"Chunk",values:zi(this).map(at)}},[Fe](){return this.toJSON()},[ie](e){return BN(e)&&Iz(this,e)},[ae](){return Ve(this,yu(zi(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return ON[Symbol.iterator]();default:return zi(this)[Symbol.iterator]()}},pipe(){return X(this,arguments)}},st=e=>{const t=Object.create(Nz);switch(t.backing=e,e._tag){case"IEmpty":{t.length=0,t.depth=0,t.left=t,t.right=t;break}case"IConcat":{t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break}case"IArray":{t.length=e.array.length,t.depth=0,t.left=$r,t.right=$r;break}case"ISingleton":{t.length=1,t.depth=0,t.left=$r,t.right=$r;break}case"ISlice":{t.length=e.length,t.depth=e.chunk.depth+1,t.left=$r,t.right=$r;break}}return t},BN=e=>re(e,CN),$r=st({_tag:"IEmpty"}),ps=()=>$r,gg=(...e)=>Cz(e),On=e=>st({_tag:"ISingleton",a:e}),$N=e=>BN(e)?e:Kh(Ze(e)),ty=(e,t,n)=>{switch(e.backing._tag){case"IArray":{Sz(e.backing.array,0,t,n,e.length);break}case"IConcat":{ty(e.left,t,n),ty(e.right,t,n+e.left.length);break}case"ISingleton":{t[n]=e.backing.a;break}case"ISlice":{let r=0,s=n;for(;r<e.length;)t[s]=Xo(e,r),r+=1,s+=1;break}}},xz=e=>{switch(e.backing._tag){case"IEmpty":return ON;case"IArray":return e.backing.array;default:{const t=new Array(e.length);return ty(e,t,0),e.backing={_tag:"IArray",array:t},e.left=$r,e.right=$r,e.depth=0,t}}},zi=xz,Rz=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return st({_tag:"IArray",array:_1(e.backing.array)});case"IConcat":return st({_tag:"IConcat",left:Oa(e.backing.right),right:Oa(e.backing.left)});case"ISlice":return Kh(_1(zi(e)))}},Oa=Rz,Kh=e=>e.length===0?ps():e.length===1?On(e[0]):st({_tag:"IArray",array:e}),Cz=e=>Kh(e),Xo=v(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Xo(e.left,t):Xo(e.right,t-e.left.length);case"ISlice":return Xo(e.backing.chunk,t+e.backing.offset)}}),Oz=v(2,(e,t)=>ur(e,On(t))),yr=v(2,(e,t)=>ur(On(t),e)),ny=v(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return $r;switch(e.backing._tag){case"ISlice":return st({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?ny(e.right,t-e.left.length):st({_tag:"IConcat",left:ny(e.left,t),right:e.right});default:return st({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}}),ur=v(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;const n=t.depth-e.depth;if(Math.abs(n)<=1)return st({_tag:"IConcat",left:e,right:t});if(n<-1)if(e.left.depth>=e.right.depth){const r=ur(e.right,t);return st({_tag:"IConcat",left:e.left,right:r})}else{const r=ur(e.right.right,t);if(r.depth===e.depth-3){const s=st({_tag:"IConcat",left:e.right.left,right:r});return st({_tag:"IConcat",left:e.left,right:s})}else{const s=st({_tag:"IConcat",left:e.left,right:e.right.left});return st({_tag:"IConcat",left:s,right:r})}}else if(t.right.depth>=t.left.depth){const r=ur(e,t.left);return st({_tag:"IConcat",left:r,right:t.right})}else{const r=ur(e,t.left.left);if(r.depth===t.depth-3){const s=st({_tag:"IConcat",left:r,right:t.left.right});return st({_tag:"IConcat",left:s,right:t.right})}else{const s=st({_tag:"IConcat",left:t.left.right,right:t.right});return st({_tag:"IConcat",left:r,right:s})}}}),Bz=e=>e.length===0,Ba=e=>e.length>0,DN=e=>Xo(e,0),$a=DN,Ci=e=>ny(e,1),ry=Symbol.for("effect/Duration"),MN=BigInt(0),A1=BigInt(24),nd=BigInt(60),sy=BigInt(1e3),I1=BigInt(1e6),N1=BigInt(1e9),$z=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,gs=e=>{if(LN(e))return e;if(eo(e))return iy(e);if(Dh(e))return _g(e);if(Array.isArray(e)&&e.length===2&&e.every(eo))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?UN:e[0]===1/0||e[1]===1/0?Uz:_g(BigInt(Math.round(e[0]*1e9))+BigInt(Math.round(e[1])));if(gr(e)){const t=$z.exec(e);if(t){const[n,r,s]=t,i=Number(r);switch(s){case"nano":case"nanos":return _g(BigInt(r));case"micro":case"micros":return Pz(BigInt(r));case"milli":case"millis":return iy(i);case"second":case"seconds":return Fz(i);case"minute":case"minutes":return jz(i);case"hour":case"hours":return Vz(i);case"day":case"days":return zz(i);case"week":case"weeks":return qz(i)}}}throw new Error("Invalid DurationInput")},x1={_tag:"Millis",millis:0},Dz={_tag:"Infinity"},Mz={[ry]:ry,[ae](){return Ve(this,yI(this.value))},[ie](e){return LN(e)&&Jz(this,e)},toString(){return`Duration(${Qz(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:Wz(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[Fe](){return this.toJSON()},pipe(){return X(this,arguments)}},Kr=e=>{const t=Object.create(Mz);return eo(e)?isNaN(e)||e<=0?t.value=x1:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(e*1e6))}:t.value=Dz:e<=MN?t.value=x1:t.value={_tag:"Nanos",nanos:e},t},LN=e=>re(e,ry),Lz=e=>{switch(e.value._tag){case"Millis":return e.value.millis===0;case"Nanos":return e.value.nanos===MN;case"Infinity":return!1}},UN=Kr(0),Uz=Kr(1/0),_g=e=>Kr(e),Pz=e=>Kr(e*sy),iy=e=>Kr(e),Fz=e=>Kr(e*1e3),jz=e=>Kr(e*6e4),Vz=e=>Kr(e*36e5),zz=e=>Kr(e*864e5),qz=e=>Kr(e*6048e5),oy=e=>Kz(e,{onMillis:t=>t,onNanos:t=>Number(t)/1e6}),Hz=e=>{const t=gs(e);switch(t.value._tag){case"Infinity":throw new Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(t.value.millis*1e6))}},Wz=e=>{const t=gs(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/N1),Number(t.value.nanos%N1)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},Kz=v(2,(e,t)=>{const n=gs(e);switch(n.value._tag){case"Nanos":return t.onNanos(n.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(n.value.millis)}}),Xb=v(3,(e,t,n)=>{const r=gs(e),s=gs(t);if(r.value._tag==="Infinity"||s.value._tag==="Infinity")return n.onMillis(oy(r),oy(s));if(r.value._tag==="Nanos"||s.value._tag==="Nanos"){const i=r.value._tag==="Nanos"?r.value.nanos:BigInt(Math.round(r.value.millis*1e6)),o=s.value._tag==="Nanos"?s.value.nanos:BigInt(Math.round(s.value.millis*1e6));return n.onNanos(i,o)}return n.onMillis(r.value.millis,s.value.millis)}),Yz=(e,t)=>Xb(e,t,{onMillis:(n,r)=>n===r,onNanos:(n,r)=>n===r}),Gz=v(2,(e,t)=>Xb(e,t,{onMillis:(n,r)=>n<=r,onNanos:(n,r)=>n<=r})),Zz=v(2,(e,t)=>Xb(e,t,{onMillis:(n,r)=>n>=r,onNanos:(n,r)=>n>=r})),Jz=v(2,(e,t)=>Yz(gs(e),gs(t))),Xz=e=>{const t=gs(e);if(t.value._tag==="Infinity")return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};const n=Hz(t),r=n/I1,s=r/sy,i=s/nd,o=i/nd,a=o/A1;return{days:Number(a),hours:Number(o%A1),minutes:Number(i%nd),seconds:Number(s%nd),millis:Number(r%sy),nanos:Number(n%I1)}},Qz=e=>{const t=gs(e);if(t.value._tag==="Infinity")return"Infinity";if(Lz(t))return"0";const n=Xz(t),r=[];return n.days!==0&&r.push(`${n.days}d`),n.hours!==0&&r.push(`${n.hours}h`),n.minutes!==0&&r.push(`${n.minutes}m`),n.seconds!==0&&r.push(`${n.seconds}s`),n.millis!==0&&r.push(`${n.millis}ms`),n.nanos!==0&&r.push(`${n.nanos}ns`),r.join(" ")},no=5,Qb=Math.pow(2,no),eq=Qb-1,tq=Qb/2,nq=Qb/4;function rq(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Da(e,t){return t>>>e&eq}function Wo(e){return 1<<e}function PN(e,t){return rq(e&t-1)}const sq=(e,t)=>({value:e,previous:t});function Qo(e,t,n,r){let s=r;if(!e){const i=r.length;s=new Array(i);for(let o=0;o<i;++o)s[o]=r[o]}return s[t]=n,s}function FN(e,t,n){const r=n.length-1;let s=0,i=0,o=n;if(e)s=i=t;else for(o=new Array(r);s<t;)o[i++]=n[s++];for(++s;s<=r;)o[i++]=n[s++];return e&&(o.length=r),o}function iq(e,t,n,r){const s=r.length;if(e){let c=s;for(;c>=t;)r[c--]=r[c];return r[t]=n,r}let i=0,o=0;const a=new Array(s+1);for(;i<t;)a[o++]=r[i++];for(a[t]=n;i<s;)a[++o]=r[i++];return a}class Ws{_tag="EmptyNode";modify(t,n,r,s,i,o){const a=r(G());return _t(a)?new Ws:(++o.value,new qi(t,s,i,a))}}function dr(e){return hI(e,"EmptyNode")}function oq(e){return dr(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function Yh(e,t){return dr(e)?!1:t===e.edit}class qi{edit;hash;key;value;_tag="LeafNode";constructor(t,n,r,s){this.edit=t,this.hash=n,this.key=r,this.value=s}modify(t,n,r,s,i,o){if(ne(i,this.key)){const c=r(this.value);return c===this.value?this:_t(c)?(--o.value,new Ws):Yh(this,t)?(this.value=c,this):new qi(t,s,i,c)}const a=r(G());return _t(a)?this:(++o.value,jN(t,n,this.hash,this,s,new qi(t,s,i,a)))}}class ew{edit;hash;children;_tag="CollisionNode";constructor(t,n,r){this.edit=t,this.hash=n,this.children=r}modify(t,n,r,s,i,o){if(s===this.hash){const c=Yh(this,t),l=this.updateCollisionList(c,t,this.hash,this.children,r,i,o);return l===this.children?this:l.length>1?new ew(t,this.hash,l):l[0]}const a=r(G());return _t(a)?this:(++o.value,jN(t,n,this.hash,this,s,new qi(t,s,i,a)))}updateCollisionList(t,n,r,s,i,o,a){const c=s.length;for(let u=0;u<c;++u){const d=s[u];if("key"in d&&ne(o,d.key)){const f=d.value,h=i(f);return h===f?s:_t(h)?(--a.value,FN(t,u,s)):Qo(t,u,new qi(n,r,o,h),s)}}const l=i(G());return _t(l)?s:(++a.value,Qo(t,c,new qi(n,r,o,l),s))}}class Ma{edit;mask;children;_tag="IndexedNode";constructor(t,n,r){this.edit=t,this.mask=n,this.children=r}modify(t,n,r,s,i,o){const a=this.mask,c=this.children,l=Da(n,s),u=Wo(l),d=PN(a,u),f=a&u,h=Yh(this,t);if(!f){const w=new Ws().modify(t,n+no,r,s,i,o);return w?c.length>=tq?cq(t,l,w,a,c):new Ma(t,a|u,iq(h,d,w,c)):this}const p=c[d],_=p.modify(t,n+no,r,s,i,o);if(p===_)return this;let g=a,y;if(dr(_)){if(g&=~u,!g)return new Ws;if(c.length<=2&&oq(c[d^1]))return c[d^1];y=FN(h,d,c)}else y=Qo(h,d,_,c);return h?(this.mask=g,this.children=y,this):new Ma(t,g,y)}}class tw{edit;size;children;_tag="ArrayNode";constructor(t,n,r){this.edit=t,this.size=n,this.children=r}modify(t,n,r,s,i,o){let a=this.size;const c=this.children,l=Da(n,s),u=c[l],d=(u||new Ws).modify(t,n+no,r,s,i,o);if(u===d)return this;const f=Yh(this,t);let h;if(dr(u)&&!dr(d))++a,h=Qo(f,l,d,c);else if(!dr(u)&&dr(d)){if(--a,a<=nq)return aq(t,a,l,c);h=Qo(f,l,new Ws,c)}else h=Qo(f,l,d,c);return f?(this.size=a,this.children=h,this):new tw(t,a,h)}}function aq(e,t,n,r){const s=new Array(t-1);let i=0,o=0;for(let a=0,c=r.length;a<c;++a)if(a!==n){const l=r[a];l&&!dr(l)&&(s[i++]=l,o|=1<<a)}return new Ma(e,o,s)}function cq(e,t,n,r,s){const i=[];let o=r,a=0;for(let c=0;o;++c)o&1&&(i[c]=s[a++]),o>>>=1;return i[t]=n,new tw(e,a+1,i)}function lq(e,t,n,r,s,i){if(n===s)return new ew(e,n,[i,r]);const o=Da(t,n),a=Da(t,s);if(o===a)return c=>new Ma(e,Wo(o)|Wo(a),[c]);{const c=o<a?[r,i]:[i,r];return new Ma(e,Wo(o)|Wo(a),c)}}function jN(e,t,n,r,s,i){let o,a=t;for(;;){const c=lq(e,a,n,r,s,i);if(typeof c=="function")o=sq(c,o),a=a+no;else{let l=c;for(;o!=null;)l=o.value(l),o=o.previous;return l}}}const VN="effect/HashMap",ay=Symbol.for(VN),uq={[ay]:ay,[Symbol.iterator](){return new Gh(this,(e,t)=>[e,t])},[ae](){let e=K(VN);for(const t of this)e^=$(K(t[0]),_e(K(t[1])));return Ve(this,e)},[ie](e){if(hq(e)){if(e._size!==this._size)return!1;for(const t of this){const n=$(e,rw(t[0],K(t[0])));if(_t(n))return!1;if(!ne(t[1],n.value))return!1}return!0}return!1},toString(){return wt(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(at)}},[Fe](){return this.toJSON()},pipe(){return X(this,arguments)}},nw=(e,t,n,r)=>{const s=Object.create(uq);return s._editable=e,s._edit=t,s._root=n,s._size=r,s};class Gh{map;f;v;constructor(t,n){this.map=t,this.f=n,this.v=zN(this.map._root,this.f,void 0)}next(){if(_t(this.v))return{done:!0,value:void 0};const t=this.v.value;return this.v=Of(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new Gh(this.map,this.f)}}const Of=e=>e?qN(e[0],e[1],e[2],e[3],e[4]):G(),zN=(e,t,n=void 0)=>{switch(e._tag){case"LeafNode":return kt(e.value)?te({value:t(e.key,e.value.value),cont:n}):Of(n);case"CollisionNode":case"ArrayNode":case"IndexedNode":{const r=e.children;return qN(r.length,r,0,t,n)}default:return Of(n)}},qN=(e,t,n,r,s)=>{for(;n<e;){const i=t[n++];if(i&&!dr(i))return zN(i,r,[e,t,n,r,s])}return Of(s)},dq=nw(!1,0,new Ws,0),Zh=()=>dq,fq=e=>{const t=WN(Zh());for(const n of e)jl(t,n[0],n[1]);return mq(t)},hq=e=>re(e,ay),pq=e=>e&&dr(e._root),gq=v(2,(e,t)=>rw(e,t,K(t))),rw=v(3,(e,t,n)=>{let r=e._root,s=0;for(;;)switch(r._tag){case"LeafNode":return ne(t,r.key)?r.value:G();case"CollisionNode":{if(n===r.hash){const i=r.children;for(let o=0,a=i.length;o<a;++o){const c=i[o];if("key"in c&&ne(t,c.key))return c.value}}return G()}case"IndexedNode":{const i=Da(s,n),o=Wo(i);if(r.mask&o){r=r.children[PN(r.mask,o)],s+=no;break}return G()}case"ArrayNode":{if(r=r.children[Da(s,n)],r){s+=no;break}return G()}default:return G()}}),_q=v(2,(e,t)=>kt(rw(e,t,K(t)))),jl=v(3,(e,t,n)=>sw(e,t,()=>te(n))),yq=v(3,(e,t,n)=>e._editable?(e._root=t,e._size=n,e):t===e._root?e:nw(e._editable,e._edit,t,n)),HN=e=>new Gh(e,t=>t),cy=e=>e._size,WN=e=>nw(!0,e._edit+1,e._root,e._size),mq=e=>(e._editable=!1,e),sw=v(3,(e,t,n)=>bq(e,t,K(t),n)),bq=v(4,(e,t,n,r)=>{const s={value:e._size},i=e._root.modify(e._editable?e._edit:NaN,0,r,n,t,s);return $(e,yq(i,s.value))}),R1=v(2,(e,t)=>sw(e,t,G)),wq=v(2,(e,t)=>Jh(e,Zh(),(n,r,s)=>jl(n,s,t(r,s)))),kq=v(2,(e,t)=>Jh(e,void 0,(n,r,s)=>t(r,s))),Jh=v(3,(e,t,n)=>{const r=e._root;if(r._tag==="LeafNode")return kt(r.value)?n(t,r.value.value,r.key):t;if(r._tag==="EmptyNode")return t;const s=[r.children];let i;for(;i=s.pop();)for(let o=0,a=i.length;o<a;){const c=i[o++];c&&!dr(c)&&(c._tag==="LeafNode"?kt(c.value)&&(t=n(t,c.value.value,c.key)):s.push(c.children))}return t}),KN="effect/HashSet",ly=Symbol.for(KN),Eq={[ly]:ly,[Symbol.iterator](){return HN(this._keyMap)},[ae](){return Ve(this,_e(K(this._keyMap))(K(KN)))},[ie](e){return Tq(e)?cy(this._keyMap)===cy(e._keyMap)&&ne(this._keyMap,e._keyMap):!1},toString(){return wt(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(at)}},[Fe](){return this.toJSON()},pipe(){return X(this,arguments)}},Xh=e=>{const t=Object.create(Eq);return t._keyMap=e,t},Tq=e=>re(e,ly),vq=Xh(Zh()),Qh=()=>vq,Sq=e=>{const t=iw(Qh());for(const n of e)Vl(t,n);return ow(t)},Aq=(...e)=>{const t=iw(Qh());for(const n of e)Vl(t,n);return ow(t)},Iq=v(2,(e,t)=>_q(e._keyMap,t)),Nq=e=>cy(e._keyMap),iw=e=>Xh(WN(e._keyMap)),ow=e=>(e._keyMap._editable=!1,e),YN=v(2,(e,t)=>{const n=iw(e);return t(n),ow(n)}),Vl=v(2,(e,t)=>e._keyMap._editable?(jl(t,!0)(e._keyMap),e):Xh(jl(t,!0)(e._keyMap))),GN=v(2,(e,t)=>e._keyMap._editable?(R1(t)(e._keyMap),e):Xh(R1(t)(e._keyMap))),xq=v(2,(e,t)=>YN(e,n=>{for(const r of t)GN(n,r)})),Rq=v(2,(e,t)=>YN(Qh(),n=>{Cq(e,r=>Vl(n,r));for(const r of t)Vl(n,r)})),Cq=v(2,(e,t)=>kq(e._keyMap,(n,r)=>t(r))),Oq=v(3,(e,t,n)=>Jh(e._keyMap,t,(r,s,i)=>n(r,i))),ro=Qh,Bq=Sq,aw=Aq,$q=Iq,ZN=Nq,gl=Vl,JN=GN,C1=xq,zl=Rq,Bf=Oq,O1=Symbol.for("effect/MutableRef"),Dq={[O1]:O1,toString(){return wt(this.toJSON())},toJSON(){return{_id:"MutableRef",current:at(this.current)}},[Fe](){return this.toJSON()},pipe(){return X(this,arguments)}},XN=e=>{const t=Object.create(Dq);return t.current=e,t},ep=e=>e.current,QN=v(2,(e,t)=>(e.current=t,e)),cw="effect/FiberId",ql=Symbol.for(cw),$f="None",uy="Runtime",Mq="Composite",Lq=et(`${cw}-${$f}`);let Uq=class{[ql]=ql;_tag=$f;id=-1;startTimeMillis=-1;[ae](){return Lq}[ie](t){return ex(t)&&t._tag===$f}toString(){return wt(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[Fe](){return this.toJSON()}};class Pq{id;startTimeMillis;[ql]=ql;_tag=uy;constructor(t,n){this.id=t,this.startTimeMillis=n}[ae](){return Ve(this,et(`${cw}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[ie](t){return ex(t)&&t._tag===uy&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}toString(){return wt(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[Fe](){return this.toJSON()}}const Fq=new Uq,ex=e=>re(e,ql),dy=e=>{switch(e._tag){case $f:return ro();case uy:return aw(e.id);case Mq:return $(dy(e.left),zl(dy(e.right)))}},B1=ge(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>XN(0)),tx=e=>Array.from(dy(e)).map(n=>`#${n}`).join(","),jq=()=>{const e=ep(B1);return $(B1,QN(e+1)),new Pq(e,Date.now())},La=Fq,Vq=tx,nx=jq,lw=Zh,zq=fq,qq=pq,rx=gq,sx=jl,ix=HN,Hq=sw,Wq=wq,ox=Jh,Hl=Symbol.for("effect/List"),fy=e=>Ze(e),Kq=e=>DV(Vh(e),fy),Yq=Kq(ne),Gq={[Hl]:Hl,_tag:"Cons",toString(){return wt(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:fy(this).map(at)}},[Fe](){return this.toJSON()},[ie](e){return cx(e)&&this._tag===e._tag&&Yq(this,e)},[ae](){return Ve(this,yu(fy(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if(t._tag==="Nil")return e=!0,this.return();const n=t.head;return t=t.tail,{done:e,value:n}},return(n){return e||(e=!0),{done:!0,value:n}}}},pipe(){return X(this,arguments)}},Df=(e,t)=>{const n=Object.create(Gq);return n.head=e,n.tail=t,n},Zq=et("Nil"),Jq={[Hl]:Hl,_tag:"Nil",toString(){return wt(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[Fe](){return this.toJSON()},[ae](){return Zq},[ie](e){return cx(e)&&this._tag===e._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return X(this,arguments)}},ax=Object.create(Jq),cx=e=>re(e,Hl),ls=e=>e._tag==="Nil",Xq=e=>e._tag==="Cons",Qq=()=>ax,so=(e,t)=>Df(e,t),Ua=Qq,uw=e=>Df(e,ax),eH=v(2,(e,t)=>nH(t,e)),tH=v(2,(e,t)=>so(t,e)),nH=v(2,(e,t)=>{if(ls(e))return t;if(ls(t))return e;{const n=Df(t.head,e);let r=n,s=t.tail;for(;!ls(s);){const i=Df(s.head,e);r.tail=i,r=i,s=s.tail}return n}}),rH=v(3,(e,t,n)=>{let r=t,s=e;for(;!ls(s);)r=n(r,s.head),s=s.tail;return r}),sH=e=>{let t=Ua(),n=e;for(;!ls(n);)t=tH(t,n.head),n=n.tail;return t},dw=function(){function e(t){t&&Object.assign(this,t)}return e.prototype=Pb,e}(),iH=Symbol.for("effect/DifferContextPatch");function $1(e){return e}const Tu={...dw.prototype,[iH]:{_Value:$1,_Patch:$1}},oH=Object.assign(Object.create(Tu),{_tag:"Empty"}),aH=Object.create(oH),lx=()=>aH,cH=Object.assign(Object.create(Tu),{_tag:"AndThen"}),lH=(e,t)=>{const n=Object.create(cH);return n.first=e,n.second=t,n},uH=Object.assign(Object.create(Tu),{_tag:"AddService"}),dH=(e,t)=>{const n=Object.create(uH);return n.key=e,n.service=t,n},fH=Object.assign(Object.create(Tu),{_tag:"RemoveService"}),hH=e=>{const t=Object.create(fH);return t.key=e,t},pH=Object.assign(Object.create(Tu),{_tag:"UpdateService"}),gH=(e,t)=>{const n=Object.create(pH);return n.key=e,n.update=t,n},_H=(e,t)=>{const n=new Map(e.unsafeMap);let r=lx();for(const[s,i]of t.unsafeMap.entries())if(n.has(s)){const o=n.get(s);n.delete(s),ne(o,i)||(r=Dd(gH(s,()=>i))(r))}else n.delete(s),r=Dd(dH(s,i))(r);for(const[s]of n.entries())r=Dd(hH(s))(r);return r},Dd=v(2,(e,t)=>lH(e,t)),yH=v(2,(e,t)=>{if(e._tag==="Empty")return t;let n=!1,r=On(e);const s=new Map(t.unsafeMap);for(;Ba(r);){const o=$a(r),a=Ci(r);switch(o._tag){case"Empty":{r=a;break}case"AddService":{s.set(o.key,o.service),r=a;break}case"AndThen":{r=yr(yr(a,o.second),o.first);break}case"RemoveService":{s.delete(o.key),r=a;break}case"UpdateService":{s.set(o.key,o.update(s.get(o.key))),n=!0,r=a;break}}}if(!n)return Ca(s);const i=new Map;for(const[o]of t.unsafeMap)s.has(o)&&(i.set(o,s.get(o)),s.delete(o));for(const[o,a]of s)i.set(o,a);return Ca(i)}),mH=Symbol.for("effect/DifferHashSetPatch");function yg(e){return e}const tp={...dw.prototype,[mH]:{_Value:yg,_Key:yg,_Patch:yg}},bH=Object.assign(Object.create(tp),{_tag:"Empty"}),wH=Object.create(bH),ux=()=>wH,kH=Object.assign(Object.create(tp),{_tag:"AndThen"}),EH=(e,t)=>{const n=Object.create(kH);return n.first=e,n.second=t,n},TH=Object.assign(Object.create(tp),{_tag:"Add"}),vH=e=>{const t=Object.create(TH);return t.value=e,t},SH=Object.assign(Object.create(tp),{_tag:"Remove"}),AH=e=>{const t=Object.create(SH);return t.value=e,t},IH=(e,t)=>{const[n,r]=Bf([e,ux()],([s,i],o)=>$q(o)(s)?[JN(o)(s),i]:[s,hy(vH(o))(i)])(t);return Bf(r,(s,i)=>hy(AH(i))(s))(n)},hy=v(2,(e,t)=>EH(e,t)),NH=v(2,(e,t)=>{if(e._tag==="Empty")return t;let n=t,r=On(e);for(;Ba(r);){const s=$a(r),i=Ci(r);switch(s._tag){case"Empty":{r=i;break}case"AndThen":{r=yr(s.first)(yr(s.second)(i));break}case"Add":{n=gl(s.value)(n),r=i;break}case"Remove":n=JN(s.value)(n),r=i}}return n}),xH=Symbol.for("effect/DifferReadonlyArrayPatch");function D1(e){return e}const vu={...dw.prototype,[xH]:{_Value:D1,_Patch:D1}},RH=Object.assign(Object.create(vu),{_tag:"Empty"}),CH=Object.create(RH),dx=()=>CH,OH=Object.assign(Object.create(vu),{_tag:"AndThen"}),BH=(e,t)=>{const n=Object.create(OH);return n.first=e,n.second=t,n},$H=Object.assign(Object.create(vu),{_tag:"Append"}),DH=e=>{const t=Object.create($H);return t.values=e,t},MH=Object.assign(Object.create(vu),{_tag:"Slice"}),LH=(e,t)=>{const n=Object.create(MH);return n.from=e,n.until=t,n},UH=Object.assign(Object.create(vu),{_tag:"Update"}),PH=(e,t)=>{const n=Object.create(UH);return n.index=e,n.patch=t,n},FH=e=>{let t=0,n=dx();for(;t<e.oldValue.length&&t<e.newValue.length;){const r=e.oldValue[t],s=e.newValue[t],i=e.differ.diff(r,s);ne(i,e.differ.empty)||(n=Md(n,PH(t,i))),t=t+1}return t<e.oldValue.length&&(n=Md(n,LH(0,t))),t<e.newValue.length&&(n=Md(n,DH(Z9(t)(e.newValue)))),n},Md=v(2,(e,t)=>BH(e,t)),jH=v(3,(e,t,n)=>{if(e._tag==="Empty")return t;let r=t.slice(),s=sr(e);for(;Bd(s);){const i=Kt(s),o=to(s);switch(i._tag){case"Empty":{s=o;break}case"AndThen":{o.unshift(i.first,i.second),s=o;break}case"Append":{for(const a of i.values)r.push(a);s=o;break}case"Slice":{r=r.slice(i.from,i.until),s=o;break}case"Update":{r[i.index]=n.patch(i.patch,r[i.index]),s=o;break}}}return r}),VH=Symbol.for("effect/Differ"),zH={[VH]:{_P:nt,_V:nt},pipe(){return X(this,arguments)}},oc=e=>{const t=Object.create(zH);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},qH=()=>oc({empty:lx(),combine:(e,t)=>Dd(t)(e),diff:(e,t)=>_H(e,t),patch:(e,t)=>yH(t)(e)}),HH=()=>oc({empty:ux(),combine:(e,t)=>hy(t)(e),diff:(e,t)=>IH(e,t),patch:(e,t)=>NH(t)(e)}),WH=e=>oc({empty:dx(),combine:(t,n)=>Md(t,n),diff:(t,n)=>FH({oldValue:t,newValue:n,differ:e}),patch:(t,n)=>jH(t,n,e)}),fx=()=>KH((e,t)=>t),KH=e=>oc({empty:nt,combine:(t,n)=>t===nt?n:n===nt?t:r=>n(t(r)),diff:(t,n)=>ne(t,n)?nt:Bh(n),patch:(t,n)=>e(n,t(n))}),Wl=255,hx=8,py=e=>e&Wl,gy=e=>e>>hx&Wl,Su=(e,t)=>(e&Wl)+((t&e&Wl)<<hx),YH=Su(0,0),GH=e=>Su(e,e),ZH=e=>Su(e,0),JH=v(2,(e,t)=>Su(py(e)&~t,gy(e))),XH=v(2,(e,t)=>e|t),QH=e=>~e>>>0&Wl,eW=0,ac=1,tW=2,px=4,_y=16,gx=32,nW=e=>np(e,gx),rW=v(2,(e,t)=>e|t),Es=e=>_x(e)&&!iW(e),_x=e=>np(e,ac),np=v(2,(e,t)=>(e&t)!==0),yx=(...e)=>e.reduce((t,n)=>t|n,0),sW=yx(eW),M1=e=>np(e,px),iW=e=>np(e,_y),Ld=v(2,(e,t)=>Su(e^t,t)),Ud=v(2,(e,t)=>e&(QH(py(t))|gy(t))|py(t)&gy(t)),L1=oc({empty:YH,diff:(e,t)=>Ld(e,t),combine:(e,t)=>XH(t)(e),patch:(e,t)=>Ud(t,e)}),oW=GH,mx=ZH,U1=JH,bx=(e,t)=>({_tag:"Par",left:e,right:t}),rd=(e,t)=>({_tag:"Seq",left:e,right:t}),aW=e=>{let t=uw(e),n=Ua();for(;;){const[r,s]=rH(t,[wx(),Ua()],([i,o],a)=>{const[c,l]=cW(a);return[hW(i,c),eH(o,l)]});if(n=lW(n,r),ls(s))return sH(n);t=s}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},cW=e=>{let t=e,n=wx(),r=Ua(),s=Ua();for(;;)switch(t._tag){case"Empty":{if(ls(r))return[n,s];t=r.head,r=r.tail;break}case"Par":{r=so(t.right,r),t=t.left;break}case"Seq":{const i=t.left,o=t.right;switch(i._tag){case"Empty":{t=o;break}case"Par":{const a=i.left,c=i.right;t=bx(rd(a,o),rd(c,o));break}case"Seq":{const a=i.left,c=i.right;t=rd(a,rd(c,o));break}case"Single":{t=i,s=so(o,s);break}}break}case"Single":{if(n=fW(n,t),ls(r))return[n,s];t=r.head,r=r.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},lW=(e,t)=>{if(ls(e))return uw(mg(t));if(pW(t))return e;const n=wW(e.head),r=gW(t);return n.length===1&&r.length===1&&ne(n[0],r[0])?so(bW(e.head,mg(t)),e.tail):so(mg(t),e)},uW=Symbol.for("effect/RequestBlock/RequestBlockParallel"),dW={_R:e=>e};class fw{map;[uW]=dW;constructor(t){this.map=t}}const wx=()=>new fw(lw()),fW=(e,t)=>new fw(Hq(e.map,t.dataSource,n=>R9(MI(n,Oz(t.blockedRequest)),()=>On(t.blockedRequest)))),hW=(e,t)=>new fw(ox(e.map,t.map,(n,r,s)=>sx(n,s,Zn(rx(n,s),{onNone:()=>r,onSome:i=>ur(r,i)})))),pW=e=>qq(e.map),gW=e=>Array.from(ix(e.map)),mg=e=>mW(Wq(e.map,t=>On(t))),_W=Symbol.for("effect/RequestBlock/RequestBlockSequential"),yW={_R:e=>e};class kx{map;[_W]=yW;constructor(t){this.map=t}}const mW=e=>new kx(e),bW=(e,t)=>new kx(ox(t.map,e.map,(n,r,s)=>sx(n,s,Zn(rx(n,s),{onNone:()=>ps(),onSome:i=>ur(i,r)})))),wW=e=>Array.from(ix(e.map)),kW=e=>Array.from(e.map),Au="Die",io="Empty",Eo="Fail",cc="Interrupt",Pa="Parallel",Fa="Sequential",Ex="effect/Cause",Tx=Symbol.for(Ex),EW={_E:e=>e},lc={[Tx]:EW,[ae](){return $(K(Ex),_e(K(MW(this))),Ve(this))},[ie](e){return TW(e)&&DW(this,e)},pipe(){return X(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:at(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:at(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:at(this.left),right:at(this.right)}}},toString(){return uc(this)},[Fe](){return this.toJSON()}},ja=(()=>{const e=Object.create(lc);return e._tag=io,e})(),Mf=e=>{const t=Object.create(lc);return t._tag=Eo,t.error=e,t},qr=e=>{const t=Object.create(lc);return t._tag=Au,t.defect=e,t},Ss=e=>{const t=Object.create(lc);return t._tag=cc,t.fiberId=e,t},rp=(e,t)=>{const n=Object.create(lc);return n._tag=Pa,n.left=e,n.right=t,n},Wn=(e,t)=>{const n=Object.create(lc);return n._tag=Fa,n.left=e,n.right=t,n},TW=e=>re(e,Tx),vW=e=>e._tag===io,SW=e=>e._tag===Eo,AW=e=>e._tag===io?!0:Va(e,!0,(t,n)=>{switch(n._tag){case io:return te(t);case Au:case Eo:case cc:return te(!1);default:return G()}}),IW=e=>kt(BW(e)),hw=e=>pw(void 0,UW)(e),NW=e=>Oa(Va(e,ps(),(t,n)=>n._tag===Eo?te($(t,yr(n.error))):G())),xW=e=>Oa(Va(e,ps(),(t,n)=>n._tag===Au?te($(t,yr(n.defect))):G())),RW=e=>Va(e,ro(),(t,n)=>n._tag===cc?te($(t,gl(n.fiberId))):G()),CW=e=>vx(e,t=>t._tag===Eo?te(t.error):G()),OW=e=>{const t=CW(e);switch(t._tag){case"None":return be(e);case"Some":return oe(t.value)}},BW=e=>vx(e,t=>t._tag===cc?te(t.fiberId):G()),P1=e=>Sx(e,{onEmpty:ja,onFail:()=>ja,onDie:qr,onInterrupt:Ss,onSequential:Wn,onParallel:rp}),$W=e=>Sx(e,{onEmpty:ja,onFail:qr,onDie:qr,onInterrupt:Ss,onSequential:Wn,onParallel:rp}),DW=(e,t)=>{let n=On(e),r=On(t);for(;Ba(n)&&Ba(r);){const[s,i]=$($a(n),Va([ro(),ps()],([c,l],u)=>{const[d,f]=yy(u);return te([$(c,zl(d)),$(l,ur(f))])})),[o,a]=$($a(r),Va([ro(),ps()],([c,l],u)=>{const[d,f]=yy(u);return te([$(c,zl(d)),$(l,ur(f))])}));if(!ne(s,o))return!1;n=i,r=a}return!0},MW=e=>LW(On(e),ps()),LW=(e,t)=>{for(;;){const[n,r]=$(e,VI([ro(),ps()],([i,o],a)=>{const[c,l]=yy(a);return[$(i,zl(c)),$(o,ur(l))]})),s=ZN(n)>0?$(t,yr(n)):t;if(Bz(r))return Oa(s);e=r,t=s}throw new Error(Mh("Cause.flattenCauseLoop"))},vx=v(2,(e,t)=>{const n=[e];for(;n.length>0;){const r=n.pop(),s=t(r);switch(s._tag){case"None":{switch(r._tag){case Fa:case Pa:{n.push(r.right),n.push(r.left);break}}break}case"Some":return s}}return G()}),yy=e=>{let t=e;const n=[];let r=ro(),s=ps();for(;t!==void 0;)switch(t._tag){case io:{if(n.length===0)return[r,s];t=n.pop();break}case Eo:{if(r=gl(r,gg(t._tag,t.error)),n.length===0)return[r,s];t=n.pop();break}case Au:{if(r=gl(r,gg(t._tag,t.defect)),n.length===0)return[r,s];t=n.pop();break}case cc:{if(r=gl(r,gg(t._tag,t.fiberId)),n.length===0)return[r,s];t=n.pop();break}case Fa:{switch(t.left._tag){case io:{t=t.right;break}case Fa:{t=Wn(t.left.left,Wn(t.left.right,t.right));break}case Pa:{t=rp(Wn(t.left.left,t.right),Wn(t.left.right,t.right));break}default:{s=yr(s,t.right),t=t.left;break}}break}case Pa:{n.push(t.right),t=t.left;break}}throw new Error(Mh("Cause.evaluateCauseLoop"))},UW={emptyCase:h1,failCase:W_,dieCase:W_,interruptCase:h1,sequentialCase:(e,t,n)=>t&&n,parallelCase:(e,t,n)=>t&&n},F1="SequentialCase",j1="ParallelCase",Sx=v(2,(e,{onDie:t,onEmpty:n,onFail:r,onInterrupt:s,onParallel:i,onSequential:o})=>pw(e,void 0,{emptyCase:()=>n,failCase:(a,c)=>r(c),dieCase:(a,c)=>t(c),interruptCase:(a,c)=>s(c),sequentialCase:(a,c,l)=>o(c,l),parallelCase:(a,c,l)=>i(c,l)})),Va=v(3,(e,t,n)=>{let r=t,s=e;const i=[];for(;s!==void 0;){const o=n(r,s);switch(r=kt(o)?o.value:r,s._tag){case Fa:{i.push(s.right),s=s.left;break}case Pa:{i.push(s.right),s=s.left;break}default:{s=void 0;break}}s===void 0&&i.length>0&&(s=i.pop())}return r}),pw=v(3,(e,t,n)=>{const r=[e],s=[];for(;r.length>0;){const o=r.pop();switch(o._tag){case io:{s.push(be(n.emptyCase(t)));break}case Eo:{s.push(be(n.failCase(t,o.error)));break}case Au:{s.push(be(n.dieCase(t,o.defect)));break}case cc:{s.push(be(n.interruptCase(t,o.fiberId)));break}case Fa:{r.push(o.right),r.push(o.left),s.push(oe({_tag:F1}));break}case Pa:{r.push(o.right),r.push(o.left),s.push(oe({_tag:j1}));break}}}const i=[];for(;s.length>0;){const o=s.pop();switch(o._tag){case"Left":{switch(o.left._tag){case F1:{const a=i.pop(),c=i.pop(),l=n.sequentialCase(t,a,c);i.push(l);break}case j1:{const a=i.pop(),c=i.pop(),l=n.parallelCase(t,a,c);i.push(l);break}}break}case"Right":{i.push(o.right);break}}}if(i.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return i.pop()}),uc=(e,t)=>hw(e)?"All fibers interrupted without errors.":Ix(e).map(function(n){return t?.renderErrorCause!==!0||n.cause===void 0?n.stack:`${n.stack} {
${Ax(n.cause,"  ")}
}`}).join(`
`),Ax=(e,t)=>{const n=e.stack.split(`
`);let r=`${t}[cause]: ${n[0]}`;for(let s=1,i=n.length;s<i;s++)r+=`
${t}${n[s]}`;return e.cause&&(r+=` {
${Ax(e.cause,`${t}  `)}
${t}}`),r};class Lf extends globalThis.Error{span=void 0;constructor(t){const n=typeof t=="object"&&t!==null,r=Error.stackTraceLimit;Error.stackTraceLimit=1,super(PW(t),n&&"cause"in t&&typeof t.cause<"u"?{cause:new Lf(t.cause)}:void 0),this.message===""&&(this.message="An error has occurred"),Error.stackTraceLimit=r,this.name=t instanceof Error?t.name:"Error",n&&(za in t&&(this.span=t[za]),Object.keys(t).forEach(s=>{s in this||(this[s]=t[s])})),this.stack=VW(`${this.name}: ${this.message}`,t instanceof Error&&t.stack?t.stack:"",this.span)}}const PW=e=>{if(typeof e=="string")return e;if(typeof e=="object"&&e!==null&&e instanceof Error)return e.message;try{if(re(e,"toString")&&gu(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return mI(e)},FW=/\((.*)\)/g,jW=ge("effect/Tracer/spanToTrace",()=>new WeakMap),VW=(e,t,n)=>{const r=[e],s=t.startsWith(e)?t.slice(e.length).split(`
`):t.split(`
`);for(let i=1;i<s.length;i++){if(s[i].includes(" at new BaseEffectError")||s[i].includes(" at new YieldableError")){i++;continue}if(s[i].includes("Generator.next")||s[i].includes("effect_internal_function"))break;r.push(s[i].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(n){let i=n,o=0;for(;i&&i._tag==="Span"&&o<10;){const a=jW.get(i);if(typeof a=="function"){const c=a();if(typeof c=="string"){const l=c.matchAll(FW);let u=!1;for(const[,d]of l)u=!0,r.push(`    at ${i.name} (${d})`);u||r.push(`    at ${i.name} (${c.replace(/^at /,"")})`)}else r.push(`    at ${i.name}`)}else r.push(`    at ${i.name}`);i=Or(i.parent),o++}}return r.join(`
`)},za=Symbol.for("effect/SpanAnnotation"),Ix=e=>pw(e,void 0,{emptyCase:()=>[],dieCase:(t,n)=>[new Lf(n)],failCase:(t,n)=>[new Lf(n)],interruptCase:()=>[],parallelCase:(t,n,r)=>[...n,...r],sequentialCase:(t,n,r)=>[...n,...r]}),sp="Pending",Nx="Done",zW="effect/Deferred",qW=Symbol.for(zW),HW={_E:e=>e,_A:e=>e},WW=e=>({_tag:sp,joiners:e}),KW=e=>({_tag:Nx,effect:e});class Iu{self;called=!1;constructor(t){this.self=t}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new Iu(this.self)}}const xx=(e,t)=>{const n=new $t("Blocked");return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n},YW=e=>{const t=new $t("RunBlocked");return t.effect_instruction_i0=e,t},qa=Symbol.for("effect/Effect");class GW{patch;op;_op=Lb;constructor(t,n){this.patch=t,this.op=n}}class $t{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[qa]=Na;constructor(t){this._op=t}[ie](t){return this===t}[ae](){return Ve(this,Bb(this))}pipe(){return X(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:at(this.effect_instruction_i0),effect_instruction_i1:at(this.effect_instruction_i1),effect_instruction_i2:at(this.effect_instruction_i2)}}toString(){return wt(this.toJSON())}[Fe](){return this.toJSON()}[Symbol.iterator](){return new Iu(new _u(this))}}class Rx{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[qa]=Na;constructor(t){this._op=t,this._tag=t}[ie](t){return Tw(t)&&t._op==="Failure"&&ne(this.effect_instruction_i0,t.effect_instruction_i0)}[ae](){return $(et(this._tag),_e(K(this.effect_instruction_i0)),Ve(this))}get cause(){return this.effect_instruction_i0}pipe(){return X(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return wt(this.toJSON())}[Fe](){return this.toJSON()}[Symbol.iterator](){return new Iu(new _u(this))}}class Cx{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[qa]=Na;constructor(t){this._op=t,this._tag=t}[ie](t){return Tw(t)&&t._op==="Success"&&ne(this.effect_instruction_i0,t.effect_instruction_i0)}[ae](){return $(et(this._tag),_e(K(this.effect_instruction_i0)),Ve(this))}get value(){return this.effect_instruction_i0}pipe(){return X(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:at(this.value)}}toString(){return wt(this.toJSON())}[Fe](){return this.toJSON()}[Symbol.iterator](){return new Iu(new _u(this))}}const ip=e=>re(e,qa),Bn=e=>{const t=new $t(kI);return t.effect_instruction_i0=e,t},ZW=v(3,(e,t,n)=>cp(r=>Q(e,s=>Q(Bx(it(()=>r(t(s)))),i=>it(()=>n(s,i)).pipe(Ha({onFailure:o=>{switch(i._tag){case hr:return mr(Wn(i.effect_instruction_i0,o));case pr:return mr(o)}},onSuccess:()=>i})))))),Nu=v(2,(e,t)=>Q(e,()=>Pe(t))),xu=e=>Nu(e,void 0),Ox=function(){const e=new $t(Uh);switch(arguments.length){case 2:{e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break}case 3:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break}case 4:{e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break}default:throw new Error(Mh("you're not supposed to end up here"))}return e},Uf=(e,t=La)=>{const n=new $t(hl);let r;return n.effect_instruction_i0=s=>{r=e(s)},n.effect_instruction_i1=t,Px(n,s=>ip(r)?r:br)},JW=(e,t=La)=>it(()=>Uf(e,t)),Kl=(e,t=La)=>Ox(e,function(){let n,r;function s(c){n?n(c):r===void 0&&(r=c)}const i=new $t(hl);i.effect_instruction_i0=c=>{n=c,r&&c(r)},i.effect_instruction_i1=t;let o,a;return this.effect_instruction_i0.length!==1?(a=new AbortController,o=zt(()=>this.effect_instruction_i0(s,a.signal))):o=zt(()=>this.effect_instruction_i0(s)),o||a?Px(i,c=>(a&&a.abort(),o??br)):i}),my=v(2,(e,t)=>_w(e,{onFailure:t,onSuccess:Pe})),V1=Symbol.for("effect/OriginalAnnotation"),gw=(e,t)=>kt(t)?new Proxy(e,{has(n,r){return r===za||r===V1||r in n},get(n,r){return r===za?t.value:r===V1?e:n[r]}}):e,z1=e=>_s(e)&&!(za in e)?Bn(t=>mr(qr(gw(e,vw(t))))):mr(qr(e)),XW=e=>QW(()=>qr(new xK(e))),Pf=e=>_w(e,{onFailure:t=>Pe(oe(t)),onSuccess:t=>Pe(be(t))}),Bx=e=>nK(e,{onFailure:Be,onSuccess:tt}),nn=e=>_s(e)&&!(za in e)?Bn(t=>mr(Mf(gw(e,vw(t))))):mr(Mf(e)),$x=e=>Q(ee(e),nn),mr=e=>{const t=new Rx(hr);return t.effect_instruction_i0=e,t},QW=e=>Q(ee(e),mr),eK=Bn(e=>Pe(e.id())),Dx=e=>Bn(t=>e(t.id())),Q=v(2,(e,t)=>{const n=new $t(Af);return n.effect_instruction_i0=e,n.effect_instruction_i1=t,n}),tK=e=>{const t=new $t("OnStep");return t.effect_instruction_i0=e,t},Mx=e=>Q(e,nt),nK=v(2,(e,t)=>Ha(e,{onFailure:n=>Pe(t.onFailure(n)),onSuccess:n=>Pe(t.onSuccess(n))})),Ha=v(2,(e,t)=>{const n=new $t(If);return n.effect_instruction_i0=e,n.effect_instruction_i1=t.onFailure,n.effect_instruction_i2=t.onSuccess,n}),_w=v(2,(e,t)=>Ha(e,{onFailure:n=>{if(xW(n).length>0)return mr($W(n));const s=NW(n);return s.length>0?t.onFailure(DN(s)):mr(n)},onSuccess:t.onSuccess})),Rs=v(2,(e,t)=>it(()=>{const n=Ze(e),r=jh(n.length);let s=0;return Nu(mw({while:()=>s<n.length,body:()=>t(n[s],s),step:i=>{r[s++]=i}}),r)})),op=v(2,(e,t)=>it(()=>{const n=Ze(e);let r=0;return mw({while:()=>r<n.length,body:()=>t(n[r],r),step:()=>{r++}})})),Lx=e=>{const t=new $t(mu);return t.effect_instruction_i0=oW(ac),t.effect_instruction_i1=()=>e,t},cn=v(2,(e,t)=>Q(e,n=>ee(()=>t(n)))),Ux=v(2,(e,t)=>_w(e,{onFailure:n=>$x(()=>t.onFailure(n)),onSuccess:n=>ee(()=>t.onSuccess(n))})),ap=v(2,(e,t)=>Ha(e,{onFailure:n=>{const r=OW(n);switch(r._tag){case"Left":return $x(()=>t(r.left));case"Right":return mr(r.right)}},onSuccess:Pe})),yw=v(2,(e,t)=>cp(n=>Ha(n(e),{onFailure:r=>{const s=Be(r);return Ha(t(s),{onFailure:i=>Be(Wn(r,i)),onSuccess:()=>s})},onSuccess:r=>{const s=tt(r);return lp(t(s),s)}}))),Px=v(2,(e,t)=>yw(e,Jx({onFailure:n=>hw(n)?xu(t(RW(n))):br,onSuccess:()=>br}))),Pe=e=>{const t=new Cx(pr);return t.effect_instruction_i0=e,t},it=e=>{const t=new $t(Uh);return t.commit=e,t},ee=e=>{const t=new $t(wI);return t.effect_instruction_i0=e,t},rK=v(e=>e.length===3||e.length===2&&!(_s(e[1])&&"onlyEffect"in e[1]),(e,t)=>Q(e,n=>{const r=typeof t=="function"?t(n):t;return ip(r)?Nu(r,n):qV(r)?Uf(s=>{r.then(i=>s(Pe(n)),i=>s(nn(new OK(i,"An unknown error occurred in Effect.tap"))))}):Pe(n)})),sK=e=>Bn(t=>{const n=t.getFiberRef(wy),r=$(n,ct(()=>t.scope()));return e(up(wy,te(r)))}),Fx=e=>{const t=new $t(mu);return t.effect_instruction_i0=mx(ac),t.effect_instruction_i1=()=>e,t},cp=e=>Ox(e,function(){const t=new $t(mu);return t.effect_instruction_i0=mx(ac),t.effect_instruction_i1=n=>_x(n)?zt(()=>this.effect_instruction_i0(Lx)):zt(()=>this.effect_instruction_i0(Fx)),t}),br=Pe(void 0),iK=e=>{const t=new $t(mu);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},mw=e=>{const t=new $t(Nf);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},bw=e=>{const t=new $t(Od);return typeof e?.priority<"u"?EK(t,e.priority):t},jx=v(2,(e,t)=>Q(e,n=>cn(t,r=>[n,r]))),Vx=v(2,(e,t)=>Q(e,n=>Nu(t,n))),lp=v(2,(e,t)=>Q(e,()=>t)),oK=e=>Q(eK,t=>$(e,zx(t))),zx=v(2,(e,t)=>Q(e.interruptAsFork(t),()=>e.await)),aK={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return X(this,arguments)}},cK={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return X(this,arguments)}},lK={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return X(this,arguments)}},qx={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return X(this,arguments)}},Hx={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return X(this,arguments)}},Wx={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return X(this,arguments)}},uK={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return X(this,arguments)}},dK={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return X(this,arguments)}},fK="effect/FiberRef",hK=Symbol.for(fK),pK={_A:e=>e},ww=e=>Bn(t=>tt(t.getFiberRef(e))),kw=v(2,(e,t)=>Q(ww(e),t)),q1=v(2,(e,t)=>gK(e,()=>[void 0,t])),gK=v(2,(e,t)=>Bn(n=>{const[r,s]=t(n.getFiberRef(e));return n.setFiberRef(e,s),Pe(r)})),up=v(3,(e,t,n)=>ZW(Vx(ww(t),q1(t,n)),()=>e,r=>q1(t,r))),_n=(e,t)=>dc(e,{differ:fx(),fork:t?.fork??nt,join:t?.join}),_K=e=>{const t=HH();return dc(e,{differ:t,fork:t.empty})},yK=e=>{const t=WH(fx());return dc(e,{differ:t,fork:t.empty})},Kx=e=>{const t=qH();return dc(e,{differ:t,fork:t.empty})},dc=(e,t)=>({...wu,[hK]:pK,initial:e,commit(){return ww(this)},diff:(r,s)=>t.differ.diff(r,s),combine:(r,s)=>t.differ.combine(r,s),patch:r=>s=>t.differ.patch(r,s),fork:t.fork,join:t.join??((r,s)=>s)}),mK=e=>dc(e,{differ:L1,fork:L1.empty}),Ru=ge(Symbol.for("effect/FiberRef/currentContext"),()=>Kx(Jb())),dp=ge(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>_n(0)),Yx=ge(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>_n(2048)),bK=ge(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>_n(lw())),wK=ge(Symbol.for("effect/FiberRef/currentLogLevel"),()=>_n(Hx)),kK=ge(Symbol.for("effect/FiberRef/currentLogSpan"),()=>_n(Ua())),EK=v(2,(e,t)=>up(e,dp,t)),TK=ge(Symbol.for("effect/FiberRef/currentConcurrency"),()=>_n("unbounded")),vK=ge(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>_n(!0)),SK=ge(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>_n(te(Wx))),AK=ge(Symbol.for("effect/FiberRef/versionMismatchErrorLogLevel"),()=>_n(te(qx))),by=ge(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>yK(xa())),wy=ge(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>_n(G(),{fork:()=>G(),join:(e,t)=>e})),sd=ge(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>_n(ja,{fork:()=>ja,join:(e,t)=>e})),IK=(e,t)=>e.addFinalizer(()=>xu(t)),NK=(e,t)=>e.close(t),fp=(e,t)=>e.fork(t),Ew=function(){class e extends globalThis.Error{commit(){return nn(this)}toJSON(){const n={...this};return this.message&&(n.message=this.message),this.cause&&(n.cause=this.cause),n}[Fe](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split(`
`).slice(1).join(`
`)}`:this.toString():"Bun"in globalThis?uc(Mf(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,p9),e}(),Gx=(e,t)=>{class n extends Ew{_tag=t}return Object.assign(n.prototype,e),n.prototype.name=t,n},H1=Symbol.for("effect/Cause/errors/RuntimeException"),xK=Gx({[H1]:H1},"RuntimeException"),RK=Symbol.for("effect/Cause/errors/InterruptedException"),CK=e=>re(e,RK),W1=Symbol.for("effect/Cause/errors/NoSuchElement"),Zx=Gx({[W1]:W1},"NoSuchElementException"),K1=Symbol.for("effect/Cause/errors/UnknownException"),OK=function(){class e extends Ew{_tag="UnknownException";error;constructor(n,r){super(r??"An unknown error occurred",{cause:n}),this.error=n}}return Object.assign(e.prototype,{[K1]:K1,name:"UnknownException"}),e}(),Tw=e=>ip(e)&&"_tag"in e&&(e._tag==="Success"||e._tag==="Failure"),BK=e=>e._tag==="Success",Y1=(e,t)=>LK(e,t?.parallel?rp:Wn),$K=e=>Be(qr(e)),G1=e=>Be(Mf(e)),Be=e=>{const t=new Rx(hr);return t.effect_instruction_i0=e,t},DK=e=>Be(Ss(e)),bg=v(2,(e,t)=>{switch(e._tag){case hr:return Be(e.effect_instruction_i0);case pr:return tt(t(e.effect_instruction_i0))}}),Jx=v(2,(e,{onFailure:t,onSuccess:n})=>{switch(e._tag){case hr:return t(e.effect_instruction_i0);case pr:return n(e.effect_instruction_i0)}}),tt=e=>{const t=new Cx(pr);return t.effect_instruction_i0=e,t},Oi=tt(void 0),MK=v(3,(e,t,{onFailure:n,onSuccess:r})=>{switch(e._tag){case hr:switch(t._tag){case pr:return Be(e.effect_instruction_i0);case hr:return Be(n(e.effect_instruction_i0,t.effect_instruction_i0))}case pr:switch(t._tag){case pr:return tt(r(e.effect_instruction_i0,t.effect_instruction_i0));case hr:return Be(t.effect_instruction_i0)}}}),LK=(e,t)=>{const n=$N(e);return Ba(n)?$(Ci(n),VI($($a(n),bg(On)),(r,s)=>$(r,MK(s,{onSuccess:(i,o)=>$(i,yr(o)),onFailure:t}))),bg(Oa),bg(r=>zi(r)),te):G()},UK=e=>({...wu,[qW]:HW,state:XN(WW([])),commit(){return Xx(this)},blockingOn:e}),Xx=e=>JW(t=>{const n=ep(e.state);switch(n._tag){case Nx:return t(n.effect);case sp:return n.joiners.push(t),PK(e,t)}},e.blockingOn),Qx=(e,t)=>{const n=ep(e.state);if(n._tag===sp){QN(e.state,KW(t));for(let r=0,s=n.joiners.length;r<s;r++)n.joiners[r](t)}},PK=(e,t)=>ee(()=>{const n=ep(e.state);if(n._tag===sp){const r=n.joiners.indexOf(t);r>=0&&n.joiners.splice(r,1)}}),FK=Bn(e=>tt(e.currentContext)),jK=()=>FK,Cu=e=>Q(jK(),e),VK=v(2,(e,t)=>up(Ru,t)(e)),zK=v(2,(e,t)=>Cu(n=>VK(e,t(n)))),vw=e=>{const t=e.currentSpan;return t!==void 0&&t._tag==="Span"?te(t):G()},qK=BK,Z1=Symbol.for("effect/MutableHashMap"),HK={[Z1]:Z1,[Symbol.iterator](){return new Sw(this)},toString(){return wt(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(at)}},[Fe](){return this.toJSON()},pipe(){return X(this,arguments)}};class Sw{self;referentialIterator;bucketIterator;constructor(t){this.self=t,this.referentialIterator=t.referential[Symbol.iterator]()}next(){if(this.bucketIterator!==void 0)return this.bucketIterator.next();const t=this.referentialIterator.next();return t.done?(this.bucketIterator=new WK(this.self.buckets.values()),this.next()):t}[Symbol.iterator](){return new Sw(this.self)}}class WK{backing;constructor(t){this.backing=t}currentBucket;next(){if(this.currentBucket===void 0){const n=this.backing.next();if(n.done)return n;this.currentBucket=n.value[Symbol.iterator]()}const t=this.currentBucket.next();return t.done?(this.currentBucket=void 0,this.next()):t}}const KK=()=>{const e=Object.create(HK);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},bi=v(2,(e,t)=>{if(Sf(t)===!1)return e.referential.has(t)?te(e.referential.get(t)):G();const n=t[ae](),r=e.buckets.get(n);return r===void 0?G():YK(e,r,t)}),YK=(e,t,n,r=!1)=>{for(let s=0,i=t.length;s<i;s++)if(n[ie](t[s][0])){const o=t[s][1];return r&&(t.splice(s,1),e.bucketsSize--),te(o)}return G()},Ec=v(2,(e,t)=>kt(bi(e,t))),Tc=v(3,(e,t,n)=>{if(Sf(t)===!1)return e.referential.set(t,n),e;const r=t[ae](),s=e.buckets.get(r);return s===void 0?(e.buckets.set(r,[[t,n]]),e.bucketsSize++,e):(GK(e,s,t),s.push([t,n]),e.bucketsSize++,e)}),GK=(e,t,n)=>{for(let r=0,s=t.length;r<s;r++)if(n[ie](t[r][0])){t.splice(r,1),e.bucketsSize--;return}},ZK="effect/Clock",J1=Symbol.for(ZK),Aw=ko("effect/Clock"),JK=2**31-1,X1={unsafeSchedule(e,t){const n=oy(t);if(n>JK)return W_;let r=!1;const s=setTimeout(()=>{r=!0,e()},n);return()=>(clearTimeout(s),!r)}},Q1=function(){const e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t;return()=>(t===void 0&&(t=BigInt(Date.now())*e-BigInt(Math.round(performance.now()*1e6))),t+BigInt(Math.round(performance.now()*1e6)))}(),XK=function(){const e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return Q1;const t=Q1()-e.bigint();return()=>t+e.bigint()}();class QK{[J1]=J1;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return XK()}currentTimeMillis=ee(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=ee(()=>this.unsafeCurrentTimeNanos());scheduler(){return Pe(X1)}sleep(t){return Kl(n=>{const r=X1.unsafeSchedule(()=>n(br),t);return xu(ee(r))})}}const eY=()=>new QK,eR="And",tR="Or",nR="InvalidData",rR="MissingData",sR="SourceUnavailable",iR="Unsupported",tY="effect/ConfigError",eE=Symbol.for(tY),fc={_tag:"ConfigError",[eE]:eE},oR=(e,t)=>{const n=Object.create(fc);return n._op=eR,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(n,"message",{enumerable:!1,get(){return this.toString()}}),n},aR=(e,t)=>{const n=Object.create(fc);return n._op=tR,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(n,"message",{enumerable:!1,get(){return this.toString()}}),n},nY=(e,t,n={pathDelim:"."})=>{const r=Object.create(fc);return r._op=nR,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Invalid data at ${$(this.path,rc(n.pathDelim))}: "${this.message}")`}}),r},oo=(e,t,n={pathDelim:"."})=>{const r=Object.create(fc);return r._op=rR,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Missing data at ${$(this.path,rc(n.pathDelim))}: "${this.message}")`}}),r},rY=(e,t,n,r={pathDelim:"."})=>{const s=Object.create(fc);return s._op=sR,s.path=e,s.message=t,s.cause=n,Object.defineProperty(s,"toString",{enumerable:!1,value(){return`(Source unavailable at ${$(this.path,rc(r.pathDelim))}: "${this.message}")`}}),s},sY=(e,t,n={pathDelim:"."})=>{const r=Object.create(fc);return r._op=iR,r.path=e,r.message=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${$(this.path,rc(n.pathDelim))}: "${this.message}")`}}),r},Bi=v(2,(e,t)=>{switch(e._op){case eR:return oR(Bi(e.left,t),Bi(e.right,t));case tR:return aR(Bi(e.left,t),Bi(e.right,t));case nR:return nY([...t,...e.path],e.message);case rR:return oo([...t,...e.path],e.message);case sR:return rY([...t,...e.path],e.message,e.cause);case iR:return sY([...t,...e.path],e.message)}}),iY={_tag:"Empty"},wg=v(2,(e,t)=>{let n=uw(t),r=e;for(;Xq(n);){const s=n.head;switch(s._tag){case"Empty":{n=n.tail;break}case"AndThen":{n=so(s.first,so(s.second,n.tail));break}case"MapName":{r=Jo(r,s.f),n=n.tail;break}case"Nested":{r=xf(r,s.name),n=n.tail;break}case"Unnested":{if($(pl(r),D9(s.name)))r=to(r),n=n.tail;else return oe(oo(r,`Expected ${s.name} to be in path in ConfigProvider#unnested`));break}}}return be(r)}),oY="Constant",aY="Fail",cY="Fallback",lY="Described",uY="Lazy",dY="MapOrFail",fY="Nested",hY="Primitive",pY="Sequence",gY="HashMap",_Y="ZipWith";var tE={};const Ff=(e,t)=>[...e,...t],yY="effect/ConfigProvider",nE=Symbol.for(yY),mY=ko("effect/ConfigProvider"),bY="effect/ConfigProviderFlat",rE=Symbol.for(bY),wY=e=>({[nE]:nE,pipe(){return X(this,arguments)},...e}),kY=e=>({[rE]:rE,patch:e.patch,load:(t,n,r=!0)=>e.load(t,n,r),enumerateChildren:e.enumerateChildren}),EY=e=>wY({load:t=>Q(Un(e,xa(),t,!1),n=>Zn(pl(n),{onNone:()=>nn(oo(xa(),`Expected a single value having structure: ${t}`)),onSome:Pe})),flattened:e}),TY=e=>{const{pathDelim:t,seqDelim:n}=Object.assign({},{pathDelim:"_",seqDelim:","},e),r=c=>$(c,rc(t)),s=c=>c.split(t),i=()=>typeof process<"u"&&"env"in process&&typeof tE=="object"?tE:{};return EY(kY({load:(c,l,u=!0)=>{const d=r(c),f=i(),h=d in f?te(f[d]):G();return $(h,ap(()=>oo(c,`Expected ${d} to exist in the process context`)),Q(p=>NY(p,c,l,n,u)))},enumerateChildren:c=>ee(()=>{const l=i(),f=Object.keys(l).map(h=>s(h.toUpperCase())).filter(h=>{for(let p=0;p<c.length;p++){const _=$(c,PI(p)),g=h[p];if(g===void 0||_!==g)return!1}return!0}).flatMap(h=>h.slice(c.length,c.length+1));return Bq(f)}),patch:iY}))},vY=(e,t,n,r)=>{const s=m1(n.length,c=>c>=r.length?G():te([e(c),c+1])),i=m1(r.length,c=>c>=n.length?G():te([t(c),c+1])),o=Ff(n,s),a=Ff(r,i);return[o,a]},SY=(e,t)=>{let n=t;if(n._tag==="Nested"){const r=e.slice();for(;n._tag==="Nested";)r.push(n.name),n=n.config;return r}return e},Un=(e,t,n,r)=>{const s=n;switch(s._tag){case oY:return Pe(sr(s.value));case lY:return it(()=>Un(e,t,s.config,r));case aY:return nn(oo(t,s.message));case cY:return $(it(()=>Un(e,t,s.first,r)),my(i=>s.condition(i)?$(Un(e,t,s.second,r),my(o=>nn(aR(i,o)))):nn(i)));case uY:return it(()=>Un(e,t,s.config(),r));case dY:return it(()=>$(Un(e,t,s.original,r),Q(Rs(i=>$(s.mapOrFail(i),ap(Bi(SY(t,s.original))))))));case fY:return it(()=>Un(e,Ff(t,sr(s.name)),s.config,r));case hY:return $(wg(t,e.patch),Q(i=>$(e.load(i,s,r),Q(o=>{if(o.length===0){const a=$(K9(i),ct(()=>"<n/a>"));return nn(oo([],`Expected ${s.description} with name ${a}`))}return Pe(o)}))));case pY:return $(wg(t,e.patch),Q(i=>$(e.enumerateChildren(i),Q(RY),Q(o=>o.length===0?it(()=>cn(Un(e,t,s.config,!0),sr)):$(Rs(o,a=>Un(e,j9(t,`[${a}]`),s.config,!0)),cn(a=>{const c=n7(a);return c.length===0?sr(xa()):sr(c)}))))));case gY:return it(()=>$(wg(t,e.patch),Q(i=>$(e.enumerateChildren(i),Q(o=>$(o,Rs(a=>Un(e,Ff(i,sr(a)),s.valueConfig,r)),cn(a=>a.length===0?sr(lw()):$(xY(a),Jo(c=>zq(y1(Ze(o),c)))))))))));case _Y:return it(()=>$(Un(e,t,s.left,r),Pf,Q(i=>$(Un(e,t,s.right,r),Pf,Q(o=>{if(At(i)&&At(o))return nn(oR(i.left,o.left));if(At(i)&&as(o))return nn(i.left);if(as(i)&&At(o))return nn(o.left);if(as(i)&&as(o)){const a=$(t,rc(".")),c=AY(t,a),[l,u]=vY(c,c,$(i.right,Jo(be)),$(o.right,Jo(be)));return $(l,y1(u),Rs(([d,f])=>$(jx(d,f),cn(([h,p])=>s.zip(h,p)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},AY=(e,t)=>n=>oe(oo(e,`The element at index ${n} in a sequence at path "${t}" was missing`)),IY=(e,t)=>e.split(new RegExp(`\\s*${Rf(t)}\\s*`)),NY=(e,t,n,r,s)=>s?$(IY(e,r),Rs(i=>n.parse(i.trim())),ap(Bi(t))):$(n.parse(e),Ux({onFailure:Bi(t),onSuccess:sr})),xY=e=>Object.keys(e[0]).map(t=>e.map(n=>n[t])),RY=e=>$(Rs(e,OY),Ux({onFailure:()=>xa(),onSuccess:Fl(Ra)}),Pf,cn(A9)),CY=/^(\[(\d+)\])$/,OY=e=>{const t=e.match(CY);if(t!==null){const n=t[2];return $(n!==void 0&&n.length>0?te(n):G(),Fh(BY))}return G()},BY=e=>{const t=Number.parseInt(e);return Number.isNaN(t)?G():te(t)},sE=Symbol.for("effect/Console"),cR=ko("effect/Console"),$Y={[sE]:sE,assert(e,...t){return ee(()=>{console.assert(e,...t)})},clear:ee(()=>{console.clear()}),count(e){return ee(()=>{console.count(e)})},countReset(e){return ee(()=>{console.countReset(e)})},debug(...e){return ee(()=>{console.debug(...e)})},dir(e,t){return ee(()=>{console.dir(e,t)})},dirxml(...e){return ee(()=>{console.dirxml(...e)})},error(...e){return ee(()=>{console.error(...e)})},group(e){return e?.collapsed?ee(()=>console.groupCollapsed(e?.label)):ee(()=>console.group(e?.label))},groupEnd:ee(()=>{console.groupEnd()}),info(...e){return ee(()=>{console.info(...e)})},log(...e){return ee(()=>{console.log(...e)})},table(e,t){return ee(()=>{console.table(e,t)})},time(e){return ee(()=>console.time(e))},timeEnd(e){return ee(()=>console.timeEnd(e))},timeLog(e,...t){return ee(()=>{console.timeLog(e,...t)})},trace(...e){return ee(()=>{console.trace(...e)})},warn(...e){return ee(()=>{console.warn(...e)})},unsafe:console},DY="effect/Random",iE=Symbol.for(DY),MY=ko("effect/Random");class LY{seed;[iE]=iE;PRNG;constructor(t){this.seed=t,this.PRNG=new JV(t)}get next(){return ee(()=>this.PRNG.number())}get nextBoolean(){return cn(this.next,t=>t>.5)}get nextInt(){return ee(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,n){return cn(this.next,r=>(n-t)*r+t)}nextIntBetween(t,n){return ee(()=>this.PRNG.integer(n-t)+t)}shuffle(t){return UY(t,n=>this.nextIntBetween(0,n))}}const UY=(e,t)=>it(()=>$(ee(()=>Array.from(e)),Q(n=>{const r=[];for(let s=n.length;s>=2;s=s-1)r.push(s);return $(r,op(s=>$(t(s),cn(i=>PY(n,s-1,i)))),Nu($N(n)))}))),PY=(e,t,n)=>{const r=e[t];return e[t]=e[n],e[n]=r,e},FY=e=>new LY(K(e)),oE=Symbol.for("effect/Tracer"),jY=e=>({[oE]:oE,...e}),lR=ko("effect/Tracer"),uR=ko("effect/ParentSpan"),aE=function(){const e="abcdef0123456789",t=e.length;return function(n){let r="";for(let s=0;s<n;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}}();class VY{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(t,n,r,s,i,o){this.name=t,this.parent=n,this.context=r,this.startTime=i,this.kind=o,this.status={_tag:"Started",startTime:i},this.attributes=new Map,this.traceId=n._tag==="Some"?n.value.traceId:aE(32),this.spanId=aE(16),this.links=Array.from(s)}end(t,n){this.status={_tag:"Ended",endTime:t,exit:n,startTime:this.status.startTime}}attribute(t,n){this.attributes.set(t,n)}event(t,n,r){this.events.push([t,n,r??{}])}addLinks(t){this.links.push(...t)}}const zY=jY({span:(e,t,n,r,s,i)=>new VY(e,t,n,r,s,i),context:e=>e()}),qY=$(Jb(),kc(Aw,eY()),kc(cR,$Y),kc(MY,FY(Math.random())),kc(mY,TY()),kc(lR,zY)),jf=ge(Symbol.for("effect/DefaultServices/currentServices"),()=>Kx(qY));function HY(e){return new Ks(e)}function WY(){return HY(new Map)}const cE=Symbol.for("effect/FiberRefs");class Ks{locals;[cE]=cE;constructor(t){this.locals=t}pipe(){return X(this,arguments)}}const KY=(e,t,n,r=!1)=>{const s=e;let i=t,o=n,a=r,c;for(;c===void 0;)if(Je(i)&&Je(o)){const l=Kt(i)[0],u=to(i),d=Kt(o)[0],f=Kt(o)[1],h=to(o);l.startTimeMillis<d.startTimeMillis?(o=h,a=!0):l.startTimeMillis>d.startTimeMillis?i=u:l.id<d.id?(o=h,a=!0):l.id>d.id?i=u:c=[f,a]}else c=[s.initial,!0];return c},YY=v(3,(e,t,n)=>{const r=new Map(e.locals);return n.locals.forEach((s,i)=>{const o=s[0][1];if(!s[0][0][ie](t)){if(!r.has(i)){if(ne(o,i.initial))return;r.set(i,[[t,i.join(i.initial,o)]]);return}const a=r.get(i),[c,l]=KY(i,a,s);if(l){const u=i.diff(c,o),d=a[0][1],f=i.join(d,i.patch(u)(d));if(!ne(d,f)){let h;const p=a[0][0];p[ie](t)?h=[[p,f],...a.slice(1)]:h=[[t,f],...a],r.set(i,h)}}}}),new Ks(r)}),GY=v(2,(e,t)=>{const n=new Map;return dR(e,n,t),new Ks(n)}),dR=(e,t,n)=>{e.locals.forEach((r,s)=>{const i=r[0][1],o=s.patch(s.fork)(i);ne(i,o)?t.set(s,r):t.set(s,[[n,o],...r])})},fR=v(2,(e,t)=>{const n=new Map(e.locals);return n.delete(t),new Ks(n)}),ZY=v(2,(e,t)=>e.locals.has(t)?te(Kt(e.locals.get(t))[1]):G()),Yl=v(2,(e,t)=>$(ZY(e,t),ct(()=>t.initial))),ky=v(2,(e,{fiberId:t,fiberRef:n,value:r})=>{if(e.locals.size===0)return new Ks(new Map([[n,[[t,r]]]]));const s=new Map(e.locals);return Ey(s,t,n,r),new Ks(s)}),Ey=(e,t,n,r)=>{const s=e.get(n)??[];let i;if(Je(s)){const[o,a]=Kt(s);if(o[ie](t)){if(ne(a,r))return;i=[[t,r],...s.slice(1)]}else i=[[t,r],...s]}else i=[[t,r]];e.set(n,i)},JY=v(2,(e,{entries:t,forkAs:n})=>{if(e.locals.size===0)return new Ks(new Map(t));const r=new Map(e.locals);return n!==void 0&&dR(e,r,n),t.forEach(([s,i])=>{i.length===1?Ey(r,i[0][0],s,i[0][1]):i.forEach(([o,a])=>{Ey(r,o,s,a)})}),new Ks(r)}),XY=Yl,QY=JY,eG=WY,tG=aK,nG=cK,rG=lK,sG=qx,iG=Hx,oG=Wx,aG=uK,cG=dK,lG=$(Ra,DI(e=>e.ordinal)),uG=x9(lG),dG=e=>{switch(e){case"All":return tG;case"Debug":return oG;case"Error":return rG;case"Fatal":return nG;case"Info":return iG;case"Trace":return aG;case"None":return cG;case"Warning":return sG}},hR=e=>e.replace(/[\s="]/g,"_"),fG=e=>t=>`${hR(t.label)}=${e-t.startTime}ms`,hG=bu,pG=g9;class gG extends pG{}const pR="Empty",gR="Add",_R="Remove",yR="Update",mR="AndThen",_G={_tag:pR},yG=(e,t)=>{const n=new Map(e.locals);let r=_G;for(const[s,i]of t.locals.entries()){const o=Kt(i)[1],a=n.get(s);if(a!==void 0){const c=Kt(a)[1];ne(c,o)||(r=kg({_tag:yR,fiberRef:s,patch:s.diff(c,o)})(r))}else r=kg({_tag:gR,fiberRef:s,value:o})(r);n.delete(s)}for(const[s]of n.entries())r=kg({_tag:_R,fiberRef:s})(r);return r},kg=v(2,(e,t)=>({_tag:mR,first:e,second:t})),mG=v(3,(e,t,n)=>{let r=n,s=sr(e);for(;Je(s);){const i=Kt(s),o=to(s);switch(i._tag){case pR:{s=o;break}case gR:{r=ky(r,{fiberId:t,fiberRef:i.fiberRef,value:i.value}),s=o;break}case _R:{r=fR(r,i.fiberRef),s=o;break}case yR:{const a=Yl(r,i.fiberRef);r=ky(r,{fiberId:t,fiberRef:i.fiberRef,value:i.fiberRef.patch(i.patch)(a)}),s=o;break}case mR:{s=xf(i.first)(xf(i.second)(o));break}}}return r}),bR="effect/MetricLabel",Ty=Symbol.for(bR);class bG{key;value;[Ty]=Ty;_hash;constructor(t,n){this.key=t,this.value=n,this._hash=et(bR+this.key+this.value)}[ae](){return this._hash}[ie](t){return kG(t)&&this.key===t.key&&this.value===t.value}pipe(){return X(this,arguments)}}const wG=(e,t)=>new bG(e,t),kG=e=>re(e,Ty),EG="Sequential",TG="Parallel",vG="ParallelN",wR={_tag:EG},SG={_tag:TG},AG=e=>({_tag:vG,parallelism:e}),vy=wR,Sy=SG,Ay=AG,IG=yG,NG=mG,hp="effect/FiberStatus",ao=Symbol.for(hp),Vf="Done",lE="Running",uE="Suspended",xG=et(`${hp}-${Vf}`);class RG{[ao]=ao;_tag=Vf;[ae](){return xG}[ie](t){return Iw(t)&&t._tag===Vf}}class CG{runtimeFlags;[ao]=ao;_tag=lE;constructor(t){this.runtimeFlags=t}[ae](){return $(K(hp),_e(K(this._tag)),_e(K(this.runtimeFlags)),Ve(this))}[ie](t){return Iw(t)&&t._tag===lE&&this.runtimeFlags===t.runtimeFlags}}class OG{runtimeFlags;blockingOn;[ao]=ao;_tag=uE;constructor(t,n){this.runtimeFlags=t,this.blockingOn=n}[ae](){return $(K(hp),_e(K(this._tag)),_e(K(this.runtimeFlags)),_e(K(this.blockingOn)),Ve(this))}[ie](t){return Iw(t)&&t._tag===uE&&this.runtimeFlags===t.runtimeFlags&&ne(this.blockingOn,t.blockingOn)}}const BG=new RG,$G=e=>new CG(e),DG=(e,t)=>new OG(e,t),Iw=e=>re(e,ao),MG=e=>e._tag===Vf,LG=BG,kR=$G,UG=DG,PG=MG,FG=Symbol.for("effect/Micro"),zf=Symbol.for("effect/Micro/MicroExit"),dE=Symbol.for("effect/Micro/MicroCause"),jG={_E:nt};class ER extends globalThis.Error{_tag;traces;[dE];constructor(t,n,r){const s=`MicroCause.${t}`;let i,o,a;if(n instanceof globalThis.Error){i=`(${s}) ${n.name}`,o=n.message;const c=o.split(`
`).length;a=n.stack?`(${s}) ${n.stack.split(`
`).slice(0,c+3).join(`
`)}`:`${i}: ${o}`}else i=s,o=Ia(n,0),a=`${i}: ${o}`;r.length>0&&(a+=`
    ${r.join(`
    `)}`),super(o),this._tag=t,this.traces=r,this[dE]=jG,this.name=i,this.stack=a}pipe(){return X(this,arguments)}toString(){return this.stack}[Fe](){return this.stack}}class VG extends ER{defect;constructor(t,n=[]){super("Die",t,n),this.defect=t}}const zG=(e,t=[])=>new VG(e,t);class qG extends ER{constructor(t=[]){super("Interrupt","interrupted",t)}}const HG=(e=[])=>new qG(e),WG=e=>e._tag==="Interrupt",fE=Symbol.for("effect/Micro/MicroFiber"),KG={_A:nt,_E:nt};class YG{context;interruptible;[fE];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(t,n=!0){this.context=t,this.interruptible=n,this[fE]=KG}getRef(t){return wz(this.context,t)}addObserver(t){return this._exit?(t(this._exit),$V):(this._observers.push(t),()=>{const n=this._observers.indexOf(t);n>=0&&this._observers.splice(n,1)})}_interrupted=!1;unsafeInterrupt(){this._exit||(this._interrupted=!0,this.interruptible&&this.evaluate(Ow))}unsafePoll(){return this._exit}evaluate(t){if(this._exit)return;if(this._yielded!==void 0){const s=this._yielded;this._yielded=void 0,s()}const n=this.runLoop(t);if(n===id)return;const r=hE.interruptChildren&&hE.interruptChildren(this);if(r!==void 0)return this.evaluate(Hf(r,()=>n));this._exit=n;for(let s=0;s<this._observers.length;s++)this._observers[s](n);this._observers.length=0}runLoop(t){let n=!1,r=t;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!n&&this.getRef(Bw).shouldYield(this)){n=!0;const s=r;r=Hf(QG,()=>s)}if(r=r[Iy](this),r===id){const s=this._yielded;return zf in s?(this._yielded=void 0,s):id}}}catch(s){return re(r,Iy)?Ny(s):Ny(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`)}}getCont(t){for(;;){const n=this._stack.pop();if(!n)return;const r=n[qf]&&n[qf](this);if(r)return{[t]:r};if(n[t])return n}}_yielded=void 0;yieldWith(t){return this._yielded=t,id}children(){return this._children??=new Set}}const hE=ge("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),TR=Symbol.for("effect/Micro/identifier"),ot=Symbol.for("effect/Micro/args"),Iy=Symbol.for("effect/Micro/evaluate"),Wa=Symbol.for("effect/Micro/successCont"),ea=Symbol.for("effect/Micro/failureCont"),qf=Symbol.for("effect/Micro/ensureCont"),id=Symbol.for("effect/Micro/Yield"),GG={_A:nt,_E:nt,_R:nt},ZG={...hG,_op:"Micro",[FG]:GG,pipe(){return X(this,arguments)},[Symbol.iterator](){return new pI(new _u(this))},toJSON(){return{_id:"Micro",op:this[TR],...ot in this?{args:this[ot]}:void 0}},toString(){return wt(this)},[Fe](){return wt(this)}};function JG(e){return Ny("Micro.evaluate: Not implemented")}const pp=e=>({...ZG,[TR]:e.op,[Iy]:e.eval??JG,[Wa]:e.contA,[ea]:e.contE,[qf]:e.ensure}),Nw=e=>{const t=pp(e);return function(){const n=Object.create(t);return n[ot]=e.single===!1?arguments:arguments[0],n}},vR=e=>{const t={...pp(e),[zf]:zf,_tag:e.op,get[e.prop](){return this[ot]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[ot]}},[ie](n){return nZ(n)&&n._tag===e.op&&ne(this[ot],n[ot])},[ae](){return Ve(this,_e(et(e.op))(K(this[ot])))}};return function(n){const r=Object.create(t);return r[ot]=n,r[Wa]=void 0,r[ea]=void 0,r[qf]=void 0,r}},xw=vR({op:"Success",prop:"value",eval(e){const t=e.getCont(Wa);return t?t[Wa](this[ot],e):e.yieldWith(this)}}),SR=vR({op:"Failure",prop:"cause",eval(e){let t=e.getCont(ea);for(;WG(this[ot])&&t&&e.interruptible;)t=e.getCont(ea);return t?t[ea](this[ot],e):e.yieldWith(this)}}),XG=Nw({op:"Yield",eval(e){let t=!1;return e.getRef(Bw).scheduleTask(()=>{t||e.evaluate(rZ)},this[ot]??0),e.yieldWith(()=>{t=!0})}}),QG=XG(0),eZ=xw(void 0),Rw=Nw({op:"WithMicroFiber",eval(e){return this[ot](e)}}),Hf=v(2,(e,t)=>{const n=Object.create(tZ);return n[ot]=e,n[Wa]=t,n}),tZ=pp({op:"OnSuccess",eval(e){return e._stack.push(this),this[ot]}}),nZ=e=>re(e,zf),AR=xw,Cw=SR,Ow=Cw(HG()),Ny=e=>Cw(zG(e)),rZ=AR(void 0),sZ="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class IR{tasks=[];running=!1;scheduleTask(t,n){this.tasks.push(t),this.running||(this.running=!0,sZ(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){const t=this.tasks;this.tasks=[];for(let n=0,r=t.length;n<r;n++)t[n]()}shouldYield(t){return t.currentOpCount>=t.getRef(aZ)}flush(){for(;this.tasks.length>0;)this.runTasks()}}const iZ=v(2,(e,t)=>Rw(n=>{const r=n.context;return n.context=t(r),uZ(e,()=>(n.context=r,eZ))})),oZ=v(2,(e,t)=>iZ(e,xN(t)));class aZ extends RN()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class Bw extends RN()("effect/Micro/currentScheduler",{defaultValue:()=>new IR}){}const cZ=v(2,(e,t)=>{const n=Object.create(lZ);return n[ot]=e,n[Wa]=t.onSuccess,n[ea]=t.onFailure,n}),lZ=pp({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[ot]}}),uZ=v(2,(e,t)=>fZ(n=>cZ(n(e),{onFailure:r=>Hf(t(Cw(r)),()=>SR(r)),onSuccess:r=>Hf(t(AR(r)),()=>xw(r))}))),NR=Nw({op:"SetInterruptible",ensure(e){if(e.interruptible=this[ot],e._interrupted&&e.interruptible)return()=>Ow}}),dZ=e=>Rw(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(NR(!1)),t._interrupted?Ow:e)),fZ=e=>Rw(t=>t.interruptible?(t.interruptible=!1,t._stack.push(NR(!0)),e(dZ)):e(nt)),hZ=(e,t)=>{const n=new YG(Bw.context(new IR));return n.evaluate(e),n};class xR{buckets=[];scheduleTask(t,n){const r=this.buckets.length;let s,i=0;for(;i<r&&this.buckets[i][0]<=n;i++)s=this.buckets[i];s&&s[0]===n?s[1].push(t):i===r?this.buckets.push([n,[t]]):this.buckets.splice(i,0,[n,[t]])}}class pZ{maxNextTickBeforeTimer;running=!1;tasks=new xR;constructor(t){this.maxNextTickBeforeTimer=t}starveInternal(t){const n=this.tasks.buckets;this.tasks.buckets=[];for(const[r,s]of n)for(let i=0;i<s.length;i++)s[i]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}shouldYield(t){return t.currentOpCount>t.getFiberRef(Yx)?t.getFiberRef(dp):!1}scheduleTask(t,n){this.tasks.scheduleTask(t,n),this.running||(this.running=!0,this.starve())}}const RR=ge(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new pZ(2048));class CR{tasks=new xR;deferred=!1;scheduleTask(t,n){this.deferred?RR.scheduleTask(t,n):this.tasks.scheduleTask(t,n)}shouldYield(t){return t.currentOpCount>t.getFiberRef(Yx)?t.getFiberRef(dp):!1}flush(){for(;this.tasks.buckets.length>0;){const t=this.tasks.buckets;this.tasks.buckets=[];for(const[n,r]of t)for(let s=0;s<r.length;s++)r[s]()}this.deferred=!0}}const OR=ge(Symbol.for("effect/FiberRef/currentScheduler"),()=>_n(RR)),BR=ge(Symbol.for("effect/FiberRef/currentRequestMap"),()=>_n(new Map)),pE=(e,t,n,r)=>{switch(e){case void 0:return t();case"unbounded":return n();case"inherit":return kw(TK,s=>s==="unbounded"?n():s>1?r(s):t());default:return e>1?r(e):t()}},$w="InterruptSignal",Dw="Stateful",Mw="Resume",Lw="YieldNow",Eg=e=>({_tag:$w,cause:e}),Pd=e=>({_tag:Dw,onFiber:e}),Co=e=>({_tag:Mw,effect:e}),gZ=()=>({_tag:Lw}),_Z="effect/FiberScope",Wf=Symbol.for(_Z);class yZ{[Wf]=Wf;fiberId=La;roots=new Set;add(t,n){this.roots.add(n),n.addObserver(()=>{this.roots.delete(n)})}}class mZ{fiberId;parent;[Wf]=Wf;constructor(t,n){this.fiberId=t,this.parent=n}add(t,n){this.parent.tell(Pd(r=>{r.addChild(n),n.addObserver(()=>{r.removeChild(n)})}))}}const bZ=e=>new mZ(e.id(),e),Uw=ge(Symbol.for("effect/FiberScope/Global"),()=>new yZ),wZ="effect/Fiber",kZ=Symbol.for(wZ),EZ={_E:e=>e,_A:e=>e},TZ="effect/Fiber",vZ=Symbol.for(TZ),$R=e=>Vx(Mx(e.await),e.inheritAll);({...wu});const ei="effect/FiberCurrent",SZ="effect/Logger",AZ=Symbol.for(SZ),IZ={_Message:e=>e,_Output:e=>e},Pw=e=>({[AZ]:IZ,log:e,pipe(){return X(this,arguments)}}),NZ=/^[^\s"=]*$/,xZ=(e,t)=>({annotations:n,cause:r,date:s,fiberId:i,logLevel:o,message:a,spans:c})=>{const l=p=>p.match(NZ)?p:e(p),u=(p,_)=>`${hR(p)}=${l(_)}`,d=(p,_)=>" "+u(p,_);let f=u("timestamp",s.toISOString());f+=d("level",o.label),f+=d("fiber",tx(i));const h=P9(a);for(let p=0;p<h.length;p++)f+=d("message",Ia(h[p],t));vW(r)||(f+=d("cause",uc(r,{renderErrorCause:!0})));for(const p of c)f+=" "+fG(s.getTime())(p);for(const[p,_]of n)f+=d(p,Ia(_,t));return f},RZ=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,CZ=Pw(xZ(RZ)),OZ=typeof process=="object"&&process!==null&&typeof process.stdout=="object"&&process.stdout!==null;OZ&&process.stdout.isTTY;const DR="effect/MetricBoundaries",xy=Symbol.for(DR);class BZ{values;[xy]=xy;constructor(t){this.values=t,this._hash=$(et(DR),_e(yu(this.values)))}_hash;[ae](){return this._hash}[ie](t){return $Z(t)&&ne(this.values,t.values)}pipe(){return X(this,arguments)}}const $Z=e=>re(e,xy),DZ=e=>{const t=$(e,LI(On(Number.POSITIVE_INFINITY)),s7);return new BZ(t)},MZ=e=>$(U9(e.count-1,t=>e.start*Math.pow(e.factor,t)),Kh,DZ),LZ="effect/MetricKeyType",MR=Symbol.for(LZ),LR="effect/MetricKeyType/Counter",Ry=Symbol.for(LR),UZ="effect/MetricKeyType/Frequency",PZ=Symbol.for(UZ),FZ="effect/MetricKeyType/Gauge",jZ=Symbol.for(FZ),UR="effect/MetricKeyType/Histogram",Cy=Symbol.for(UR),VZ="effect/MetricKeyType/Summary",zZ=Symbol.for(VZ),PR={_In:e=>e,_Out:e=>e};class qZ{incremental;bigint;[MR]=PR;[Ry]=Ry;constructor(t,n){this.incremental=t,this.bigint=n,this._hash=et(LR)}_hash;[ae](){return this._hash}[ie](t){return FR(t)}pipe(){return X(this,arguments)}}class HZ{boundaries;[MR]=PR;[Cy]=Cy;constructor(t){this.boundaries=t,this._hash=$(et(UR),_e(K(this.boundaries)))}_hash;[ae](){return this._hash}[ie](t){return jR(t)&&ne(this.boundaries,t.boundaries)}pipe(){return X(this,arguments)}}const WZ=e=>new qZ(e?.incremental??!1,e?.bigint??!1),KZ=e=>new HZ(e),FR=e=>re(e,Ry),YZ=e=>re(e,PZ),GZ=e=>re(e,jZ),jR=e=>re(e,Cy),ZZ=e=>re(e,zZ),JZ="effect/MetricKey",VR=Symbol.for(JZ),XZ={_Type:e=>e},QZ=Vh(ne);class Fw{name;keyType;description;tags;[VR]=XZ;constructor(t,n,r,s=[]){this.name=t,this.keyType=n,this.description=r,this.tags=s,this._hash=$(et(this.name+this.description),_e(K(this.keyType)),_e(yu(this.tags)))}_hash;[ae](){return this._hash}[ie](t){return eJ(t)&&this.name===t.name&&ne(this.keyType,t.keyType)&&ne(this.description,t.description)&&QZ(this.tags,t.tags)}pipe(){return X(this,arguments)}}const eJ=e=>re(e,VR),tJ=(e,t)=>new Fw(e,WZ(t),Ph(t?.description)),nJ=(e,t,n)=>new Fw(e,KZ(t),Ph(n)),rJ=v(2,(e,t)=>t.length===0?e:new Fw(e.name,e.keyType,e.description,$d(e.tags,t))),sJ="effect/MetricState",Ou=Symbol.for(sJ),zR="effect/MetricState/Counter",Oy=Symbol.for(zR),qR="effect/MetricState/Frequency",By=Symbol.for(qR),HR="effect/MetricState/Gauge",$y=Symbol.for(HR),WR="effect/MetricState/Histogram",Dy=Symbol.for(WR),KR="effect/MetricState/Summary",My=Symbol.for(KR),Bu={_A:e=>e};class iJ{count;[Ou]=Bu;[Oy]=Oy;constructor(t){this.count=t}[ae](){return $(K(zR),_e(K(this.count)),Ve(this))}[ie](t){return _J(t)&&this.count===t.count}pipe(){return X(this,arguments)}}const oJ=Vh(ne);class aJ{occurrences;[Ou]=Bu;[By]=By;constructor(t){this.occurrences=t}_hash;[ae](){return $(et(qR),_e(yu(Ze(this.occurrences.entries()))),Ve(this))}[ie](t){return yJ(t)&&oJ(Ze(this.occurrences.entries()),Ze(t.occurrences.entries()))}pipe(){return X(this,arguments)}}class cJ{value;[Ou]=Bu;[$y]=$y;constructor(t){this.value=t}[ae](){return $(K(HR),_e(K(this.value)),Ve(this))}[ie](t){return mJ(t)&&this.value===t.value}pipe(){return X(this,arguments)}}class lJ{buckets;count;min;max;sum;[Ou]=Bu;[Dy]=Dy;constructor(t,n,r,s,i){this.buckets=t,this.count=n,this.min=r,this.max=s,this.sum=i}[ae](){return $(K(WR),_e(K(this.buckets)),_e(K(this.count)),_e(K(this.min)),_e(K(this.max)),_e(K(this.sum)),Ve(this))}[ie](t){return bJ(t)&&ne(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return X(this,arguments)}}class uJ{error;quantiles;count;min;max;sum;[Ou]=Bu;[My]=My;constructor(t,n,r,s,i,o){this.error=t,this.quantiles=n,this.count=r,this.min=s,this.max=i,this.sum=o}[ae](){return $(K(KR),_e(K(this.error)),_e(K(this.quantiles)),_e(K(this.count)),_e(K(this.min)),_e(K(this.max)),_e(K(this.sum)),Ve(this))}[ie](t){return wJ(t)&&this.error===t.error&&ne(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return X(this,arguments)}}const dJ=e=>new iJ(e),fJ=e=>new aJ(e),hJ=e=>new cJ(e),pJ=e=>new lJ(e.buckets,e.count,e.min,e.max,e.sum),gJ=e=>new uJ(e.error,e.quantiles,e.count,e.min,e.max,e.sum),_J=e=>re(e,Oy),yJ=e=>re(e,By),mJ=e=>re(e,$y),bJ=e=>re(e,Dy),wJ=e=>re(e,My),kJ="effect/MetricHook",EJ=Symbol.for(kJ),TJ={_In:e=>e,_Out:e=>e},$u=e=>({[EJ]:TJ,pipe(){return X(this,arguments)},...e}),gE=BigInt(0),vJ=e=>{let t=e.keyType.bigint?gE:0;const n=e.keyType.incremental?e.keyType.bigint?s=>s>=gE:s=>s>=0:s=>!0,r=s=>{n(s)&&(t=t+s)};return $u({get:()=>dJ(t),update:r,modify:r})},SJ=e=>{const t=new Map;for(const r of e.keyType.preregisteredWords)t.set(r,0);const n=r=>{const s=t.get(r)??0;t.set(r,s+1)};return $u({get:()=>fJ(t),update:n,modify:n})},AJ=(e,t)=>{let n=t;return $u({get:()=>hJ(n),update:r=>{n=r},modify:r=>{n=n+r}})},IJ=e=>{const t=e.keyType.boundaries.values,n=t.length,r=new Uint32Array(n+1),s=new Float32Array(n);let i=0,o=0,a=Number.MAX_VALUE,c=Number.MIN_VALUE;$(t,Fl(Ra),Jo((d,f)=>{s[f]=d}));const l=d=>{let f=0,h=n;for(;f!==h;){const p=Math.floor(f+(h-f)/2),_=s[p];d<=_?h=p:f=p,h===f+1&&(d<=s[f]?h=f:f=h)}r[f]=r[f]+1,i=i+1,o=o+d,d<a&&(a=d),d>c&&(c=d)},u=()=>{const d=jh(n);let f=0;for(let h=0;h<n;h++){const p=s[h],_=r[h];f=f+_,d[h]=[p,f]}return d};return $u({get:()=>pJ({buckets:u(),count:i,min:a,max:c,sum:o}),update:l,modify:l})},NJ=e=>{const{error:t,maxAge:n,maxSize:r,quantiles:s}=e.keyType,i=$(s,Fl(Ra)),o=jh(r);let a=0,c=0,l=0,u=0,d=0;const f=p=>{const _=[];let g=0;for(;g!==r-1;){const y=o[g];if(y!=null){const[w,k]=y,b=iy(p-w);Zz(b,UN)&&Gz(b,n)&&_.push(k)}g=g+1}return xJ(t,i,Fl(_,Ra))},h=(p,_)=>{if(r>0){a=a+1;const g=a%r;o[g]=[_,p]}u=c===0?p:Math.min(u,p),d=c===0?p:Math.max(d,p),c=c+1,l=l+p};return $u({get:()=>gJ({error:t,quantiles:f(Date.now()),count:c,min:u,max:d,sum:l}),update:([p,_])=>h(p,_),modify:([p,_])=>h(p,_)})},xJ=(e,t,n)=>{const r=n.length;if(!Je(t))return xa();const s=t[0],i=t.slice(1),o=_E(e,r,G(),0,s,n),a=sr(o);return i.forEach(c=>{a.push(_E(e,r,o.value,o.consumed,c,o.rest))}),Jo(a,c=>[c.quantile,c.value])},_E=(e,t,n,r,s,i)=>{let o=e,a=t,c=n,l=r,u=s,d=i,f=e,h=t,p=n,_=r,g=s,y=i;for(;;){if(!Je(d))return{quantile:u,value:G(),consumed:l,rest:[]};if(u===1)return{quantile:u,value:te(FI(d)),consumed:l+d.length,rest:[]};const w=Kt(d),k=G9(d,A=>A===w),b=u*a,N=o/2*b,S=l+k[0].length,E=Math.abs(S-b);if(S<b-N){f=o,h=a,p=pl(d),_=S,g=u,y=k[1],o=f,a=h,c=p,l=_,u=g,d=y;continue}if(S>b+N){const A=_t(c)?te(w):c;return{quantile:u,value:A,consumed:l,rest:d}}switch(c._tag){case"None":{f=o,h=a,p=pl(d),_=S,g=u,y=k[1],o=f,a=h,c=p,l=_,u=g,d=y;continue}case"Some":{const A=Math.abs(b-c.value);if(E<A){f=o,h=a,p=pl(d),_=S,g=u,y=k[1],o=f,a=h,c=p,l=_,u=g,d=y;continue}return{quantile:u,value:te(c.value),consumed:l,rest:d}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},RJ="effect/MetricPair",CJ=Symbol.for(RJ),OJ={_Type:e=>e},BJ=(e,t)=>({[CJ]:OJ,metricKey:e,metricState:t,pipe(){return X(this,arguments)}}),$J="effect/MetricRegistry",yE=Symbol.for($J);class DJ{[yE]=yE;map=KK();snapshot(){const t=[];for(const[n,r]of this.map)t.push(BJ(n,r.get()));return t}get(t){const n=$(this.map,bi(t),Or);if(n==null){if(FR(t.keyType))return this.getCounter(t);if(GZ(t.keyType))return this.getGauge(t);if(YZ(t.keyType))return this.getFrequency(t);if(jR(t.keyType))return this.getHistogram(t);if(ZZ(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return n}getCounter(t){let n=$(this.map,bi(t),Or);if(n==null){const r=vJ(t);$(this.map,Ec(t))||$(this.map,Tc(t,r)),n=r}return n}getFrequency(t){let n=$(this.map,bi(t),Or);if(n==null){const r=SJ(t);$(this.map,Ec(t))||$(this.map,Tc(t,r)),n=r}return n}getGauge(t){let n=$(this.map,bi(t),Or);if(n==null){const r=AJ(t,t.keyType.bigint?BigInt(0):0);$(this.map,Ec(t))||$(this.map,Tc(t,r)),n=r}return n}getHistogram(t){let n=$(this.map,bi(t),Or);if(n==null){const r=IJ(t);$(this.map,Ec(t))||$(this.map,Tc(t,r)),n=r}return n}getSummary(t){let n=$(this.map,bi(t),Or);if(n==null){const r=NJ(t);$(this.map,Ec(t))||$(this.map,Tc(t,r)),n=r}return n}}const MJ=()=>new DJ,LJ="effect/Metric",UJ=Symbol.for(LJ),PJ={_Type:e=>e,_In:e=>e,_Out:e=>e},mE=ge(Symbol.for("effect/Metric/globalMetricRegistry"),()=>MJ()),YR=function(e,t,n,r){const s=Object.assign(i=>rK(i,o=>zJ(s,o)),{[UJ]:PJ,keyType:e,unsafeUpdate:t,unsafeValue:n,unsafeModify:r,register(){return this.unsafeValue([]),this},pipe(){return X(this,arguments)}});return s},gp=(e,t)=>GR(tJ(e,t)),GR=e=>{let t;const n=new WeakMap,r=s=>{if(s.length===0)return t!==void 0||(t=mE.get(e)),t;let i=n.get(s);return i!==void 0||(i=mE.get(rJ(e,s)),n.set(s,i)),i};return YR(e.keyType,(s,i)=>r(i).update(s),s=>r(s).get(),(s,i)=>r(i).modify(s))},FJ=(e,t,n)=>GR(nJ(e,t,n)),jJ=v(3,(e,t,n)=>VJ(e,[wG(t,n)])),VJ=v(2,(e,t)=>YR(e.keyType,(n,r)=>e.unsafeUpdate(n,$d(t,r)),n=>e.unsafeValue($d(t,n)),(n,r)=>e.unsafeModify(n,$d(t,r)))),zJ=v(2,(e,t)=>kw(by,n=>ee(()=>e.unsafeUpdate(t,n))));({...Pb});const qJ=v(2,(e,t)=>kw(BR,n=>ee(()=>{if(n.has(e)){const r=n.get(e);r.state.completed||(r.state.completed=!0,Qx(r.result,t))}}))),HJ="effect/Supervisor",_p=Symbol.for(HJ),jw={_T:e=>e};class yp{underlying;value0;[_p]=jw;constructor(t,n){this.underlying=t,this.value0=n}get value(){return this.value0}onStart(t,n,r,s){this.underlying.onStart(t,n,r,s)}onEnd(t,n){this.underlying.onEnd(t,n)}onEffect(t,n){this.underlying.onEffect(t,n)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new yp(this,$(this.value,cn(t)))}zip(t){return new mp(this,t)}}class mp{left;right;_tag="Zip";[_p]=jw;constructor(t,n){this.left=t,this.right=n}get value(){return jx(this.left.value,this.right.value)}onStart(t,n,r,s){this.left.onStart(t,n,r,s),this.right.onStart(t,n,r,s)}onEnd(t,n){this.left.onEnd(t,n),this.right.onEnd(t,n)}onEffect(t,n){this.left.onEffect(t,n),this.right.onEffect(t,n)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new yp(this,$(this.value,cn(t)))}zip(t){return new mp(this,t)}}const ZR=e=>re(e,_p)&&hI(e,"Zip");class WJ{effect;[_p]=jw;constructor(t){this.effect=t}get value(){return this.effect}onStart(t,n,r,s){}onEnd(t,n){}onEffect(t,n){}onSuspend(t){}onResume(t){}map(t){return new yp(this,$(this.value,cn(t)))}zip(t){return new mp(this,t)}onRun(t,n){return t()}}const KJ=e=>new WJ(e),bp=ge("effect/Supervisor/none",()=>KJ(br)),YJ=oc,JR="Empty",XR="AddSupervisor",QR="RemoveSupervisor",eC="AndThen",_l={_tag:JR},Fd=(e,t)=>({_tag:eC,first:e,second:t}),GJ=(e,t)=>ZJ(t,On(e)),ZJ=(e,t)=>{let n=e,r=t;for(;Ba(r);){const s=$a(r);switch(s._tag){case JR:{r=Ci(r);break}case XR:{n=n.zip(s.supervisor),r=Ci(r);break}case QR:{n=Ly(n,s.supervisor),r=Ci(r);break}case eC:{r=yr(s.first)(yr(s.second)(Ci(r)));break}}}return n},Ly=(e,t)=>ne(e,t)?bp:ZR(e)?Ly(e.left,t).zip(Ly(e.right,t)):e,Kf=e=>ne(e,bp)?ro():ZR(e)?$(Kf(e.left),zl(Kf(e.right))):aw(e),JJ=(e,t)=>{if(ne(e,t))return _l;const n=Kf(e),r=Kf(t),s=$(r,C1(n),Bf(_l,(o,a)=>Fd(o,{_tag:XR,supervisor:a}))),i=$(n,C1(r),Bf(_l,(o,a)=>Fd(o,{_tag:QR,supervisor:a})));return Fd(s,i)},XJ=YJ({empty:_l,patch:GJ,combine:Fd,diff:JJ}),QJ=gp("effect_fiber_started",{incremental:!0}),bE=gp("effect_fiber_active"),eX=gp("effect_fiber_successes",{incremental:!0}),tX=gp("effect_fiber_failures",{incremental:!0}),nX=jJ(FJ("effect_fiber_lifetimes",MZ({start:.5,factor:2,count:35})),"time_unit","milliseconds"),vc="Continue",rX="Done",wE="Yield",sX={_E:e=>e,_A:e=>e},od=e=>{throw new Error(`BUG: FiberRuntime - ${Ia(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},Jr=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),Xr=ge("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),Sc={[Af]:(e,t,n)=>zt(()=>t.effect_instruction_i1(n)),OnStep:(e,t,n)=>tt(tt(n)),[If]:(e,t,n)=>zt(()=>t.effect_instruction_i2(n)),[Lb]:(e,t,n)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),Es(e.currentRuntimeFlags)&&e.isInterrupted()?Be(e.getInterruptedCause()):tt(n)),[Nf]:(e,t,n)=>(zt(()=>t.effect_instruction_i2(n)),zt(()=>t.effect_instruction_i0())?(e.pushStack(t),zt(()=>t.effect_instruction_i1())):br),[Cd]:(e,t,n)=>{const r=zt(()=>t.effect_instruction_i0.next(n));return r.done?tt(r.value):(e.pushStack(t),QV(r.value))}},iX={[$w]:(e,t,n,r)=>(e.processNewInterruptSignal(r.cause),Es(t)?Be(r.cause):n),[Mw]:(e,t,n,r)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[Dw]:(e,t,n,r)=>(r.onFiber(e,kR(t)),n),[Lw]:(e,t,n,r)=>Q(bw(),()=>n)},oX=e=>op(aW(e),t=>Hi(kW(t),([n,r])=>{const s=new Map,i=[];for(const a of r){i.push(zi(a));for(const c of a)s.set(c.request,c)}const o=i.flat();return up(wX(n.runAll(i),o,()=>o.forEach(a=>{a.listeners.interrupted=!0})),BR,s)},!1,!1)),aX=Ub();class tC extends gG{[kZ]=EZ;[vZ]=sX;_fiberRefs;_fiberId;_queue=new Array;_children=null;_observers=new Array;_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(t,n,r){if(super(),this.currentRuntimeFlags=r,this._fiberId=t,this._fiberRefs=n,M1(r)){const s=this.getFiberRef(by);QJ.unsafeUpdate(1,s),bE.unsafeUpdate(1,s)}this.refreshRefCache()}commit(){return $R(this)}id(){return this._fiberId}resume(t){this.tell(Co(t))}get status(){return this.ask((t,n)=>n)}get runtimeFlags(){return this.ask((t,n)=>PG(n)?t.currentRuntimeFlags:n.runtimeFlags)}scope(){return bZ(this)}get children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(sd)}fiberRefs(){return this.ask(t=>t.getFiberRefs())}ask(t){return it(()=>{const n=UK(this._fiberId);return this.tell(Pd((r,s)=>{Qx(n,ee(()=>t(r,s)))})),Xx(n)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return Kl(t=>{const n=r=>t(Pe(r));return this.tell(Pd((r,s)=>{r._exitValue!==null?n(this._exitValue):r.addObserver(n)})),ee(()=>this.tell(Pd((r,s)=>{r.removeObserver(n)})))},this.id())}get inheritAll(){return Bn((t,n)=>{const r=t.id(),s=t.getFiberRefs(),i=n.runtimeFlags,o=this.getFiberRefs(),a=YY(s,r,o);t.setFiberRefs(a);const c=t.getFiberRef(SE),l=$(Ld(i,c),U1(ac),U1(_y));return iK(l)})}get poll(){return ee(()=>Ph(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return ee(()=>this.tell(Eg(Ss(t))))}unsafeInterruptAsFork(t){this.tell(Eg(Ss(t)))}addObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}removeObserver(t){this._observers=this._observers.filter(n=>n!==t)}getFiberRefs(){return this.setFiberRef(SE,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=fR(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,n){this._fiberRefs=ky(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:n}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(jf),this.currentTracer=this.currentDefaultServices.unsafeMap.get(lR.key),this.currentSupervisor=this.getFiberRef(bX),this.currentScheduler=this.getFiberRef(OR),this.currentContext=this.getFiberRef(Ru),this.currentSpan=this.currentContext.unsafeMap.get(uR.key)}setFiberRefs(t){this._fiberRefs=t,this.refreshRefCache()}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}transferChildren(t){const n=this._children;if(this._children=null,n!==null&&n.size>0)for(const r of n)r._exitValue===null&&t.add(this.currentRuntimeFlags,r)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let n=vc;const r=globalThis[ei];globalThis[ei]=this;try{for(;n===vc;)n=this._queue.length===0?rX:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[ei]=r}this._queue.length>0&&!this._running?(this._running=!0,n===wE?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(dp))}drainQueueWhileRunning(t,n){let r=n;for(;this._queue.length>0;){const s=this._queue.splice(0,1)[0];r=iX[s._tag](this,t,r,s)}return r}isInterrupted(){return!AW(this.getFiberRef(sd))}addInterruptedCause(t){const n=this.getFiberRef(sd);this.setFiberRef(sd,Wn(n,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(const n of this._children)n.tell(Eg(Ss(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){const t=this._children.values();this._children=null;let n=!1;return mw({while:()=>!n,body:()=>{const s=t.next();return s.done?ee(()=>{n=!0}):xu(s.value.await)},step:()=>{}})}return null}reportExitValue(t){if(M1(this.currentRuntimeFlags)){const n=this.getFiberRef(by),r=this.id().startTimeMillis,s=Date.now();switch(nX.unsafeUpdate(s-r,n),bE.unsafeUpdate(-1,n),t._tag){case pr:{eX.unsafeUpdate(1,n);break}case hr:{tX.unsafeUpdate(1,n);break}}}if(t._tag==="Failure"){const n=this.getFiberRef(SK);!hw(t.cause)&&n._tag==="Some"&&this.log("Fiber terminated with an unhandled error",t.cause,n)}}setExitValue(t){this._exitValue=t,this.reportExitValue(t);for(let n=this._observers.length-1;n>=0;n--)this._observers[n](t);this._observers=[]}getLoggers(){return this.getFiberRef(fX)}log(t,n,r){const s=kt(r)?r.value:this.getFiberRef(wK),i=this.getFiberRef(cX);if(uG(i,s))return;const o=this.getFiberRef(kK),a=this.getFiberRef(bK),c=this.getLoggers(),l=this.getFiberRefs();if(ZN(c)>0){const u=IN(this.getFiberRef(jf),Aw),d=new Date(u.unsafeCurrentTimeMillis());s9(l,()=>{for(const f of c)f.log({fiberId:this.id(),logLevel:s,message:t,cause:n,context:l,spans:o,annotations:a,date:d})})}}evaluateMessageWhileSuspended(t){switch(t._tag){case Lw:return wE;case $w:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(Be(t.cause)),this._asyncInterruptor=null),vc;case Mw:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),vc;case Dw:return t.onFiber(this,this._exitValue!==null?LG:UG(this.currentRuntimeFlags,this._asyncBlockingOn)),vc;default:return od(t)}}evaluateEffect(t){this.currentSupervisor.onResume(this);try{let n=Es(this.currentRuntimeFlags)&&this.isInterrupted()?Be(this.getInterruptedCause()):t;for(;n!==null;){const r=n,s=this.runLoop(r);if(s===Jr){const i=Xr.currentOp;Xr.currentOp=null,i._op===Od?nW(this.currentRuntimeFlags)?(this.tell(gZ()),this.tell(Co(Oi)),n=null):n=Oi:i._op===hl&&(n=null)}else{this.currentRuntimeFlags=$(this.currentRuntimeFlags,rW(_y));const i=this.interruptAllChildren();i!==null?n=Q(i,()=>s):(this._queue.length===0?this.setExitValue(s):this.tell(Co(s)),n=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(t){if(this._running)this.tell(Co(t));else{this._running=!0;const n=globalThis[ei];globalThis[ei]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[ei]=n,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(Co(t))}patchRuntimeFlags(t,n){const r=Ud(t,n);return globalThis[ei]=this,this.currentRuntimeFlags=r,r}initiateAsync(t,n){let r=!1;const s=i=>{r||(r=!0,this.tell(Co(i)))};Es(t)&&(this._asyncInterruptor=s);try{n(s)}catch(i){s(mr(qr(i)))}}pushStack(t){this._stack.push(t),t._op==="OnStep"&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){const t=this._stack.pop();if(t)return t._op==="OnStep"&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._op!==ug)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._op!==Af&&t._op!==Nf&&t._op!==Cd)return t;t=this.popStack()}}[o9](t){return ee(()=>NN(this.currentContext,t))}Left(t){return nn(t.left)}None(t){return nn(new Zx)}Right(t){return tt(t.right)}Some(t){return tt(t.value)}Micro(t){return Uf(n=>{let r=n;const s=hZ(oZ(t,this.currentContext));return s.addObserver(i=>{if(i._tag==="Success")return r(tt(i.value));switch(i.cause._tag){case"Interrupt":return r(Be(Ss(La)));case"Fail":return r(nn(i.cause.error));case"Die":return r(z1(i.cause.defect))}}),Uf(i=>{r=o=>{i(br)},s.unsafeInterrupt()})})}[wI](t){const n=zt(()=>t.effect_instruction_i0()),r=this.getNextSuccessCont();return r!==void 0?(r._op in Sc||od(r),Sc[r._op](this,r,n)):(Xr.currentOp=tt(n),Jr)}[pr](t){const n=t,r=this.getNextSuccessCont();return r!==void 0?(r._op in Sc||od(r),Sc[r._op](this,r,n.effect_instruction_i0)):(Xr.currentOp=n,Jr)}[hr](t){const n=t.effect_instruction_i0,r=this.getNextFailCont();if(r!==void 0)switch(r._op){case ug:case If:return Es(this.currentRuntimeFlags)&&this.isInterrupted()?Be(P1(n)):zt(()=>r.effect_instruction_i1(n));case"OnStep":return Es(this.currentRuntimeFlags)&&this.isInterrupted()?Be(P1(n)):tt(Be(n));case Lb:return this.patchRuntimeFlags(this.currentRuntimeFlags,r.patch),Es(this.currentRuntimeFlags)&&this.isInterrupted()?Be(Wn(n,this.getInterruptedCause())):Be(n);default:od(r)}else return Xr.currentOp=Be(n),Jr}[kI](t){return zt(()=>t.effect_instruction_i0(this,kR(this.currentRuntimeFlags)))}Blocked(t){const n=this.getFiberRefs(),r=this.currentRuntimeFlags;if(this._steps.length>0){const s=[],i=this._steps[this._steps.length-1];let o=this.popStack();for(;o&&o._op!=="OnStep";)s.push(o),o=this.popStack();this.setFiberRefs(i.refs),this.currentRuntimeFlags=i.flags;const a=IG(i.refs,n),c=Ld(i.flags,r);return tt(xx(t.effect_instruction_i0,Bn(l=>{for(;s.length>0;)l.pushStack(s.pop());return l.setFiberRefs(NG(l.id(),l.getFiberRefs())(a)),l.currentRuntimeFlags=Ud(c)(l.currentRuntimeFlags),t.effect_instruction_i1})))}return cp(s=>Q(nC(YW(t.effect_instruction_i0)),()=>s(t.effect_instruction_i1)))}RunBlocked(t){return oX(t.effect_instruction_i0)}[mu](t){const n=t.effect_instruction_i0,r=this.currentRuntimeFlags,s=Ud(r,n);if(Es(s)&&this.isInterrupted())return Be(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,n),t.effect_instruction_i1){const i=Ld(s,r);return this.pushStack(new GW(i,t)),zt(()=>t.effect_instruction_i1(r))}else return Oi}[Af](t){return this.pushStack(t),t.effect_instruction_i0}OnStep(t){return this.pushStack(t),t.effect_instruction_i0}[ug](t){return this.pushStack(t),t.effect_instruction_i0}[If](t){return this.pushStack(t),t.effect_instruction_i0}[hl](t){return this._asyncBlockingOn=t.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,t.effect_instruction_i0),Xr.currentOp=t,Jr}[Od](t){return this._isYielding=!1,Xr.currentOp=t,Jr}[Nf](t){const n=t.effect_instruction_i0,r=t.effect_instruction_i1;return n()?(this.pushStack(t),r()):Oi}[Cd](t){return Sc[Cd](this,t,void 0)}[Uh](t){return zt(()=>t.commit())}runLoop(t){let n=t;for(this.currentOpCount=0;;){if((this.currentRuntimeFlags&tW)!==0&&this.currentSupervisor.onEffect(this,n),this._queue.length>0&&(n=this.drainQueueWhileRunning(this.currentRuntimeFlags,n)),!this._isYielding){this.currentOpCount+=1;const r=this.currentScheduler.shouldYield(this);if(r!==!1){this._isYielding=!0,this.currentOpCount=0;const s=n;n=Q(bw({priority:r}),()=>s)}}try{if(n=this.currentTracer.context(()=>{if(aX!==n[qa]._V){const r=this.getFiberRef(AK);if(r._tag==="Some"){const s=n[qa]._V;this.log(`Executing an Effect versioned ${s} with a Runtime of version ${Ub()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,ja,r)}}return this[n._op](n)},this),n===Jr){const r=Xr.currentOp;return r._op===Od||r._op===hl?Jr:(Xr.currentOp=null,r._op===pr||r._op===hr?r:Be(qr(r)))}}catch(r){n!==Jr&&!re(n,"_op")||!(n._op in this)?n=XW(`Not a valid effect: ${Ia(n)}`):CK(r)?n=Be(Wn(qr(r),Ss(La))):n=z1(r)}}}run=()=>{this.drainQueueOnCurrentThread()}}const cX=ge("effect/FiberRef/currentMinimumLogLevel",()=>_n(dG("Info"))),lX=e=>Pw(t=>{const n=XY(t.context,jf);IN(n,cR).unsafe.log(e.log(t))}),uX=ge(Symbol.for("effect/Logger/defaultLogger"),()=>lX(CZ)),dX=ge(Symbol.for("effect/Logger/tracerLogger"),()=>Pw(({annotations:e,cause:t,context:n,fiberId:r,logLevel:s,message:i})=>{const o=Eu(Yl(n,Ru),uR);if(o._tag==="None"||o.value._tag==="ExternalSpan")return;const a=NN(Yl(n,jf),Aw),c={};for(const[l,u]of e)c[l]=u;c["effect.fiberId"]=Vq(r),c["effect.logLevel"]=s.label,t!==null&&t._tag!=="Empty"&&(c["effect.cause"]=uc(t,{renderErrorCause:!0})),o.value.event(Ia(Array.isArray(i)&&i.length===1?i[0]:i),a.unsafeCurrentTimeNanos(),c)})),fX=ge(Symbol.for("effect/FiberRef/currentLoggers"),()=>_K(aw(uX,dX))),hX=v(e=>VV(e[0]),(e,t,n)=>Bn(r=>{const s=n?.batching===!0||n?.batching==="inherit"&&r.getFiberRef(vK);return n?.discard?pE(n.concurrency,()=>Oo(vy,n?.concurrentFinalizers)(i=>s?Hi(e,(o,a)=>i(t(o,a)),!0,!1,1):op(e,(o,a)=>i(t(o,a)))),()=>Oo(Sy,n?.concurrentFinalizers)(i=>Hi(e,(o,a)=>i(t(o,a)),s,!1)),i=>Oo(Ay(i),n?.concurrentFinalizers)(o=>Hi(e,(a,c)=>o(t(a,c)),s,!1,i))):pE(n?.concurrency,()=>Oo(vy,n?.concurrentFinalizers)(i=>s?kE(e,1,(o,a)=>i(t(o,a)),!0):Rs(e,(o,a)=>i(t(o,a)))),()=>Oo(Sy,n?.concurrentFinalizers)(i=>pX(e,(o,a)=>i(t(o,a)),s)),i=>Oo(Ay(i),n?.concurrentFinalizers)(o=>kE(e,i,(a,c)=>o(t(a,c)),s)))})),pX=(e,t,n)=>it(()=>{const r=Ze(e),s=new Array(r.length);return lp(Hi(r,(o,a)=>Q(t(o,a),c=>ee(()=>s[a]=c)),n,!1),Pe(s))}),Hi=(e,t,n,r,s)=>cp(i=>sK(o=>Bn(a=>{let c=Array.from(e).reverse(),l=c.length;if(l===0)return br;let u=0,d=!1;const f=s?Math.min(c.length,s):c.length,h=new Set,p=new Array,_=()=>h.forEach(A=>{A.currentScheduler.scheduleTask(()=>{A.unsafeInterruptAsFork(a.id())},0)}),g=new Array,y=new Array,w=new Array,k=()=>{const A=p.filter(({exit:x})=>x._tag==="Failure").sort((x,D)=>x.index<D.index?-1:x.index===D.index?0:1).map(({exit:x})=>x);return A.length===0&&A.push(Oi),A},b=(A,x=!1)=>{const D=Fx(o(A)),B=_X(D,a,a.currentRuntimeFlags,Uw);return a.currentScheduler.scheduleTask(()=>{x&&B.unsafeInterruptAsFork(a.id()),B.resume(D)},0),B},N=()=>{r||(l-=c.length,c=[]),d=!0,_()},S=n?tK:Bx,E=b(Kl(A=>{const x=(B,z)=>{B._op==="Blocked"?w.push(B):(p.push({index:z,exit:B}),B._op==="Failure"&&!d&&N())},D=()=>{if(c.length>0){const B=c.pop();let z=u++;const J=()=>{const q=c.pop();return z=u++,Q(bw(),()=>Q(S(i(t(q,z))),R))},R=q=>c.length>0&&(x(q,z),c.length>0)?J():Pe(q),U=Q(S(i(t(B,z))),R),P=b(U);g.push(P),h.add(P),d&&P.currentScheduler.scheduleTask(()=>{P.unsafeInterruptAsFork(a.id())},0),P.addObserver(q=>{let Z;if(q._op==="Failure"?Z=q:Z=q.effect_instruction_i0,y.push(P),h.delete(P),x(Z,z),p.length===l)A(Pe(ct(Y1(k(),{parallel:!0}),()=>Oi)));else if(w.length+p.length===l){const Re=k(),Dt=w.map(qe=>qe.effect_instruction_i0).reduce(bx);A(Pe(xx(Dt,Hi([ct(Y1(Re,{parallel:!0}),()=>Oi),...w.map(qe=>qe.effect_instruction_i1)],qe=>qe,n,!0,s))))}else D()})}};for(let B=0;B<f;B++)D()}));return xu(yw(Mx(i($R(E))),Jx({onFailure:A=>{N();const x=w.length+1,D=Math.min(typeof s=="number"?s:w.length,w.length),B=Array.from(w);return Kl(z=>{let J=0,R=0;const U=(q,Z)=>Re=>{J++,J===x&&z(tt(Be(A))),B.length>0&&Z&&P()},P=()=>{b(B.pop(),!0).addObserver(U(R,!0)),R++};E.addObserver(U(R,!1)),R++;for(let q=0;q<D;q++)P()})},onSuccess:()=>Rs(y,A=>A.inheritAll)})))}))),kE=(e,t,n,r)=>it(()=>{const s=Ze(e),i=new Array(s.length);return lp(Hi(s,(a,c)=>cn(n(a,c),l=>i[c]=l),r,!1,t),Pe(i))}),nC=e=>yX(e,Uw),gX=(e,t,n,r=null)=>{const s=rC(e,t,n,r);return s.resume(e),s},_X=(e,t,n,r=null)=>rC(e,t,n,r),rC=(e,t,n,r=null)=>{const s=nx(),i=t.getFiberRefs(),o=GY(i,s),a=new tC(s,o,n),c=Yl(o,Ru),l=a.currentSupervisor;return l.onStart(c,e,te(t),a),a.addObserver(d=>l.onEnd(d,a)),(r!==null?r:$(t.getFiberRef(wy),ct(()=>t.scope()))).add(n,a),a},yX=(e,t)=>Bn((n,r)=>Pe(gX(e,n,r.runtimeFlags,t))),EE=e=>Cu(t=>Zn(Eu(t,Du),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return Q(fp(n,Sy),r=>Vw(e,r))}}})),TE=e=>t=>Cu(n=>Zn(Eu(n,Du),{onNone:()=>t,onSome:r=>r.strategy._tag==="ParallelN"&&r.strategy.parallelism===e?t:Q(fp(r,Ay(e)),s=>Vw(t,s))})),Oo=(e,t)=>n=>Cu(r=>Zn(Eu(r,Du),{onNone:()=>n(nt),onSome:s=>{if(t===!0){const i=e._tag==="Parallel"?EE:e._tag==="Sequential"?vE:TE(e.parallelism);switch(s.strategy._tag){case"Parallel":return i(n(EE));case"Sequential":return i(n(vE));case"ParallelN":return i(n(TE(s.strategy.parallelism)))}}else return n(nt)}})),vE=e=>Cu(t=>Zn(Eu(t,Du),{onNone:()=>e,onSome:n=>{switch(n.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return Q(fp(n,vy),r=>Vw(e,r))}}})),Du=ko("effect/Scope"),Vw=v(2,(e,t)=>zK(e,xN(vz(Du,t)))),mX=e=>dc(e,{differ:XJ,fork:_l}),SE=mK(sW),bX=mX(bp),wX=(e,t,n)=>Dx(r=>Q(Q(nC(Lx(e)),s=>Kl(i=>{const o=t.map(l=>l.listeners.count),a=()=>{o.every(l=>l===0)&&t.every(l=>l.result.state.current._tag==="Pending"?!0:!!(l.result.state.current._tag==="Done"&&Tw(l.result.state.current.effect)&&l.result.state.current.effect._tag==="Failure"&&IW(l.result.state.current.effect.cause)))&&(c.forEach(l=>l()),n?.(),i(oK(s)))};s.addObserver(l=>{c.forEach(u=>u()),i(l)});const c=t.map((l,u)=>{const d=f=>{o[u]=f,a()};return l.listeners.addObserver(d),()=>l.listeners.removeObserver(d)});return a(),ee(()=>{c.forEach(l=>l())})})),()=>it(()=>{const s=t.flatMap(i=>i.state.completed?[]:[i]);return op(s,i=>qJ(i.request,DK(r)))}))),kX=SW,EX=uc,TX=NK,vX=fp,zw=e=>function(){if(arguments.length===1){const t=arguments[0];return(n,...r)=>e(t,n,...r)}return e.apply(this,arguments)},sC=zw((e,t,n)=>{const r=nx(),s=[[Ru,[[r,e.context]]]];n?.scheduler&&s.push([OR,[[r,n.scheduler]]]);let i=QY(e.fiberRefs,{entries:s,forkAs:r});n?.updateRefs&&(i=n.updateRefs(i,r));const o=new tC(r,i,e.runtimeFlags);let a=t;n?.scope&&(a=Q(vX(n.scope,wR),l=>lp(IK(l,Dx(u=>ne(u,o.id())?br:zx(o,u))),yw(t,u=>TX(l,u)))));const c=o.currentSupervisor;return c!==bp&&(c.onStart(e.context,a,G(),o),o.addObserver(l=>c.onEnd(l,o))),Uw.add(e.runtimeFlags,o),n?.immediate===!1?o.resume(a):o.start(a),o}),SX=zw((e,t)=>{const n=CX(e)(t);if(n._tag==="Failure")throw xX(n.effect_instruction_i0);return n.effect_instruction_i0});class AX extends Error{fiber;_tag="AsyncFiberException";constructor(t){super(`Fiber #${t.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=t,this.name=this._tag,this.stack=this.message}}const IX=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new AX(e);return Error.stackTraceLimit=t,n},Tg=Symbol.for("effect/Runtime/FiberFailure"),ad=Symbol.for("effect/Runtime/FiberFailure/Cause");class NX extends Error{[Tg];[ad];constructor(t){const n=Ix(t)[0];super(n?.message||"An error has occurred"),this[Tg]=Tg,this[ad]=t,this.name=n?`(FiberFailure) ${n.name}`:"FiberFailure",n?.stack&&(this.stack=n.stack)}toJSON(){return{_id:"FiberFailure",cause:this[ad].toJSON()}}toString(){return"(FiberFailure) "+uc(this[ad],{renderErrorCause:!0})}[Fe](){return this.toString()}}const xX=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new NX(e);return Error.stackTraceLimit=t,n},RX=e=>{const t=e;switch(t._op){case"Failure":case"Success":return t;case"Left":return G1(t.left);case"Right":return tt(t.right);case"Some":return tt(t.value);case"None":return G1(Zx())}},CX=zw((e,t)=>{const n=RX(t);if(n)return n;const r=new CR,s=sC(e)(t,{scheduler:r});r.flush();const i=s.unsafePoll();return i||$K(gw(IX(s),vw(s)))});class OX{context;runtimeFlags;fiberRefs;constructor(t,n,r){this.context=t,this.runtimeFlags=n,this.fiberRefs=r}pipe(){return X(this,arguments)}}const BX=e=>new OX(e.context,e.runtimeFlags,e.fiberRefs),$X=yx(ac,gx,px),iC=BX({context:Jb(),runtimeFlags:$X,fiberRefs:eG()}),DX=sC(iC),MX=SX(iC),LX=function(){const e=Symbol.for("effect/Data/Error/plainArgs");return{BaseEffectError:class extends Ew{constructor(n){super(n?.message,n?.cause?{cause:n.cause}:void 0),n&&(Object.assign(this,n),Object.defineProperty(this,e,{value:n,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}.BaseEffectError}(),UX=e=>{const t={BaseEffectError:class extends LX{_tag=e}};return t.BaseEffectError.prototype.name=e,t.BaseEffectError},PX=ip,jd=hX,cd=it,Dn=br,FX=my,Uy=cn,jX=ap,Bo=Pf,Ir=Q,VX=DX,zX=MX;class Tt{path;actual;issue;_tag="Pointer";constructor(t,n,r){this.path=t,this.actual=n,this.issue=r}}class AE{actual;message;_tag="Unexpected";constructor(t,n){this.actual=t,this.message=n}}class Ac{ast;message;_tag="Missing";actual=void 0;constructor(t,n){this.ast=t,this.message=n}}class He{ast;actual;issues;output;_tag="Composite";constructor(t,n,r,s){this.ast=t,this.actual=n,this.issues=r,this.output=s}}class vg{ast;actual;kind;issue;_tag="Refinement";constructor(t,n,r,s){this.ast=t,this.actual=n,this.kind=r,this.issue=s}}class Sg{ast;actual;kind;issue;_tag="Transformation";constructor(t,n,r,s){this.ast=t,this.actual=n,this.kind=r,this.issue=s}}class Mr{ast;actual;message;_tag="Type";constructor(t,n,r){this.ast=t,this.actual=n,this.message=r}}class IE{ast;actual;message;_tag="Forbidden";constructor(t,n,r){this.ast=t,this.actual=n,this.message=r}}const NE=Symbol.for("effect/Schema/ParseErrorTypeId");class qX extends UX("ParseError"){[NE]=NE;get message(){return this.toString()}toString(){return Vd.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[Fe](){return this.toJSON()}}const HX=e=>new qX({issue:e}),Py=be,WX=oe,en=T9,Cs=v(2,(e,t)=>en(e)?jb(e,{onLeft:oe,onRight:t}):Ir(e,t)),Nr=v(2,(e,t)=>en(e)?S9(e,t):Uy(e,t)),Ag=v(2,(e,t)=>en(e)?v9(e,t):jX(e,t)),oC=v(2,(e,t)=>en(e)?jb(e,{onLeft:t,onRight:be}):FX(e,t)),aC=(e,t)=>t===void 0||eo(t)?e:e===void 0?t:{...e,...t},KX=(e,t,n)=>{const r=Mt(e,t);return(s,i)=>r(s,aC(n,i))},qw=(e,t,n)=>{const r=KX(e,t,n);return(s,i)=>OI(r(s,i),HX)},YX=(e,t)=>qw(e.ast,!0,t),GX=(e,t)=>qw(e.ast,!1,t),se=YX,cC=(e,t)=>qw(It(e.ast),!0,t),ZX=GX,JX=ge(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),XX=ge(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),Mt=(e,t)=>{const n=t?JX:XX,r=n.get(e);if(r)return r;const s=QX(e,t),i=T7(e),o=kt(i)?(l,u)=>s(l,aC(u,i.value)):s,a=v7(e),c=t&&kt(a)?(l,u)=>Jc(oC(o(l,u),a.value),e,l,u):o;return n.set(e,c),c},Ig=e=>Or(w7(e)),Ng=e=>Or(k7(e)),QX=(e,t)=>{switch(e._tag){case"Refinement":if(t){const n=Mt(e.from,!0);return(r,s)=>{s=s??hg;const i=s?.errors==="all",o=Cs(oC(n(r,s),a=>{const c=new vg(e,r,"From",a);return i&&A7(e)&&fC(a)?Zn(e.filter(r,s,e),{onNone:()=>oe(c),onSome:l=>oe(new He(e,r,[c,new vg(e,r,"Predicate",l)]))}):oe(c)}),a=>Zn(e.filter(a,s,e),{onNone:()=>be(a),onSome:c=>oe(new vg(e,r,"Predicate",c))}));return Jc(o,e,r,s)}}else{const n=Mt(It(e),!0),r=Mt(lC(e.from),!1);return(s,i)=>Jc(Cs(n(s,i),o=>r(o,i)),e,s,i)}case"Transformation":{const n=nQ(e.transformation,t),r=t?Mt(e.from,!0):Mt(e.to,!1),s=t?Mt(e.to,!0):Mt(e.from,!1);return(i,o)=>Jc(Cs(Ag(r(i,o),a=>new Sg(e,i,t?"Encoded":"Type",a)),a=>Cs(Ag(n(a,o??hg,e,i),c=>new Sg(e,i,"Transformation",c)),c=>Ag(s(c,o),l=>new Sg(e,i,t?"Type":"Encoded",l)))),e,i,o)}case"Declaration":{const n=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(r,s)=>Jc(n(r,s??hg,e),e,r,s)}case"Literal":return yn(e,n=>n===e.literal);case"UniqueSymbol":return yn(e,n=>n===e.symbol);case"UndefinedKeyword":return yn(e,LV);case"NeverKeyword":return yn(e,UV);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return be;case"StringKeyword":return yn(e,gr);case"NumberKeyword":return yn(e,eo);case"BooleanKeyword":return yn(e,$h);case"BigIntKeyword":return yn(e,Dh);case"SymbolKeyword":return yn(e,K_);case"ObjectKeyword":return yn(e,_s);case"Enums":return yn(e,n=>e.enums.some(([r,s])=>s===n));case"TemplateLiteral":{const n=sz(e);return yn(e,r=>gr(r)&&n.test(r))}case"TupleType":{const n=e.elements.map(l=>Mt(l.type,t)),r=e.rest.map(l=>Mt(l.type,t));let s=e.elements.filter(l=>!l.isOptional);e.rest.length>0&&(s=s.concat(e.rest.slice(1)));const i=s.length,o=e.elements.length>0?e.elements.map((l,u)=>u).join(" | "):"never",a=Ig(e),c=Ng(e);return(l,u)=>{if(!V9(l))return oe(new Mr(e,l));const d=u?.errors==="all",f=[];let h=0;const p=[],_=l.length;for(let k=_;k<=i-1;k++){const b=new Tt(k,l,new Ac(s[k-_]));if(d){f.push([h++,b]);continue}else return oe(new He(e,l,b,p))}if(e.rest.length===0)for(let k=e.elements.length;k<=_-1;k++){const b=new Tt(k,l,new AE(l[k],`is unexpected, expected: ${o}`));if(d){f.push([h++,b]);continue}else return oe(new He(e,l,b,p))}let g=0,y;for(;g<n.length;g++)if(_<g+1){if(e.elements[g].isOptional)continue}else{const k=n[g],b=k(l[g],u);if(en(b)){if(At(b)){const N=new Tt(g,l,b.left);if(d){f.push([h++,N]);continue}else return oe(new He(e,l,N,er(p)))}p.push([h++,b.right])}else{const N=h++,S=g;y||(y=[]),y.push(({es:E,output:A})=>Ir(Bo(b),x=>{if(At(x)){const D=new Tt(S,l,x.left);return d?(E.push([N,D]),Dn):oe(new He(e,l,D,er(A)))}return A.push([N,x.right]),Dn}))}}if(Je(r)){const[k,...b]=r;for(;g<_-b.length;g++){const N=k(l[g],u);if(en(N))if(At(N)){const S=new Tt(g,l,N.left);if(d){f.push([h++,S]);continue}else return oe(new He(e,l,S,er(p)))}else p.push([h++,N.right]);else{const S=h++,E=g;y||(y=[]),y.push(({es:A,output:x})=>Ir(Bo(N),D=>{if(At(D)){const B=new Tt(E,l,D.left);return d?(A.push([S,B]),Dn):oe(new He(e,l,B,er(x)))}else return x.push([S,D.right]),Dn}))}}for(let N=0;N<b.length;N++)if(g+=N,!(_<g+1)){const S=b[N](l[g],u);if(en(S)){if(At(S)){const E=new Tt(g,l,S.left);if(d){f.push([h++,E]);continue}else return oe(new He(e,l,E,er(p)))}p.push([h++,S.right])}else{const E=h++,A=g;y||(y=[]),y.push(({es:x,output:D})=>Ir(Bo(S),B=>{if(At(B)){const z=new Tt(A,l,B.left);return d?(x.push([E,z]),Dn):oe(new He(e,l,z,er(D)))}return D.push([E,B.right]),Dn}))}}}const w=({es:k,output:b})=>Bd(k)?oe(new He(e,l,er(k),er(b))):be(er(b));if(y&&y.length>0){const k=y;return cd(()=>{const b={es:Gc(f),output:Gc(p)};return Ir(jd(k,N=>N(b),{concurrency:a,batching:c,discard:!0}),()=>w(b))})}return w({output:p,es:f})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return yn(e,PV);const n=[],r={},s=[];for(const u of e.propertySignatures)n.push([Mt(u.type,t),u]),r[u.name]=null,s.push(u.name);const i=e.indexSignatures.map(u=>[Mt(u.parameter,t),Mt(u.type,t),u.parameter]),o=Br.make(e.indexSignatures.map(u=>u.parameter).concat(s.map(u=>K_(u)?new x7(u):new X_(u)))),a=Mt(o,t),c=Ig(e),l=Ng(e);return(u,d)=>{if(!zV(u))return oe(new Mr(e,u));const f=d?.errors==="all",h=[];let p=0;const _=d?.onExcessProperty==="error",g=d?.onExcessProperty==="preserve",y={};let w;if(_||g){w=Reflect.ownKeys(u);for(const S of w){const E=a(S,d);if(en(E)&&At(E))if(_){const A=new Tt(S,u,new AE(u[S],`is unexpected, expected: ${String(o)}`));if(f){h.push([p++,A]);continue}else return oe(new He(e,u,A,y))}else y[S]=u[S]}}let k;const b=d?.exact===!0;for(let S=0;S<n.length;S++){const E=n[S][1],A=E.name,x=Object.prototype.hasOwnProperty.call(u,A);if(!x){if(E.isOptional)continue;if(b){const z=new Tt(A,u,new Ac(E));if(f){h.push([p++,z]);continue}else return oe(new He(e,u,z,y))}}const D=n[S][0],B=D(u[A],d);if(en(B)){if(At(B)){const z=new Tt(A,u,x?B.left:new Ac(E));if(f){h.push([p++,z]);continue}else return oe(new He(e,u,z,y))}y[A]=B.right}else{const z=p++,J=A;k||(k=[]),k.push(({es:R,output:U})=>Ir(Bo(B),P=>{if(At(P)){const q=new Tt(J,u,x?P.left:new Ac(E));return f?(R.push([z,q]),Dn):oe(new He(e,u,q,U))}return U[J]=P.right,Dn}))}}for(let S=0;S<i.length;S++){const E=i[S],A=E[0],x=E[1],D=qI(u,E[2]);for(const B of D){const z=A(B,d);if(en(z)&&as(z)){const J=x(u[B],d);if(en(J))if(At(J)){const R=new Tt(B,u,J.left);if(f){h.push([p++,R]);continue}else return oe(new He(e,u,R,y))}else Object.prototype.hasOwnProperty.call(r,B)||(y[B]=J.right);else{const R=p++,U=B;k||(k=[]),k.push(({es:P,output:q})=>Ir(Bo(J),Z=>{if(At(Z)){const Re=new Tt(U,u,Z.left);return f?(P.push([R,Re]),Dn):oe(new He(e,u,Re,q))}else return Object.prototype.hasOwnProperty.call(r,B)||(q[B]=Z.right),Dn}))}}}}const N=({es:S,output:E})=>{if(Bd(S))return oe(new He(e,u,er(S),E));if(d?.propertyOrder==="original"){const A=w||Reflect.ownKeys(u);for(const D of s)A.indexOf(D)===-1&&A.push(D);const x={};for(const D of A)Object.prototype.hasOwnProperty.call(E,D)&&(x[D]=E[D]);return be(x)}return be(E)};if(k&&k.length>0){const S=k;return cd(()=>{const E={es:Gc(h),output:Object.assign({},y)};return Ir(jd(S,A=>A(E),{concurrency:c,batching:l,discard:!0}),()=>N(E))})}return N({es:h,output:y})}}case"Union":{const n=eQ(e.types,t),r=Reflect.ownKeys(n.keys),s=r.length,i=e.types.length,o=new Map;for(let l=0;l<i;l++)o.set(e.types[l],Mt(e.types[l],t));const a=Ig(e)??1,c=Ng(e);return(l,u)=>{const d=[];let f=0,h=[];if(s>0)if(Ob(l))for(let g=0;g<s;g++){const y=r[g],w=n.keys[y].buckets;if(Object.prototype.hasOwnProperty.call(l,y)){const k=String(l[y]);if(Object.prototype.hasOwnProperty.call(w,k))h=h.concat(w[k]);else{const{candidates:b,literals:N}=n.keys[y],S=Br.make(N),E=b.length===i?new Vi([new Ut(y,S,!1,!0)],[]):Br.make(b);d.push([f++,new He(E,l,new Tt(y,l,new Mr(S,l[y])))])}}else{const{candidates:k,literals:b}=n.keys[y],N=new Ut(y,Br.make(b),!1,!0),S=k.length===i?new Vi([N],[]):Br.make(k);d.push([f++,new He(S,l,new Tt(y,l,new Ac(N)))])}}else{const g=n.candidates.length===i?e:Br.make(n.candidates);d.push([f++,new Mr(g,l)])}n.otherwise.length>0&&(h=h.concat(n.otherwise));let p;for(let g=0;g<h.length;g++){const y=h[g],w=o.get(y)(l,u);if(en(w)&&(!p||p.length===0)){if(as(w))return w;d.push([f++,w.left])}else{const k=f++;p||(p=[]),p.push(b=>cd(()=>"finalResult"in b?Dn:Ir(Bo(w),N=>(as(N)?b.finalResult=N:b.es.push([k,N.left]),Dn))))}}const _=g=>Bd(g)?g.length===1&&g[0][1]._tag==="Type"?oe(g[0][1]):oe(new He(e,l,er(g))):oe(new Mr(e,l));if(p&&p.length>0){const g=p;return cd(()=>{const y={es:Gc(d)};return Ir(jd(g,w=>w(y),{concurrency:a,batching:c,discard:!0}),()=>"finalResult"in y?y.finalResult:_(y.es))})}return _(d)}}case"Suspend":{const n=HI(()=>Mt(e.f(),t));return(r,s)=>n()(r,s)}}},yn=(e,t)=>n=>t(n)?be(n):oe(new Mr(e,n)),Zc=(e,t)=>{switch(e._tag){case"Declaration":{const n=lN(e);if(kt(n))return Zc(n.value,t);break}case"TypeLiteral":{const n=[];for(let r=0;r<e.propertySignatures.length;r++){const s=e.propertySignatures[r],i=t?S1(s.type):It(s.type);E1(i)&&!s.isOptional&&n.push([s.name,i])}return n}case"TupleType":{const n=[];for(let r=0;r<e.elements.length;r++){const s=e.elements[r],i=t?S1(s.type):It(s.type);E1(i)&&!s.isOptional&&n.push([r,i])}return n}case"Refinement":return Zc(e.from,t);case"Suspend":return Zc(e.f(),t);case"Transformation":return Zc(t?e.from:e.to,t)}return[]},eQ=(e,t)=>{const n={},r=[],s=[];for(let i=0;i<e.length;i++){const o=e[i],a=Zc(o,t);if(a.length>0){s.push(o);for(let c=0;c<a.length;c++){const[l,u]=a[c],d=String(u.literal);n[l]=n[l]||{buckets:{},literals:[],candidates:[]};const f=n[l].buckets;if(Object.prototype.hasOwnProperty.call(f,d)){if(c<a.length-1)continue;f[d].push(o),n[l].literals.push(u),n[l].candidates.push(o)}else{f[d]=[o],n[l].literals.push(u),n[l].candidates.push(o);break}}}else r.push(o)}return{keys:n,otherwise:r,candidates:s}},lC=e=>Yb(e)?lC(e.from):e,Jc=(e,t,n,r)=>{if(r?.isEffectAllowed===!0||en(e))return e;const s=new CR,i=VX(e,{scheduler:s});s.flush();const o=i.unsafePoll();if(o){if(qK(o))return be(o.value);const a=o.cause;return kX(a)?oe(a.error):oe(new IE(t,n,EX(a)))}return oe(new IE(t,n,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},tQ=([e],[t])=>e>t?1:e<t?-1:0;function er(e){return e.sort(tQ).map(t=>t[1])}const nQ=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return be;case"TypeLiteralTransformation":return n=>{let r=be(n);for(const s of e.propertySignatureTransformations){const[i,o]=t?[s.from,s.to]:[s.to,s.from],a=t?s.decode:s.encode;r=Nr(r,l=>{const u=a(Object.prototype.hasOwnProperty.call(l,i)?te(l[i]):G());return delete l[i],kt(u)&&(l[o]=u.value),l})}return r}}},Vt=(e,t=[])=>({value:e,forest:t}),Vd={formatIssue:e=>Nr(Lo(e),rQ),formatIssueSync:e=>{const t=Vd.formatIssue(e);return en(t)?I9(t):zX(t)},formatError:e=>Vd.formatIssue(e.issue),formatErrorSync:e=>Vd.formatIssueSync(e.issue)},rQ=e=>e.value+uC(`
`,e.forest),uC=(e,t)=>{let n="";const r=t.length;let s;for(let i=0;i<r;i++){s=t[i];const o=i===r-1;n+=e+(o?"└":"├")+"─ "+s.value,n+=uC(e+(r>1&&!o?"│  ":"   "),s.forest)}return n},sQ=e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}},iQ=e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}},dC=e=>"ast"in e?te(e.ast):G(),Fy=be(void 0),oQ=e=>dC(e).pipe(Fh(m7),Zn({onNone:()=>Fy,onSome:t=>{const n=t(e);return gr(n)?be({message:n,override:!1}):PX(n)?Uy(n,r=>({message:r,override:!1})):gr(n.message)?be({message:n.message,override:n.override}):Uy(n.message,r=>({message:r,override:n.override}))}})),Hw=e=>t=>t._tag===e,fC=Hw("Composite"),xE=Hw("Refinement"),RE=Hw("Transformation"),yl=e=>Cs(oQ(e),t=>t!==void 0?!t.override&&(fC(e)||xE(e)&&e.kind==="From"||RE(e)&&e.kind!=="Transformation")?RE(e)||xE(e)?yl(e.issue):Fy:be(t.message):Fy),hC=e=>dC(e).pipe(Fh(E7),O9(t=>t(e)),Or);function aQ(e){return cN(e).pipe(Fs(()=>oN(e)),Fs(()=>aN(e)),Fs(()=>zh(e)),ct(()=>`{ ${e.from} | filter }`))}function cQ(e){return e.message!==void 0?e.message:`Expected ${Yb(e.ast)?aQ(e.ast):String(e.ast)}, actual ${bo(e.actual)}`}const lQ=e=>Nr(yl(e),t=>t??hC(e)??cQ(e)),ld=e=>hC(e)??String(e.ast),uQ=e=>e.message??"is forbidden",dQ=e=>e.message??"is unexpected",fQ=e=>{const t=b7(e.ast);if(kt(t)){const n=t.value();return gr(n)?be(n):n}return be(e.message??"is missing")},Lo=e=>{switch(e._tag){case"Type":return Nr(lQ(e),Vt);case"Forbidden":return be(Vt(ld(e),[Vt(uQ(e))]));case"Unexpected":return be(Vt(dQ(e)));case"Missing":return Nr(fQ(e),Vt);case"Transformation":return Cs(yl(e),t=>t!==void 0?be(Vt(t)):Nr(Lo(e.issue),n=>Vt(ld(e),[Vt(sQ(e.kind),[n])])));case"Refinement":return Cs(yl(e),t=>t!==void 0?be(Vt(t)):Nr(Lo(e.issue),n=>Vt(ld(e),[Vt(iQ(e.kind),[n])])));case"Pointer":return Nr(Lo(e.issue),t=>Vt(a7(e.path),[t]));case"Composite":return Cs(yl(e),t=>{if(t!==void 0)return be(Vt(t));const n=ld(e);return WI(e.issues)?Nr(jd(e.issues,Lo),r=>Vt(n,r)):Nr(Lo(e.issues),r=>Vt(n,[r]))})}},hQ=v(e=>_s(e[0]),(e,...t)=>{const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}),pQ=v(e=>_s(e[0]),(e,...t)=>{const n={...e};for(const r of t)delete n[r];return n}),Gl=Symbol.for("effect/Schema");function lt(e){return class{[Gl]=CE;static ast=e;static annotations(n){return lt(wr(this.ast,n))}static pipe(){return X(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static[Gl]=CE}}const CE={_A:e=>e,_I:e=>e,_R:e=>e},OE={schemaId:p7,message:KI,missingMessage:Vb,identifier:zb,title:Wr,description:sc,examples:YI,default:GI,documentation:g7,jsonSchema:ZI,arbitrary:JI,pretty:XI,equivalence:QI,concurrency:eN,batching:tN,parseIssueTitle:nN,parseOptions:rN,decodingFallback:sN},hc=e=>{if(!e)return{};const t={...e};for(const n in OE)if(n in e){const r=OE[n];t[r]=e[n],delete t[n]}return t},wr=(e,t)=>Gb(e,hc(t)),Ka=e=>re(e,Gl)&&_s(e[Gl]);function gQ(e){return Wb(e)?Br.make(J7(e,t=>new X_(t))):new X_(e[0])}function pC(e,t=gQ(e)){return class extends lt(t){static annotations(r){return pC(this.literals,wr(this.ast,r))}static literals=[...e]}}function Le(...e){return Je(e)?pC(e):yC}const _Q=e=>new H7(Object.keys(e).filter(t=>typeof e[e[t]]!="number").map(t=>[t,e[t]])),gC=(e,t=_Q(e))=>class extends lt(t){static annotations(r){return gC(this.enums,wr(this.ast,r))}static enums={...e}},_C=e=>gC(e),yQ=(e,t,n)=>Ww(e,new qh(e.map(r=>r.ast),(...r)=>t.decode(...r.map(lt)),(...r)=>t.encode(...r.map(lt)),hc(n))),mQ=(e,t)=>{const n=()=>(s,i,o)=>e(s)?Py(s):WX(new Mr(o,s)),r=n;return Ww([],new qh([],n,r,hc(t)))};function Ww(e,t){return class extends lt(t){static annotations(r){return Ww(this.typeParameters,wr(this.ast,r))}static typeParameters=[...e]}}const bQ=function(){if(Array.isArray(arguments[0])){const n=arguments[0],r=arguments[1],s=arguments[2];return yQ(n,r,s)}const e=arguments[0],t=arguments[1];return mQ(e,t)};class wQ extends lt(Q_){}class yC extends lt(qb){}class Kw extends lt(dN){}class co extends lt(z7){}class we extends lt(M7){}class rn extends lt(P7){}class Yw extends lt(j7){}const kQ=e=>Br.make(e.map(t=>t.ast));function mC(e,t=kQ(e)){return class extends lt(t){static annotations(r){return mC(this.members,wr(this.ast,r))}static members=[...e]}}function Gw(...e){return Wb(e)?mC(e):Je(e)?e[0]:yC}const EQ=e=>Gw(e,wQ),TQ=(e,t)=>new Hb(e.map(n=>Ka(n)?new ic(n.ast,!1):n.ast),t.map(n=>Ka(n)?new Hh(n.ast):n.ast),!0);function bC(e,t,n=TQ(e,t)){return class extends lt(n){static annotations(s){return bC(this.elements,this.rest,wr(this.ast,s))}static elements=[...e];static rest=[...t]}}function wC(e,t){return class extends bC([],[e],t){static annotations(r){return wC(this.value,wr(this.ast,r))}static value=e}}const Ne=e=>wC(e),jy=e=>e?'"?:"':'":"';class kC extends ic{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(t,n,r,s,i){super(t,n,s),this.isReadonly=r,this.defaultValue=i}toString(){const t=jy(this.isOptional),n=String(this.type);return`PropertySignature<${t}, ${n}, never, ${t}, ${n}>`}}class vQ extends ic{isReadonly;defaultValue;constructor(t,n,r,s,i){super(t,n,s),this.isReadonly=r,this.defaultValue=i}}const SQ=e=>e===void 0?"never":gr(e)?JSON.stringify(e):String(e);class AQ{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(t,n,r,s){this.from=t,this.to=n,this.decode=r,this.encode=s}toString(){return`PropertySignature<${jy(this.to.isOptional)}, ${this.to.type}, ${SQ(this.from.fromKey)}, ${jy(this.from.isOptional)}, ${this.from.type}>`}}const EC=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new kC(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new AQ(e.from,new vQ(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},TC=Symbol.for("effect/PropertySignature"),vC=e=>re(e,TC);class Zw{ast;[Gl];[TC]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(t){this.ast=t}pipe(){return X(this,arguments)}annotations(t){return new Zw(EC(this.ast,hc(t)))}toString(){return String(this.ast)}}class Jw extends Zw{from;constructor(t,n){super(t),this.from=n}annotations(t){return new Jw(EC(this.ast,hc(t)),this.from)}}const Gt=e=>{const t=e.ast===Q_||e.ast===qb?Q_:EQ(e).ast;return new Jw(new kC(t,!0,!0,{},void 0),e)},IQ=wN([Vb]),NQ=(e,t)=>{const n=Reflect.ownKeys(e),r=[];if(n.length>0){const i=[],o=[],a=[];for(let c=0;c<n.length;c++){const l=n[c],u=e[l];if(vC(u)){const d=u.ast;switch(d._tag){case"PropertySignatureDeclaration":{const f=d.type,h=d.isOptional,p=d.annotations;i.push(new Ut(l,f,h,!0,IQ(d))),o.push(new Ut(l,It(f),h,!0,p)),r.push(new Ut(l,f,h,!0,p));break}case"PropertySignatureTransformation":{const f=d.from.fromKey??l;i.push(new Ut(f,d.from.type,d.from.isOptional,!0,d.from.annotations)),o.push(new Ut(l,d.to.type,d.to.isOptional,!0,d.to.annotations)),a.push(new Q7(f,l,d.decode,d.encode));break}}}else i.push(new Ut(l,u.ast,!1,!0)),o.push(new Ut(l,It(u.ast),!1,!0)),r.push(new Ut(l,u.ast,!1,!0))}if(Je(a)){const c=[],l=[];for(const u of t){const{indexSignatures:d,propertySignatures:f}=v1(u.key.ast,u.value.ast);f.forEach(h=>{i.push(h),o.push(new Ut(h.name,It(h.type),h.isOptional,h.isReadonly,h.annotations))}),d.forEach(h=>{c.push(h),l.push(new Wh(h.parameter,It(h.type),h.isReadonly))})}return new yN(new Vi(i,c,{[J_]:"Struct (Encoded side)"}),new Vi(o,l,{[J_]:"Struct (Type side)"}),new ez(a))}}const s=[];for(const i of t){const{indexSignatures:o,propertySignatures:a}=v1(i.key.ast,i.value.ast);a.forEach(c=>r.push(c)),o.forEach(c=>s.push(c))}return new Vi(r,s)},xQ=(e,t)=>{const n=Reflect.ownKeys(e);for(const r of n){const s=e[r];if(t[r]===void 0&&vC(s)){const i=s.ast,o=i._tag==="PropertySignatureDeclaration"?i.defaultValue:i.to.defaultValue;o!==void 0&&(t[r]=o())}}return t};function Xw(e,t,n=NQ(e,t)){return class extends lt(n){static annotations(s){return Xw(this.fields,this.records,wr(this.ast,s))}static fields={...e};static records=[...t];static make=(s,i)=>{const o=xQ(e,{...s});return RC(i)?o:cC(this)(o)};static pick(...s){return W(hQ(e,...s))}static omit(...s){return W(pQ(e,...s))}}}function W(e,...t){return Xw(e,t)}function SC(e,t,n){return class extends Xw({},[{key:e,value:t}],n){static annotations(s){return SC(e,t,wr(this.ast,s))}static key=e;static value=t}}const AC=e=>SC(e.key,e.value),IC=e=>lt(new Kb(()=>e().ast)),RQ=Symbol.for("effect/SchemaId/Refine");function NC(e,t,n){return class extends lt(n){static annotations(s){return NC(this.from,this.filter,wr(this.ast,s))}static[RQ]=e;static from=e;static filter=t;static make=(s,i)=>RC(i)?s:cC(this)(s)}}const BE=(e,t,n)=>{if($h(e))return e?G():te(new Mr(t,n));if(gr(e))return te(new Mr(t,n,e));if(e!==void 0){if("_tag"in e)return te(e);const r=new Mr(t,n,e.message);return te(Je(e.path)?new Tt(e.path,n,r):r)}return G()},CQ=(e,t,n)=>{if(o7(e))return BE(e,t,n);if(Je(e)){const r=r7(e,s=>BE(s,t,n));if(Je(r))return te(r.length===1?r[0]:new He(t,n,r))}return G()};function OQ(e,t){return n=>{function r(i,o,a){return CQ(e(i,o,a),a,i)}const s=new _N(n.ast,r,hc(t));return NC(n,r,s)}}function xC(e,t,n){return class extends lt(n){static annotations(s){return xC(this.from,this.to,wr(this.ast,s))}static from=e;static to=t}}const BQ=v(e=>Ka(e[0])&&Ka(e[1]),(e,t,n)=>xC(e,t,new yN(e.ast,t.ast,new X7(n.decode,n.encode)))),ze=v(e=>Ka(e[0])&&Ka(e[1]),(e,t,n)=>BQ(e,t,{strict:!0,decode:(r,s,i,o)=>Py(n.decode(r,o)),encode:(r,s,i,o)=>Py(n.encode(r,o))})),$E=Symbol.for("effect/SchemaId/Pattern"),$Q=(e,t)=>n=>{const r=e.source;return n.pipe(OQ(s=>(e.lastIndex=0,e.test(s)),{schemaId:$E,[$E]:{regex:e},description:`a string matching the pattern ${r}`,jsonSchema:{pattern:r},...t}))};class Ee extends bQ(FV,{identifier:"Uint8ArrayFromSelf",pretty:()=>t=>`new Uint8Array(${JSON.stringify(Array.from(t))})`,arbitrary:()=>t=>t.uint8Array(),equivalence:()=>Vh(ne)}){}function RC(e){return $h(e)?e:e?.disableValidation??!1}var DQ=class extends j{constructor(){super("google.protobuf.Empty",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ud=new DQ,MQ=class extends j{constructor(){super("types.EnumOption",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"ty",kind:"message",T:()=>Kn}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.name="",e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.name=e.string();break;case 2:s.ty=Kn.internalBinaryRead(e,e.uint32(),n,s.ty);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.name!==""&&t.tag(1,m.LengthDelimited).string(e.name),e.ty&&Kn.internalBinaryWrite(e.ty,t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},xg=new MQ,LQ=class extends j{constructor(){super("types.Enum",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"option",kind:"scalar",T:13},{no:3,name:"options",kind:"message",repeat:2,T:()=>xg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.name="",t.option=0,t.options=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.name=e.string();break;case 2:s.option=e.uint32();break;case 3:s.options.push(xg.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.name!==""&&t.tag(1,m.LengthDelimited).string(e.name),e.option!==0&&t.tag(2,m.Varint).uint32(e.option);for(let s=0;s<e.options.length;s++)xg.internalBinaryWrite(e.options[s],t.tag(3,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Rg=new LQ,UQ=class extends j{constructor(){super("types.Primitive",[{no:1,name:"i8",kind:"scalar",oneof:"primitive_type",T:5},{no:2,name:"i16",kind:"scalar",oneof:"primitive_type",T:5},{no:3,name:"i32",kind:"scalar",oneof:"primitive_type",T:5},{no:4,name:"i64",kind:"scalar",oneof:"primitive_type",T:3,L:0},{no:5,name:"i128",kind:"scalar",oneof:"primitive_type",T:12},{no:6,name:"u8",kind:"scalar",oneof:"primitive_type",T:13},{no:7,name:"u16",kind:"scalar",oneof:"primitive_type",T:13},{no:8,name:"u32",kind:"scalar",oneof:"primitive_type",T:13},{no:9,name:"u64",kind:"scalar",oneof:"primitive_type",T:4,L:0},{no:10,name:"u128",kind:"scalar",oneof:"primitive_type",T:12},{no:11,name:"u256",kind:"scalar",oneof:"primitive_type",T:12},{no:12,name:"bool",kind:"scalar",oneof:"primitive_type",T:8},{no:13,name:"felt252",kind:"scalar",oneof:"primitive_type",T:12},{no:14,name:"class_hash",kind:"scalar",localName:"class_hash",oneof:"primitive_type",T:12},{no:15,name:"contract_address",kind:"scalar",localName:"contract_address",oneof:"primitive_type",T:12},{no:16,name:"eth_address",kind:"scalar",localName:"eth_address",oneof:"primitive_type",T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.primitive_type={oneofKind:void 0},e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.primitive_type={oneofKind:"i8",i8:e.int32()};break;case 2:s.primitive_type={oneofKind:"i16",i16:e.int32()};break;case 3:s.primitive_type={oneofKind:"i32",i32:e.int32()};break;case 4:s.primitive_type={oneofKind:"i64",i64:e.int64().toBigInt()};break;case 5:s.primitive_type={oneofKind:"i128",i128:e.bytes()};break;case 6:s.primitive_type={oneofKind:"u8",u8:e.uint32()};break;case 7:s.primitive_type={oneofKind:"u16",u16:e.uint32()};break;case 8:s.primitive_type={oneofKind:"u32",u32:e.uint32()};break;case 9:s.primitive_type={oneofKind:"u64",u64:e.uint64().toBigInt()};break;case 10:s.primitive_type={oneofKind:"u128",u128:e.bytes()};break;case 11:s.primitive_type={oneofKind:"u256",u256:e.bytes()};break;case 12:s.primitive_type={oneofKind:"bool",bool:e.bool()};break;case 13:s.primitive_type={oneofKind:"felt252",felt252:e.bytes()};break;case 14:s.primitive_type={oneofKind:"class_hash",class_hash:e.bytes()};break;case 15:s.primitive_type={oneofKind:"contract_address",contract_address:e.bytes()};break;case 16:s.primitive_type={oneofKind:"eth_address",eth_address:e.bytes()};break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.primitive_type.oneofKind==="i8"&&t.tag(1,m.Varint).int32(e.primitive_type.i8),e.primitive_type.oneofKind==="i16"&&t.tag(2,m.Varint).int32(e.primitive_type.i16),e.primitive_type.oneofKind==="i32"&&t.tag(3,m.Varint).int32(e.primitive_type.i32),e.primitive_type.oneofKind==="i64"&&t.tag(4,m.Varint).int64(e.primitive_type.i64),e.primitive_type.oneofKind==="i128"&&t.tag(5,m.LengthDelimited).bytes(e.primitive_type.i128),e.primitive_type.oneofKind==="u8"&&t.tag(6,m.Varint).uint32(e.primitive_type.u8),e.primitive_type.oneofKind==="u16"&&t.tag(7,m.Varint).uint32(e.primitive_type.u16),e.primitive_type.oneofKind==="u32"&&t.tag(8,m.Varint).uint32(e.primitive_type.u32),e.primitive_type.oneofKind==="u64"&&t.tag(9,m.Varint).uint64(e.primitive_type.u64),e.primitive_type.oneofKind==="u128"&&t.tag(10,m.LengthDelimited).bytes(e.primitive_type.u128),e.primitive_type.oneofKind==="u256"&&t.tag(11,m.LengthDelimited).bytes(e.primitive_type.u256),e.primitive_type.oneofKind==="bool"&&t.tag(12,m.Varint).bool(e.primitive_type.bool),e.primitive_type.oneofKind==="felt252"&&t.tag(13,m.LengthDelimited).bytes(e.primitive_type.felt252),e.primitive_type.oneofKind==="class_hash"&&t.tag(14,m.LengthDelimited).bytes(e.primitive_type.class_hash),e.primitive_type.oneofKind==="contract_address"&&t.tag(15,m.LengthDelimited).bytes(e.primitive_type.contract_address),e.primitive_type.oneofKind==="eth_address"&&t.tag(16,m.LengthDelimited).bytes(e.primitive_type.eth_address);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ta=new UQ,PQ=class extends j{constructor(){super("types.Struct",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"children",kind:"message",repeat:2,T:()=>Og}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.name="",t.children=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.name=e.string();break;case 2:s.children.push(Og.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.name!==""&&t.tag(1,m.LengthDelimited).string(e.name);for(let s=0;s<e.children.length;s++)Og.internalBinaryWrite(e.children[s],t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},na=new PQ,FQ=class extends j{constructor(){super("types.Array",[{no:1,name:"children",kind:"message",repeat:2,T:()=>Kn}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.children=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.children.push(Kn.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.children.length;s++)Kn.internalBinaryWrite(e.children[s],t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},$o=new FQ,jQ=class extends j{constructor(){super("types.FixedSizeArray",[{no:1,name:"children",kind:"message",repeat:2,T:()=>Kn},{no:2,name:"size",kind:"scalar",T:13}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.children=[],t.size=0,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.children.push(Kn.internalBinaryRead(e,e.uint32(),n));break;case 2:s.size=e.uint32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.children.length;s++)Kn.internalBinaryWrite(e.children[s],t.tag(1,m.LengthDelimited).fork(),n).join();e.size!==0&&t.tag(2,m.Varint).uint32(e.size);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Cg=new jQ,VQ=class extends j{constructor(){super("types.Ty",[{no:2,name:"primitive",kind:"message",oneof:"ty_type",T:()=>ta},{no:3,name:"enum",kind:"message",oneof:"ty_type",T:()=>Rg},{no:4,name:"struct",kind:"message",oneof:"ty_type",T:()=>na},{no:5,name:"tuple",kind:"message",oneof:"ty_type",T:()=>$o},{no:6,name:"array",kind:"message",oneof:"ty_type",T:()=>$o},{no:7,name:"bytearray",kind:"scalar",oneof:"ty_type",T:9},{no:8,name:"fixed_size_array",kind:"message",localName:"fixed_size_array",oneof:"ty_type",T:()=>Cg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.ty_type={oneofKind:void 0},e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 2:s.ty_type={oneofKind:"primitive",primitive:ta.internalBinaryRead(e,e.uint32(),n,s.ty_type.primitive)};break;case 3:s.ty_type={oneofKind:"enum",enum:Rg.internalBinaryRead(e,e.uint32(),n,s.ty_type.enum)};break;case 4:s.ty_type={oneofKind:"struct",struct:na.internalBinaryRead(e,e.uint32(),n,s.ty_type.struct)};break;case 5:s.ty_type={oneofKind:"tuple",tuple:$o.internalBinaryRead(e,e.uint32(),n,s.ty_type.tuple)};break;case 6:s.ty_type={oneofKind:"array",array:$o.internalBinaryRead(e,e.uint32(),n,s.ty_type.array)};break;case 7:s.ty_type={oneofKind:"bytearray",bytearray:e.string()};break;case 8:s.ty_type={oneofKind:"fixed_size_array",fixed_size_array:Cg.internalBinaryRead(e,e.uint32(),n,s.ty_type.fixed_size_array)};break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.ty_type.oneofKind==="primitive"&&ta.internalBinaryWrite(e.ty_type.primitive,t.tag(2,m.LengthDelimited).fork(),n).join(),e.ty_type.oneofKind==="enum"&&Rg.internalBinaryWrite(e.ty_type.enum,t.tag(3,m.LengthDelimited).fork(),n).join(),e.ty_type.oneofKind==="struct"&&na.internalBinaryWrite(e.ty_type.struct,t.tag(4,m.LengthDelimited).fork(),n).join(),e.ty_type.oneofKind==="tuple"&&$o.internalBinaryWrite(e.ty_type.tuple,t.tag(5,m.LengthDelimited).fork(),n).join(),e.ty_type.oneofKind==="array"&&$o.internalBinaryWrite(e.ty_type.array,t.tag(6,m.LengthDelimited).fork(),n).join(),e.ty_type.oneofKind==="bytearray"&&t.tag(7,m.LengthDelimited).string(e.ty_type.bytearray),e.ty_type.oneofKind==="fixed_size_array"&&Cg.internalBinaryWrite(e.ty_type.fixed_size_array,t.tag(8,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Kn=new VQ,zQ=class extends j{constructor(){super("types.Member",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"ty",kind:"message",T:()=>Kn},{no:3,name:"key",kind:"scalar",T:8}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.name="",t.key=!1,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.name=e.string();break;case 2:s.ty=Kn.internalBinaryRead(e,e.uint32(),n,s.ty);break;case 3:s.key=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.name!==""&&t.tag(1,m.LengthDelimited).string(e.name),e.ty&&Kn.internalBinaryWrite(e.ty,t.tag(2,m.LengthDelimited).fork(),n).join(),e.key!==!1&&t.tag(3,m.Varint).bool(e.key);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Og=new zQ,CC=(e=>(e[e.FixedLen=0]="FixedLen",e[e.VariableLen=1]="VariableLen",e))(CC||{}),OC=(e=>(e[e.AND=0]="AND",e[e.OR=1]="OR",e))(OC||{}),BC=(e=>(e[e.EQ=0]="EQ",e[e.NEQ=1]="NEQ",e[e.GT=2]="GT",e[e.GTE=3]="GTE",e[e.LT=4]="LT",e[e.LTE=5]="LTE",e[e.IN=6]="IN",e[e.NOT_IN=7]="NOT_IN",e[e.CONTAINS=8]="CONTAINS",e[e.CONTAINS_ALL=9]="CONTAINS_ALL",e[e.CONTAINS_ANY=10]="CONTAINS_ANY",e[e.ARRAY_LENGTH_EQ=11]="ARRAY_LENGTH_EQ",e[e.ARRAY_LENGTH_GT=12]="ARRAY_LENGTH_GT",e[e.ARRAY_LENGTH_LT=13]="ARRAY_LENGTH_LT",e))(BC||{}),$C=(e=>(e[e.ASC=0]="ASC",e[e.DESC=1]="DESC",e))($C||{}),DC=(e=>(e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD",e))(DC||{}),MC=(e=>(e[e.EXECUTE=0]="EXECUTE",e[e.EXECUTE_FROM_OUTSIDE=1]="EXECUTE_FROM_OUTSIDE",e))(MC||{}),Qw=(e=>(e[e.WORLD=0]="WORLD",e[e.ERC20=1]="ERC20",e[e.ERC721=2]="ERC721",e[e.ERC1155=3]="ERC1155",e[e.UDC=4]="UDC",e[e.OTHER=5]="OTHER",e))(Qw||{}),qQ=class extends j{constructor(){super("types.World",[{no:1,name:"world_address",kind:"scalar",localName:"world_address",T:9},{no:2,name:"models",kind:"message",repeat:2,T:()=>$g}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.world_address="",t.models=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.world_address=e.string();break;case 2:s.models.push($g.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.world_address!==""&&t.tag(1,m.LengthDelimited).string(e.world_address);for(let s=0;s<e.models.length;s++)$g.internalBinaryWrite(e.models[s],t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Bg=new qQ,HQ=class extends j{constructor(){super("types.Model",[{no:1,name:"selector",kind:"scalar",T:12},{no:2,name:"namespace",kind:"scalar",T:9},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"packed_size",kind:"scalar",localName:"packed_size",T:13},{no:5,name:"unpacked_size",kind:"scalar",localName:"unpacked_size",T:13},{no:6,name:"class_hash",kind:"scalar",localName:"class_hash",T:12},{no:7,name:"layout",kind:"scalar",T:12},{no:8,name:"schema",kind:"scalar",T:12},{no:9,name:"contract_address",kind:"scalar",localName:"contract_address",T:12},{no:10,name:"use_legacy_store",kind:"scalar",localName:"use_legacy_store",T:8}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.selector=new Uint8Array(0),t.namespace="",t.name="",t.packed_size=0,t.unpacked_size=0,t.class_hash=new Uint8Array(0),t.layout=new Uint8Array(0),t.schema=new Uint8Array(0),t.contract_address=new Uint8Array(0),t.use_legacy_store=!1,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.selector=e.bytes();break;case 2:s.namespace=e.string();break;case 3:s.name=e.string();break;case 4:s.packed_size=e.uint32();break;case 5:s.unpacked_size=e.uint32();break;case 6:s.class_hash=e.bytes();break;case 7:s.layout=e.bytes();break;case 8:s.schema=e.bytes();break;case 9:s.contract_address=e.bytes();break;case 10:s.use_legacy_store=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.selector.length&&t.tag(1,m.LengthDelimited).bytes(e.selector),e.namespace!==""&&t.tag(2,m.LengthDelimited).string(e.namespace),e.name!==""&&t.tag(3,m.LengthDelimited).string(e.name),e.packed_size!==0&&t.tag(4,m.Varint).uint32(e.packed_size),e.unpacked_size!==0&&t.tag(5,m.Varint).uint32(e.unpacked_size),e.class_hash.length&&t.tag(6,m.LengthDelimited).bytes(e.class_hash),e.layout.length&&t.tag(7,m.LengthDelimited).bytes(e.layout),e.schema.length&&t.tag(8,m.LengthDelimited).bytes(e.schema),e.contract_address.length&&t.tag(9,m.LengthDelimited).bytes(e.contract_address),e.use_legacy_store!==!1&&t.tag(10,m.Varint).bool(e.use_legacy_store);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},$g=new HQ,WQ=class extends j{constructor(){super("types.Entity",[{no:1,name:"hashed_keys",kind:"scalar",localName:"hashed_keys",T:12},{no:2,name:"models",kind:"message",repeat:2,T:()=>na},{no:3,name:"created_at",kind:"scalar",localName:"created_at",T:4,L:0},{no:4,name:"updated_at",kind:"scalar",localName:"updated_at",T:4,L:0},{no:5,name:"executed_at",kind:"scalar",localName:"executed_at",T:4,L:0}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.hashed_keys=new Uint8Array(0),t.models=[],t.created_at=0n,t.updated_at=0n,t.executed_at=0n,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.hashed_keys=e.bytes();break;case 2:s.models.push(na.internalBinaryRead(e,e.uint32(),n));break;case 3:s.created_at=e.uint64().toBigInt();break;case 4:s.updated_at=e.uint64().toBigInt();break;case 5:s.executed_at=e.uint64().toBigInt();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.hashed_keys.length&&t.tag(1,m.LengthDelimited).bytes(e.hashed_keys);for(let s=0;s<e.models.length;s++)na.internalBinaryWrite(e.models[s],t.tag(2,m.LengthDelimited).fork(),n).join();e.created_at!==0n&&t.tag(3,m.Varint).uint64(e.created_at),e.updated_at!==0n&&t.tag(4,m.Varint).uint64(e.updated_at),e.executed_at!==0n&&t.tag(5,m.Varint).uint64(e.executed_at);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ra=new WQ,KQ=class extends j{constructor(){super("types.Event",[{no:1,name:"keys",kind:"scalar",repeat:2,T:12},{no:2,name:"data",kind:"scalar",repeat:2,T:12},{no:3,name:"transaction_hash",kind:"scalar",localName:"transaction_hash",T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.keys=[],t.data=[],t.transaction_hash=new Uint8Array(0),e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.keys.push(e.bytes());break;case 2:s.data.push(e.bytes());break;case 3:s.transaction_hash=e.bytes();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.keys.length;s++)t.tag(1,m.LengthDelimited).bytes(e.keys[s]);for(let s=0;s<e.data.length;s++)t.tag(2,m.LengthDelimited).bytes(e.data[s]);e.transaction_hash.length&&t.tag(3,m.LengthDelimited).bytes(e.transaction_hash);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},sa=new KQ,YQ=class extends j{constructor(){super("types.Query",[{no:1,name:"clause",kind:"message",T:()=>yt},{no:2,name:"no_hashed_keys",kind:"scalar",localName:"no_hashed_keys",T:8},{no:3,name:"models",kind:"scalar",repeat:2,T:9},{no:4,name:"pagination",kind:"message",T:()=>mt},{no:5,name:"historical",kind:"scalar",T:8}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.no_hashed_keys=!1,t.models=[],t.historical=!1,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.clause=yt.internalBinaryRead(e,e.uint32(),n,s.clause);break;case 2:s.no_hashed_keys=e.bool();break;case 3:s.models.push(e.string());break;case 4:s.pagination=mt.internalBinaryRead(e,e.uint32(),n,s.pagination);break;case 5:s.historical=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.clause&&yt.internalBinaryWrite(e.clause,t.tag(1,m.LengthDelimited).fork(),n).join(),e.no_hashed_keys!==!1&&t.tag(2,m.Varint).bool(e.no_hashed_keys);for(let s=0;s<e.models.length;s++)t.tag(3,m.LengthDelimited).string(e.models[s]);e.pagination&&mt.internalBinaryWrite(e.pagination,t.tag(4,m.LengthDelimited).fork(),n).join(),e.historical!==!1&&t.tag(5,m.Varint).bool(e.historical);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ia=new YQ,GQ=class extends j{constructor(){super("types.EventQuery",[{no:1,name:"keys",kind:"message",T:()=>us},{no:2,name:"pagination",kind:"message",T:()=>mt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.keys=us.internalBinaryRead(e,e.uint32(),n,s.keys);break;case 2:s.pagination=mt.internalBinaryRead(e,e.uint32(),n,s.pagination);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.keys&&us.internalBinaryWrite(e.keys,t.tag(1,m.LengthDelimited).fork(),n).join(),e.pagination&&mt.internalBinaryWrite(e.pagination,t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Dg=new GQ,ZQ=class extends j{constructor(){super("types.Clause",[{no:1,name:"hashed_keys",kind:"message",localName:"hashed_keys",oneof:"clause_type",T:()=>Mg},{no:2,name:"keys",kind:"message",oneof:"clause_type",T:()=>us},{no:3,name:"member",kind:"message",oneof:"clause_type",T:()=>Ug},{no:4,name:"composite",kind:"message",oneof:"clause_type",T:()=>Pg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.clause_type={oneofKind:void 0},e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.clause_type={oneofKind:"hashed_keys",hashed_keys:Mg.internalBinaryRead(e,e.uint32(),n,s.clause_type.hashed_keys)};break;case 2:s.clause_type={oneofKind:"keys",keys:us.internalBinaryRead(e,e.uint32(),n,s.clause_type.keys)};break;case 3:s.clause_type={oneofKind:"member",member:Ug.internalBinaryRead(e,e.uint32(),n,s.clause_type.member)};break;case 4:s.clause_type={oneofKind:"composite",composite:Pg.internalBinaryRead(e,e.uint32(),n,s.clause_type.composite)};break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.clause_type.oneofKind==="hashed_keys"&&Mg.internalBinaryWrite(e.clause_type.hashed_keys,t.tag(1,m.LengthDelimited).fork(),n).join(),e.clause_type.oneofKind==="keys"&&us.internalBinaryWrite(e.clause_type.keys,t.tag(2,m.LengthDelimited).fork(),n).join(),e.clause_type.oneofKind==="member"&&Ug.internalBinaryWrite(e.clause_type.member,t.tag(3,m.LengthDelimited).fork(),n).join(),e.clause_type.oneofKind==="composite"&&Pg.internalBinaryWrite(e.clause_type.composite,t.tag(4,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},yt=new ZQ,JQ=class extends j{constructor(){super("types.KeysClause",[{no:2,name:"keys",kind:"scalar",repeat:2,T:12},{no:3,name:"pattern_matching",kind:"enum",localName:"pattern_matching",T:()=>["types.PatternMatching",CC]},{no:4,name:"models",kind:"scalar",repeat:2,T:9}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.keys=[],t.pattern_matching=0,t.models=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 2:s.keys.push(e.bytes());break;case 3:s.pattern_matching=e.int32();break;case 4:s.models.push(e.string());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.keys.length;s++)t.tag(2,m.LengthDelimited).bytes(e.keys[s]);e.pattern_matching!==0&&t.tag(3,m.Varint).int32(e.pattern_matching);for(let s=0;s<e.models.length;s++)t.tag(4,m.LengthDelimited).string(e.models[s]);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},us=new JQ,XQ=class extends j{constructor(){super("types.HashedKeysClause",[{no:1,name:"hashed_keys",kind:"scalar",localName:"hashed_keys",repeat:2,T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.hashed_keys=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.hashed_keys.push(e.bytes());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.hashed_keys.length;s++)t.tag(1,m.LengthDelimited).bytes(e.hashed_keys[s]);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Mg=new XQ,QQ=class extends j{constructor(){super("types.MemberValue",[{no:1,name:"primitive",kind:"message",oneof:"value_type",T:()=>ta},{no:2,name:"string",kind:"scalar",oneof:"value_type",T:9},{no:3,name:"list",kind:"message",oneof:"value_type",T:()=>Lg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.value_type={oneofKind:void 0},e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.value_type={oneofKind:"primitive",primitive:ta.internalBinaryRead(e,e.uint32(),n,s.value_type.primitive)};break;case 2:s.value_type={oneofKind:"string",string:e.string()};break;case 3:s.value_type={oneofKind:"list",list:Lg.internalBinaryRead(e,e.uint32(),n,s.value_type.list)};break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.value_type.oneofKind==="primitive"&&ta.internalBinaryWrite(e.value_type.primitive,t.tag(1,m.LengthDelimited).fork(),n).join(),e.value_type.oneofKind==="string"&&t.tag(2,m.LengthDelimited).string(e.value_type.string),e.value_type.oneofKind==="list"&&Lg.internalBinaryWrite(e.value_type.list,t.tag(3,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},oa=new QQ,eee=class extends j{constructor(){super("types.MemberValueList",[{no:1,name:"values",kind:"message",repeat:2,T:()=>oa}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.values=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.values.push(oa.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.values.length;s++)oa.internalBinaryWrite(e.values[s],t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Lg=new eee,tee=class extends j{constructor(){super("types.MemberClause",[{no:2,name:"model",kind:"scalar",T:9},{no:3,name:"member",kind:"scalar",T:9},{no:4,name:"operator",kind:"enum",T:()=>["types.ComparisonOperator",BC]},{no:5,name:"value",kind:"message",T:()=>oa}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.model="",t.member="",t.operator=0,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 2:s.model=e.string();break;case 3:s.member=e.string();break;case 4:s.operator=e.int32();break;case 5:s.value=oa.internalBinaryRead(e,e.uint32(),n,s.value);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.model!==""&&t.tag(2,m.LengthDelimited).string(e.model),e.member!==""&&t.tag(3,m.LengthDelimited).string(e.member),e.operator!==0&&t.tag(4,m.Varint).int32(e.operator),e.value&&oa.internalBinaryWrite(e.value,t.tag(5,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Ug=new tee,nee=class extends j{constructor(){super("types.CompositeClause",[{no:3,name:"operator",kind:"enum",T:()=>["types.LogicalOperator",OC]},{no:4,name:"clauses",kind:"message",repeat:2,T:()=>yt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.operator=0,t.clauses=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 3:s.operator=e.int32();break;case 4:s.clauses.push(yt.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.operator!==0&&t.tag(3,m.Varint).int32(e.operator);for(let s=0;s<e.clauses.length;s++)yt.internalBinaryWrite(e.clauses[s],t.tag(4,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Pg=new nee,ree=class extends j{constructor(){super("types.Token",[{no:1,name:"token_id",kind:"scalar",localName:"token_id",opt:!0,T:12},{no:2,name:"contract_address",kind:"scalar",localName:"contract_address",T:12},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"symbol",kind:"scalar",T:9},{no:5,name:"decimals",kind:"scalar",T:13},{no:6,name:"metadata",kind:"scalar",T:12},{no:7,name:"total_supply",kind:"scalar",localName:"total_supply",opt:!0,T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.contract_address=new Uint8Array(0),t.name="",t.symbol="",t.decimals=0,t.metadata=new Uint8Array(0),e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.token_id=e.bytes();break;case 2:s.contract_address=e.bytes();break;case 3:s.name=e.string();break;case 4:s.symbol=e.string();break;case 5:s.decimals=e.uint32();break;case 6:s.metadata=e.bytes();break;case 7:s.total_supply=e.bytes();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.token_id!==void 0&&t.tag(1,m.LengthDelimited).bytes(e.token_id),e.contract_address.length&&t.tag(2,m.LengthDelimited).bytes(e.contract_address),e.name!==""&&t.tag(3,m.LengthDelimited).string(e.name),e.symbol!==""&&t.tag(4,m.LengthDelimited).string(e.symbol),e.decimals!==0&&t.tag(5,m.Varint).uint32(e.decimals),e.metadata.length&&t.tag(6,m.LengthDelimited).bytes(e.metadata),e.total_supply!==void 0&&t.tag(7,m.LengthDelimited).bytes(e.total_supply);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},aa=new ree,see=class extends j{constructor(){super("types.TokenContract",[{no:2,name:"contract_address",kind:"scalar",localName:"contract_address",T:12},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"symbol",kind:"scalar",T:9},{no:5,name:"decimals",kind:"scalar",T:13},{no:6,name:"count",kind:"scalar",T:13},{no:7,name:"metadata",kind:"scalar",T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.contract_address=new Uint8Array(0),t.name="",t.symbol="",t.decimals=0,t.count=0,t.metadata=new Uint8Array(0),e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 2:s.contract_address=e.bytes();break;case 3:s.name=e.string();break;case 4:s.symbol=e.string();break;case 5:s.decimals=e.uint32();break;case 6:s.count=e.uint32();break;case 7:s.metadata=e.bytes();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.contract_address.length&&t.tag(2,m.LengthDelimited).bytes(e.contract_address),e.name!==""&&t.tag(3,m.LengthDelimited).string(e.name),e.symbol!==""&&t.tag(4,m.LengthDelimited).string(e.symbol),e.decimals!==0&&t.tag(5,m.Varint).uint32(e.decimals),e.count!==0&&t.tag(6,m.Varint).uint32(e.count),e.metadata.length&&t.tag(7,m.LengthDelimited).bytes(e.metadata);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Fg=new see,iee=class extends j{constructor(){super("types.TokenBalance",[{no:1,name:"balance",kind:"scalar",T:12},{no:2,name:"account_address",kind:"scalar",localName:"account_address",T:12},{no:3,name:"contract_address",kind:"scalar",localName:"contract_address",T:12},{no:4,name:"token_id",kind:"scalar",localName:"token_id",opt:!0,T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.balance=new Uint8Array(0),t.account_address=new Uint8Array(0),t.contract_address=new Uint8Array(0),e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.balance=e.bytes();break;case 2:s.account_address=e.bytes();break;case 3:s.contract_address=e.bytes();break;case 4:s.token_id=e.bytes();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.balance.length&&t.tag(1,m.LengthDelimited).bytes(e.balance),e.account_address.length&&t.tag(2,m.LengthDelimited).bytes(e.account_address),e.contract_address.length&&t.tag(3,m.LengthDelimited).bytes(e.contract_address),e.token_id!==void 0&&t.tag(4,m.LengthDelimited).bytes(e.token_id);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ca=new iee,oee=class extends j{constructor(){super("types.OrderBy",[{no:1,name:"field",kind:"scalar",T:9},{no:2,name:"direction",kind:"enum",T:()=>["types.OrderDirection",$C]}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.field="",t.direction=0,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.field=e.string();break;case 2:s.direction=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.field!==""&&t.tag(1,m.LengthDelimited).string(e.field),e.direction!==0&&t.tag(2,m.Varint).int32(e.direction);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},jg=new oee,aee=class extends j{constructor(){super("types.Controller",[{no:1,name:"address",kind:"scalar",T:12},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"deployed_at_timestamp",kind:"scalar",localName:"deployed_at_timestamp",T:4,L:0}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.address=new Uint8Array(0),t.username="",t.deployed_at_timestamp=0n,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.address=e.bytes();break;case 2:s.username=e.string();break;case 3:s.deployed_at_timestamp=e.uint64().toBigInt();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.address.length&&t.tag(1,m.LengthDelimited).bytes(e.address),e.username!==""&&t.tag(2,m.LengthDelimited).string(e.username),e.deployed_at_timestamp!==0n&&t.tag(3,m.Varint).uint64(e.deployed_at_timestamp);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Vg=new aee,cee=class extends j{constructor(){super("types.Pagination",[{no:1,name:"cursor",kind:"scalar",T:9},{no:2,name:"limit",kind:"scalar",T:13},{no:3,name:"direction",kind:"enum",T:()=>["types.PaginationDirection",DC]},{no:4,name:"order_by",kind:"message",localName:"order_by",repeat:2,T:()=>jg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.cursor="",t.limit=0,t.direction=0,t.order_by=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.cursor=e.string();break;case 2:s.limit=e.uint32();break;case 3:s.direction=e.int32();break;case 4:s.order_by.push(jg.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.cursor!==""&&t.tag(1,m.LengthDelimited).string(e.cursor),e.limit!==0&&t.tag(2,m.Varint).uint32(e.limit),e.direction!==0&&t.tag(3,m.Varint).int32(e.direction);for(let s=0;s<e.order_by.length;s++)jg.internalBinaryWrite(e.order_by[s],t.tag(4,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},mt=new cee,lee=class extends j{constructor(){super("types.ControllerQuery",[{no:1,name:"contract_addresses",kind:"scalar",localName:"contract_addresses",repeat:2,T:12},{no:2,name:"usernames",kind:"scalar",repeat:2,T:9},{no:3,name:"pagination",kind:"message",T:()=>mt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.contract_addresses=[],t.usernames=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.contract_addresses.push(e.bytes());break;case 2:s.usernames.push(e.string());break;case 3:s.pagination=mt.internalBinaryRead(e,e.uint32(),n,s.pagination);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.contract_addresses.length;s++)t.tag(1,m.LengthDelimited).bytes(e.contract_addresses[s]);for(let s=0;s<e.usernames.length;s++)t.tag(2,m.LengthDelimited).string(e.usernames[s]);e.pagination&&mt.internalBinaryWrite(e.pagination,t.tag(3,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},zg=new lee,uee=class extends j{constructor(){super("types.TokenQuery",[{no:1,name:"contract_addresses",kind:"scalar",localName:"contract_addresses",repeat:2,T:12},{no:2,name:"token_ids",kind:"scalar",localName:"token_ids",repeat:2,T:12},{no:3,name:"pagination",kind:"message",T:()=>mt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.contract_addresses=[],t.token_ids=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.contract_addresses.push(e.bytes());break;case 2:s.token_ids.push(e.bytes());break;case 3:s.pagination=mt.internalBinaryRead(e,e.uint32(),n,s.pagination);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.contract_addresses.length;s++)t.tag(1,m.LengthDelimited).bytes(e.contract_addresses[s]);for(let s=0;s<e.token_ids.length;s++)t.tag(2,m.LengthDelimited).bytes(e.token_ids[s]);e.pagination&&mt.internalBinaryWrite(e.pagination,t.tag(3,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},qg=new uee,dee=class extends j{constructor(){super("types.TokenBalanceQuery",[{no:1,name:"account_addresses",kind:"scalar",localName:"account_addresses",repeat:2,T:12},{no:2,name:"contract_addresses",kind:"scalar",localName:"contract_addresses",repeat:2,T:12},{no:3,name:"token_ids",kind:"scalar",localName:"token_ids",repeat:2,T:12},{no:4,name:"pagination",kind:"message",T:()=>mt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.account_addresses=[],t.contract_addresses=[],t.token_ids=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.account_addresses.push(e.bytes());break;case 2:s.contract_addresses.push(e.bytes());break;case 3:s.token_ids.push(e.bytes());break;case 4:s.pagination=mt.internalBinaryRead(e,e.uint32(),n,s.pagination);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.account_addresses.length;s++)t.tag(1,m.LengthDelimited).bytes(e.account_addresses[s]);for(let s=0;s<e.contract_addresses.length;s++)t.tag(2,m.LengthDelimited).bytes(e.contract_addresses[s]);for(let s=0;s<e.token_ids.length;s++)t.tag(3,m.LengthDelimited).bytes(e.token_ids[s]);e.pagination&&mt.internalBinaryWrite(e.pagination,t.tag(4,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},la=new dee,fee=class extends j{constructor(){super("types.TransactionCall",[{no:1,name:"contract_address",kind:"scalar",localName:"contract_address",T:12},{no:2,name:"entrypoint",kind:"scalar",T:9},{no:3,name:"calldata",kind:"scalar",repeat:2,T:12},{no:4,name:"call_type",kind:"enum",localName:"call_type",T:()=>["types.CallType",MC]},{no:5,name:"caller_address",kind:"scalar",localName:"caller_address",T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.contract_address=new Uint8Array(0),t.entrypoint="",t.calldata=[],t.call_type=0,t.caller_address=new Uint8Array(0),e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.contract_address=e.bytes();break;case 2:s.entrypoint=e.string();break;case 3:s.calldata.push(e.bytes());break;case 4:s.call_type=e.int32();break;case 5:s.caller_address=e.bytes();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.contract_address.length&&t.tag(1,m.LengthDelimited).bytes(e.contract_address),e.entrypoint!==""&&t.tag(2,m.LengthDelimited).string(e.entrypoint);for(let s=0;s<e.calldata.length;s++)t.tag(3,m.LengthDelimited).bytes(e.calldata[s]);e.call_type!==0&&t.tag(4,m.Varint).int32(e.call_type),e.caller_address.length&&t.tag(5,m.LengthDelimited).bytes(e.caller_address);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Hg=new fee,hee=class extends j{constructor(){super("types.Transaction",[{no:1,name:"transaction_hash",kind:"scalar",localName:"transaction_hash",T:12},{no:2,name:"sender_address",kind:"scalar",localName:"sender_address",T:12},{no:3,name:"calldata",kind:"scalar",repeat:2,T:12},{no:4,name:"max_fee",kind:"scalar",localName:"max_fee",T:12},{no:5,name:"signature",kind:"scalar",repeat:2,T:12},{no:6,name:"nonce",kind:"scalar",T:12},{no:7,name:"block_number",kind:"scalar",localName:"block_number",T:4,L:0},{no:8,name:"transaction_type",kind:"scalar",localName:"transaction_type",T:9},{no:9,name:"block_timestamp",kind:"scalar",localName:"block_timestamp",T:4,L:0},{no:10,name:"calls",kind:"message",repeat:2,T:()=>Hg},{no:11,name:"unique_models",kind:"scalar",localName:"unique_models",repeat:2,T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.transaction_hash=new Uint8Array(0),t.sender_address=new Uint8Array(0),t.calldata=[],t.max_fee=new Uint8Array(0),t.signature=[],t.nonce=new Uint8Array(0),t.block_number=0n,t.transaction_type="",t.block_timestamp=0n,t.calls=[],t.unique_models=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.transaction_hash=e.bytes();break;case 2:s.sender_address=e.bytes();break;case 3:s.calldata.push(e.bytes());break;case 4:s.max_fee=e.bytes();break;case 5:s.signature.push(e.bytes());break;case 6:s.nonce=e.bytes();break;case 7:s.block_number=e.uint64().toBigInt();break;case 8:s.transaction_type=e.string();break;case 9:s.block_timestamp=e.uint64().toBigInt();break;case 10:s.calls.push(Hg.internalBinaryRead(e,e.uint32(),n));break;case 11:s.unique_models.push(e.bytes());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.transaction_hash.length&&t.tag(1,m.LengthDelimited).bytes(e.transaction_hash),e.sender_address.length&&t.tag(2,m.LengthDelimited).bytes(e.sender_address);for(let s=0;s<e.calldata.length;s++)t.tag(3,m.LengthDelimited).bytes(e.calldata[s]);e.max_fee.length&&t.tag(4,m.LengthDelimited).bytes(e.max_fee);for(let s=0;s<e.signature.length;s++)t.tag(5,m.LengthDelimited).bytes(e.signature[s]);e.nonce.length&&t.tag(6,m.LengthDelimited).bytes(e.nonce),e.block_number!==0n&&t.tag(7,m.Varint).uint64(e.block_number),e.transaction_type!==""&&t.tag(8,m.LengthDelimited).string(e.transaction_type),e.block_timestamp!==0n&&t.tag(9,m.Varint).uint64(e.block_timestamp);for(let s=0;s<e.calls.length;s++)Hg.internalBinaryWrite(e.calls[s],t.tag(10,m.LengthDelimited).fork(),n).join();for(let s=0;s<e.unique_models.length;s++)t.tag(11,m.LengthDelimited).bytes(e.unique_models[s]);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ua=new hee,pee=class extends j{constructor(){super("types.TransactionFilter",[{no:1,name:"transaction_hashes",kind:"scalar",localName:"transaction_hashes",repeat:2,T:12},{no:2,name:"caller_addresses",kind:"scalar",localName:"caller_addresses",repeat:2,T:12},{no:3,name:"contract_addresses",kind:"scalar",localName:"contract_addresses",repeat:2,T:12},{no:4,name:"entrypoints",kind:"scalar",repeat:2,T:9},{no:5,name:"model_selectors",kind:"scalar",localName:"model_selectors",repeat:2,T:12},{no:6,name:"from_block",kind:"scalar",localName:"from_block",opt:!0,T:4,L:0},{no:7,name:"to_block",kind:"scalar",localName:"to_block",opt:!0,T:4,L:0}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.transaction_hashes=[],t.caller_addresses=[],t.contract_addresses=[],t.entrypoints=[],t.model_selectors=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.transaction_hashes.push(e.bytes());break;case 2:s.caller_addresses.push(e.bytes());break;case 3:s.contract_addresses.push(e.bytes());break;case 4:s.entrypoints.push(e.string());break;case 5:s.model_selectors.push(e.bytes());break;case 6:s.from_block=e.uint64().toBigInt();break;case 7:s.to_block=e.uint64().toBigInt();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.transaction_hashes.length;s++)t.tag(1,m.LengthDelimited).bytes(e.transaction_hashes[s]);for(let s=0;s<e.caller_addresses.length;s++)t.tag(2,m.LengthDelimited).bytes(e.caller_addresses[s]);for(let s=0;s<e.contract_addresses.length;s++)t.tag(3,m.LengthDelimited).bytes(e.contract_addresses[s]);for(let s=0;s<e.entrypoints.length;s++)t.tag(4,m.LengthDelimited).string(e.entrypoints[s]);for(let s=0;s<e.model_selectors.length;s++)t.tag(5,m.LengthDelimited).bytes(e.model_selectors[s]);e.from_block!==void 0&&t.tag(6,m.Varint).uint64(e.from_block),e.to_block!==void 0&&t.tag(7,m.Varint).uint64(e.to_block);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},da=new pee,gee=class extends j{constructor(){super("types.TransactionQuery",[{no:1,name:"filter",kind:"message",T:()=>da},{no:2,name:"pagination",kind:"message",T:()=>mt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.filter=da.internalBinaryRead(e,e.uint32(),n,s.filter);break;case 2:s.pagination=mt.internalBinaryRead(e,e.uint32(),n,s.pagination);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.filter&&da.internalBinaryWrite(e.filter,t.tag(1,m.LengthDelimited).fork(),n).join(),e.pagination&&mt.internalBinaryWrite(e.pagination,t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Wg=new gee,_ee=class extends j{constructor(){super("types.Contract",[{no:1,name:"contract_address",kind:"scalar",localName:"contract_address",T:12},{no:2,name:"contract_type",kind:"enum",localName:"contract_type",T:()=>["types.ContractType",Qw]},{no:3,name:"head",kind:"scalar",opt:!0,T:4,L:0},{no:4,name:"tps",kind:"scalar",opt:!0,T:4,L:0},{no:5,name:"last_block_timestamp",kind:"scalar",localName:"last_block_timestamp",opt:!0,T:4,L:0},{no:6,name:"last_pending_block_tx",kind:"scalar",localName:"last_pending_block_tx",opt:!0,T:12},{no:7,name:"updated_at",kind:"scalar",localName:"updated_at",T:4,L:0},{no:8,name:"created_at",kind:"scalar",localName:"created_at",T:4,L:0}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.contract_address=new Uint8Array(0),t.contract_type=0,t.updated_at=0n,t.created_at=0n,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.contract_address=e.bytes();break;case 2:s.contract_type=e.int32();break;case 3:s.head=e.uint64().toBigInt();break;case 4:s.tps=e.uint64().toBigInt();break;case 5:s.last_block_timestamp=e.uint64().toBigInt();break;case 6:s.last_pending_block_tx=e.bytes();break;case 7:s.updated_at=e.uint64().toBigInt();break;case 8:s.created_at=e.uint64().toBigInt();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.contract_address.length&&t.tag(1,m.LengthDelimited).bytes(e.contract_address),e.contract_type!==0&&t.tag(2,m.Varint).int32(e.contract_type),e.head!==void 0&&t.tag(3,m.Varint).uint64(e.head),e.tps!==void 0&&t.tag(4,m.Varint).uint64(e.tps),e.last_block_timestamp!==void 0&&t.tag(5,m.Varint).uint64(e.last_block_timestamp),e.last_pending_block_tx!==void 0&&t.tag(6,m.LengthDelimited).bytes(e.last_pending_block_tx),e.updated_at!==0n&&t.tag(7,m.Varint).uint64(e.updated_at),e.created_at!==0n&&t.tag(8,m.Varint).uint64(e.created_at);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},fa=new _ee,yee=class extends j{constructor(){super("types.ContractQuery",[{no:1,name:"contract_addresses",kind:"scalar",localName:"contract_addresses",repeat:2,T:12},{no:2,name:"contract_types",kind:"enum",localName:"contract_types",repeat:1,T:()=>["types.ContractType",Qw]}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.contract_addresses=[],t.contract_types=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.contract_addresses.push(e.bytes());break;case 2:if(a===m.LengthDelimited)for(let u=e.int32()+e.pos;e.pos<u;)s.contract_types.push(e.int32());else s.contract_types.push(e.int32());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.contract_addresses.length;s++)t.tag(1,m.LengthDelimited).bytes(e.contract_addresses[s]);if(e.contract_types.length){t.tag(2,m.LengthDelimited).fork();for(let s=0;s<e.contract_types.length;s++)t.int32(e.contract_types[s]);t.join()}let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ha=new yee,mee=class extends j{constructor(){super("world.SubscribeTransactionsRequest",[{no:1,name:"filter",kind:"message",T:()=>da}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.filter=da.internalBinaryRead(e,e.uint32(),n,s.filter);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.filter&&da.internalBinaryWrite(e.filter,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},bee=new mee,wee=class extends j{constructor(){super("world.SubscribeTransactionsResponse",[{no:1,name:"transaction",kind:"message",T:()=>ua}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.transaction=ua.internalBinaryRead(e,e.uint32(),n,s.transaction);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.transaction&&ua.internalBinaryWrite(e.transaction,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},kee=new wee,Eee=class extends j{constructor(){super("world.RetrieveControllersRequest",[{no:1,name:"query",kind:"message",T:()=>zg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=zg.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&zg.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Tee=new Eee,vee=class extends j{constructor(){super("world.RetrieveControllersResponse",[{no:1,name:"next_cursor",kind:"scalar",localName:"next_cursor",T:9},{no:2,name:"controllers",kind:"message",repeat:2,T:()=>Vg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.next_cursor="",t.controllers=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.next_cursor=e.string();break;case 2:s.controllers.push(Vg.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.next_cursor!==""&&t.tag(1,m.LengthDelimited).string(e.next_cursor);for(let s=0;s<e.controllers.length;s++)Vg.internalBinaryWrite(e.controllers[s],t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},See=new vee,Aee=class extends j{constructor(){super("world.RetrieveContractsRequest",[{no:1,name:"query",kind:"message",T:()=>ha}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=ha.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&ha.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Iee=new Aee,Nee=class extends j{constructor(){super("world.RetrieveContractsResponse",[{no:1,name:"contracts",kind:"message",repeat:2,T:()=>fa}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.contracts=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.contracts.push(fa.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.contracts.length;s++)fa.internalBinaryWrite(e.contracts[s],t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},xee=new Nee,Ree=class extends j{constructor(){super("world.UpdateTokenBalancesSubscriptionRequest",[{no:1,name:"subscription_id",kind:"scalar",localName:"subscription_id",T:4,L:0},{no:2,name:"contract_addresses",kind:"scalar",localName:"contract_addresses",repeat:2,T:12},{no:3,name:"account_addresses",kind:"scalar",localName:"account_addresses",repeat:2,T:12},{no:4,name:"token_ids",kind:"scalar",localName:"token_ids",repeat:2,T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.subscription_id=0n,t.contract_addresses=[],t.account_addresses=[],t.token_ids=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.subscription_id=e.uint64().toBigInt();break;case 2:s.contract_addresses.push(e.bytes());break;case 3:s.account_addresses.push(e.bytes());break;case 4:s.token_ids.push(e.bytes());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.subscription_id!==0n&&t.tag(1,m.Varint).uint64(e.subscription_id);for(let s=0;s<e.contract_addresses.length;s++)t.tag(2,m.LengthDelimited).bytes(e.contract_addresses[s]);for(let s=0;s<e.account_addresses.length;s++)t.tag(3,m.LengthDelimited).bytes(e.account_addresses[s]);for(let s=0;s<e.token_ids.length;s++)t.tag(4,m.LengthDelimited).bytes(e.token_ids[s]);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Cee=new Ree,Oee=class extends j{constructor(){super("world.SubscribeTokenBalancesResponse",[{no:1,name:"subscription_id",kind:"scalar",localName:"subscription_id",T:4,L:0},{no:2,name:"balance",kind:"message",T:()=>ca}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.subscription_id=0n,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.subscription_id=e.uint64().toBigInt();break;case 2:s.balance=ca.internalBinaryRead(e,e.uint32(),n,s.balance);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.subscription_id!==0n&&t.tag(1,m.Varint).uint64(e.subscription_id),e.balance&&ca.internalBinaryWrite(e.balance,t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Bee=new Oee,$ee=class extends j{constructor(){super("world.RetrieveTokensRequest",[{no:1,name:"query",kind:"message",T:()=>qg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=qg.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&qg.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Dee=new $ee,Mee=class extends j{constructor(){super("world.SubscribeTokensRequest",[{no:1,name:"contract_addresses",kind:"scalar",localName:"contract_addresses",repeat:2,T:12},{no:2,name:"token_ids",kind:"scalar",localName:"token_ids",repeat:2,T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.contract_addresses=[],t.token_ids=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.contract_addresses.push(e.bytes());break;case 2:s.token_ids.push(e.bytes());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.contract_addresses.length;s++)t.tag(1,m.LengthDelimited).bytes(e.contract_addresses[s]);for(let s=0;s<e.token_ids.length;s++)t.tag(2,m.LengthDelimited).bytes(e.token_ids[s]);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Lee=new Mee,Uee=class extends j{constructor(){super("world.RetrieveTokensResponse",[{no:1,name:"next_cursor",kind:"scalar",localName:"next_cursor",T:9},{no:2,name:"tokens",kind:"message",repeat:2,T:()=>aa}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.next_cursor="",t.tokens=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.next_cursor=e.string();break;case 2:s.tokens.push(aa.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.next_cursor!==""&&t.tag(1,m.LengthDelimited).string(e.next_cursor);for(let s=0;s<e.tokens.length;s++)aa.internalBinaryWrite(e.tokens[s],t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Pee=new Uee,Fee=class extends j{constructor(){super("world.SubscribeTokensResponse",[{no:1,name:"subscription_id",kind:"scalar",localName:"subscription_id",T:4,L:0},{no:2,name:"token",kind:"message",T:()=>aa}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.subscription_id=0n,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.subscription_id=e.uint64().toBigInt();break;case 2:s.token=aa.internalBinaryRead(e,e.uint32(),n,s.token);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.subscription_id!==0n&&t.tag(1,m.Varint).uint64(e.subscription_id),e.token&&aa.internalBinaryWrite(e.token,t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},jee=new Fee,Vee=class extends j{constructor(){super("world.UpdateTokenSubscriptionRequest",[{no:1,name:"subscription_id",kind:"scalar",localName:"subscription_id",T:4,L:0},{no:2,name:"contract_addresses",kind:"scalar",localName:"contract_addresses",repeat:2,T:12},{no:3,name:"token_ids",kind:"scalar",localName:"token_ids",repeat:2,T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.subscription_id=0n,t.contract_addresses=[],t.token_ids=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.subscription_id=e.uint64().toBigInt();break;case 2:s.contract_addresses.push(e.bytes());break;case 3:s.token_ids.push(e.bytes());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.subscription_id!==0n&&t.tag(1,m.Varint).uint64(e.subscription_id);for(let s=0;s<e.contract_addresses.length;s++)t.tag(2,m.LengthDelimited).bytes(e.contract_addresses[s]);for(let s=0;s<e.token_ids.length;s++)t.tag(3,m.LengthDelimited).bytes(e.token_ids[s]);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},zee=new Vee,qee=class extends j{constructor(){super("world.RetrieveTokenBalancesRequest",[{no:1,name:"query",kind:"message",T:()=>la}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=la.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&la.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Hee=new qee,Wee=class extends j{constructor(){super("world.SubscribeTokenBalancesRequest",[{no:1,name:"account_addresses",kind:"scalar",localName:"account_addresses",repeat:2,T:12},{no:2,name:"contract_addresses",kind:"scalar",localName:"contract_addresses",repeat:2,T:12},{no:3,name:"token_ids",kind:"scalar",localName:"token_ids",repeat:2,T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.account_addresses=[],t.contract_addresses=[],t.token_ids=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.account_addresses.push(e.bytes());break;case 2:s.contract_addresses.push(e.bytes());break;case 3:s.token_ids.push(e.bytes());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.account_addresses.length;s++)t.tag(1,m.LengthDelimited).bytes(e.account_addresses[s]);for(let s=0;s<e.contract_addresses.length;s++)t.tag(2,m.LengthDelimited).bytes(e.contract_addresses[s]);for(let s=0;s<e.token_ids.length;s++)t.tag(3,m.LengthDelimited).bytes(e.token_ids[s]);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Kee=new Wee,Yee=class extends j{constructor(){super("world.RetrieveTokenBalancesResponse",[{no:1,name:"next_cursor",kind:"scalar",localName:"next_cursor",T:9},{no:2,name:"balances",kind:"message",repeat:2,T:()=>ca}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.next_cursor="",t.balances=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.next_cursor=e.string();break;case 2:s.balances.push(ca.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.next_cursor!==""&&t.tag(1,m.LengthDelimited).string(e.next_cursor);for(let s=0;s<e.balances.length;s++)ca.internalBinaryWrite(e.balances[s],t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Gee=new Yee,Zee=class extends j{constructor(){super("world.RetrieveTransactionsRequest",[{no:1,name:"query",kind:"message",T:()=>Wg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=Wg.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&Wg.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Jee=new Zee,Xee=class extends j{constructor(){super("world.RetrieveTransactionsResponse",[{no:1,name:"next_cursor",kind:"scalar",localName:"next_cursor",T:9},{no:2,name:"transactions",kind:"message",repeat:2,T:()=>ua}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.next_cursor="",t.transactions=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.next_cursor=e.string();break;case 2:s.transactions.push(ua.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.next_cursor!==""&&t.tag(1,m.LengthDelimited).string(e.next_cursor);for(let s=0;s<e.transactions.length;s++)ua.internalBinaryWrite(e.transactions[s],t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Qee=new Xee,ete=class extends j{constructor(){super("world.RetrieveTokenContractsRequest",[{no:1,name:"query",kind:"message",T:()=>la}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=la.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&la.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},tte=new ete,nte=class extends j{constructor(){super("world.RetrieveTokenContractsResponse",[{no:1,name:"next_cursor",kind:"scalar",localName:"next_cursor",T:9},{no:2,name:"tokens",kind:"message",repeat:2,T:()=>Fg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.next_cursor="",t.tokens=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.next_cursor=e.string();break;case 2:s.tokens.push(Fg.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.next_cursor!==""&&t.tag(1,m.LengthDelimited).string(e.next_cursor);for(let s=0;s<e.tokens.length;s++)Fg.internalBinaryWrite(e.tokens[s],t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},rte=new nte,ste=class extends j{constructor(){super("world.SubscribeContractsRequest",[{no:1,name:"query",kind:"message",T:()=>ha}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=ha.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&ha.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ite=new ste,ote=class extends j{constructor(){super("world.SubscribeContractsResponse",[{no:1,name:"contract",kind:"message",T:()=>fa}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.contract=fa.internalBinaryRead(e,e.uint32(),n,s.contract);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.contract&&fa.internalBinaryWrite(e.contract,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ate=new ote,cte=class extends j{constructor(){super("world.WorldMetadataRequest",[])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},lte=new cte,ute=class extends j{constructor(){super("world.WorldMetadataResponse",[{no:1,name:"world",kind:"message",T:()=>Bg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.world=Bg.internalBinaryRead(e,e.uint32(),n,s.world);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.world&&Bg.internalBinaryWrite(e.world,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},dte=new ute,fte=class extends j{constructor(){super("world.SubscribeEntitiesRequest",[{no:1,name:"clause",kind:"message",T:()=>yt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.clause=yt.internalBinaryRead(e,e.uint32(),n,s.clause);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.clause&&yt.internalBinaryWrite(e.clause,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},hte=new fte,pte=class extends j{constructor(){super("world.SubscribeEventMessagesRequest",[{no:1,name:"clause",kind:"message",T:()=>yt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.clause=yt.internalBinaryRead(e,e.uint32(),n,s.clause);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.clause&&yt.internalBinaryWrite(e.clause,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},gte=new pte,_te=class extends j{constructor(){super("world.UpdateEntitiesSubscriptionRequest",[{no:1,name:"subscription_id",kind:"scalar",localName:"subscription_id",T:4,L:0},{no:2,name:"clause",kind:"message",T:()=>yt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.subscription_id=0n,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.subscription_id=e.uint64().toBigInt();break;case 2:s.clause=yt.internalBinaryRead(e,e.uint32(),n,s.clause);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.subscription_id!==0n&&t.tag(1,m.Varint).uint64(e.subscription_id),e.clause&&yt.internalBinaryWrite(e.clause,t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},yte=new _te,mte=class extends j{constructor(){super("world.UpdateEventMessagesSubscriptionRequest",[{no:1,name:"subscription_id",kind:"scalar",localName:"subscription_id",T:4,L:0},{no:2,name:"clause",kind:"message",T:()=>yt}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.subscription_id=0n,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.subscription_id=e.uint64().toBigInt();break;case 2:s.clause=yt.internalBinaryRead(e,e.uint32(),n,s.clause);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.subscription_id!==0n&&t.tag(1,m.Varint).uint64(e.subscription_id),e.clause&&yt.internalBinaryWrite(e.clause,t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},bte=new mte,wte=class extends j{constructor(){super("world.SubscribeEntityResponse",[{no:1,name:"entity",kind:"message",T:()=>ra},{no:2,name:"subscription_id",kind:"scalar",localName:"subscription_id",T:4,L:0}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.subscription_id=0n,e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.entity=ra.internalBinaryRead(e,e.uint32(),n,s.entity);break;case 2:s.subscription_id=e.uint64().toBigInt();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.entity&&ra.internalBinaryWrite(e.entity,t.tag(1,m.LengthDelimited).fork(),n).join(),e.subscription_id!==0n&&t.tag(2,m.Varint).uint64(e.subscription_id);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},DE=new wte,kte=class extends j{constructor(){super("world.RetrieveEntitiesRequest",[{no:1,name:"query",kind:"message",T:()=>ia}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=ia.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&ia.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Ete=new kte,Tte=class extends j{constructor(){super("world.RetrieveEventMessagesRequest",[{no:1,name:"query",kind:"message",T:()=>ia}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=ia.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&ia.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},vte=new Tte,Ste=class extends j{constructor(){super("world.RetrieveEntitiesResponse",[{no:1,name:"next_cursor",kind:"scalar",localName:"next_cursor",T:9},{no:2,name:"entities",kind:"message",repeat:2,T:()=>ra}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.next_cursor="",t.entities=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.next_cursor=e.string();break;case 2:s.entities.push(ra.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.next_cursor!==""&&t.tag(1,m.LengthDelimited).string(e.next_cursor);for(let s=0;s<e.entities.length;s++)ra.internalBinaryWrite(e.entities[s],t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},ME=new Ste,Ate=class extends j{constructor(){super("world.RetrieveEventsRequest",[{no:1,name:"query",kind:"message",T:()=>Dg}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.query=Dg.internalBinaryRead(e,e.uint32(),n,s.query);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.query&&Dg.internalBinaryWrite(e.query,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Ite=new Ate,Nte=class extends j{constructor(){super("world.RetrieveEventsResponse",[{no:1,name:"next_cursor",kind:"scalar",localName:"next_cursor",T:9},{no:2,name:"events",kind:"message",repeat:2,T:()=>sa}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.next_cursor="",t.events=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.next_cursor=e.string();break;case 2:s.events.push(sa.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.next_cursor!==""&&t.tag(1,m.LengthDelimited).string(e.next_cursor);for(let s=0;s<e.events.length;s++)sa.internalBinaryWrite(e.events[s],t.tag(2,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},xte=new Nte,Rte=class extends j{constructor(){super("world.SubscribeEventsRequest",[{no:1,name:"keys",kind:"message",repeat:2,T:()=>us}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.keys=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.keys.push(us.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.keys.length;s++)us.internalBinaryWrite(e.keys[s],t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Cte=new Rte,Ote=class extends j{constructor(){super("world.SubscribeEventsResponse",[{no:1,name:"event",kind:"message",T:()=>sa}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.event=sa.internalBinaryRead(e,e.uint32(),n,s.event);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.event&&sa.internalBinaryWrite(e.event,t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Bte=new Ote,$te=class extends j{constructor(){super("world.PublishMessageRequest",[{no:1,name:"signature",kind:"scalar",repeat:2,T:12},{no:2,name:"message",kind:"scalar",T:9}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.signature=[],t.message="",e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.signature.push(e.bytes());break;case 2:s.message=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.signature.length;s++)t.tag(1,m.LengthDelimited).bytes(e.signature[s]);e.message!==""&&t.tag(2,m.LengthDelimited).string(e.message);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},zd=new $te,Dte=class extends j{constructor(){super("world.PublishMessageResponse",[{no:1,name:"entity_id",kind:"scalar",localName:"entity_id",T:12}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.entity_id=new Uint8Array(0),e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.entity_id=e.bytes();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){e.entity_id.length&&t.tag(1,m.LengthDelimited).bytes(e.entity_id);let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},qd=new Dte,Mte=class extends j{constructor(){super("world.PublishMessageBatchRequest",[{no:1,name:"messages",kind:"message",repeat:2,T:()=>zd}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.messages=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.messages.push(zd.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.messages.length;s++)zd.internalBinaryWrite(e.messages[s],t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Lte=new Mte,Ute=class extends j{constructor(){super("world.PublishMessageBatchResponse",[{no:1,name:"responses",kind:"message",repeat:2,T:()=>qd}])}create(e){const t=globalThis.Object.create(this.messagePrototype);return t.responses=[],e!==void 0&&F(this,t,e),t}internalBinaryRead(e,t,n,r){let s=r??this.create(),i=e.pos+t;for(;e.pos<i;){let[o,a]=e.tag();switch(o){case 1:s.responses.push(qd.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${o} (wire type ${a}) for ${this.typeName}`);let l=e.skip(a);c!==!1&&(c===!0?T.onRead:c)(this.typeName,s,o,a,l)}}return s}internalBinaryWrite(e,t,n){for(let s=0;s<e.responses.length;s++)qd.internalBinaryWrite(e.responses[s],t.tag(1,m.LengthDelimited).fork(),n).join();let r=n.writeUnknownFields;return r!==!1&&(r==!0?T.onWrite:r)(this.typeName,e,t),t}},Pte=new Ute,Kg=new bV("world.World",[{name:"SubscribeContracts",serverStreaming:!0,options:{},I:ite,O:ate},{name:"WorldMetadata",options:{},I:lte,O:dte},{name:"SubscribeEntities",serverStreaming:!0,options:{},I:hte,O:DE},{name:"UpdateEntitiesSubscription",options:{},I:yte,O:ud},{name:"RetrieveEntities",options:{},I:Ete,O:ME},{name:"SubscribeEventMessages",serverStreaming:!0,options:{},I:gte,O:DE},{name:"UpdateEventMessagesSubscription",options:{},I:bte,O:ud},{name:"SubscribeTokenBalances",serverStreaming:!0,options:{},I:Kee,O:Bee},{name:"UpdateTokenBalancesSubscription",options:{},I:Cee,O:ud},{name:"SubscribeTokens",serverStreaming:!0,options:{},I:Lee,O:jee},{name:"UpdateTokensSubscription",options:{},I:zee,O:ud},{name:"RetrieveEventMessages",options:{},I:vte,O:ME},{name:"RetrieveEvents",options:{},I:Ite,O:xte},{name:"SubscribeEvents",serverStreaming:!0,options:{},I:Cte,O:Bte},{name:"RetrieveTokens",options:{},I:Dee,O:Pee},{name:"RetrieveTokenBalances",options:{},I:Hee,O:Gee},{name:"RetrieveTransactions",options:{},I:Jee,O:Qee},{name:"SubscribeTransactions",serverStreaming:!0,options:{},I:bee,O:kee},{name:"RetrieveControllers",options:{},I:Tee,O:See},{name:"RetrieveContracts",options:{},I:Iee,O:xee},{name:"RetrieveTokenContracts",options:{},I:tte,O:rte},{name:"PublishMessage",options:{},I:zd,O:qd},{name:"PublishMessageBatch",options:{},I:Lte,O:Pte}]),Fte=class{constructor(e){this._transport=e}typeName=Kg.typeName;methods=Kg.methods;options=Kg.options;subscribeContracts(e,t){const n=this.methods[0],r=this._transport.mergeOptions(t);return Me("serverStreaming",this._transport,n,r,e)}worldMetadata(e,t){const n=this.methods[1],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}subscribeEntities(e,t){const n=this.methods[2],r=this._transport.mergeOptions(t);return Me("serverStreaming",this._transport,n,r,e)}updateEntitiesSubscription(e,t){const n=this.methods[3],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}retrieveEntities(e,t){const n=this.methods[4],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}subscribeEventMessages(e,t){const n=this.methods[5],r=this._transport.mergeOptions(t);return Me("serverStreaming",this._transport,n,r,e)}updateEventMessagesSubscription(e,t){const n=this.methods[6],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}subscribeTokenBalances(e,t){const n=this.methods[7],r=this._transport.mergeOptions(t);return Me("serverStreaming",this._transport,n,r,e)}updateTokenBalancesSubscription(e,t){const n=this.methods[8],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}subscribeTokens(e,t){const n=this.methods[9],r=this._transport.mergeOptions(t);return Me("serverStreaming",this._transport,n,r,e)}updateTokensSubscription(e,t){const n=this.methods[10],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}retrieveEventMessages(e,t){const n=this.methods[11],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}retrieveEvents(e,t){const n=this.methods[12],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}subscribeEvents(e,t){const n=this.methods[13],r=this._transport.mergeOptions(t);return Me("serverStreaming",this._transport,n,r,e)}retrieveTokens(e,t){const n=this.methods[14],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}retrieveTokenBalances(e,t){const n=this.methods[15],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}retrieveTransactions(e,t){const n=this.methods[16],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}subscribeTransactions(e,t){const n=this.methods[17],r=this._transport.mergeOptions(t);return Me("serverStreaming",this._transport,n,r,e)}retrieveControllers(e,t){const n=this.methods[18],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}retrieveContracts(e,t){const n=this.methods[19],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}retrieveTokenContracts(e,t){const n=this.methods[20],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}publishMessage(e,t){const n=this.methods[21],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}publishMessageBatch(e,t){const n=this.methods[22],r=this._transport.mergeOptions(t);return Me("unary",this._transport,n,r,e)}},jte=class{transport;worldClient;constructor(e){this.transport=new OV({baseUrl:e.url,format:"binary"}),this.worldClient=new Fte(this.transport)}destroy(){}};function ln(e){const t=e.startsWith("0x")?e.slice(2):e,n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r/2]=parseInt(t.substr(r,2),16);return n}function Vte(e){switch(e){case"Asc":return 0;case"Desc":return 1;default:return 0}}function zte(e){switch(e){case"Forward":return 0;case"Backward":return 1;default:return 0}}function qte(e){return{field:e.field,direction:Vte(e.direction)}}function pc(e){return{limit:e.limit||0,cursor:e.cursor||"",direction:zte(e.direction),order_by:e.order_by.map(qte)}}function Hte(e){switch(e){case"FixedLen":return 0;case"VariableLen":return 1;default:return 0}}function Wte(e){switch(e){case"Eq":return 0;case"Neq":return 1;case"Gt":return 2;case"Gte":return 3;case"Lt":return 4;case"Lte":return 5;case"In":return 6;case"NotIn":return 7;default:return 0}}function Kte(e){switch(e){case"And":return 0;case"Or":return 1;default:return 0}}function LC(e){return typeof e=="string"?{value_type:{oneofKind:"string",string:e}}:Array.isArray(e)?{value_type:{oneofKind:"list",list:{values:e.map(LC)}}}:e&&typeof e=="object"&&"Primitive"in e?{value_type:{oneofKind:"primitive",primitive:e.Primitive}}:{value_type:{oneofKind:"string",string:String(e)}}}function Ko(e){if("HashedKeys"in e)return{clause_type:{oneofKind:"hashed_keys",hashed_keys:{hashed_keys:e.HashedKeys.map(ln)}}};if("Keys"in e)return{clause_type:{oneofKind:"keys",keys:{keys:e.Keys.keys.map(n=>n?ln(n):new Uint8Array),pattern_matching:Hte(e.Keys.pattern_matching),models:e.Keys.models}}};if("Member"in e)return{clause_type:{oneofKind:"member",member:{model:e.Member.model,member:e.Member.member,operator:Wte(e.Member.operator),value:LC(e.Member.value)}}};if("Composite"in e)return{clause_type:{oneofKind:"composite",composite:{operator:Kte(e.Composite.operator),clauses:e.Composite.clauses.map(Ko)}}};throw new Error("Unknown clause type")}function UC(e){return{pagination:pc(e.pagination),clause:e.clause?Ko(e.clause):void 0,no_hashed_keys:e.no_hashed_keys,models:e.models,historical:e.historical}}function Yte(e){return{contract_addresses:e.contract_addresses.map(ln),usernames:e.usernames,pagination:pc(e.pagination)}}function Gte(e){return{contract_addresses:e.contract_addresses.map(ln),token_ids:e.token_ids.map(ln),pagination:pc(e.pagination)}}function PC(e){return{contract_addresses:e.contract_addresses.map(ln),account_addresses:e.account_addresses.map(ln),token_ids:e.token_ids.map(ln),pagination:pc(e.pagination)}}function FC(e){return{transaction_hashes:e.transaction_hashes.map(ln),caller_addresses:e.caller_addresses.map(ln),contract_addresses:e.contract_addresses.map(ln),entrypoints:e.entrypoints,model_selectors:e.model_selectors.map(ln),from_block:e.from_block?BigInt(e.from_block):void 0,to_block:e.to_block?BigInt(e.to_block):void 0}}function Zte(e){return{filter:e.filter?FC(e.filter):void 0,pagination:pc(e.pagination)}}function Jte(e){return{query:UC(e)}}function Xte(e){return{query:UC(e)}}function Qte(e){return{query:Gte(e)}}function ene(e){return{query:PC(e)}}function tne(e){return{query:PC(e)}}function nne(e){return{query:Yte(e)}}function rne(e){return{query:Zte(e)}}function sne(e){return{query:{keys:e.keys?{keys:e.keys.keys.map(t=>t?ln(t):new Uint8Array),pattern_matching:e.keys.pattern_matching==="FixedLen"?0:1,models:e.keys.models||[]}:void 0,pagination:e.pagination?pc(e.pagination):void 0}}}function ine(e){return{query:{contract_addresses:e.contract_addresses?.map(ln)||[],contract_types:e.contract_types||[]}}}var dd=void 0;function le(e){return"0x"+Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}function one(e){const t=e.startsWith("0x")?e.slice(2):e,n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r/2]=parseInt(t.substr(r,2),16);return n}function ane(e){switch(e){case 0:return"Execute";case 1:return"ExecuteFromOutside";default:return"Execute"}}function cne(e){return{contract_address:le(e.contract_address),entrypoint:e.entrypoint,calldata:e.calldata.map(le),call_type:ane(e.call_type),caller_address:le(e.caller_address)}}function jC(e){return{transaction_hash:le(e.transaction_hash),sender_address:le(e.sender_address),calldata:e.calldata.map(le),max_fee:le(e.max_fee),signature:e.signature.map(le),nonce:le(e.nonce),block_number:Number(e.block_number),transaction_type:e.transaction_type,block_timestamp:Number(e.block_timestamp),calls:e.calls.map(cne),unique_models:e.unique_models.map(le)}}function lne(e){return{items:e.transactions.map(jC),next_cursor:e.next_cursor||void 0}}function une(e){return{address:le(e.address),username:e.username,deployed_at_timestamp:Number(e.deployed_at_timestamp)}}function dne(e){return{items:e.controllers.map(une),next_cursor:e.next_cursor||void 0}}function LE(e){return dd||(dd=new TextDecoder),dd.decode(e)}function VC(e){try{return JSON.parse(LE(e))}catch{return LE(e)}}function zC(e){return{contract_address:le(e.contract_address),token_id:e.token_id?le(e.token_id):void 0,name:e.name,symbol:e.symbol,decimals:e.decimals,metadata:VC(e.metadata)}}function fne(e){return{items:e.tokens.map(zC),next_cursor:e.next_cursor||void 0}}function qC(e){return{balance:le(e.balance),account_address:le(e.account_address),contract_address:le(e.contract_address),token_id:e.token_id?le(e.token_id):void 0}}function hne(e){return{items:e.balances.map(qC),next_cursor:e.next_cursor||void 0}}function pne(e){return{contract_address:le(e.contract_address),name:e.name,symbol:e.symbol,decimals:e.decimals,count:e.count,metadata:VC(e.metadata)}}function gne(e){return{items:e.tokens.map(pne),next_cursor:e.next_cursor||void 0}}function _ne(e){if(!e.primitive_type)return null;switch(e.primitive_type.oneofKind){case"i8":return e.primitive_type.i8;case"i16":return e.primitive_type.i16;case"i32":return e.primitive_type.i32;case"i64":return Number(e.primitive_type.i64);case"i128":return le(e.primitive_type.i128);case"u8":return e.primitive_type.u8;case"u16":return e.primitive_type.u16;case"u32":return e.primitive_type.u32;case"u64":return Number(e.primitive_type.u64);case"u128":return le(e.primitive_type.u128);case"u256":return le(e.primitive_type.u256);case"bool":return e.primitive_type.bool;case"felt252":return le(e.primitive_type.felt252);case"class_hash":return le(e.primitive_type.class_hash);case"contract_address":return le(e.primitive_type.contract_address);case"eth_address":return le(e.primitive_type.eth_address);default:return null}}function yne(e){return e.primitive_type&&e.primitive_type.oneofKind||""}function Xc(e,t=!1){if(!e.ty_type)return{type:"primitive",type_name:"",value:null,key:t};switch(e.ty_type.oneofKind){case"primitive":return{type:"primitive",type_name:yne(e.ty_type.primitive),value:_ne(e.ty_type.primitive),key:t};case"struct":{const n=e.ty_type.struct,r={};for(const s of n.children)s.ty&&(r[s.name]=Xc(s.ty,s.key));return{type:"struct",type_name:n.name,value:r,key:t}}case"enum":{const n=e.ty_type.enum,r=n.options[n.option];return{type:"enum",type_name:n.name,value:r&&r.ty?{option:r.name,value:Xc(r.ty)}:null,key:t}}case"array":return{type:"array",type_name:"array",value:e.ty_type.array.children.map(r=>Xc(r)),key:t};case"tuple":return{type:"tuple",type_name:"tuple",value:e.ty_type.tuple.children.map(r=>Xc(r)),key:t};case"bytearray":return{type:"bytearray",type_name:"bytearray",value:e.ty_type.bytearray,key:t};default:return{type:"primitive",type_name:"",value:null,key:t}}}function mne(e){const t={};if(e&&Array.isArray(e))for(const n of e)n.ty&&(t[n.name]=Xc(n.ty,n.key));return t}function HC(e){const t={};for(const n of e.models)t[n.name]=mne(n.children);return{hashed_keys:le(e.hashed_keys),models:t}}function bne(e){return{items:e.entities.map(HC),next_cursor:e.next_cursor||void 0}}function wne(e){return{head:Number(e.head),tps:Number(e.tps),last_block_timestamp:Number(e.last_block_timestamp),contract_address:le(e.contract_address)}}function kne(e){return{message:e.message,signature:e.signature.map(one)}}function WC(e){return{keys:e.keys.map(le),data:e.data.map(le),transaction_hash:le(e.transaction_hash)}}function Ene(e){return{items:e.events.map(WC),next_cursor:e.next_cursor||void 0}}function KC(e){return{contract_address:le(e.contract_address),contract_type:e.contract_type,head:e.head?Number(e.head):void 0,tps:e.tps?Number(e.tps):void 0,last_block_timestamp:e.last_block_timestamp?Number(e.last_block_timestamp):void 0,last_pending_block_tx:e.last_pending_block_tx?le(e.last_pending_block_tx):void 0,updated_at:Number(e.updated_at),created_at:Number(e.created_at)}}function Tne(e){return{items:e.contracts.map(KC)}}function vne(e){return e.world?{world_address:le(e.world.world_address),models:e.world.models.map(t=>({selector:le(t.selector),namespace:t.namespace,name:t.name,packed_size:t.packed_size,unpacked_size:t.unpacked_size,class_hash:le(t.class_hash),layout:le(t.layout),schema:le(t.schema),contract_address:le(t.contract_address),use_legacy_store:t.use_legacy_store}))}:null}var YC=we.pipe($Q(/^0x[0-9a-fA-F]*$/,{message:()=>"Invalid hex string format"})),ue=ze(Ee,YC,{decode:e=>"0x"+Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join(""),encode:e=>{const t=e.startsWith("0x")?e.slice(2):e,n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r/2]=parseInt(t.substr(r,2),16);return n}}),GC=Gt(ue),Hd=ze(Ne(Ee),Ne(YC),{decode:e=>e.map(t=>"0x"+Array.from(t).map(n=>n.toString(16).padStart(2,"0")).join("")),encode:e=>e.map(t=>{const n=t.startsWith("0x")?t.slice(2):t,r=new Uint8Array(n.length/2);for(let s=0;s<n.length;s+=2)r[s/2]=parseInt(n.substr(s,2),16);return r})}),Vy=ze(co,rn,{decode:e=>Number(e),encode:e=>BigInt(e)}),Mu=Gt(we);Gt(rn);var pa=void 0;ze(Ee,we,{decode:e=>(pa||(pa=new TextDecoder),pa.decode(e)),encode:e=>new TextEncoder().encode(e)});var ZC=ze(Ee,Kw,{decode:e=>{pa||(pa=new TextDecoder);const t=pa.decode(e);try{return JSON.parse(t)}catch{return t}},encode:e=>{const t=typeof e=="string"?e:JSON.stringify(e);return new TextEncoder().encode(t)}}),Sne=ze(_C({EXECUTE:0,EXECUTE_FROM_OUTSIDE:1}),Le("Execute","ExecuteFromOutside"),{decode:e=>{switch(e){case 0:return"Execute";case 1:return"ExecuteFromOutside";default:return"Execute"}},encode:e=>{switch(e){case"Execute":return 0;case"ExecuteFromOutside":return 1;default:return 0}}}),UE=ze(W({contract_address:Ee,entrypoint:we,calldata:Ne(Ee),call_type:_C({EXECUTE:0,EXECUTE_FROM_OUTSIDE:1}),caller_address:Ee}),W({contract_address:ue,entrypoint:we,calldata:Hd,call_type:Sne,caller_address:ue}),{decode:e=>({contract_address:e.contract_address,entrypoint:e.entrypoint,calldata:e.calldata,call_type:e.call_type,caller_address:e.caller_address}),encode:e=>({contract_address:e.contract_address,entrypoint:e.entrypoint,calldata:e.calldata,call_type:e.call_type,caller_address:e.caller_address})}),zy=ze(W({transaction_hash:Ee,sender_address:Ee,calldata:Ne(Ee),max_fee:Ee,signature:Ne(Ee),nonce:Ee,block_number:co,block_timestamp:co,transaction_type:we,calls:Ne(UE),unique_models:Ne(Ee)}),W({transaction_hash:ue,sender_address:ue,calldata:Hd,max_fee:ue,signature:Hd,nonce:ue,block_number:Vy,block_timestamp:Vy,transaction_type:we,calls:Ne(UE),unique_models:Hd}),{decode:e=>({transaction_hash:e.transaction_hash,sender_address:e.sender_address,calldata:e.calldata,max_fee:e.max_fee,signature:e.signature,nonce:e.nonce,block_number:e.block_number,block_timestamp:e.block_timestamp,transaction_type:e.transaction_type,calls:e.calls,unique_models:e.unique_models}),encode:e=>({transaction_hash:e.transaction_hash,sender_address:e.sender_address,calldata:e.calldata,max_fee:e.max_fee,signature:e.signature,nonce:e.nonce,block_number:BigInt(e.block_number),block_timestamp:BigInt(e.block_timestamp),transaction_type:e.transaction_type,calls:e.calls,unique_models:e.unique_models})}),PE=ze(W({address:Ee,username:we,deployed_at_timestamp:co}),W({address:ue,username:we,deployed_at_timestamp:Vy}),{decode:e=>({address:e.address,username:e.username,deployed_at_timestamp:e.deployed_at_timestamp}),encode:e=>({address:e.address,username:e.username,deployed_at_timestamp:BigInt(e.deployed_at_timestamp)})}),qy=ze(W({contract_address:Ee,token_id:Gt(Ee),name:we,symbol:we,decimals:rn,metadata:Ee}),W({contract_address:ue,token_id:GC,name:we,symbol:we,decimals:rn,metadata:ZC}),{decode:e=>({contract_address:e.contract_address,token_id:e.token_id,name:e.name,symbol:e.symbol,decimals:e.decimals,metadata:e.metadata}),encode:e=>({contract_address:e.contract_address,token_id:e.token_id,name:e.name,symbol:e.symbol,decimals:e.decimals,metadata:e.metadata})}),Hy=ze(W({balance:Ee,account_address:Ee,contract_address:Ee,token_id:Gt(Ee)}),W({balance:ue,account_address:ue,contract_address:ue,token_id:GC}),{decode:e=>({balance:e.balance,account_address:e.account_address,contract_address:e.contract_address,token_id:e.token_id}),encode:e=>({balance:e.balance,account_address:e.account_address,contract_address:e.contract_address,token_id:e.token_id})}),FE=ze(W({contract_address:Ee,name:we,symbol:we,decimals:rn,count:co,metadata:Ee}),W({contract_address:ue,name:we,symbol:we,decimals:rn,count:rn,metadata:ZC}),{decode:e=>({contract_address:e.contract_address,name:e.name,symbol:e.symbol,decimals:e.decimals,count:e.count,metadata:e.metadata}),encode:e=>({contract_address:e.contract_address,name:e.name,symbol:e.symbol,decimals:e.decimals,count:BigInt(e.count),metadata:e.metadata})}),Ane=ze(W({transactions:Ne(zy),next_cursor:Mu}),W({items:Ne(zy),next_cursor:Gt(we)}),{decode:e=>({items:e.transactions,next_cursor:e.next_cursor}),encode:e=>({transactions:e.items,next_cursor:e.next_cursor})}),Ine=ze(W({controllers:Ne(PE),next_cursor:Mu}),W({items:Ne(PE),next_cursor:Gt(we)}),{decode:e=>({items:e.controllers,next_cursor:e.next_cursor}),encode:e=>({controllers:e.items,next_cursor:e.next_cursor})}),Nne=ze(W({tokens:Ne(qy),next_cursor:Mu}),W({items:Ne(qy),next_cursor:Gt(we)}),{decode:e=>({items:e.tokens,next_cursor:e.next_cursor}),encode:e=>({tokens:e.items,next_cursor:e.next_cursor})}),xne=ze(W({balances:Ne(Hy),next_cursor:Mu}),W({items:Ne(Hy),next_cursor:Gt(we)}),{decode:e=>({items:e.balances,next_cursor:e.next_cursor}),encode:e=>({balances:e.items,next_cursor:e.next_cursor})}),Rne=ze(W({tokens:Ne(FE),next_cursor:Mu}),W({items:Ne(FE),next_cursor:Gt(we)}),{decode:e=>({items:e.tokens,next_cursor:e.next_cursor}),encode:e=>({tokens:e.items,next_cursor:e.next_cursor})}),jE=ze(W({primitive_type:Gw(W({oneofKind:Le("i8"),i8:rn}),W({oneofKind:Le("i16"),i16:rn}),W({oneofKind:Le("i32"),i32:rn}),W({oneofKind:Le("i64"),i64:co}),W({oneofKind:Le("i128"),i128:Ee}),W({oneofKind:Le("u8"),u8:rn}),W({oneofKind:Le("u16"),u16:rn}),W({oneofKind:Le("u32"),u32:rn}),W({oneofKind:Le("u64"),u64:co}),W({oneofKind:Le("u128"),u128:Ee}),W({oneofKind:Le("u256"),u256:Ee}),W({oneofKind:Le("bool"),bool:Yw}),W({oneofKind:Le("felt252"),felt252:Ee}),W({oneofKind:Le("class_hash"),class_hash:Ee}),W({oneofKind:Le("contract_address"),contract_address:Ee}),W({oneofKind:Le("eth_address"),eth_address:Ee})).pipe(Gt)}),Kw,{decode:e=>{if(!e.primitive_type)return null;switch(e.primitive_type.oneofKind){case"i8":return e.primitive_type.i8;case"i16":return e.primitive_type.i16;case"i32":return e.primitive_type.i32;case"i64":return Number(e.primitive_type.i64);case"i128":return ue.pipe(se)(e.primitive_type.i128);case"u8":return e.primitive_type.u8;case"u16":return e.primitive_type.u16;case"u32":return e.primitive_type.u32;case"u64":return Number(e.primitive_type.u64);case"u128":return ue.pipe(se)(e.primitive_type.u128);case"u256":return ue.pipe(se)(e.primitive_type.u256);case"bool":return e.primitive_type.bool;case"felt252":return ue.pipe(se)(e.primitive_type.felt252);case"class_hash":return ue.pipe(se)(e.primitive_type.class_hash);case"contract_address":return ue.pipe(se)(e.primitive_type.contract_address);case"eth_address":return ue.pipe(se)(e.primitive_type.eth_address);default:return null}},encode:e=>{throw new Error("Encoding not implemented for PrimitiveSchema")}}),ss=IC(()=>ze(W({ty_type:Gw(W({oneofKind:Le("primitive"),primitive:jE}),W({oneofKind:Le("struct"),struct:W({name:we,children:Ne(Yf)})}),W({oneofKind:Le("enum"),enum:W({name:we,option:rn,options:Ne(Yf)})}),W({oneofKind:Le("array"),array:W({children:Ne(ss)})}),W({oneofKind:Le("tuple"),tuple:W({children:Ne(ss)})}),W({oneofKind:Le("bytearray"),bytearray:we})).pipe(Gt)}),W({type:we,type_name:we,value:Kw,key:Yw}),{decode:(e,t=!1)=>{if(!e.ty_type)return{type:"primitive",type_name:"",value:null,key:t};switch(e.ty_type.oneofKind){case"primitive":{const n=jE.pipe(se)(e.ty_type.primitive);return{type:"primitive",type_name:e.ty_type.primitive.primitive_type?.oneofKind||"",value:n,key:t}}case"struct":{const n=e.ty_type.struct,r={};for(const s of n.children)s.ty&&(r[s.name]=ss.pipe(se)(s.ty));return{type:"struct",type_name:n.name,value:r,key:t}}case"enum":{const n=e.ty_type.enum,r=n.options[n.option];return{type:"enum",type_name:n.name,value:r&&r.ty?{option:r.name,value:ss.pipe(se)(r.ty)}:null,key:t}}case"array":return{type:"array",type_name:"array",value:e.ty_type.array.children.map(r=>ss.pipe(se)(r)),key:t};case"tuple":return{type:"tuple",type_name:"tuple",value:e.ty_type.tuple.children.map(r=>ss.pipe(se)(r)),key:t};case"bytearray":return{type:"bytearray",type_name:"bytearray",value:e.ty_type.bytearray,key:t};default:return{type:"primitive",type_name:"",value:null,key:t}}},encode:e=>{throw new Error("Encoding not implemented for TySchema")}})),Yf=IC(()=>W({name:we,ty:Gt(ss),key:Yw})),VE=ze(Ne(Yf),AC({key:we,value:ss}),{decode:e=>{const t={};if(e&&Array.isArray(e)){for(const n of e)if(n.ty){const r=ss.pipe(se)(n.ty);t[n.name]={...r,key:n.key}}}return t},encode:e=>{throw new Error("Encoding not implemented for ModelSchema")}}),Wy=ze(W({hashed_keys:Ee,models:Ne(W({name:we,children:Ne(Yf)}))}),W({hashed_keys:ue,models:AC({key:we,value:VE})}),{decode:e=>{const t={};for(const n of e.models)t[n.name]=VE.pipe(se)(n.children);return{hashed_keys:ue.pipe(se)(e.hashed_keys),models:t}},encode:e=>{throw new Error("Encoding not implemented for EntitySchema")}}),Cne=ze(W({entities:Ne(Wy),next_cursor:Gt(we)}),W({items:Ne(Wy),next_cursor:Gt(we)}),{decode:e=>({items:e.entities,next_cursor:e.next_cursor}),encode:e=>({entities:e.items,next_cursor:e.next_cursor})});function One(e){return se(zy)(e)}function Bne(e){return se(Ane)(e)}function $ne(e){return se(Ine)(e)}function Dne(e){return se(qy)(e)}function Mne(e){return se(Nne)(e)}function Lne(e){return se(Hy)(e)}function Une(e){return se(xne)(e)}function Pne(e){return se(Rne)(e)}function Fne(e){return se(Wy)(e)}function jne(e){return se(Cne)(e)}function Vne(e){return{head:Number(e.head),tps:Number(e.tps),last_block_timestamp:Number(e.last_block_timestamp),contract_address:se(ue)(e.contract_address)}}function zne(e){return{message:e.message,signature:e.signature.map(t=>ZX(ue)(t))}}function JC(e){return{keys:e.keys.map(t=>se(ue)(t)),data:e.data.map(t=>se(ue)(t)),transaction_hash:se(ue)(e.transaction_hash)}}function qne(e){return{items:e.events.map(JC),next_cursor:e.next_cursor||void 0}}function XC(e){return{contract_address:se(ue)(e.contract_address),contract_type:e.contract_type,head:e.head?Number(e.head):void 0,tps:e.tps?Number(e.tps):void 0,last_block_timestamp:e.last_block_timestamp?Number(e.last_block_timestamp):void 0,last_pending_block_tx:e.last_pending_block_tx?se(ue)(e.last_pending_block_tx):void 0,updated_at:Number(e.updated_at),created_at:Number(e.created_at)}}function Hne(e){return{items:e.contracts.map(XC)}}function Wne(e){return e.world?{world_address:se(ue)(e.world.world_address),models:e.world.models.map(t=>({selector:se(ue)(t.selector),namespace:t.namespace,name:t.name,packed_size:t.packed_size,unpacked_size:t.unpacked_size,class_hash:se(ue)(t.class_hash),layout:se(ue)(t.layout),schema:se(ue)(t.schema),contract_address:se(ue)(t.contract_address),use_legacy_store:t.use_legacy_store}))}:null}function Mn(e){const t=e.startsWith("0x")?e.slice(2):e,n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r/2]=parseInt(t.substr(r,2),16);return n}function Yg(e){return"0x"+Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}var Kne=class{_subscription;constructor(e){this._subscription=e}cancel(){this._subscription.cancel()}free(){this._subscription.cancel()}get id(){return this._subscription.id}},Yne=class{client;nextSubscriptionId=1n;subscriptions=new Map;useEffectSchema;mappers;constructor(e){this.client=new jte({url:e.toriiUrl}),this.useEffectSchema=e.useEffectSchema??!1,this.mappers=this.useEffectSchema?{entitiesResponse:jne,controllersResponse:$ne,tokensResponse:Mne,tokenBalancesResponse:Une,tokenContractsResponse:Pne,transactionsResponse:Bne,indexerUpdate:Vne,message:zne,transaction:One,entity:Fne,token:Dne,tokenBalance:Lne,eventsResponse:qne,contractsResponse:Hne,worldMetadataResponse:Wne,event:JC,contract:XC}:{entitiesResponse:bne,controllersResponse:dne,tokensResponse:fne,tokenBalancesResponse:hne,tokenContractsResponse:gne,transactionsResponse:lne,indexerUpdate:wne,message:kne,transaction:jC,entity:HC,token:zC,tokenBalance:qC,eventsResponse:Ene,contractsResponse:Tne,worldMetadataResponse:vne,event:WC,contract:KC}}createStreamSubscription(e){const t=this.nextSubscriptionId++,n=e.createStream(),r={id:t,stream:n,cancel:()=>{this.subscriptions.delete(t)}};return this.subscriptions.set(t,r),n.responses.onMessage(e.onMessage),e.onError?n.responses.onError(e.onError):n.responses.onError(s=>{console.error(`Stream error (subscription ${t}):`,s)}),e.onComplete?n.responses.onComplete(e.onComplete):n.responses.onComplete(()=>{this.subscriptions.delete(t)}),new Kne(r)}async getControllers(e){const t=nne(e),n=await this.client.worldClient.retrieveControllers(t).response;return this.mappers.controllersResponse(n)}async getTransactions(e){const t=rne(e),n=await this.client.worldClient.retrieveTransactions(t).response;return this.mappers.transactionsResponse(n)}async getTokens(e){const t=Qte(e),n=await this.client.worldClient.retrieveTokens(t).response;return this.mappers.tokensResponse(n)}async getTokenBalances(e){const t=ene(e),n=await this.client.worldClient.retrieveTokenBalances(t).response;return this.mappers.tokenBalancesResponse(n)}async getTokenContracts(e){const t=tne(e),n=await this.client.worldClient.retrieveTokenContracts(t).response;return this.mappers.tokenContractsResponse(n)}async getEntities(e){const t=Jte(e),n=await this.client.worldClient.retrieveEntities(t).response;return this.mappers.entitiesResponse(n)}async getAllEntities(e,t){const n={pagination:{limit:e,cursor:t||void 0,direction:"Forward",order_by:[]},clause:void 0,no_hashed_keys:!0,models:[],historical:!1};return this.getEntities(n)}async getEventMessages(e){const t=Xte(e),n=await this.client.worldClient.retrieveEventMessages(t).response;return this.mappers.entitiesResponse(n)}async onTransaction(e,t){return this.createStreamSubscription({createStream:()=>this.client.worldClient.subscribeTransactions({filter:e?FC(e):void 0}),onMessage:n=>{n.transaction&&t(this.mappers.transaction(n.transaction))}})}async onTokenUpdated(e,t,n){return this.createStreamSubscription({createStream:()=>this.client.worldClient.subscribeTokens({contract_addresses:e?.map(Mn)||[],token_ids:t?.map(Mn)||[]}),onMessage:r=>{r.token&&n(this.mappers.token(r.token))}})}async onEntityUpdated(e,t){return this.createStreamSubscription({createStream:()=>this.client.worldClient.subscribeEntities({clause:e?Ko(e):void 0}),onMessage:n=>{n.entity&&t(this.mappers.entity(n.entity),n.subscription_id)}})}async updateEntitySubscription(e,t){const n=this.findSubscription(e);if(!n)throw new Error("Subscription not found");await this.client.worldClient.updateEntitiesSubscription({subscription_id:BigInt(n.id),clause:t?Ko(t):void 0}).response}async onEventMessageUpdated(e,t){return this.createStreamSubscription({createStream:()=>this.client.worldClient.subscribeEventMessages({clause:e?Ko(e):void 0}),onMessage:n=>{n.entity&&t(this.mappers.entity(n.entity),n.subscription_id)}})}async updateEventMessageSubscription(e,t){const n=this.findSubscription(e);if(!n)throw new Error("Subscription not found");await this.client.worldClient.updateEventMessagesSubscription({subscription_id:BigInt(n.id),clause:t?Ko(t):void 0}).response}async onStarknetEvent(e,t){const n=e.map(r=>({keys:r.keys.map(s=>s?Mn(s):new Uint8Array),pattern_matching:r.pattern_matching==="FixedLen"?0:1,models:r.models}));return this.createStreamSubscription({createStream:()=>this.client.worldClient.subscribeEvents({keys:n}),onMessage:r=>{if(r.event){const s=this.useEffectSchema?i=>se(ue)(i):Yg;t({keys:r.event.keys.map(s),data:r.event.data.map(s),transaction_hash:s(r.event.transaction_hash)})}}})}async onTokenBalanceUpdated(e,t,n,r){return this.createStreamSubscription({createStream:()=>this.client.worldClient.subscribeTokenBalances({contract_addresses:e?.map(Mn)||[],account_addresses:t?.map(Mn)||[],token_ids:n?.map(Mn)||[]}),onMessage:s=>{s.balance&&r(this.mappers.tokenBalance(s.balance),s.subscription_id)}})}async updateTokenBalanceSubscription(e,t,n,r){const s=this.findSubscription(e);if(!s)throw new Error("Subscription not found");await this.client.worldClient.updateTokenBalancesSubscription({subscription_id:BigInt(s.id),contract_addresses:t.map(Mn),account_addresses:n.map(Mn),token_ids:r.map(Mn)}).response}async publishMessage(e){const t=this.mappers.message(e),n=await this.client.worldClient.publishMessage(t).response;return this.useEffectSchema?se(ue)(n.entity_id):Yg(n.entity_id)}async publishMessageBatch(e){const t={messages:e.map(this.mappers.message)},n=await this.client.worldClient.publishMessageBatch(t).response,r=this.useEffectSchema?s=>se(ue)(s):Yg;return n.responses.map(s=>r(s.entity_id))}async getWorldMetadata(){const e=await this.client.worldClient.worldMetadata({}).response;return this.mappers.worldMetadataResponse(e)}async getEvents(e){const t=sne(e),n=await this.client.worldClient.retrieveEvents(t).response;return this.mappers.eventsResponse(n)}async getContracts(e){const t=ine(e||{}),n=await this.client.worldClient.retrieveContracts(t).response;return this.mappers.contractsResponse(n)}async updateTokensSubscription(e,t,n){const r=this.findSubscription(e);if(!r)throw new Error("Subscription not found");await this.client.worldClient.updateTokensSubscription({subscription_id:BigInt(r.id),contract_addresses:t?.map(Mn)||[],token_ids:n?.map(Mn)||[]}).response}async onContractsUpdated(e,t){return this.createStreamSubscription({createStream:()=>this.client.worldClient.subscribeContracts({query:{contract_addresses:e.contract_addresses?.map(Mn)||[],contract_types:e.contract_types||[]}}),onMessage:n=>{n.contract&&t(this.mappers.contract(n.contract))}})}findSubscription(e){return this.subscriptions.get(e.id)}destroy(){for(const[e,t]of this.subscriptions)t.cancel();this.subscriptions.clear(),this.client.destroy()}};function Ky(e,t){if(Object.hasOwn(e,"type")&&Object.hasOwn(e,"value"))return{Primitive:{[e.type]:e.value}};if(typeof e=="number")return{Primitive:{U32:e}};if(typeof e=="boolean")return{Primitive:{Bool:e}};if(typeof e=="bigint")return{Primitive:{Felt252:t(e.toString())}};if(typeof e=="string")return{String:e};if(Array.isArray(e))return{List:e.map(n=>Ky(n,t))};throw new Error(`Unsupported primitive type: ${typeof e}`)}function Gne(e,t,n="VariableLen"){return new Zne().keys(e,t,n)}var Zne=class{clause;constructor(){this.clause={}}keys(e,t,n="VariableLen"){return this.clause={Keys:{keys:t.length===0?[void 0]:t,pattern_matching:n,models:e}},this}hashed_keys(e){let t=e.map((n,r)=>{try{return`0x${BigInt(n).toString(16)}`}catch{throw new Error(`Invalid key value at index ${r}: ${n}. Expected a valid BigNumberish value.`)}});return this.clause={HashedKeys:t},this}where(e,t,n,r){let s=Array.isArray(r)?{List:r.map(i=>Ky(i,Us.encodeShortString))}:Ky(r,Us.encodeShortString);return this.clause={Member:{model:e,member:t,operator:n,value:s}},this}compose(){return new Jne}build(){if(Object.keys(this.clause).length===0)throw new Error("You cannot build an empty Clause");return this.clause}},Jne=class{orClauses=[];andClauses=[];or(e){return this.orClauses=e.map(t=>t.build()),this}and(e){return this.andClauses=e.map(t=>t.build()),this}build(){if(this.orClauses.length===0&&this.andClauses.length===0)throw new Error("ComposeClause is empty. Add .or([clause]) or .and([clause])");if(this.orClauses&&this.andClauses.length===0)return{Composite:{operator:"Or",clauses:this.orClauses}};if(this.andClauses&&this.orClauses.length===0)return{Composite:{operator:"And",clauses:this.andClauses}};if(this.andClauses&&this.orClauses)return{Composite:{operator:"And",clauses:[...this.andClauses,{Composite:{operator:"Or",clauses:this.orClauses}}]}};throw new Error("CompositeClause is not properly build")}},zE="Account is undefined",Xne="Clause has not been defined yet. Use `.withClause()` to do so";function Qne(e,t,n,r,s){return{types:{StarknetDomain:[{name:"name",type:"shortstring"},{name:"version",type:"shortstring"},{name:"chainId",type:"shortstring"},{name:"revision",type:"shortstring"}],...s,[e]:r!==void 0?r:Object.keys(t).map(i=>({name:i,type:typeof t[i]=="bigint"||typeof t[i]=="number"?"felt":"string"}))},primaryType:e,domain:n,message:t}}var QC={limit:1e3,cursor:void 0,direction:"Forward",order_by:[]},fd=class eO{constructor(t,n,r){this.limit=t,this.cursor=n,this.direction=r,this.items=[],r||(this.direction="Forward")}items;static fromQuery(t,n){let r=t.getPagination();return new eO(r.limit??1e3,n,r.direction)}withItems(t){return this.items=t,this}getItems(){return this.items}getNextQuery(t){let n=t.withLimit(this.limit);return this.cursor&&n.withCursor(this.cursor),n.getPagination().direction!==this.direction&&n.withDirection(this.direction),n}getPreviousQuery(t){let n=t.withLimit(this.limit);return this.cursor&&n.withCursor(this.cursor),n.getPagination().direction===this.direction&&n.withDirection(ere(this.direction)),n}};function ere(e){return e==="Forward"?"Backward":"Forward"}function Qc(e,t){let n=[];for(let r of e){let s=x_(r.hashed_keys),i=r.models,o={entityId:s,models:{}};for(let a in r.models){let[c,l]=a.split("-");!c||!l||(o.models[c]||(o.models[c]={}),o.models[c][l]=tO(i[a]))}n.push(o)}return Object.values(n)}function Gf(e){switch(e.type){case"primitive":return nre(e);case"struct":return tO(e.value);case"enum":return e.value.option==="Some"?new Bl(xn.Some,Gf(e.value.value)):e.value.option==="None"?new Bl(xn.None):tre(e);case"tuple":case"array":return e.value.map(Gf);default:return e.value}}function tre(e){return e.value.value.type==="tuple"?e.value.option:new nc({[e.value.option]:Gf(e.value.value)})}function nre(e){switch(e.type_name){case"u64":case"i64":return Number(e.value);case"u128":case"i128":return BigInt(e.value);case"u256":return BigInt(e.value);case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":case"bool":case"ContractAddress":case"ClassHash":case"felt252":case"EthAddress":default:return e.value}}function tO(e){let t=e instanceof Map?Array.from(e.entries()):Object.entries(e);return Object.fromEntries(t.map(([n,r])=>[n,Gf(r)]))}function qE(e){return t=>{try{if(e){let n=Qc([t]);e({data:n,error:void 0})}}catch(n){e&&e({data:void 0,error:n instanceof Error?n:new Error(String(n))})}}}function Yo(e,t){return n=>{if(n!==t)try{e({data:n,error:void 0})}catch(r){e({data:void 0,error:r})}}}var Yy={};function rr(e){return e.contractAddresses&&(e.contractAddresses=e.contractAddresses.map(t=>x_(t))),e.accountAddresses&&(e.accountAddresses=e.accountAddresses.map(t=>x_(t))),{contractAddresses:e.contractAddresses??[],accountAddresses:e.accountAddresses??[],attributesFilter:e.attributesFilter??[],contractTypes:e.contractTypes??[],tokenIds:e.tokenIds??[],pagination:e.pagination??QC}}function rre(e){return e.map(t=>({trait_name:t.name,trait_value:t.value}))}async function nO(e,t){let{contractAddresses:n,tokenIds:r,pagination:s,attributesFilter:i}=rr(t);return await e.getTokens({contract_addresses:n,token_ids:r,attribute_filters:rre(i),pagination:s})}async function sre(e,t){let{contractAddresses:n,contractTypes:r,pagination:s}=rr(t);return await e.getTokenContracts({contract_addresses:n,contract_types:r,pagination:s})}async function rO(e,t){let{contractAddresses:n,accountAddresses:r,tokenIds:s,pagination:i}=rr(t);return await e.getTokenBalances({contract_addresses:n,account_addresses:r,token_ids:s,pagination:i})}async function ire(e,t){let{subscription:n,contractAddresses:r,accountAddresses:s,tokenIds:i}=t;return await e.updateTokenBalanceSubscription(n,r??[],s??[],i??[])}async function ore(e,t){let{contractAddresses:n,accountAddresses:r,tokenIds:s,callback:i}=t,o=await rO(e,{contractAddresses:n??[],accountAddresses:r??[],tokenIds:s??[]}),a=await e.onTokenBalanceUpdated(n??[],r??[],s??[],Yo(i,Yy));return[o,a]}var Gy={};async function are(e,t){let{contractAddresses:n,tokenIds:r,callback:s}=t,i=await nO(e,{contractAddresses:n??[],tokenIds:r??[]}),o=await e.onTokenUpdated(n??[],r??[],Yo(s,Gy));return[i,o]}var cre=()=>({pagination:{limit:100,cursor:void 0,direction:"Forward",order_by:[]},clause:void 0,no_hashed_keys:!0,models:[],historical:!1}),lre=class sO{query;constructor(t){this.query={...cre(),...t}}withLimit(t){return this.query.pagination.limit=t,this}withOffset(){return this}withCursor(t){return this.query.pagination.cursor=t,this}withDirection(t){return this.query.pagination.direction=t,this}withClause(t){return this.query.clause=t,this}includeHashedKeys(){return this.query.no_hashed_keys=!1,this}addOrderBy(t,n){return this.query.pagination.order_by.push({field:t,direction:n}),this}withOrderBy(t){return this.query.pagination.order_by=t,this}addEntityModel(t){return this.query.models.push(t),this}withEntityModels(t){return this.query.models=t,this}build(){return this.query}static withPagination(t,n,r){return new sO().withLimit(n).withCursor(t).withDirection(r)}getClause(){return this.query.clause?qn(this.query.clause):En(Xne)}getPagination(){return this.query.pagination}isHistorical(){return this.query.historical}};function ure({client:e,config:t,sendMessage:n,sendMessageBatch:r,grpcClient:s}){let i=s??e;if(!i)throw new Error("Either client or grpcClient must be provided");let o=s??new Yne({toriiUrl:t.client.toriiUrl??"http://localhost:8080",worldAddress:t.client.worldAddress});return{client:e,subscribeEntityQuery:async({query:a,callback:c})=>{let l=a.build(),u=await i.getEntities(l),d=Qc(u.items);return[fd.fromQuery(a,u.next_cursor).withItems(d),await i.onEntityUpdated(l.clause,qE(c))]},subscribeEventQuery:async({query:a,callback:c})=>{let l=a.build(),u=await o.getEventMessages(l),d=Qc(u.items);return[fd.fromQuery(a,u.next_cursor).withItems(d),await o.onEventMessageUpdated(l.clause,qE(c))]},subscribeTokenBalance:async a=>{if(s){let{contractAddresses:c,accountAddresses:l,tokenIds:u,pagination:d}=rr(a),f=await s.getTokenBalances({contract_addresses:c,account_addresses:l,token_ids:u,pagination:d}),h=await s.onTokenBalanceUpdated(c??[],l??[],u??[],Yo(a.callback,Yy));return[f,h]}return await ore(e,a)},getEntities:async({query:a})=>{let c=a.build(),l=await i.getEntities(c);return fd.fromQuery(a,l.next_cursor).withItems(Qc(l.items))},getEventMessages:async({query:a})=>{let c=a.build(),l=await i.getEventMessages(c);return fd.fromQuery(a,l.next_cursor).withItems(Qc(l.items))},generateTypedData:(a,c,l,u)=>Qne(a,c,t.domain,l,u),sendMessage:n,sendMessageBatch:r,sendSignedMessageBatch:async a=>{try{return qn(await i.publishMessageBatch(a))}catch(c){throw console.error("Failed to send signed message batch:",c),c}},getTokens:async a=>{if(s){let{contractAddresses:c,tokenIds:l,pagination:u}=rr(a);return await s.getTokens({contract_addresses:c,token_ids:l,pagination:u})}return await nO(e,a)},getTokenContracts:async a=>{if(s){let{contractAddresses:c,contractTypes:l,pagination:u}=rr(a);return await s.getTokenContracts({contract_addresses:c,contract_types:l,pagination:u})}return await sre(e,a)},getTokenBalances:async a=>{if(s){let{contractAddresses:c,accountAddresses:l,tokenIds:u,pagination:d}=rr(a);return await s.getTokenBalances({contract_addresses:c,account_addresses:l,token_ids:u,pagination:d})}return await rO(e,a)},onTokenBalanceUpdated:async a=>{let{contractAddresses:c,accountAddresses:l,tokenIds:u}=rr(a);return await o.onTokenBalanceUpdated(c??[],l??[],u??[],Yo(a.callback,Yy))},onTokenUpdated:async a=>{let{contractAddresses:c,tokenIds:l}=rr(a);return await o.onTokenUpdated(c??[],l??[],Yo(a.callback,Gy))},updateTokenBalanceSubscription:async a=>{if(s){let{contractAddresses:c,accountAddresses:l,tokenIds:u}=rr(a);return await s.updateTokenBalanceSubscription(a.subscription,c??[],l??[],u??[])}return await ire(e,a)},updateEntitySubscription:async(a,c)=>await i.updateEntitySubscription(a,c),updateEventMessageSubscription:async(a,c,l)=>await o.updateEventMessageSubscription(a,c),getControllers:async(a,c,l=QC)=>await i.getControllers({contract_addresses:a,usernames:c,pagination:l}),subscribeToken:async a=>{if(s){let{contractAddresses:c,tokenIds:l,pagination:u}=rr(a),d=await s.getTokens({contract_addresses:c,token_ids:l,pagination:u}),f=await s.onTokenUpdated(c??[],l??[],Yo(a.callback,Gy));return[d,f]}return await are(e,a)}}}var dre={toriiUrl:"http://localhost:8080"};async function fre(e){let t;if(!e.grpcClient){let n={...dre,...e.client};t=await new Ch(n)}return ure({client:t,config:e,sendMessage:async(n,r)=>{if(!r)return En(zE);try{let s=await r.signMessage(n),i=JSON.stringify(n),o=e.grpcClient||t;return qn(await o.publishMessage({message:i,signature:Array.isArray(s)?s:[s.r.toString(),s.s.toString()]}))}catch(s){throw console.error("Failed to send message:",s),s}},sendMessageBatch:async(n,r)=>{if(!r)return En(zE);try{let s=[];for(let o of n){let a=await r.signMessage(o),c=JSON.stringify(o);s.push({message:c,signature:Array.isArray(a)?a:[a.r.toString(),a.s.toString()]})}let i=e.grpcClient||t;return qn(await i.publishMessageBatch(s))}catch(s){throw console.error("Failed to send message batch:",s),s}},grpcClient:e.grpcClient})}const hre=[{address:"0x4389260c4f329b2039c848aba5d1575ad1374c910b85c91561079a5b33db426",class_hash:"0x33b10c88c52d3f5a12a4909b52b1bbbf194d520936ca751ce711c8c548f70c9",abi:[{type:"impl",name:"actions__ContractImpl",interface_name:"dojo::contract::interface::IContract"},{type:"interface",name:"dojo::contract::interface::IContract",items:[]},{type:"impl",name:"DojoDeployedContractImpl",interface_name:"dojo::meta::interface::IDeployedResource"},{type:"struct",name:"core::byte_array::ByteArray",members:[{name:"data",type:"core::array::Array::<core::bytes_31::bytes31>"},{name:"pending_word",type:"core::felt252"},{name:"pending_word_len",type:"core::integer::u32"}]},{type:"interface",name:"dojo::meta::interface::IDeployedResource",items:[{type:"function",name:"dojo_name",inputs:[],outputs:[{type:"core::byte_array::ByteArray"}],state_mutability:"view"}]},{type:"impl",name:"ActionsImpl",interface_name:"dojo_stark_explorer::systems::actions::IActions"},{type:"enum",name:"dojo_stark_explorer::models::Direction",variants:[{name:"Middle",type:"()"},{name:"Left",type:"()"},{name:"Right",type:"()"}]},{type:"interface",name:"dojo_stark_explorer::systems::actions::IActions",items:[{type:"function",name:"spawn",inputs:[],outputs:[],state_mutability:"external"},{type:"function",name:"collect_coins",inputs:[],outputs:[],state_mutability:"external"},{type:"function",name:"move",inputs:[{name:"direction",type:"dojo_stark_explorer::models::Direction"}],outputs:[],state_mutability:"external"}]},{type:"function",name:"dojo_init",inputs:[],outputs:[],state_mutability:"view"},{type:"impl",name:"WorldProviderImpl",interface_name:"dojo::contract::components::world_provider::IWorldProvider"},{type:"struct",name:"dojo::world::iworld::IWorldDispatcher",members:[{name:"contract_address",type:"core::starknet::contract_address::ContractAddress"}]},{type:"interface",name:"dojo::contract::components::world_provider::IWorldProvider",items:[{type:"function",name:"world_dispatcher",inputs:[],outputs:[{type:"dojo::world::iworld::IWorldDispatcher"}],state_mutability:"view"}]},{type:"impl",name:"UpgradeableImpl",interface_name:"dojo::contract::components::upgradeable::IUpgradeable"},{type:"interface",name:"dojo::contract::components::upgradeable::IUpgradeable",items:[{type:"function",name:"upgrade",inputs:[{name:"new_class_hash",type:"core::starknet::class_hash::ClassHash"}],outputs:[],state_mutability:"external"}]},{type:"constructor",name:"constructor",inputs:[]},{type:"event",name:"dojo::contract::components::upgradeable::upgradeable_cpt::Upgraded",kind:"struct",members:[{name:"class_hash",type:"core::starknet::class_hash::ClassHash",kind:"data"}]},{type:"event",name:"dojo::contract::components::upgradeable::upgradeable_cpt::Event",kind:"enum",variants:[{name:"Upgraded",type:"dojo::contract::components::upgradeable::upgradeable_cpt::Upgraded",kind:"nested"}]},{type:"event",name:"dojo::contract::components::world_provider::world_provider_cpt::Event",kind:"enum",variants:[]},{type:"event",name:"dojo_stark_explorer::systems::actions::actions::Event",kind:"enum",variants:[{name:"UpgradeableEvent",type:"dojo::contract::components::upgradeable::upgradeable_cpt::Event",kind:"nested"},{name:"WorldProviderEvent",type:"dojo::contract::components::world_provider::world_provider_cpt::Event",kind:"nested"}]}],init_calldata:[],tag:"Stark_Explorer_Game-actions",selector:"0x8292d2b4cd0a7a8580e178289da759e637e3975ba8663b99a6a5e58d88c46d",systems:["spawn","collect_coins","move","upgrade"]}],pre={contracts:hre},gre=pre.contracts.find(e=>e.tag==="Stark_Explorer_Game-actions"),_re={chains:[{rpcUrl:"https://api.cartridge.gg/x/starknet/sepolia"}],defaultChainId:"0x534e5f5345504f4c4941",policies:{contracts:{[gre.address]:{name:"Actions",description:"Actions contract to control the player movement",methods:[{name:"Spawn",entrypoint:"spawn",description:"Spawns the player, resets score, and displays high score in the game"},{name:"Move",entrypoint:"move",description:"Move the player in the game"},{name:"Collect Coins",entrypoint:"collect_coins",description:"Collects Coins"}]}}}},e0=3,t0=[16.5,50,83.5],yre=800,mre=1400,iO=1800,oO=3200,bre=4200,wre=3800;let HE=null,WE=null,Ya=!1,Ts=1,Zy=null,Zf=null,ds=new Set;const Jy=document.getElementById("playfield"),Xy=document.getElementById("ufo"),Jf=document.getElementById("score-display"),Zl=document.getElementById("score-big"),KE=document.getElementById("high-score-display"),Qy=document.getElementById("high-big"),YE=document.getElementById("position-display"),Gg=document.getElementById("spawn-button"),GE=document.getElementById("coinSound"),ZE=document.getElementById("crashSound"),hd=document.getElementById("leaderboard");function js(e,t){return Math.floor(Math.random()*(t-e+1))+e}function kre(){const e=document.getElementById("starfield");if(!e)return;const t=e.getContext("2d");let n=e.width=innerWidth,r=e.height=innerHeight;const s=[],i=Math.floor(n*r/5e3);function o(){n=e.width=innerWidth,r=e.height=innerHeight,s.length=0;for(let c=0;c<i;c++)s.push({x:Math.random()*n,y:Math.random()*r,r:Math.random()*1.6+.2,speed:Math.random()*.4+.05,alpha:.3+Math.random()*.7})}o(),window.addEventListener("resize",o);function a(){t.clearRect(0,0,n,r);for(const c of s)c.y+=c.speed,c.y>r&&(c.y=0),t.globalAlpha=c.alpha,t.fillStyle="#ffffff",t.fillRect(c.x,c.y,c.r,c.r);requestAnimationFrame(a)}requestAnimationFrame(a)}const JE="Stark_Explorer_Game",XE="Coins",Ere="Stark_Explorer_Game-actions";function Tre(e){e.forEach(t=>{if(t.models&&t.models[JE][XE]){const n=t.models[JE][XE];aO(n.score),cO(n.high_score),vre(n.high_score)}})}function aO(e){Jf&&(Jf.textContent=`Coins: ${e}`),Zl&&(Zl.textContent=e)}function cO(e){KE&&(KE.textContent=`High Score: ${e}`),Qy&&(Qy.textContent=e)}function vre(e){if(typeof e!="number"&&typeof e!="string")return;const t=Number(e),n="stark_explorer_local_leaderboard_v1";try{const r=localStorage.getItem(n);let s=r?JSON.parse(r):[];const i=s.findIndex(o=>o.name==="You");i>=0?s[i].score<t&&(s[i].score=t):s.push({name:"You",score:t}),s=s.sort((o,a)=>a.score-o.score).slice(0,5),localStorage.setItem(n,JSON.stringify(s)),Sre(s)}catch(r){console.warn("leaderboard update fail",r)}}function Sre(e){if(hd){if(hd.innerHTML="",e.length===0){hd.innerHTML='<div class="muted">No scores yet — collect some coins!</div>';return}e.forEach((t,n)=>{const r=document.createElement("div");r.className="leader",r.innerHTML=`<div><div class="name">${n+1}. ${t.name}</div><div class="score">${t.score}</div></div>`,hd.appendChild(r)})}}async function Are(e,t){if(!(!e||!t))try{const n=await e.execute({contractAddress:t.contracts.find(r=>r.tag===Ere).address,entrypoint:"spawn",calldata:[]});console.log("Spawn tx sent:",n)}catch(n){console.error("spawn fail",n)}}function Ire(e,t){HE=e,WE=t,Gg&&(Gg.disabled=!1,Gg.onclick=()=>Are(HE,WE)),Ts=1,em(Ts),window.addEventListener("keydown",Nre),xre()}function Nre(e){e.key==="ArrowLeft"&&Ts>0?(Ts--,em(Ts)):e.key==="ArrowRight"&&Ts<e0-1&&(Ts++,em(Ts))}function em(e){const t=t0[e];Xy.style.left=`${t}%`,YE&&(YE.textContent=`Lane (${e})`)}let lO=0;function xre(){uO(),Ya=!0,dO(),fO()}function uO(){Ya=!1,Zy&&clearTimeout(Zy),Zf&&clearTimeout(Zf),ds.forEach(e=>{const t=document.getElementById(e);t&&t.remove()}),ds.clear()}function dO(){Ya&&(Zy=setTimeout(()=>{Ore(),dO()},js(yre,mre)))}function fO(){Ya&&(Zf=setTimeout(()=>{pO(),fO()},js(iO,oO)))}function hO(e){if(!Xy||!e)return!1;const t=Xy.getBoundingClientRect(),n=e.getBoundingClientRect();return!(t.top>n.bottom||t.bottom<n.top||t.left>n.right||t.right<n.left)}function Rre(e,t){clearInterval(t),e.remove(),ds.delete(e.id),ZE&&ZE.play(),uO(),Zl&&(Zl.textContent="GAME OVER"),Jf&&(Jf.textContent="Game Over"),alert("You hit an asteroid! Game Over.")}function Cre(e,t){clearInterval(t),e.remove(),ds.delete(e.id),GE&&GE.play();let n=parseInt(Zl.textContent)||0;n+=1,aO(n),cO(Math.max(n,parseInt(Qy.textContent)||0))}function Ore(){const e=js(0,e0-1),t=`asteroid-${++lO}`,n=document.createElement("div");n.className="asteroid",n.id=t;const r=js(36,62);n.style.width=`${r}px`,n.style.height=`${r}px`;const s=(Math.random()-.5)*10;n.style.left=`${t0[e]+s}%`,n.style.animationDuration=`${bre+js(-200,200)}ms`,Jy.appendChild(n),ds.add(t);const i=setInterval(()=>{if(!document.getElementById(t))return clearInterval(i);hO(n)&&Rre(n,i)},50);n.addEventListener("animationend",()=>{n.remove(),ds.delete(t),clearInterval(i)})}function pO(){if(!Ya)return;const e=js(0,e0-1),t=`coin-${++lO}`,n=document.createElement("div");n.id=t,n.className="coin",n.style.width="28px",n.style.height="28px";const r=t0[e],s=(Math.random()-.5)*8;n.style.left=`${r+s}%`,n.style.top="-40px";const i=wre+js(-200,400);n.style.transition=`transform ${i}ms linear`,Jy.appendChild(n),ds.add(t),requestAnimationFrame(()=>{n.style.transform=`translateY(${Jy.clientHeight+40}px)`});const o=setInterval(()=>{if(!document.getElementById(t)){clearInterval(o),ds.delete(t);return}hO(n)&&Cre(n,o)},80);if(setTimeout(()=>{document.getElementById(t)&&(n.remove(),ds.delete(t)),clearInterval(o)},i+50),Ya){const a=js(iO,oO);Zf=setTimeout(pO,a)}}const QE=await fetch("./manifest_sepolia.json").then(e=>e.json()),Bre={name:"Stark_Explorer",version:"1.0",chainId:"0x534e5f5345504f4c4941",revision:"1"};async function $re(e){const t=await fre({client:{worldAddress:QE.world.address,toriiUrl:"https://api.cartridge.gg/x/starkExplorer/torii"},domain:Bre});Ire(e,QE);const[n,r]=await t.subscribeEntityQuery({query:new lre().withClause(Gne(["Stark_Explorer_Game-Position","Stark_Explorer_Game-Coins"],[e.address],"FixedLen").build()),callback:({data:s,error:i})=>{s&&Tre(s),i&&console.error(i)}});window.addEventListener("beforeunload",()=>{r&&r.cancel()})}const Dre=new aP(_re);document.getElementById("controller-button").onclick=async()=>{try{console.log("Connecting to Cartridge...");const e=await Dre.connect();if(!e)throw new Error("No account returned from Cartridge");console.log("Connected to Cartridge:",e.address),kre();const t=document.getElementById("controller-button");t.textContent="Connected",t.style.backgroundColor="#4CAF50",document.getElementById("spawn-button").disabled=!1,setTimeout(()=>{$re(e).catch(n=>console.error("Game error:",n))},500)}catch(e){console.error("Failed to connect:",e);const t=document.getElementById("controller-button");t.textContent="Connection Failed",t.style.backgroundColor="#f44336"}};
